{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "0",
      "Content_Hash": "0"
    },
    "Metadata": [
      {
        "Id": [
          "acf6c265-cd3a-470f-bd85-24b1907d3eb1"
        ],
        "Id_History": [
          "acf6c265-cd3a-470f-bd85-24b1907d3eb1,c51828ec-041f-48f9-a2d8-c6c0af074119,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "Access to the Credential Store Is Limited"
        ],
        "Category": [
          "Authentication"
        ],
        "Phase": [
          "Design"
        ],
        "Technology": [
          "Scala Play"
        ],
        "Type": [
          "Checklist Item"
        ],
        "DirectLink": [
          "Access to the Credential Store Is Limited"
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "false",
          "DataType": "html"
        },
        "Data": [
          "<h1>Applies to</h1>\r\n  <p>Scala and Play Framework 2.1.0+<br /></p>\r\n  <h1>What to Check For</h1>\r\n  <p>Ensure that access to the credential store is properly secured and limited to administrators with the correct privileges.</p>\r\n  <h1>Why</h1>\r\n  <p>Unauthorized access to the credential store can allow an attacker to overwrite users' credentials and gain access to application resources.</p>\r\n  <h1>How to Check</h1>Follow these steps to ensure that the credential store is properly secured:\r\n  <ul></ul><ol><li><p><strong>Identify all routines that access the store. </strong>Locate all routines within your application that access the credential store. Such routines include:</p><ul><li>Authenticating users </li><li>Creating users </li><li>Modifying users </li><li>Changing user passwords</li></ul></li><li><p><strong>Verify that credentials for accessing the store are secured. </strong>Ensure that your application's access credentials and connection strings are not hard-coded into your application's code base. </p><ul><li>If your application <strong>uses a database</strong> for its credential repository, ensure that access credentials and connection strings are secured properly. </li><li>If your application <strong>does not use a database</strong>\r\n for its credential repository, verify that only the appropriate \r\ncomponents of your application are able to access the credential store.</li></ul></li><ul><li>Example of how&nbsp;<strong>not</strong>&nbsp;to handle access to the credential store:<blockquote><pre>// The application discloses the credentials necessary for accessing the user database<br />val driver = \"com.mysql.jdbc.Driver\"\r\nval url = \"jdbc:mysql://localhost/mysql\"\r\nval username = \"root\"\r\nval password = \"root\"\r\nClass.forName(driver)\r\nconnection = DriverManager.getConnection(url, username, password)</pre></blockquote><br /></li></ul><li><b>Check the access controls for your credential store</b>. Ensure that your application's credential store has the appropriate \r\nsecurity in place. For instance, if your application uses a database for\r\n its credential store, verify that the database server is secured \r\nproperly.</li></ol><ol></ol><h1>How to Fix</h1><p>Follow these steps to properly secure the credential store:</p><ol><li><p><strong>Do not disclose the location of the store within your application. </strong>Do not let&nbsp;regular application users know where the store is located.</p></li><li><p><strong>Secure credentials required for accessing the store. </strong>Store the necessary sensitive information in Environment variables, and create a mapping to them in the configuration file (e.g., <font face=\"Courier New\">application.conf</font> file).</p></li><li><p><strong>Restrict access to the credential store.&nbsp;</strong>Limit the number of users that can access the store. If it is a file on the local file system, set the appropriate permissions to restrict the read/write access. If it is a database, restrict the accounts that can access the database server.</p></li></ol><h1>Problem Example</h1><p>The following code authenticates a user based on their credentials. Because the code discloses the credentials to the user database, anybody with access to the code also has access to the credential store.</p><pre>package jdbc\r\n\r\nimport java.sql.DriverManager\r\nimport java.sql.Connection\r\n\r\nobject ScalaJdbcConnectSelect {\r\n\r\n  def main(args: Array[String]) {\r\n    // connect to the database named \"mysql\" on the localhost\r\n    val driver = \"com.mysql.jdbc.Driver\"\r\n    val url = \"jdbc:mysql://localhost/mysql\"\r\n    val username = \"root\"\r\n    val password = \"root\"\r\n\r\n    var connection:Connection = null\r\n\r\n    try {\r\n      // make the connection\r\n      Class.forName(driver)\r\n      connection = DriverManager.getConnection(url, username, password)\r\n\r\n      // create the statement, and run the select query\r\n      val statement = connection.createStatement()\r\n      val resultSet = statement.executeQuery(\"SELECT host, user FROM user\")\r\n      while ( resultSet.next() ) {\r\n        val host = resultSet.getString(\"host\")\r\n        val user = resultSet.getString(\"user\")\r\n        println(\"host, user = \" + host + \", \" + user)\r\n      }\r\n    } catch {\r\n      case e =&gt; e.printStackTrace\r\n    }\r\n    connection.close()\r\n  }\r\n\r\n}</pre><h1>Solution Example</h1><p>The following code authenticates a user based on their credentials. The code relies on other parts of the application to handle database connectivity. Therefore, the code does not reveal the application's credentials to the credential store.</p><pre>package jdbc\r\n\r\nimport java.sql.DriverManager\r\nimport java.sql.Connection\r\nimport play.api.Play.current\r\n\r\nobject ScalaJdbcConnectSelect {\r\n\r\n  def main(args: Array[String]) {\r\n\r\n    val driver = \"com.mysql.jdbc.Driver\"\r\n    val url = getString(\"server.auth.url\")\r\n    val username = getString(\"server.auth.username\")\r\n    val password = getString(\"server.auth.password\")\r\n\r\n    var connection:Connection = null\r\n\r\n    try {\r\n      // make the connection\r\n      Class.forName(driver)\r\n      connection = DriverManager.getConnection(url, username, password)\r\n\r\n      // create the statement, and run the select query\r\n      val statement = connection.createStatement()\r\n      val resultSet = statement.executeQuery(\"SELECT host, user FROM user\")\r\n      while ( resultSet.next() ) {\r\n        val host = resultSet.getString(\"host\")\r\n        val user = resultSet.getString(\"user\")\r\n        println(\"host, user = \" + host + \", \" + user)\r\n      }\r\n    } catch {\r\n      case e =&gt; e.printStackTrace\r\n    }\r\n    connection.close()\r\n  }\r\n\r\n}</pre>The content of application.conf file would be:<pre>include \"base.conf\"\r\n\r\nserver.auth.username=${AUTH_USERNAME}\r\nserver.auth.password=${AUTH_PASSWORD}\r\nserver.auth.url=${AUTH_PASSWORD}</pre>These values would then be pulled from the environment variables or some other secure location.<div><br /></div><div><br /></div>"
        ]
      }
    ]
  }
}