<h2>Applies To</h2><ul><li> HTML5</li>
<li> PHP</li>
</ul><h2>What to Check For</h2><p>Verify that the X-Frame-Options header is added to responses programmatically.
</p><h2>Why</h2><p>The X-Frame-Options response header instructs the browser to disallow the use of iframes across domains or limit their use to the same origin. This protects against clickjacking, a malicious technique that uses iframes to overlay (hide) a clickable link or button on a web page. In a clickjacking attack, a user thinks he or she is clicking the intended link but actually clicks the overlaid iframe link, thus sending data to an unintended website. 
</p><h2>When</h2><p>Use this guideline when implementing HTML5 web applications where the web page is not intended for rendering in a frame or iframe.
</p><h2>How to Check</h2><p>To verify that the X-Frame-Options header is added to responses programmatically:
</p><ol>
<li>Search the application code for references to the <em>header</em> function. Create a spreadsheet to list all code that uses the <em>header</em> function. #Examine each piece of code that uses the <em>header</em> function to make sure that it uses <em>x-frame-options</em> as the parameter and that the appropriate restrictions for iframes are set in this parameter.</li>
</ol><h2>How to Fix</h2><p>To add the X-Frame-Options header to responses programmatically:
</p><ol>
<li>Add the following to the response at the top of the PHP page to deny any framing in the page: <tt> header("x-frame-options: DENY"); </tt> </li>
<li>Alternatively, add the following to the response at the top of the PHP page to allow framing in the page only from the same domain as the application: <tt> header("x-frame-options: SAMEORIGIN"); </tt></li>
</ol>
<h2>HTTP Header Guidelines</h2><ul><li> <a href="00000000-0000-0000-0000-00000028bb7d">Use X-Content-Security-Policy to Mitigate XSS</a></li>
<li> <a href="00000000-0000-0000-0000-0000009026c0">Use X-XSS-Protection to Prevent Reflected XSS</a></li>
<li> <a href="00000000-0000-0000-0000-000000204a22">Use X-Frame-Options to Prevent ClickJacking</a></li>
<li> <a href="9e0f93ba-0b80-4aab-b93c-c17b9af2a19c">Use a Filter to Inject X-Frame-Options</a></li>
<li> <a href="ae2dc4f8-af3d-4002-9417-f3f1d5c9128b">Add X-Frame Options to Responses</a></li>
<li> <a href="00000000-0000-0000-0000-00000063561d">Use the Strict-Transport-Security Header to Enforce HTTPS</a></li>
<li> <a href="00000000-0000-0000-0000-000000225f24">Use includeSubDomains with Strict-Transport-Security</a></li>
</ul><h2>HTTP Header Checklist Items</h2><ul><li> <a href="00000000-0000-0000-0000-0000006b6766">X-Content-Security-Policy Is Used to Mitigate XSS</a></li>
<li> <a href="00000000-0000-0000-0000-0000007122c6">X-XSS-Protection Is Used to Prevent Reflected XSS</a></li>
<li> <a href="00000000-0000-0000-0000-000000498810">X-Frame-Options Are Used to Prevent Clickjacking</a></li>
<li> <a href="0d1871fe-76d3-4ea3-87be-ef63662dd772">A Filter Is Used to Inject X-Frame Options</a></li>
<li> <a href="26caffea-d597-40fd-9ed0-36fb025d188b">X-Frame Options Are Added to Responses</a></li>
<li> <a href="00000000-0000-0000-0000-0000001b501f">The Strict-Transport-Security Header is Used to Enforce HTTPS</a></li>
<li> <a href="0078cd3f-9e84-4eb4-9a2f-7f51e3100801">IncludeSubDomains is Used with Strict-Transport-Security</a></li>
</ul>