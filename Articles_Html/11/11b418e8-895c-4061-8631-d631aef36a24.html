<h2>What to Check For</h2><p>Ensure log files are protected.
</p><h2>Why</h2><p>Log files often contain internal application details that could enable an attacker to more effectively target your application.
</p><h2>How to Check</h2><p>Use these steps to ensure log files are protected:
</p><ol>
<li> <strong>Verify that the log location is not disclosed.</strong> Scan your application's code base to verify that the location of the log files is known only to the internal logging framework.</li>
<li> <strong>Check the file permissions of logs.</strong> Verify that the logs are set with the appropriate file system permissions. All entities, excluding your application and its administrators/developers, must be prohibited access to the logs. If your application backs up its logs, verify that log backups are stored into an environment that is as secure as the storage environment for the current logs.</li>
<li> <strong>Check the log server capabilities.</strong> The log server should protect the log files. Ask the vendor for information about controls used to protect the log files on the log server.</li>
<li> <strong>Check that only users with job-related needs have access to logs.</strong> Verify that only authorized employees have user accounts on the log server. Examine the administration interface on the log server to get a list of users. Make sure that all the users are authorized and that their authorizations are based on legitimate job-related needs by interviewing them.</li>
<li> <strong>Check that measures are taken to prevent tampering.</strong> Consult the documentation or technical support to make sure the log server solution implements measures to prevent tampering. Verify that the log server is physically secure, preferably in a separate locked room.</li>
<li> <strong>Verify that logs are current.</strong> Get the list of network devices from the network documentation. For a random sample of devices, verify that the logs from them are present on the log server and that the logs are current.</li>
<li> <strong>Confirm file-integrity monitoring capability.</strong> Consult the vendor's documentation or technical support to make sure the log server solution implements some form of file-integrity monitoring.</li>
</ol><h2>How to Fix</h2><p>Perform the following actions to secure the log files:
</p><ol>
<li> <strong>Secure the log server.</strong> All the functionality to comply with this requirement should be provided by the centralized log server. Ask the vendor for information about securing the log server.</li>
<li> <strong>Only allow access to users with job-related needs.</strong> Most centralized log servers have built-in access control. The flexibility of this access control is different for different solutions. To satisfy this requirement, it is sufficient to only create access accounts for authorized employees who have a legitimate job-related need to view the logs. Ideally, the authentication mechanism on the log server should be integrated with the rest of the network.</li>
<li> <strong>Prevent tampering.</strong> Most centralized log server solutions have built-in controls to prevent tampering. The exact controls vary, but they typically include an access control list and some means of preventing privileged users or users with physical access from altering the log files. The latter typically does not need to be configured. It is recommended to segregate the log server physically by placing it in a locked room.</li>
<li> <strong>Configure all network devices to send logs to the log server.</strong> Forward the logs from all compatible devices to the log server. For detailed instructions on sending the logs to the log server, please refer to the vendor's documentation or technical support.</li>
<li> <strong>Configure file-integrity monitoring.</strong> This feature should be implemented by the log server solution itself. It should not require configuration on the part of the staff. Please refer to the vendor's documentation or technical support to make sure that your log server is compliant with this requirement.</li>
</ol>