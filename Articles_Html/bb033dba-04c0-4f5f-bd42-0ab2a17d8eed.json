{
  "id": "bb033dba-04c0-4f5f-bd42-0ab2a17d8eed",
  "checksum": "f3f37836e90ab8d9f5bd60d8d4678f04ca1ba36c",
  "words": {
    "what": [
      "h1"
    ],
    "to": [
      "h1",
      "p",
      "h1",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "li",
      "p",
      "p",
      "h1",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p"
    ],
    "check": [
      "h1",
      "h1",
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "p",
      "strong"
    ],
    "for": [
      "h1",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "unless": [
      "p"
    ],
    "absolutely": [
      "p",
      "p"
    ],
    "necessary": [
      "p",
      "p"
    ],
    "the": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p"
    ],
    "application": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "p",
      "p",
      "title"
    ],
    "should": [
      "p"
    ],
    "not": [
      "p",
      "ol",
      "li",
      "p",
      "p"
    ],
    "accept": [
      "p"
    ],
    "file": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "strong",
      "title"
    ],
    "names": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "or": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "p"
    ],
    "paths": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "strong"
    ],
    "as": [
      "p"
    ],
    "input": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "why": [
      "h1"
    ],
    "malicious": [
      "p"
    ],
    "can": [
      "p",
      "ol",
      "li",
      "p",
      "ol",
      "li",
      "p"
    ],
    "be": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "used": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "coerce": [
      "p"
    ],
    "your": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "into": [
      "p"
    ],
    "accessing": [
      "p"
    ],
    "arbitrary": [
      "p"
    ],
    "files": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "and": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "resources": [
      "p"
    ],
    "how": [
      "h1",
      "h1"
    ],
    "use": [
      "p",
      "ol",
      "li",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "following": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "steps": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "this": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "problem": [
      "p"
    ],
    "find": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "all": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "ul",
      "li",
      "a"
    ],
    "sources": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "p"
    ],
    "of": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p"
    ],
    "in": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "ol",
      "li",
      "p"
    ],
    "during": [
      "ol",
      "li",
      "p"
    ],
    "design": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "time": [
      "ol",
      "li",
      "p"
    ],
    "identify": [
      "ol",
      "li",
      "p"
    ],
    "potential": [
      "ol",
      "li",
      "p"
    ],
    "scour": [
      "ol",
      "li",
      "p"
    ],
    "source": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "code": [
      "ol",
      "li",
      "p",
      "p"
    ],
    "discover": [
      "ol",
      "li",
      "p"
    ],
    "that": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p"
    ],
    "may": [
      "ol",
      "li",
      "p"
    ],
    "have": [
      "ol",
      "li",
      "p"
    ],
    "been": [
      "ol",
      "li",
      "p"
    ],
    "missed": [
      "ol",
      "li",
      "p"
    ],
    "compile": [
      "ol",
      "li",
      "p"
    ],
    "a": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "list": [
      "ol",
      "li",
      "p"
    ],
    "you": [
      "ol",
      "li",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "determine": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "if": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "any": [
      "ol",
      "li",
      "p",
      "strong",
      "ol",
      "li",
      "p"
    ],
    "provides": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "path": [
      "ol",
      "li",
      "p",
      "strong",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "title"
    ],
    "information": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "examine": [
      "ol",
      "li",
      "p"
    ],
    "each": [
      "ol",
      "li",
      "p"
    ],
    "it": [
      "ol",
      "li",
      "p"
    ],
    "is": [
      "ol",
      "li",
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "ul",
      "li",
      "a"
    ],
    "generate": [
      "ol",
      "li",
      "p"
    ],
    "name": [
      "ol",
      "li",
      "p",
      "ol",
      "li",
      "p",
      "title"
    ],
    "path&nbsp;look": [
      "ol",
      "li",
      "p"
    ],
    "only": [
      "ol",
      "li",
      "p",
      "ol",
      "li",
      "p"
    ],
    "provide": [
      "ol",
      "li",
      "p"
    ],
    "full": [
      "ol",
      "li",
      "p",
      "ol",
      "li",
      "p"
    ],
    "but": [
      "ol",
      "li",
      "p"
    ],
    "also": [
      "ol",
      "li",
      "p"
    ],
    "user": [
      "ol",
      "li",
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "could": [
      "ol",
      "li",
      "p"
    ],
    "modify": [
      "ol",
      "li",
      "p"
    ],
    "internal": [
      "ol",
      "li",
      "p"
    ],
    "generation": [
      "ol",
      "li",
      "p"
    ],
    "fix": [
      "h1"
    ],
    "control": [
      "p"
    ],
    "over": [
      "p"
    ],
    "remove": [
      "p"
    ],
    "responsible": [
      "p"
    ],
    "from": [
      "p",
      "p"
    ],
    "functionality": [
      "p"
    ],
    "critical": [
      "p"
    ],
    "proper": [
      "p"
    ],
    "working": [
      "p"
    ],
    "then": [
      "p"
    ],
    "validate": [
      "p"
    ],
    "directory": [
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "traversal": [
      "p"
    ],
    "canonicalization": [
      "p"
    ],
    "attacks": [
      "p"
    ],
    "ensure": [
      "ol",
      "li",
      "p"
    ],
    "refer": [
      "ol",
      "li",
      "p"
    ],
    "within": [
      "ol",
      "li",
      "p"
    ],
    "application's": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "virtual": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p"
    ],
    "hierarchy": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "appropriate": [
      "ol",
      "li",
      "p"
    ],
    "when": [
      "ol",
      "li",
      "p"
    ],
    "checking": [
      "ol",
      "li",
      "p"
    ],
    "obtain": [
      "ol",
      "li",
      "p"
    ],
    "by": [
      "ol",
      "li",
      "p"
    ],
    "using": [
      "ol",
      "li",
      "p"
    ],
    "systemio.path.getfullpath": [
      "ol",
      "li",
      "p",
      "b"
    ],
    "method": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "mappath": [
      "ol",
      "li",
      "p",
      "b"
    ],
    "map": [
      "ol",
      "li",
      "p"
    ],
    "supplied": [
      "ol",
      "li",
      "p"
    ],
    "physical": [
      "ol",
      "li",
      "p"
    ],
    "on": [
      "ol",
      "li",
      "p"
    ],
    "server": [
      "ol",
      "li",
      "p"
    ],
    "overloaded": [
      "ol",
      "li",
      "p"
    ],
    "requestmappath": [
      "ol",
      "li",
      "p",
      "b"
    ],
    "accepts": [
      "ol",
      "li",
      "p"
    ],
    "bool": [
      "ol",
      "li",
      "p",
      "b"
    ],
    "parameter": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "so": [
      "ol",
      "li",
      "p"
    ],
    "prevent": [
      "ol",
      "li",
      "p"
    ],
    "cross-application": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "pre",
      "p"
    ],
    "mapping": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "pre",
      "p"
    ],
    "try&#123": [
      "ol",
      "li",
      "pre"
    ],
    "string": [
      "ol",
      "li",
      "pre"
    ],
    "mappedpath": [
      "ol",
      "li",
      "pre"
    ],
    "=": [
      "ol",
      "li",
      "pre"
    ],
    "requestmappath(": [
      "ol",
      "li",
      "pre"
    ],
    "inputpathtext,": [
      "ol",
      "li",
      "pre"
    ],
    "requestapplicationpath,": [
      "ol",
      "li",
      "pre"
    ],
    "false;&#125;catch": [
      "ol",
      "li",
      "pre"
    ],
    "httpexception)&#123;": [
      "ol",
      "li",
      "pre"
    ],
    "//": [
      "ol",
      "li",
      "pre"
    ],
    "attempted&#125": [
      "ol",
      "li",
      "pre"
    ],
    "final": [
      "ol",
      "li",
      "p"
    ],
    "false": [
      "ol",
      "li",
      "p",
      "b"
    ],
    "prevents": [
      "ol",
      "li",
      "p"
    ],
    "means": [
      "ol",
      "li",
      "p"
    ],
    "cannot": [
      "ol",
      "li",
      "p"
    ],
    "successfully": [
      "ol",
      "li",
      "p"
    ],
    "supply": [
      "ol",
      "li",
      "p"
    ],
    "contains": [
      "ol",
      "li",
      "p"
    ],
    "\".\"": [
      "ol",
      "li",
      "p"
    ],
    "traverse": [
      "ol",
      "li",
      "p"
    ],
    "outside": [
      "ol",
      "li",
      "p"
    ],
    "attempt": [
      "ol",
      "li",
      "p"
    ],
    "do": [
      "ol",
      "li",
      "p"
    ],
    "results": [
      "ol",
      "li",
      "p"
    ],
    "an": [
      "ol",
      "li",
      "p"
    ],
    "exception": [
      "ol",
      "li",
      "p"
    ],
    "type": [
      "ol",
      "li",
      "p",
      "ul",
      "li",
      "a"
    ],
    "httpexception": [
      "ol",
      "li",
      "p",
      "b"
    ],
    "related": [
      "h1"
    ],
    "items": [
      "h1"
    ],
    "checklist": [
      "ul",
      "li",
      "a"
    ],
    "item": [
      "ul",
      "li",
      "a"
    ],
    "validated": [
      "ul",
      "li",
      "a"
    ],
    "length": [
      "ul",
      "li",
      "a"
    ],
    "range": [
      "ul",
      "li",
      "a"
    ],
    "format": [
      "ul",
      "li",
      "a"
    ],
    "adapted": [
      "p"
    ],
    "microsoft": [
      "p"
    ],
    "patterns": [
      "p"
    ],
    "&": [
      "p"
    ],
    "practices": [
      "p"
    ],
    "guidance": [
      "p"
    ],
    "sink]": [
      "title"
    ],
    "avoids": [
      "title"
    ]
  },
  "tags": {
    "h1": [
      "What to Check For",
      "Why",
      "How to Check",
      "How to Fix",
      "Related Items"
    ],
    "p": [
      "Unless absolutely necessary, the application should not accept file names or file paths as input.",
      "Malicious file input can be used to coerce your application into accessing arbitrary files and resources.",
      "Use the following steps to check for this problem:",
      "Find all sources of input in your application. During design time identify all of the potential sources of input to your application. Scour the source code to discover sources of input that may have been missed in the design. Compile a list that you can use in the following steps.",
      "Determine if any source of input provides file or path information. Examine each source of input and determine if it is used to generate a file name or file path.&nbsp;Look not only for sources of input that provide full paths or file names but also for user input that could be used to modify the internal generation of paths and file names.",
      "If user control over file paths or file names is not absolutely necessary, remove the responsible code from the application.",
      "",
      "If the functionality is critical to the proper working of the application, then validate the input for directory traversal and canonicalization attacks:",
      "Check File Names. Ensure that file paths only refer to files within your application's virtual directory hierarchy if that is appropriate. When checking file names, obtain the full name of the file by using the System.IO.Path.GetFullPath method.",
      "Check File Paths. If you use MapPath to map a supplied virtual path to a physical path on the server, use the overloaded Request.MapPath method that accepts a bool parameter so that you can prevent cross-application mapping:",
      "The final false parameter prevents cross-application mapping. This means that a user cannot successfully supply a path that contains \"..\" to traverse outside of your application's virtual directory hierarchy. Any attempt to do this results in an exception of type HttpException.",
      "Adapted from Microsoft patterns & practices guidance."
    ],
    "ol": [
      "Find all sources of input in your application. During design time identify all of the potential sources of input to your application. Scour the source code to discover sources of input that may have been missed in the design. Compile a list that you can use in the following steps.\n      \n        \n          Determine if any source of input provides file or path information. Examine each source of input and determine if it is used to generate a file name or file path.&nbsp;Look not only for sources of input that provide full paths or file names but also for user input that could be used to modify the internal generation of paths and file names.",
      "Check File Names. Ensure that file paths only refer to files within your application's virtual directory hierarchy if that is appropriate. When checking file names, obtain the full name of the file by using the System.IO.Path.GetFullPath method. \n      \n        \n          Check File Paths. If you use MapPath to map a supplied virtual path to a physical path on the server, use the overloaded Request.MapPath method that accepts a bool parameter so that you can prevent cross-application mapping: \n        try&#123;  string mappedPath = Request.MapPath( inputPath.Text,                                       Request.ApplicationPath, false);&#125;catch (HttpException)&#123;  // Cross-application mapping attempted&#125;\n        The final false parameter prevents cross-application mapping. This means that a user cannot successfully supply a path that contains \"..\" to traverse outside of your application's virtual directory hierarchy. Any attempt to do this results in an exception of type HttpException."
    ],
    "li": [
      "Find all sources of input in your application. During design time identify all of the potential sources of input to your application. Scour the source code to discover sources of input that may have been missed in the design. Compile a list that you can use in the following steps.",
      "Determine if any source of input provides file or path information. Examine each source of input and determine if it is used to generate a file name or file path.&nbsp;Look not only for sources of input that provide full paths or file names but also for user input that could be used to modify the internal generation of paths and file names.",
      "Check File Names. Ensure that file paths only refer to files within your application's virtual directory hierarchy if that is appropriate. When checking file names, obtain the full name of the file by using the System.IO.Path.GetFullPath method.",
      "Check File Paths. If you use MapPath to map a supplied virtual path to a physical path on the server, use the overloaded Request.MapPath method that accepts a bool parameter so that you can prevent cross-application mapping: \n        try&#123;  string mappedPath = Request.MapPath( inputPath.Text,                                       Request.ApplicationPath, false);&#125;catch (HttpException)&#123;  // Cross-application mapping attempted&#125;\n        The final false parameter prevents cross-application mapping. This means that a user cannot successfully supply a path that contains \"..\" to traverse outside of your application's virtual directory hierarchy. Any attempt to do this results in an exception of type HttpException.",
      "Checklist Item: All Input is Validated For Length, Range, Format, and Type"
    ],
    "strong": [
      "Find all sources of input in your application.",
      "Determine if any source of input provides file or path information.",
      "Check File Names.",
      "Check File Paths."
    ],
    "b": [
      "System.IO.Path.GetFullPath",
      "MapPath",
      "Request.MapPath",
      "bool",
      "false",
      "HttpException"
    ],
    "pre": [
      "try&#123;  string mappedPath = Request.MapPath( inputPath.Text,                                       Request.ApplicationPath, false);&#125;catch (HttpException)&#123;  // Cross-application mapping attempted&#125;"
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "ul": [
      "Checklist Item: All Input is Validated For Length, Range, Format, and Type"
    ],
    "a": [
      "Checklist Item: All Input is Validated For Length, Range, Format, and Type"
    ],
    "hr": [
      ""
    ]
  },
  "links": [
    {
      "href": "/article/581e8fff-7841-49ac-8bbe-d74e44aa9bd8",
      "text": "Checklist Item: All Input is Validated For Length, Range, Format, and Type"
    }
  ],
  "html": "<h1>What to Check For</h1>\n  <p>Unless absolutely necessary, the application should not accept file names or file paths as input.</p>\n  <h1>Why</h1>\n  <p>Malicious file input can be used to coerce your application into accessing arbitrary files and resources.</p>\n  <h1>How to Check</h1>\n  <p>Use the following steps to check for this problem:</p>\n  <ol>\n    <li>\n      <p>\n        <strong>Find all sources of input in your application. </strong>During design time identify all of the potential sources of input to your application. Scour the source code to discover sources of input that may have been missed in the design. Compile a list that you can use in the following steps.</p>\n      <li>\n        <p>\n          <strong>Determine if any source of input provides file or path information. </strong>Examine each source of input and determine if it is used to generate a file name or file path.&amp;nbsp;Look not only for sources of input that provide full paths or file names but also for user input that could be used to modify the internal generation of paths and file names.</p>\n      </li>\n    </li>\n  </ol>\n  <h1>How to Fix</h1>\n  <p>If user control over file paths or file names is not absolutely necessary, remove the responsible code from the application.</p>\n  <p />\n  <p>If the functionality is critical to the proper working of the application, then validate the input for directory traversal and canonicalization attacks:</p>\n  <ol>\n    <li>\n      <p>\n        <strong>Check File Names. </strong>Ensure that file paths only refer to files within your application's virtual directory hierarchy if that is appropriate. When checking file names, obtain the full name of the file by using the <b>System.IO.Path.GetFullPath</b> method. </p>\n      <li>\n        <p>\n          <strong>Check File Paths. </strong>If you use <b>MapPath</b> to map a supplied virtual path to a physical path on the server, use the overloaded <b>Request.MapPath</b> method that accepts a <b>bool</b> parameter so that you can prevent cross-application mapping: </p>\n        <pre>try<br />&amp;#123;<br />  string mappedPath = Request.MapPath( inputPath.Text,<br />                                       Request.ApplicationPath, false);<br />&amp;#125;<br />catch (HttpException)<br />&amp;#123;<br />  // Cross-application mapping attempted<br />&amp;#125;</pre>\n        <p>The final <b>false</b> parameter prevents cross-application mapping. This means that a user cannot successfully supply a path that contains \"..\" to traverse outside of your application's virtual directory hierarchy. Any attempt to do this results in an exception of type <b>HttpException</b>. </p>\n      </li>\n    </li>\n  </ol>\n  <h1>Related Items</h1>\n  <ul>\n      <li>\n        <a href=\"/article/581e8fff-7841-49ac-8bbe-d74e44aa9bd8\">Checklist Item: All Input is Validated For Length, Range, Format, and Type</a>\n      </li>\n  </ul>\n  <hr />\n  <p>Adapted from Microsoft patterns &amp; practices guidance. </p>"
}