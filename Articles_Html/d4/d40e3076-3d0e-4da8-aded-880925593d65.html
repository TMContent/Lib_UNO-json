<h1>Applies to</h1>
  <ul>
    <li>
      <div>Web Application</div>
    </li>
  </ul>
  <h1>What to Check For</h1>
  <p>Check to ensure that effective filters are in place to prevent malicious traffic from entering the perimeter network.</p>
  <p />
  <h1>How to Fix</h1>
  <p>Filtering published ports on a firewall can be an effective and efficient method of blocking malicious packets and payloads. Filters range from simple packet filters that restrict traffic at the network layer based on source and destination IP addresses and port numbers, to complex application filters that inspect application-specific payloads. A defense in depth approach that uses layered filters is a very effective way to block attacks. There are several common types of firewall filters: </p>
  <ol>
    <li>
      <p />
      <b>Packet filters. </b>These can filter packets based on protocol, source or destination port number and source or destination address, or computer name. IP packet filters are static, and communication through a specific port is either allowed or blocked. Blocked packets are usually logged, and a secure packet filter denies by default. <p>At the network layer, the payload is unknown and might be dangerous. More intelligent types of filtering must be configured to inspect the payload and make decisions based on access control rules. </p><li><p><b>Circuit-level filters. </b>These inspect sessions rather than payload data. An inbound or outbound client makes a request directly against the firewall/gateway, and in turn the gateway initiates a connection to the server and acts as a broker between the two connections. With knowledge of application connection rules, circuit level filters ensure valid interactions. They do not inspect the actual payload, but they do count frames to ensure packet integrity and prevent session hijacking and replaying. </p><li><p /><b>Application filters. </b>Smart application filters can analyze a data stream for an application and provide application-specific processing, including inspecting, screening or blocking, redirecting, and even modifying the data as it passes through the firewall. Application filters protect against attacks such as the following: <ul><li>Unsafe SMTP commands <li>Attacks against internal DNS servers. <li>HTTP-based attacks (for example, Code Red and Nimda, which use application-specific knowledge) </li></li></li></ul><p>For example, an application filter can block an HTTP DELETE, but allow an HTTP GET. The capabilities of content screening, including virus detection, lexical analysis, and site categorization, make application filters very effective in Web scenarios both as security measures and in enforcement of business rules. </p><li><p><b>Stateful inspection. </b>Application filters are limited to knowledge of the payload of a packet and therefore make filtering decisions based only on the payload. Stateful inspection uses both the payload and its context to determine filtering rules. Using the payload and the packet contents allow stateful inspection rules to ensure session and communication integrity. The inspection of packets, their payload, and sequence limits the scalability of stateful inspection. </p><li><p><b>Custom application filters</b>. These filters ensure the integrity of application server/client communication. </p></li></li></li></li></li>
  </ol>
  <p>When you use filters at multiple levels of the network stack, it helps make your environment more secure. For example, a packet filter can be used to block IP traffic destined for any port other than port 80, and an application filter might further restrict traffic based on the nature of the HTTP verb. For example, it might block HTTP DELETE verbs.</p>
  <hr />
  <p>Adapted from Microsoft patterns & practices guidance.</p>