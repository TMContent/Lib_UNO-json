<p>Logging is the process where detailed logs are kept of both user and application activity across an entire server or deployment. By implementing a proper logging process you can ensure that problems with an application or service are caught quickly and the underlying problem remediated before it becomes an issue. While logs can strengthen security if used properly, they can also become a liability if  allowed to fall into the wrong hands. View each topic below to better understand how a logging service is properly set up and the logs secured from both internal and external attacks.</p>
<h2>Log Sensitive Operations</h2>
<p>Logging is frequently used to help detect when an attack may be in progress or an attacker has gained unauthorized access to the system. Important security operations should be logged when they are carried out or a user attempts to trigger a security critical function. This coupled with data such as time stamps, the event source, user identifiers and other information can help track down which account was used and what data was modified. Keeping track of user activity is one of the most useful aspects of general logging, but special attention should be paid to privileged accounts. Make sure that the activity on privileged accounts is logged and that only highly trusted accounts are able to modify the logs.</p>
<ul>
<li><a href="a8a03491-4da8-4ab1-af04-90f80167ce2e">Any</a></li>
<li><a href="b88851a8-65e9-43b0-9e0a-104889680386">Java</a></li>
<li><a href="599dd454-45b6-4b28-a528-f61830cb4181">PHP</a></li>
<li><a href="12c8bd7d-ed20-4e91-a7b3-8edaa006b491">C++</a></li>
</ul>
<h2>Send Logs to a Log Server</h2>
<p>Be cause logs are one of the primary ways an attack is found and analyzed, log files are frequently targeted after a successful breach by attackers. Because of this, log files should be kept on a separate secure server to ensure they are protected if the main server is compromised. Because log servers are used internally and have a specialized purpose, the attack surface is reduced and can be kept more secure than a general-purpose server.</p>
<ul>
<li><a href="099fe70b-15a6-45e4-84a8-95d9d98e9581">Any</a></li>
<li><a href="bf02bb27-01e9-4968-847b-82fb74280b26">.NET</a></li>
</ul>
<h2>Protect Logs</h2>
<p>Since log files are commonly targeted by attackers to make successful security breaches less obvious, effort should be put into keeping logs secure. Access to log files should be minimized and the number of users who can edit them kept as small as possible. Access to the log files should be restricted to administrator accounts or other highly trusted users. Ensure that log file access follows the principle of least privilege, with write access being restricted to highly trusted accounts. Support personnel and applications should be given read only access to ensure if compromised, these accounts will not be able to remove or tamper with log files. By keeping the amount of users who can modify log files to a minimum, the log files are secure from internal and external attacks alike.</p>
<ul>
<li><a href="1ac7d033-1666-431e-8de9-98f74aa68fb3">Any</a></li>
<li><a href="abc6bfbd-93a8-48d5-92a7-5427b155f69a">.NET</a></li>
<li><a href="4f8d5c0f-0ee4-4dfe-8d4b-d1af1ad72305">Java</a></li>
<li><a href="235c0d6e-2aa8-4b14-892e-d71790937c98">PHP</a></li>
</ul>
<h2>Do Not Log Sensitive Information</h2>
<p>Logs are frequently reviewed and analyzed by system administrators and are meant to keep track of any action taken on a server. Because of this sensitive or personally identifiable information (PID) should not be logged to ensure this data is not leaked whether from a breach or internal actor.  Social Security numbers, credit card information and passwords are all examples of information that should not be logged. Some industries have regulatory requirements in place that specify what is considered sensitive information; these should be researched and adhered to when setting up any logging process. The sensitive information an application processes may differ depending on the function or use case. For example in mobile applications, location information should not be logged as this can be considered sensitive information.</p>
<ul>
<li><a href="dcf3fde4-a701-4d5f-b46a-8a4f57b49d64">.NET</a></li>
<li><a href="82abb5d8-684b-47b7-adec-34c77ecfb25a">Java</a></li>
<li><a href="6430ffee-d18e-42d4-bf3d-53fd7b21846e">PHP</a></li>
<li><a href="b72c287a-c431-4ec9-a02e-210c9c02a739">C++</a></li>
<li><a href="00000000-0000-0000-0000-00000033f0db">iOS</a></li>
<li><a href="00000000-0000-0000-0000-0000001dcb79">Android</a></li>
</ul>
<h2>Throttle Logs</h2>
<p>If a logged event can be executed quickly and without limit within in a certainly period of time, it can be used to “poison” logs and either overwhelm the logging process or obscure intrusions. Start by identifying mechanisms or actions that can be executed quickly. Using a buffer to limit the amount of logs entries that can be written in a given period of time can help ensure that entries are not dropped if an action starts generating a large amount of logged events.</p>
<ul>
<li><a href="fc33dfc5-5210-4656-bc27-e43b16c3c89e">.NET</a></li>
<li><a href="0196cc1e-01c4-48ac-87d5-aab9c6fbb78c">Java</a></li>
<li><a href="edf5c057-e38d-4f69-a6fd-11764d7b0563">C++</a></li>
</ul>
<h2>Centralize Logging</h2>
<p>The logging process should be centralized and a dedicated class or library used. This simplifies the logging process and ensures that logging is easy to implement and manage. The logging process should be clearly planned before being implemented, as the security and scope should not be an afterthought. After the logging process is designed and implemented, make sure that all code which generates log entries uses the unified logging API.</p>
<ul>
<li><a href="7af4efea-59f5-468a-b5a1-c423cd29744a">.NET</a></li>
<li><a href="fa45dc02-507a-4d3f-a396-ed4aaf044f98">Java</a></li>
<li><a href="2121fb95-1840-401b-98c7-4fb14b23730f">PHP</a></li>
<li><a href="771ecd14-0e60-4689-a144-81801c922fac">C++</a></li>
</ul>
<h2>Include Important Details in Logs</h2>
<p>After implementing a dedicated logging process, it is important to ensure that relevant information is being recorded in the log files. Information should be included that is useful for both forensic review and system administration.</p>
<ul>
<li><a href="ae5e20be-5f68-49e9-8700-a9e628fd8931">Any</a></li>
<li><a href="14f3d913-78ec-4ff5-99aa-56b32faa67c4">.NET</a></li>
<li><a href="0109ec06-1830-472d-95ed-7ec64404c961">Java</a></li>
<li><a href="3aef9249-12f2-44cd-bffa-2d88bcf3ce13">PHP</a></li>
</ul>
<h2>Validate Logged User Data</h2>
<p>All data that is provided by users and later logged should be validated before the information is written to the log file. This should be done to ensure that logging vulnerabilities are not exploited, and the information contained within is not corrupted or altered. If possible, logging user supplied data should be avoided to ensure it is not used as a vector of attack. If logging this data is necessary to keep detailed logs, the information should be verified before it is passed to the logging process.</p>
<ul>
<li><a href="00000000-0000-0000-0000-0000004307e6">.NET</a></li>
<li><a href="00000000-0000-0000-0000-000000065b72">Java</a></li>
</ul>
<h2>Keep Logs for a Year</h2>
<p>Logs should be kept for at least one year on the logging server and should be archived through an automated process. Attacks or compromises may be discovered months or years after they first happened and logs can provide valuable insight into the vector or target. Special attention should be paid to the archival of log files; some logging systems will remove logs once they’ve reached a certain size or age reducing the history and integrity of the logs.</p>
<ul>
<li><a href="4da510f9-d288-4819-bb90-b1d7dfe55c06">Any</a></li>
</ul>
<p><a href="bcbbe5c7-95c3-468d-9371-6eb42f9b93e6">Back to the Programming Best Practices Area</a></p>
