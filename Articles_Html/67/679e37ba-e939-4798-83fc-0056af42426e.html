<h2>Applies To</h2><ul><li> PHP</li>
</ul><h2>What to Check For</h2><p>Verify that user data is not concatenated into XSL stylesheets.
</p><h2>Why</h2><p>Concatenating user data into XSL stylesheets results in XSLT injection vulnerabilities. It is possible to encode data properly and then safely insert it into XSL stylesheets, if that is really necessary. For most realistic applications, placing user data into XSL stylesheets should not be necessary, so the safest thing to do is to remove the code that does it.
</p><h2>How to Check</h2><p>To verify that user data is not concatenated into XSL stylesheets, 
</p><ol>
<li> <strong>Find code that creates or modifies XSL stylesheets.</strong> Review application code and make a spreadsheet of all code that creates or modifies XSL stylesheets.</li>
<li> <strong>Verify that user data is not concatenated into XSL stylesheets.</strong> Examine each piece of code that creates XSL stylesheets and make sure that user data is never concatenated into XSL stylesheets.</li>
</ol>
<h2>How to Fix</h2><p>To remove code that concatenates untrusted data into XSL stylesheets:
</p><ol>
<li> <strong>Find code that concatenates user data into XSL stylesheets.</strong> Make a spreadsheet of all the code that concatenates user data into XSL stylesheets. This is a very rare scenario, so this code should be easy to find if your application is doing this.</li>
<li> <strong>Remove code that concatenates user data into XSL stylesheets.</strong> Remove code that concatenates user data into XSL stylesheets. It should really be possible to implement most applications without including user data in XSL stylesheets, so you should be able to just remove the concatenation code and perhaps implement the application some other way. If it is absolutely necessary to include user data in XSL stylesheets, then the data must first be encoded properly. Make sure to use XML encoding functions that are known to be reliable for this purpose, such as htmlentities() with the ENT_XML1 flag set.</li>
</ol>