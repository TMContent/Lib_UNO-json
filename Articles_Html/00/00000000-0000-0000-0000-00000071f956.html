<h2>What to Check For</h2><p>Verify that session cookies are sent only using TLS.
</p><h2>Why</h2><p>If session identifiers are transmitted in plain-text, an attacker can intercept them using a man-in-the-middle attack. After intercepting a session identifier, the attacker can hijack the corresponding session. Hijacking a session allows the attacker to carry out any action that is available to the authenticated user. To prevent session identifiers from being sent in plain-text, session cookies should be sent only using TLS.
</p><h2>How to Check</h2><p>To verify that session cookies are sent only using TLS:
</p><ol>
<li> <strong>Load the application and authenticate.</strong> Open the application with a web browser and authenticate. It's okay to start the session in some other way and many applications will create sessions even for users that aren't authenticated. Logging in is a certain way to start a session for any reasonably designed application that uses sessions. Make sure that the application uses TLS - most browsers indicate that with an icon in the URL bar.</li>
<li> <strong>Examine the session cookies.</strong> Use a web browser option or plugin that shows detailed information about the current cookies. Examine the session cookie created by the application. Make sure that it has the <em>HTTPOnly</em> and <em>Secure</em> flags set.</li>
<li> <strong>Examine Web.config.</strong> Review the Web.config configuration file to make sure that <em>httpOnlyCookies</em> and <em>requireSSL</em> properties are set to <em>true</em> for the <em>httpCookies</em> element. These settings will actually set <em>HTTPOnly</em> and <em>Secure</em> flags for all cookies, which is not strictly required to pass this checklist, but these settings are recommended.</li>
</ol><h2>How to Fix</h2><p>To send session cookies only using TLS:
</p><ol>
<li> <strong>Configure IIS to use TLS.</strong> Get a valid certificate. Hosting service providers often sell valid TLS certificates. Install the certificate. Create an HTTPS binding for the site. A link in the "Additional Resources" section describes how to do this in detail.</li>
<li> <strong>Set the <em>Secure</em> flag on cookies.</strong> Set the <em>requireSSL</em> property to <em>true</em> for the <em>httpCookies</em> element in the web.config file, like this: &lt;httpcookies requiressl="true"&gt;&lt;/httpcookies&gt; If you use Forms Authentication, you will also need to set <em>requireSSL</em> to <em>true</em> for the <em>forms</em> element.  </li>
</ol><h2>Additional Resources</h2><ul><li> For information about setting up TLS on IIS, see <a href="http://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis">http://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis</a></li></ul>