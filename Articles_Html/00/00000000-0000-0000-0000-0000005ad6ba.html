<h2>Applies To</h2><ul><li> ASP.NET</li>
</ul><h2>What to Check For</h2><p>Make sure that parameterized APIs are used to launch external processes.
</p><h2>Why</h2><p>Using parameterized APIs helps prevent injection attacks.
</p><h2>How to Check</h2><p>To make sure that parameterized APIs are used to launch external processes:
</p><ol>
<li> <strong>Identify all calls to external commands.</strong> Search for the following APIs to find code that executes external commands: <em>AppCommandHandler.ExecuteCommand</em>, <em>System.Diagnostics.Process</em></li>
<li> <strong>Make sure that parameterized APIs are used to execute external processes.</strong> For each piece of code that executes external commands, make sure that <em>System.Diagnostics.Process</em> is used. </li>
<li> <strong>Make sure that data passed to external commands is validated.</strong> For each piece of code that executes external commands, make sure that any user data is validated using positive validation before being passed to external processes as parameters. Be particularly cautious if passing user data to a command interpreter, such as cmd.exe or PowerShell. Be careful when passing user data to any program that may spawn another application, for example explorer.exe. Even if parameterized APIs are used, passing untrusted user data to such processes may result in command injection vulnerabilities. It is best to avoid calling programs that may spawn other programs based on parameters passed to them. If such programs cannot be avoided, user data has to be positively validated before being passed in parameters.</li>
</ol><h2>How to Fix</h2><p>To use parameterized APIs to launch external processes:
</p><ol>
<li> <strong>Identify all calls to external commands.</strong> Search for the following APIs to find code that executes external commands: <em>AppCommandHandler.ExecuteCommand</em>, <em>System.Diagnostics.Process</em>.</li>
<li> <strong>Use parameterized APIs.</strong> The <em>System.Diagnostics.Process</em> object provides a parameterized API for executing external commands. Command parameters can be set using a <em>System.Diagnostics.ProcessStartInfo</em> object, which is passed as an argument to the constructor of the <em>System.Diagnostics.Process</em> object. Use these APIs whenever executing external commands from your applications. This is the most common way to do it, so your application is probably already doing it this way.</li>
<li> <strong>Validate data passed to command execution APIs.</strong> Input passed to external commands should be very carefully validated. Be particularly cautious if passing user data to a command interpreter, such as cmd.exe or PowerShell. Be careful when passing user data to any program that may spawn another application, for example explorer.exe. Even if parameterized APIs are used, passing untrusted user data to such processes may result in command injection vulnerabilities. It is best to avoid calling programs that may spawn other programs based on parameters passed to them. If such programs cannot be avoided, user data has to be positively validated before being passed in parameters.</li>
</ol>