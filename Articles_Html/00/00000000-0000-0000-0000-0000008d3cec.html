<h2>Applies To</h2><ul><li> Android applications that access files based on input.</li>
</ul><h2>What to Do</h2><p>Canonizalize and validate all file paths that include input data.
</p><h2>Why</h2><p>Canonicalizing file paths before validating them helps prevent unauthorized access. If a file path is not canonicalized, an attacker may use special characters to access resources outside of what is allowed by the application.
</p><h2>How</h2><p>To canonicalize file names and paths:
</p><ol>
<li> <strong>Identify all input used for file access.</strong> Enumerate all file access performed by the application. Examine code responsible for accessing each file. Take note of any input used to form path or file names for file access.</li>
<li> <strong>Canonicalize all input data used for file access.</strong> Use the <em>getCanonicalPath</em> method to get the canonical path to a file.</li>
<li> <strong>Validate file paths.</strong> Verify that the user or application is authorized to access the specified resource.</li>
</ol>