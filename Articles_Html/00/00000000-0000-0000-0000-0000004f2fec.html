<h2>What to Check For</h2><p>Verify that all input is validated.
</p><h2>Why</h2><p>Properly implemented input validation is effective at preventing many types of injection vulnerabilities, such as Cross-Site Scripting and SQL injection.
</p><h2>How to Check</h2><p>To verify that all input is validated:
</p><ol>
<li> <strong>Identify all entry points for user input.</strong> Make a list of all possible sources of user input in your application.</li>
<li> <strong>Identify all types on input accepted by the application.</strong> For each source of user input on the list, define valid characters, length, format, and range (for numerical values).</li>
<li> <strong>Trace data from source to sink.</strong> Trace each source of input through your application until you find its ultimate destination.  The final sink may be in memory, on the hard drive, sent over the network or stored in a database.</li>
<li> <strong>Inspect the input validation subsystem.</strong> Each input source should have a data validation routine associated with it. Ideally the validation will occur as soon after the input reaches your application as possible. Shared validation routines are better than creating many spread throughout your code base, check for consolidation of routines to aid testing and reduce the chance of one-off bugs. If an input source does not have a validation routine associated with it, flag it for fixing. </li>
<li> <strong>Ensure quality of validation routines.</strong> Make sure that each validator verifies the characters, length, format, and range (for numerical values) of the respective type of input. Validation should check first for known valid and safe data and then for malicious, dangerous data. Do not rely on filtering out all malicious data, it is too easy to miss something.</li>
</ol><h2>How to Fix</h2><p>To validate all user input using white-list input validation:
</p><ol>
<li> <strong>Identify all entry points for user input.</strong> Make a list of all possible sources of user input in your application.</li>
<li> <strong>Identify all types on input accepted by the application.</strong> For each source of user input on the list, define valid characters, length, format, and range (for numerical values).</li>
<li> <strong>Define an input validation subsystem.</strong> Define a set of validator functions that should be used to validate each type of input handled by the application. Input should be validated on the server.</li>
<li> <strong>Validate characters.</strong> Restrict the acceptable range of characters in text input by using regular expressions.</li>
<li> <strong>Validate length.</strong> Add code to check that the length of the user input is valid.</li>
<li> <strong>Validate format.</strong> If the input type has a specific pattern, such as a date or a phone number, add code to use regular expressions to make sure user input matches the input type specified by the application. Use regular expressions to enforce strong password requirements.</li>
<li> <strong>Validate range.</strong> Restrict the acceptable range of numerical input by comparing the input to the maximum and minimum acceptable values.</li>
<li> <strong>(Optional) Reject and respond to known bad input.</strong> This step does not add much actual security, but it is included here to let you know that such an option exists. The input validation subsystem may check for known attack strings and respond to these likely attacks by alerting the user. The options for responding to invalid input are: reject invalid input, log invalid input, take evasive action.</li>
<li> <strong>(Optional) Encode input.</strong> If the input is going to be displayed back through the web application, consider adding code to encode it to prevent Cross-Site Scripting attacks.</li>
</ol><h2>Data Validation Guidelines</h2><ul><li> <a href="00000000-0000-0000-0000-0000008d3cec">Canonicalize File Names and Paths</a></li>
<li> <a href="00000000-0000-0000-0000-0000008149ca">Validate All Input</a></li>
<li> <a href="00000000-0000-0000-0000-0000006c7089">Validate and Encode Data Inserted into XML Documents</a></li>
<li> <a href="00000000-0000-0000-0000-0000007635ae">Validate File Formats</a></li>
</ul><h2>Data Validation Checklists</h2><ul><li> <a href="00000000-0000-0000-0000-0000009763b8">File Names and Paths Are Canonicalized</a></li>
<li> <a href="00000000-0000-0000-0000-0000004f2fec">All Input Is Validated</a></li>
<li> <a href="00000000-0000-0000-0000-00000071b4f0">Data Inserted into XML Documents Is Validated and Encoded</a></li>
<li> <a href="00000000-0000-0000-0000-00000080c790">File Formats Are Validated</a></li></ul>