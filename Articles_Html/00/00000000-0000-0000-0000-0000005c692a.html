<h2>Applies To</h2><ul><li> HTML5</li>
</ul><h2>What to Do</h2><p>Parameterize data used in WebSQL queries, instead of concatenating data with the query and passing a string to the <em>executeSql</em> method.
</p><h2>Why</h2><p>When executing database queries, placing data in parameters is an effective way to prevent SQL injection attacks. In WebSQL, the executeSQL method allows you to execute a query from a string or to pass data as parameters to the query. The first approach is likely to result in SQL injection vulnerabilities if the attacker is able to force SQL escape characters into the data. The second approach prevents SQL injection vulnerabilities by making sure that data is not interpreted as a part of the query. Though WebSQL injection is not a serious threat, because WebSQL is a client-side technology and the client has full access to the WebSQL database anyway, parameterizing SQL queries is still good practice.
</p><h2>How</h2><p>To parameterize data used in WebSQL queries:
</p><ol>
<li> <strong>Identify all WebSQL queries.</strong> Search the application code for "executeSql" to locate all code that executes WebSQL queries. Create a spreadsheet to list the code that executes WebSQL queries. </li>
<li> <strong>Identify the WebSQL queries that are not parameterized.</strong> Identify each WebSQL query in the spreadsheet that is not parameterized. If the query contains any data that is passed from elsewhere in the application, such as user input, and this data is concatenated with the query, then it is not parameterized. If data is passed from the application to the WebSQL database using parameters of the <em>executeSql</em> method, then the query is parameterized. The wrong way to execute SQL queries is to concatenate data into the query, like this: <tt> tx.executeSql('SELECT * FROM users WHERE id=' + id); </tt> The correct way is to pass data as parameters, like this: <tt> tx.executeSql('SELECT * FROM users WHERE id=?', [id]); </tt></li>
<li> <strong>For each WebSQL query that is not parameterized, identify all data placed in the query.</strong> Examine each WebSQL query that is not parameterized and identify the data passed from the application to the WebSQL database in the query. Create a spreadsheet to list each piece of data passed to the database, the data type, and where it comes from. The data that is passed to WebSQL databases from the application should already be stored in variables; note the names of these variables in the spreadsheet as well.</li>
<li> <strong>Rewrite non-parameterized WebSQL queries to take data as parameters.</strong> Remove code that concatenates data from the application into WebSQL queries. Write the WebSQL queries as the first argument to the executeSql method and replace data that is passed from the application with a question mark. Pass the data from the application to the database as an array of variables through the second argument of the <em>executeSql</em> method. For example: <tt> tx.executeSql('SELECT * FROM users WHERE id=?', [id]); </tt> In this example, the id is a piece of data that is passed from the application to the database and it is passed as a parameter. </li>
</ol><h2>Additional Resources</h2><ul><li> For more information about executing WebSQL queries, see <a href="http://dev.w3.org/html5/webdatabase/#executing-sql-statements">http://dev.w3.org/html5/webdatabase/#executing-sql-statements</a></li>
</ul>