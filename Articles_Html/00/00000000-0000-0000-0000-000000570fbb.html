<h2>What to Check For</h2><p>Make sure that <em>HTTPOnly</em> and <em>Secure</em> flags are set on session cookies.
</p><h2>Why</h2><p>The <em>Secure</em> flag should be set on session cookie to protect its contents from eavesdropping attacks.  These attacks, if successful, can be used to hijack the userâ€™s session and interact with the application as if they were the real user. Setting the <em>Secure</em> flag on session cookie ensures it is only transferred over connections that are secured by TLS and prevents eavesdropping.
</p><p>
The <em>HTTPOnly</em> flag should be set on session cookie to mitigate Cross-Site Scripting attacks. Setting the <em>HTTPOnly</em> flag on session cookie prevents the contents of the cookie from being transmitted by a client-side script. Since in a Cross-Site Scripting attack  an arbitrary script runs in the context of the user's browser, the <em>HTTPOnly</em> flag effectively prevents the malicious script from using the cookie in the attack.
</p><h2>How to Check</h2><p>To check if <em>HTTPOnly</em> and <em>Secure</em> flags are set on session cookies:
</p><ol>
<li> <strong>Load the application and authenticate.</strong> Open the application with a web browser and authenticate. It's okay to start the session in some other way and many applications will create sessions even for users that aren't authenticated. Logging in is a certain way to start a session for any reasonably designed application that uses sessions. Make sure that the application uses TLS - most browsers indicate that with an icon in the URL bar.</li>
<li> <strong>Examine the session cookies.</strong> Use a web browser option or plugin that shows detailed information about the current cookies. Examine the session cookie created by the application. Make sure that it has the <em>HTTPOnly</em> and <em>Secure</em> flags set.</li>
<li> <strong>Examine Web.config.</strong> Review the Web.config configuration file on the server side to make sure that <em>httpOnlyCookies</em> and <em>requireSSL</em> properties are set to <em>true</em> for the <em>httpCookies</em> element. These settings will actually set <em>HTTPOnly</em> and <em>Secure</em> flags for all cookies. This is not strictly required to pass this checklist, but these settings are recommended.</li>
</ol><h2>How to Fix</h2><p>To set <em>HTTPOnly</em> and <em>Secure</em> flags on session cookies:
</p><ol>
<li> <strong>Configure IIS to use TLS.</strong> Get a valid certificate. Hosting service providers often sell valid TLS certificates. Install the certificate. Create an HTTPS binding for the site. A link in the "Additional Resources" section describes how to do this in detail.</li>
<li> <strong>Set the <em>Secure</em> and <em>HTTPOnly</em> flags for session cookies.</strong> Edit the Web.config file. Set the <em>httpOnlyCookies</em> property to <em>true</em> for the <em>httpCookies</em> element. Set the <em>requireSSL</em> property to <em>true</em> for the <em>httpCookies</em> element. There are different ways to write this in XML. Here is one: &lt;httpcookies httponlycookies="true" requiressl="true"&gt;&lt;/httpcookies&gt;</li>
</ol><h2>Additional Resources</h2><ul><li> For information about how to setup TLS on IIS, see <a href="http://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis">http://www.iis.net/learn/manage/configuring-security/how-to-set-up-ssl-on-iis</a></li></ul>