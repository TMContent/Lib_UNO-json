<h2>Applies To</h2><ul><li> Java</li>
</ul><h2>What to Check For</h2><p>Verify that data in HTTP response headers is URL-encoded.
</p><h2>Why</h2><p>Data in HTTP response headers should be URL-encoded to prevent response splitting vulnerabilities.
</p><h2>How to Check</h2><p>To verify that data in HTTP response headers is URL-encoded:
</p><ol>
<li> <strong>Identify all data included in HTTP response headers.</strong> Search your code for calls to <em>setHeader</em>, <em>addHeader</em>, amd <em>addCookie</em>  to find all code that adds data to HTTP response headers.</li>
<li> <strong>Verify that data included in HTTP response headers is validated.</strong> Examine code that adds data to response headers. Make sure that any user data is passed through positive validation routines before being included in HTTP response headers.</li>
<li> <strong>Verify that data included in HTTP response headers is URL-encoded.</strong> Examine code that adds data to response headers. Make sure that any user data is URL-encoded using the <em>URLEncoder.encode</em> function before being included in HTTP response headers.</li>
</ol><h2>How</h2><p>To URL-encode data in HTTP Response headers:
</p><ol>
<li> <strong>Identify all data included in HTTP response headers.</strong> Search your code for calls to <em>setHeader</em>, <em>addHeader</em>, amd <em>addCookie</em> to find all code that adds data to HTTP response headers.</li>
<li> <strong>Validate all data included in HTTP response headers.</strong> Use positive validation routines to check all data that gets included in HTTP response headers.</li>
<li> <strong>URL-encode all data included in HTTP response headers.</strong> Use the <em>URLEncoder.encode</em> method to URL-encode data that gets includes in HTTP response headers.</li>
</ol><h2>Additional Resources</h2><ul><li> For more information about the <em>URLEncoder.encode</em> method, see <a href="https://docs.oracle.com/javase/7/docs/api/java/net/URLEncoder.html">https://docs.oracle.com/javase/7/docs/api/java/net/URLEncoder.html</a></li></ul>