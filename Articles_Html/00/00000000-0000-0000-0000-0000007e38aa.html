<h2>Applies To</h2><ul><li> Android applications that use SQL databases.</li>
</ul><h2>What to Check For</h2><p>Verify that parameterized methods are used for database access.
</p><h2>Why</h2><p>Using parameterized query methods for database access prevents SQL injection vulnerabilities.
</p><h2>How to Check</h2><p>To verify that parameterized methods are used for database access:
</p><ol>
<li> <strong>Identify all code that executes SQL queries.</strong> Review application code to find all queries that are executed by the application and the code that executes them.</li>
<li> <strong>Verify that parameterized APIs are used to execute SQL queries.</strong> Make sure that data is passed to queries as parameters. Make sure that data, especially untrusted data, is never concatenated with the query strings and then executed.</li>
</ol><h2>How to Fix</h2><p>The Android API includes parameterized functions for querying SQLite databases. Avoid using the rawQuery method, because it may be used in a manner that introduces SQL injection vulnerabilities, by including untrusted input in the SQL query string.
</p><p>
Use the following method for SELECT statements:
</p><ul>
<li><em>query</em></li>
</ul><p>
Use the following methods for INSERT statements:
</p><ul>
<li><em>insert</em></li>
<li><em>insertOrThrow</em></li>
<li><em>insertWithOnConflict</em></li>
</ul><p>
Use the following methods for UPDATE statements:
</p><ul>
<li><em>update</em></li>
<li><em>updateWithOnConflict</em></li>
</ul><p>
Use the following method for DELETE statements:
</p><ul>
<li><em>delete</em></li>
</ul><p>
If your application uses some other API, please make sure that it uses parameterized methods for database access.
</p>
<h2>Additional Resources</h2><ul><li>For more information about the Android SQLite API, please see <a href="http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html">http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html</a></li>
</ul>