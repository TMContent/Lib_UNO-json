<h2>Applies To</h2><ul><li> Android applications that authenticate to a remote server.</li>
</ul><h2>What to Check For</h2><p>Verify that a secure password reset function is implemented.
</p><h2>Why</h2><p>Password reset and recovery features are important to prevent locking out of users that forgot their passwords, however they also present a security challenge. An attacker might try to compromise user passwords by abusing the password recovery or reset functions and these functions by definition need to be accessible to unauthenticated users, so they require particular diligence in being protected. Password reset is preferable to recovery - if an attacker manages to change the user's password, the user should be able to notice that a compromise has taken place.
</p><h2>How to Check</h2><p>To verify that a secure password reset function has been implemented:
</p><ol>
<li> <strong>Make sure that password resetting is implemented.</strong> Review the application authentication mechanism to make sure that password resetting is implemented. Password reset is preferable to recovery - if an attacker manages to change the user's password, the user should be able to notice that a compromise has taken place.</li>
<li> <strong>Check if password resetting is implemented on the server.</strong> Examine the code that implements password resetting to make sure that security controls guarding it are implemented on the server.</li>
<li> <strong>Check if user identity is verified during the reset.</strong> Test the password reset functionality to make sure that the user's identity is verified sufficiently during the reset.</li>
<li> <strong>Verify that a side channel is used to send password reset tokens.</strong> Test the password reset functionality to make sure that the password reset tokens are sent using a side channel, such as the e-mail address associated with the username for which the password reset is requested. A side channel is a way to communicate information other than the one that is used to request the password reset, so if the password reset is requested via a web page, an e-mail message would be a side channel.</li>
</ol><h2>How to Fix</h2><p>To implement a secure password reset function:
</p><ol>
<li> <strong>Implement password resetting on the server.</strong> Most of the password resetting functionality should be implemented on the server. The Android application might need a button on the login page for requesting a password reset.</li>
<li> <strong>Verify user identity.</strong> The exact method for verifying user identity should be specific to the application and  based on the types of information available about the user and the security requirements. User identity is often established by asking security questions that are associated with the account and proceeding with the reset only if the correct answer is provided. At the very least, the application should ask for the e-mail address associated with the user account for which the password reset is requested.</li>
<li> <strong>Use a side channel to send a password reset token.</strong> The most common and effective solution is to send a difficult to predict token to the e-mail address associated with the user account for which the password reset is requested.</li>
<li> <strong>Provide a control for changing the password.</strong> Once the user has the password reset token, there should be a way for the user to submit that token and to then be able to change the password. One way is to provide a web page that does this, another is to provide a Web Service to the Android application that accepts the password reset token and allows the user to change the password; both methods may be used in combination.</li>
<li> <strong>Log the password reset event.</strong> Both failed and successful password reset requests should be logged on the server. A large amount of password reset requests may indicate an attack.</li>
</ol><h2>Authentication Guidelines</h2><ul><li> <a href="00000000-0000-0000-0000-000000589e46">Encrypt Authentication Credentials Sent over the Network</a></li>
<li> <a href="00000000-0000-0000-0000-0000002eb5bd">Implement a Secure Password Reset Function</a></li>
<li> <a href="00000000-0000-0000-0000-0000002a1fe0">Throttle Authentication Attempts</a></li>
<li> <a href="00000000-0000-0000-0000-00000081c795">Use Server-side Authentication</a></li>
</ul><h2>Authentication Checklists</h2><ul><li> <a href="00000000-0000-0000-0000-000000582050">Authentication Credentials Sent over the Network Are Encrypted</a></li>
<li> <a href="00000000-0000-0000-0000-00000035726e">A Secure Password Reset Function Is Implemented</a></li>
<li> <a href="00000000-0000-0000-0000-00000016d320">Authentication Attempts Are Throttled</a></li>
<li> <a href="00000000-0000-0000-0000-00000029e0c4">Authentication Is Implemented on the Server-side</a></li>
</ul><h2>Additional Resources</h2><ul><li> For a guide on implementing a password reset function, please see <a href="https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet">https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet</a></li>
</ul>
