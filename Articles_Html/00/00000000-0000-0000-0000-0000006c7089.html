<h2>What to Do</h2><p>Validate and encode data inserted into XML documents.
</p><h2>Why</h2><p>Validating and encoding data inserted into XML documents helps prevent XML injection vulnerabilities.
</p><h2>How</h2><p>To validate and encode data inserted into XML documents:
</p><ol>
<li> <strong>Identify XML documents used by the application.</strong> Examine the application design to identify all XML documents and XML document types used by the application.</li>
<li> <strong>Identify code that handles XML documents.</strong> Review application to find code that uses XML documents.</li>
<li> <strong>Add data validation methods.</strong> Add methods that validate all the data types stored in XML documents and used by the application.</li>
<li> <strong>Use validation methods.</strong> Call the data validation methods from the previous step whenever loading XML documents. Validation should be performed before encoding.</li>
<li> <strong>Add encoding methods.</strong> Add methods that escape XML entities. Unfortunately, there are no stable libraries available for Android to escape XML entities. When writing methods that escape XML entities, consider the following: <ul>
<li> Data must first be converted to a uniform character encoding. </li>
<li> XML entities have to be escaped properly. </li>
<li> Code that loads XML documents should be able to restore the original data from the encoded data.</li></ul></li>
<li> <strong>Use encoding methods.</strong> Call encoding methods wherever the application processes XML documents. </li>
</ol>