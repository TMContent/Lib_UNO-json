<h2>Applies To</h2><ul><li> Android applications that handle XML documents.</li>
</ul><h2>What to Do</h2><p>Validate and encode data inserted into XML documents.
</p><h2>Why</h2><p>Validating and encoding data inserted into XML documents helps prevent XML injection vulnerabilities.
</p><h2>How</h2><p>To validate and encode data inserted into XML documents:
</p><ol>
<li> <strong>Identify XML documents used by the application.</strong> Examine the application design to identify all XML documents and XML document types used by the application.</li>
<li> <strong>Identify code that handles XML documents.</strong> Review application to find code that uses XML documents.</li>
<li> <strong>Add data validation methods.</strong> Add methods that validate all the data types stored in XML documents and used by the application.</li>
<li> <strong>Use validation methods.</strong> Call the data validation methods from the previous step whenever loading XML documents. Validation should be performed before encoding.</li>
<li> <strong>Add encoding methods.</strong> Add methods that escape XML entities. Unfortunately, there are no stable libraries available for Android to escape XML entities. When writing methods that escape XML entities, consider the following: <ul>
<li> Data must first be converted to a uniform character encoding. </li>
<li> XML entities have to be escaped properly. </li>
<li> Code that loads XML documents should be able to restore the original data from the encoded data.</li></ul></li>
<li> <strong>Use encoding methods.</strong> Call encoding methods wherever the application processes XML documents. </li>
</ol><h2>Data Validation Guidelines</h2><ul><li> <a href="00000000-0000-0000-0000-0000008d3cec">Canonicalize File Names and Paths</a></li>
<li> <a href="00000000-0000-0000-0000-0000008149ca">Validate All Input</a></li>
<li> <a href="00000000-0000-0000-0000-0000006c7089">Validate and Encode Data Inserted into XML Documents</a></li>
<li> <a href="00000000-0000-0000-0000-0000007635ae">Validate File Formats</a></li>
</ul><h2>Data Validation Checklists</h2><ul><li> <a href="00000000-0000-0000-0000-0000009763b8">File Names and Paths Are Canonicalized</a></li>
<li> <a href="00000000-0000-0000-0000-0000004f2fec">All Input Is Validated</a></li>
<li> <a href="00000000-0000-0000-0000-00000071b4f0">Data Inserted into XML Documents Is Validated and Encoded</a></li>
<li> <a href="00000000-0000-0000-0000-00000080c790">File Formats Are Validated</a></li></ul>