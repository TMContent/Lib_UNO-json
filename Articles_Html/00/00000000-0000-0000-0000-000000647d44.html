<h2>Applies To</h2><ul><li> iOS applications that use <em>UIWebView</em> controls.</li>
</ul><h2>What to Check For</h2><p>Verify that data passed to <em>UIWebView</em> controls is validated and encoded.
</p><h2>Why</h2><p>Validating data passed to <em>UIWebView</em> controls helps prevent Cross-Site Scripting vulnerabilities. <em>UIWebView</em> controls are capable of executing JavaScript passed to them. If unvalidated data is passed to <em>UIWebView</em> controls, it may be possible for an attacker to pass malicious JavaScript, which will then be executed in the context of the application.
</p><h2>How to Check</h2><p>To verify that data passed to <em>UIWebView</em> controls is validated and encoded:
</p><ol>
<li> <strong>Identify data passed to <em>UIWebView</em> controls.</strong> Examine the application design and identify what types of data are handled by <em>UIWebView</em> controls, if any.</li>
<li> <strong>Identify code that passes data to <em>UIWebView</em> controls.</strong> Review code to identify all <em>UIWebView</em> controls used by the application. Determine whether any of the data passed to the controls may include Javascript, and identify code that handles this data. Trouble areas may be found by searching for <em>stringByEvaluatingJavaScriptFromString</em> method calls.</li>
<li> <strong>Identify and review validation methods for data passed to <em>UIWebView</em> controls.</strong> Make sure there are validation methods for each type of data that is passed to <em>UIWebView</em> controls. Pay particular attention to any data that may include JavaScript.</li>
<li> <strong>Identify and review encoding methods for data passed to <em>UIWebView</em> controls.</strong> Make sure there are encoding methods for each context of data that is passed to <em>UIWebView</em> controls. Unfortunately, there are no standard libraries that handle encoding for iOS. Encoding methods should:<ul>
<li> Convert data to the same character-encoding before validating or encoding. </li>
<li> Escape HTML entities, JavaScript entities, and XML entities, depending on context.</li></ul></li>
<li> <strong>Verify that validation and encoding are performed on all data passed to <em>UIWebView</em> controls.</strong> Make sure that all data passed to <em>UIWebView</em> controls is validated and encoded using the methods identified in above.</li>
</ol><h2>How to Fix</h2><p>To validate and encode data passed to <em>UIWebView</em> controls:
</p><ol>
<li> <strong>Identify data passed to <em>UIWebView</em> controls.</strong> Examine the application design and identify what types of data are handled by <em>UIWebView</em> controls, if any.</li>
<li> <strong>Identify code that passes data to <em>UIWebView</em> controls.</strong> Review code to identify all <em>UIWebView</em> controls used by the application. Determine whether any of the data passed to the controls may include Javascript, and identify code that handles this data. Trouble areas may be found by searching for <em>stringByEvaluatingJavaScriptFromString</em> method calls.</li>
<li> <strong>Write validation methods for data passed to <em>UIWebView</em> controls.</strong> Create data validation methods that validate all data types sent to <em>UIWebView</em> controls used by the application. Pay particular attention to any data that may include JavaScript.</li>
<li> <strong>Write encoding methods for data passed to <em>UIWebView</em> controls.</strong> Write encoding methods that handle all the types of data that are passed to <em>UIWebView</em> controls. Unfortunately, there appear to be no standard libraries that handle encoding for iOS. Encoding methods should: <ul>
<li> Convert data to the same character-encoding before validating or encoding. </li>
<li> Escape HTML entities, JavaScript entities, and XML entities, depending on context.</li></ul></li>
<li> <strong>Validate and encode data passed to <em>UIWebView</em> controls.</strong> Always validate and encode each type of data with its respective validation and encoding functions before passing it to <em>UIWebView</em> controls.</li>
</ol><h2>Data Validation Guidelines</h2><ul><li> <a href="00000000-0000-0000-0000-000000866d55">Canonicalize File Names and Paths</a></li>
<li> <a href="00000000-0000-0000-0000-000000590dce">Check File Paths and Names for Null Bytes</a></li>
<li> <a href="00000000-0000-0000-0000-00000051c329">Validate All Input</a></li>
<li> <a href="00000000-0000-0000-0000-0000005804d8">Validate and Encode Data Inserted into XML Documents</a></li>
<li> <a href="00000000-0000-0000-0000-000000410a08">Validate and Encode Data Passed to UIWebView Controls</a></li>
<li> <a href="00000000-0000-0000-0000-00000049bb5e">Validate File Formats</a></li>
</ul><h2>Data Validation Checklists</h2><ul><li> <a href="00000000-0000-0000-0000-0000004d996e">File Names and Paths Are Canonicalized</a></li>
<li> <a href="00000000-0000-0000-0000-0000004446d0">File Paths and Names Are Checked for Null Bytes</a></li>
<li> <a href="00000000-0000-0000-0000-000000396c19">All Input Is Validated</a></li>
<li> <a href="00000000-0000-0000-0000-0000008c53b6">Data Inserted into XML Documents Is Validated and Encoded</a></li>
<li> <a href="00000000-0000-0000-0000-000000647d44">Data Passed to UIWebView Controls Is Validated and Encoded</a></li>
<li> <a href="00000000-0000-0000-0000-000000066105">File Formats Are Validated</a></li>
</ul><h2>Additional Resources</h2><ul><li> For information about <em>escapedTemplateForString</em> function, please see <a href="http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html">http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html</a></li>
<li> For more information about <em>UIWebView</em> controls, please see <a href="http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html">http://developer.apple.com/library/ios/#documentation/uikit/reference/UIWebView_Class/Reference/Reference.html</a></li></ul>