<h2>Applies To</h2><ul><li> PHP </li>
</ul><h2>What to Check For</h2><p>Make sure that sensitive data is not stored in persistent cookies.
</p><h2>Why</h2><p>Data stored in persistent cookies may be recovered by an attacker, if the attacker gets access to where the cookies are stored. Usually, this attack scenario means an attacker gaining physical access to the victim's computer and recovering all the cookies from it. At that point, any sensitive data in those cookies comes into the possession of the attacker. It is therefore not recommended to store sensitive data in persistent cookies. The most common type of sensitive data that is stored in persistent cookies is an authentication token or a session ID, which is used to keep a user logged on for an extended period of time. If this functionality is absolutely required, then storing such sensitive information in persistent cookies cannot be avoided. Overall, it is recommended not to implement that functionality and not to store any sensitive information in persistent cookies.
</p><h2>How to Check</h2><p>To make sure that sensitive data is not stored in persistent cookies:
</p><ol>
<li> <strong>Identify all cookies used by the application.</strong> Search application code for references to <em>setcookie</em>. This should help find all the cookies created by the application.</li>
<li> <strong>Find code that handles sensitive cookies.</strong> Examine code that handles each cookie and see if it stores sensitive information in the cookie.</li>
<li> <strong>Make sure that sensitive cookies aren't persistent.</strong> Review all code that handles sensitive cookies. Make sure that the <em>expire</em> property of sensitive cookies is never set, because that makes them persistent.</li>
</ol><h2>How to Fix</h2><p>To prevent storing sensitive data in persistent cookies:
</p><ol>
<li> <strong>Identify all cookies used by the application.</strong> Search application code for references to <em>setcookie</em>. This should help find all the cookies created by the application.</li>
<li> <strong>Find code that handles sensitive cookies.</strong> Examine code that handles each cookie and see if it stores sensitive information in the cookie.</li>
<li> <strong>Don't make sensitive cookies persistent.</strong> Review all code that handles sensitive cookies. Make sure that the <em>expire</em> property of sensitive cookies is never set, because that makes them persistent. Remove code that sets the <em>expire</em> property of sensitive cookies, if such code exists.</li>
</ol><h2>Additional Resources</h2><ul><li> For more information about the <em>setcookie</em> function, see <a href="http://php.net/manual/en/function.setcookie.php">http://php.net/manual/en/function.setcookie.php</a></li></ul>