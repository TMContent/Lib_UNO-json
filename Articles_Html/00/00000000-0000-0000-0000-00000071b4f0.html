<h2>What to Check For</h2><p>Verify that data inserted into XML documents is validated and encoded.
</p><h2>Why</h2><p>Validating and encoding data inserted into XML documents helps prevent XML injection vulnerabilities.
</p><h2>How to Check</h2><p>To verify that data inserted into XML documents is validated and encoded:
</p><ol>
<li> <strong>Identify XML documents used by the application.</strong> Examine the application design to identify all XML documents and XML document types used by the application.</li>
<li> <strong>Identify code that uses XML documents.</strong> Review application code to find code that uses XML documents.</li>
<li> <strong>Review validation code.</strong> Make sure there are clear validation functions defined for each type of XML data handled by the application.</li>
<li> <strong>Review encoding code.</strong> Make sure there are encoding functions defined for XML data. Consider the following when evaluating XML encoding: data has to be converted to a uniform character encoding first, XML entities have to be escaped properly, and code that loads XML documents should be able to restore the original data from the encoded data.</li>
<li> <strong>Verify that validation and encoding are used.</strong> Make sure that all XML data is validated and encoded before being inserted into XML documents.</li>
</ol><h2>How to Fix</h2><p>To validate and encode data inserted into XML documents:
</p><ol>
<li> <strong>Identify XML documents used by the application.</strong> Examine the application design to identify all XML documents and XML document types used by the application.</li>
<li> <strong>Identify code that uses XML documents.</strong> Review application code to find code that uses XML documents.</li>
<li> <strong>Add data validation code.</strong> Add methods that validate all the data types that are stored in XML documents and used by the application.</li>
<li> <strong>Use validation code.</strong> Add code that uses the data validation methods from the previous step to code that uses XML documents. Validation should be performed before encoding.</li>
<li> <strong>Add encoding code.</strong> Add methods that escape XML entities. Unfortunately, there are no stable libraries available for escaping XML entities for iOS. When writing code that escapes XML entities, consider the following: data has to be converted to a uniform character encoding first, XML entities have to be escaped properly, and code that loads XML documents should be able to restore the original data from the encoded data.</li>
<li> <strong>Use encoding code.</strong> Add code that encodes data to code that uses XML documents. </li>
</ol><h2>Data Validation Guidelines</h2><ul><li> <a href="00000000-0000-0000-0000-0000008d3cec">Canonicalize File Names and Paths</a></li>
<li> <a href="00000000-0000-0000-0000-0000008149ca">Validate All Input</a></li>
<li> <a href="00000000-0000-0000-0000-0000006c7089">Validate and Encode Data Inserted into XML Documents</a></li>
<li> <a href="00000000-0000-0000-0000-0000007635ae">Validate File Formats</a></li>
</ul><h2>Data Validation Checklists</h2><ul><li> <a href="00000000-0000-0000-0000-0000009763b8">File Names and Paths Are Canonicalized</a></li>
<li> <a href="00000000-0000-0000-0000-0000004f2fec">All Input Is Validated</a></li>
<li> <a href="00000000-0000-0000-0000-00000071b4f0">Data Inserted into XML Documents Is Validated and Encoded</a></li>
<li> <a href="00000000-0000-0000-0000-00000080c790">File Formats Are Validated</a></li></ul>