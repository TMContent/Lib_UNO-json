<h2>Applies To</h2><ul><li> HTML5</li>
</ul><h2>What to Check For</h2><p>Verify that authentication information is not stored in local storage.
</p><h2>Why</h2><p>HTML5 local storage is not designed to store sensitive information and is not suitable for that purpose. Data in local storage may be accessed by JavaScript, which means that it can be compromised via cross-site scripting (XSS) attacks. Cookies with the HTTPOnly flag set cannot be accessed with JavaScript, so they are much harder to compromise via XSS. 
</p><p>
Overall, protected cookies are a better way to store session tokens, but should not store authentication information itself. Authentication information, other than session tokens, should not be stored on the client at all.
</p><h2>How to Check</h2><p>To verify that authentication information is not stored in local storage:
</p><ol>
<li> <strong>Find all code that stores authentication information in local storage.</strong> Search the application code for references to the localStorage object. Examine each reference to the localStorage object to identify whether it is used to store or access authentication information. If the number of these references is prohibitively large, examine just the authentication code in this manner and ask the application's architect whether local storage is used to store authentication information. Create a spreadsheet to list all the code that stores or accesses authentication information in local storage.</li>
<li> <strong>Verify that session tokens are stored in protected cookies.</strong> Identify how session tokens used by the application are stored. A cursory review can be performed by using a web browser and viewing the cookies. The presence of a session cookie set by the application should incidate that cookies are being used to store session tokens. However, it is more reliable to review application code to identify how session tokens are stored and to make sure that they are not stored in local storage.</li>
<li> <strong>Verify that authentication information is not stored in local storage.</strong> Review every piece of application code that uses local storage and check what kind of data it stores in local storage. Make sure that authentication information, such as usernames or passwords, is not stored in local storage.</li>
</ol><h2>How to Fix</h2><p>To remove all code that stores authentication information in local storage:
</p><ol>
<li> <strong>Find all code that stores authentication information in local storage.</strong> Search the application code for references to the localStorage object. Examine each reference to the localStorage object to identify whether it is used to store or access authentication information. If the number of these references is prohibitively large, examine just the authentication code in this manner and ask the application's architect whether local storage is used to store authentication information. Create a spreadsheet to list all the code that stores or accesses authentication information in local storage.</li>
<li> <strong>Store session tokens in protected cookies.</strong> The recommended way to handle sessions in web applications is to store session tokens in cookies that have HTTPOnly and Secure flags set. If the application uses a mechanism for session management other than storing session identifiers in protected cookies, it should be rewritten. Most web application platforms are designed in a manner to facilitate using cookies to store session identifiers, so there should be plenty of documentation and the overall process should be pretty simple.</li>
<li> <strong>Remove all code that stores authentication information in local storage.</strong> Once the application stores session identifiers in protected cookies, code that stores and accesses authentication information in local storage can be safely removed. Use the spreadsheet you created to find this code and remove it. Test these changes thoroughly, especially if you are making them to a live application.</li>
</ol><h2>Local Storage Guidelines</h2><ul><li> <a href="00000000-0000-0000-0000-0000005c244a">Host Different Applications on Different Subdomains</a></li>
<li> <a href="00000000-0000-0000-0000-00000061bbb6">Do Not Store Sensitive Information in Local Storage</a></li>
<li> <a href="00000000-0000-0000-0000-000000233bdb">Use Session Storage Instead of Local Storage If Possible</a></li>
<li> <a href="00000000-0000-0000-0000-00000052241e">Do Not Store Session Identifiers in Local Storage</a></li>
<li> <a href="00000000-0000-0000-0000-00000052e67b">Do Not Store Authentication Information in Local Storage</a></li>
</ul><h2>Local Storage Checklist Items</h2><ul><li> <a href="00000000-0000-0000-0000-000000358a18">Different Applications Are Hosted on Different Subdomains</a></li>
<li> <a href="00000000-0000-0000-0000-000000972b0b">Sensitive Information Is Not Stored in Local Storage</a></li>
<li> <a href="00000000-0000-0000-0000-0000007e3ee6">SessionStorage Is Used Instead of LocalStorage If Possible</a></li>
<li> <a href="00000000-0000-0000-0000-00000062c37e">Session Identifiers Are Not Stored in Local Storage</a></li>
<li> <a href="00000000-0000-0000-0000-0000004e1296">Authentication Information Is Not Stored in Local Storage</a></li>
</ul>