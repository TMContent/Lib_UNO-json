<h1>Summary</h1>
  <p>This How to shows you how to configure ASP.NET Web applications to run in medium trust. If you host multiple applications on the same server, you can use code access security and the medium trust level to provide application isolation. By setting and locking the trust level in the machine-level Web.config file, you can establish security policies for all Web applications on the server.&nbsp;Medium trust still provides a constrained environment for isolating applications from one another and from shared server resources. Medium trust applications have no registry access, no event log access, and no ability to use reflection. Web access is limited to the network address that you define in the &lt;&lt;<b>trust/&gt;</b>&gt; element, and file system access is limited to the application's virtual directory hierarchy. If medium trust policy is too restrictive, you can create and use a custom policy file. </p>
  <h1>Contents</h1>
  <ul>
    <li>
      <div>Objectives</div>
      <li>
        <div>Overview</div>
        <li>Medium Trust Summary<li><div>Summary of Steps</div><li><div>Step 1. Configure Medium Trust</div><li><div>Step 2. Lock the Trust Level</div><li><div>Step 3. Optionally Create a Custom Policy Based on Medium Trust</div><li><div>OleDbPermission, EventLogPermission and FileIOPermission</div><li><div>Developing for Medium Trust</div><li><div>Additional Resources</div></li></li></li></li></li></li></li></li>
      </li>
    </li>
  </ul>
  <h1>Objectives</h1>
  <ul>
    <li>Learn how to develop Web applications using medium trust. <li>Learn about the constraints while using medium trust levels. <li>Configure medium trust levels in your Web application. <li>Modify trust levels to create your own custom trust levels. </li></li></li></li>
  </ul>
  <h1>Overview</h1>
  <p>By default, ASP.NET Web applications and Web services run with full trust and applications can perform privileged operations and access resources subject only to operating system security and Windows access control lists (ACLs).</p>
  <p>To lock down an ASP.NET application and to provide an additional level of application isolation in a hosted environment, you can use code access security to restrict the resources the application can access and the privileged operations it can perform. You do this by configuring the &lt;<b>trust</b>&gt;<b></b>element as shown here.</p>
  <div>
    <pre>&lt;trust level="Full&#124;High&#124;Medium&#124;Low&#124;Minimal" /&gt;  </pre>
  </div>
  <p>The &lt;<b>trust</b>&gt; element supports a number of default trust levels. Each level in succession provides a more restrictive environment (with fewer code access security permissions) in which to run your application.</p>
  <p>Internet service providers (ISPs) that need to host multiple applications from many different companies frequently use the medium trust level to help ensure that applications cannot read each other's data or interfere with one another in any way. Medium trust also places restrictions on the types of shared system resources that the applications can access.</p>
  <h1>Medium Trust Summary</h1>
  <p>The main constraints placed on medium trust Web applications are: </p>
  <ul>
    <li>
      <b>OleDbPermission</b> is not available. This means you cannot use the ADO.NET managed OLE DB data provider to access databases. However, you can use the managed SQL Server provider to access SQL Server databases. <li><b>EventLogPermission</b> is not available. This means you cannot access the Windows event log. <li><b>ReflectionPermission</b> is not available. This means you cannot use reflection. <li><b>RegistryPermission</b> is not available. This means you cannot access the registry. <li><b>WebPermission</b> is restricted. This means your application can only communicate with an address or range of addresses that you define in the &lt;<b>trust</b>&gt; element. <li><b>FileIOPermission</b> is restricted. This means you can only access files in your application's virtual directory hierarchy. Your application is granted Read, Write, Append, and PathDiscovery permissions for your application's virtual directory hierarchy. </li></li></li></li></li></li>
  </ul>
  <p>You are also prevented from calling unmanaged code or from using Enterprise Services.</p>
  <h1>Summary of Steps</h1>
  <p>To use medium trust in your ASP.NET applications: </p>
  <ul>
    <li>Step 1. Configure medium trust. <li>Step 2. Lock the trust level. <li>Step 3. Optionally create a custom policy based on medium trust.<strong></strong></li></li></li>
  </ul>
  <h1>Step 1. Configure Medium Trust</h1>
  <p>To configure an application to run with medium trust, add the following element to either the application's specific Web.config file in the application's virtual root directory or to the machine-level Web.config file.</p>
  <div>
    <pre>&lt;trust level="Medium" originUrl="" /&gt;  </pre>
  </div>
  <blockquote>
    <b>Note</b>&nbsp;&nbsp;&nbsp;If present, the <b>originUrl</b> attribute can be used by some permissions, such as <b>WebPermission</b>, to restrict connectivity to a defined set of addresses.<b></b></blockquote>
  <p>To configure all Web applications on a server to run with medium trust, add this element to the machine-level Web.config file located in the following folder: &#37;windir&#37;\Microsoft.NET\Framework\&#123;version&#125;\CONFIG.</p>
  <p>By default, Web applications are configured to run with full trust as shown in the following default configuration from the machine-level Web.config file.</p>
  <div>
    <pre>&lt;location allowOverride="true"&gt;<br />&nbsp;&lt;system.web&gt;<br />&nbsp;&nbsp; &lt;securityPolicy&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;trustLevel name="Full" policyFile="internal" /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;trustLevel name="High" policyFile="web_hightrust.config" /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;trustLevel name="Medium" <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; policyFile="web_mediumtrust.config" /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;trustLevel name="Low"&nbsp; policyFile="web_lowtrust.config" /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;trustLevel name="Minimal" <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; policyFile="web_minimaltrust.config" /&gt;&nbsp; <br />&nbsp;&nbsp; &lt;/securityPolicy&gt;<br />&nbsp;&nbsp; &lt;trust level="Full" originUrl="" /&gt;<br />&nbsp;&lt;/system.web&gt;<br />&lt;/location&gt;  </pre>
  </div>
  <p>To review the full set of permissions available to medium trust applications, view the Web_mediumtrust.config file.</p>
  <h1>Step 2. Lock the Trust Level</h1>
  <p>Application service providers or anyone responsible for running multiple Web applications on the same server should apply the medium trust policy setting in the machine-level Web.config file and then lock the trust level for all Web applications.</p>
  <p>To do this, set the <b>allowOverride</b> attribute to <b>false</b> in the machine-level Web.config file, as shown in the following code example.</p>
  <div>
    <pre>&lt;location allowOverride="false"&gt;<br />&nbsp;&lt;system.web&gt;<br />&nbsp;&nbsp; &lt;securityPolicy&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;trustLevel name="Full" policyFile="internal" /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;trustLevel name="High" policyFile="web_hightrust.config" /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;trustLevel name="Medium"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; policyFile="web_mediumtrust.config" /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;trustLevel name="Low"&nbsp; <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; policyFile="web_lowtrust.config" /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;trustLevel name="Minimal" <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; policyFile="web_minimaltrust.config" /&gt;&nbsp; <br />&nbsp;&nbsp; &lt;/securityPolicy&gt;<br />&nbsp;&nbsp; &lt;trust level="Medium" originUrl="" /&gt;<br />&nbsp;&lt;/system.web&gt;<br />&lt;/location&gt;  </pre>
  </div>
  <p>By setting <b>allowOverride="false"</b>, an individual developer is unable to override the medium trust policy setting in their application's Web.config file.</p>
  <h1>Step 3. Optionally Create a Custom Policy Based on Medium Trust</h1>
  <p>If medium trust proves too restrictive, you can create a custom policy file based on the medium trust policy. For example, you might want to allow applications to do one of the following: connect to an Oracle database, write events to the Windows event log, or read files from a specified directory outside of the application's virtual directory hierarchy.</p>
  <h2>To create a custom policy based on medium trust </h2>
  <ol>
    <li>Copy the medium trust policy file web_MediumTrust.config located in the following directory to create a new policy file in the same directory: &#37;windir&#37;\Microsoft.NET\Framework\&#123;Version&#125;\CONFIG. <p>Give it a name that indicates that it is your variation of medium trust; for example, it could be named customWeb_MediumTrust.config. </p><li>Add the permissions that you want to grant. In the following example, the <b>FileIOPermission</b> is modified to allow read access to a specific directory outside of the application's virtual directory hierarchy. <div><pre>&lt;PermissionSet<br />&nbsp;&nbsp;&nbsp; class="NamedPermissionSet"<br />&nbsp;&nbsp;&nbsp; version="1"<br />&nbsp;&nbsp;&nbsp; Name="ASP.Net"&gt;<br />&nbsp; ...<br />&nbsp;&nbsp;&nbsp; &lt;IPermission<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; class="FileIOPermission"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; version="1"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Read="C:\SomeDir;&#36;AppDir&#36;"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Write="&#36;AppDir&#36;"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Append="&#36;AppDir&#36;"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PathDiscovery="&#36;AppDir&#36;"<br />/&gt;<br />&nbsp; ...<br />&lt;/PermissionSet&gt;  </pre></div><li>Create a new custom policy level in your machine-level Web.config file. The policy file is the name of the policy file you created in step 1. <div><pre>&lt;securityPolicy&gt;<br />&nbsp; &lt;trustLevel name="CustomMedium" <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; policyFile="customWeb_mediumtrust.config" /&gt;<br />&nbsp; ...<br />&lt;/securityPolicy&gt;  </pre></div><li>Configure applications to run at the new custom policy level by setting the trust level to <b>"CustomMedium"</b>. Your security policy will resemble the following example. <div><pre>&lt;system.web&gt;<br />&nbsp; &lt;securityPolicy&gt;<br />&nbsp;&nbsp; &lt;trustLevel name="CustomMedium"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; policyFile="customWeb_mediumtrust.config" /&gt;<br />&nbsp;&nbsp; &lt;trustLevel name="Full" policyFile="internal" /&gt;<br />&nbsp;&nbsp; &lt;trustLevel name="High" <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; policyFile="web_hightrust.config" /&gt;<br />&nbsp;&nbsp; &lt;trustLevel name="Medium" <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; policyFile="web_mediumtrust.config" /&gt;<br />&nbsp;&nbsp; &lt;trustLevel name="Low"&nbsp; policyFile="web_lowtrust.config" /&gt;<br />&nbsp;&nbsp; &lt;trustLevel name="Minimal"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; policyFile="web_minimaltrust.config" /&gt;<br />&nbsp;&lt;/securityPolicy&gt;<br />&nbsp;&lt;trust level="CustomMedium" originUrl="" /&gt;<br />&lt;/system.web&gt;  </pre></div></li></li></li></li>
  </ol>
  <h1>OleDbPermission, EventLogPermission and FileIOPermission</h1>
  <p>Common permissions that you might need to add include: </p>
  <ul>
    <li>
      <b>OleDbPermission</b>
      <li>
        <b>EventLogPermision</b>
        <li>
          <b>FileIOPermission</b>
        </li>
      </li>
    </li>
  </ul>
  <h2>OleDbPermission</h2>
  <p>If you support multiple database server types, you need to grant <b>OleDbPermission</b> to Web applications in addition to <b>SqlClientPermission</b>, which is already granted by medium trust policy.</p>
  <h3>To extend medium trust policy to grant OleDbPermission </h3>
  <ol>
    <li>Create a custom policy file and configure your application to use the custom trust level, as described in the "Modifying Medium Trust Policy" section earlier in this document. <li>Add the following permission class to the &lt;<b>SecurityClasses</b>&gt; section. <div><pre>&lt;SecurityClass Name="OleDbPermission" <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Description="System.Data.OleDb.OleDbPermission, System.Data, Version=3.5.0.0, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Culture=neutral, PublicKeyToken=b77a5c561934e089"/&gt;  </pre></div><li>Add the unrestricted <b>OleDbPermission</b> to the "ASP.Net" named permission set, as shown in the following example. <div><pre>&lt;PermissionSet<br />&nbsp;&nbsp;&nbsp; class="NamedPermissionSet"<br />&nbsp;&nbsp;&nbsp; version="1"<br />&nbsp;&nbsp;&nbsp; Name="ASP.Net"&gt;<br />&nbsp; ...<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;IPermission class="OleDbPermission" <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; version="1" <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Unrestricted="true"/&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; ...<br />&nbsp;&nbsp; &lt;/PermissionSet&gt;  </pre></div></li></li></li>
  </ol>
  <h3>Locking Down Connection Strings</h3>
  <p>Adding the unrestricted <b>OleDbPermission</b> to your policy file means that your application can use any OLE DB provider on the server. In a hosted environment, an administrator may need to use the more advanced form of the <b>OleDbPermission</b> syntax to lock down connection strings used with <b>OleDbPermission</b> to allow access only to specific databases. The following example shows how to restrict access to a specific OLE DB data source.</p>
  <div>
    <pre>&lt;IPermission class="OleDbPermission"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; version="1"&gt;<br />&nbsp; &lt;add ConnectionString=<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\data\w4w.mdb"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; KeyRestrictions=""<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; KeyRestrictionBehavior="AllowOnly"/&gt;<br />&lt;/IPermission&gt;  </pre>
  </div>
  <p>The &lt;<b>add</b>&gt; element supports the following attributes: </p>
  <ul>
    <li>
      <b>ConnectionString.</b> This element specifies a permitted connection string. <li><b>KeyRestrictions. </b>This element specifies additional connection string parameters that may or may not be added to the connection string depending on the value of <b>KeyRestrictionBehavior</b>. Specify connection string parameters using the syntax <i>parameterName</i>=. You can specify multiple parameters by delimiting each one with a semi-colon (;). <li><b>KeyRestrictionBehavior.</b> You can set this to <b>AllowOnly</b> or <b>PreventUsage</b>. <ul><li>If you use <b>AllowOnly</b>, only the additional connection string parameters specified in the <b>KeyRestrictions</b> attribute may be added to the connection string specified in <b>ConnectionString</b>. <li>If you use <b>PreventUsage</b>, the connection string parameters specified in the <b>KeyRestrictions</b> attribute may not be added to the connection string specified in <b>ConnectionString</b>, although other connection string parameters may be added. </li></li></ul></li></li></li>
  </ul>
  <p>If no key restrictions are specified, and the <b>KeyRestrictionBehavior</b> attribute is set to <b>AllowOnly</b>, no additional connection string parameters are allowed.</p>
  <p>If no key restrictions are specified, and the <b>KeyRestrictionBehavior</b> property is set to <b>PreventUsage</b>, additional connection string parameters are allowed. </p>
  <h3>EventLogPermission</h3>
  <p>Medium trust policy does not permit access to the Windows event log. </p>
  <p>
    <b>To enable access to the event log</b>
  </p>
  <ol>
    <li>Create a custom policy file and configure your application to use the custom trust level, as described in the "Modifying Medium Trust Policy" section earlier in this document. <li>Add the following permission class to the &lt;<b>SecurityClasses</b>&gt; section to the custom policy file. <div><pre>&lt;SecurityClasses&gt;<br />&nbsp; ...<br />&nbsp; &lt;SecurityClass Name="EventLogPermission"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Description="System.Diagnostics.EventLogPermission, System, Version=3.5.0.0, <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Culture=neutral, PublicKeyToken=b77a5c561934e089" /&gt;<br />&nbsp; ...<br />&lt;/SecurityClasses&gt;                          </pre></div><li>Add the following <b>EventLogPermission</b> to the "ASP.Net" named permission set. <div><pre>&lt;PermissionSet<br />&nbsp;&nbsp;&nbsp; class="NamedPermissionSet"<br />&nbsp;&nbsp;&nbsp; version="1"<br />&nbsp;&nbsp;&nbsp; Name="ASP.Net"&gt;<br />&nbsp; ...<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;IPermission<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; class="EventLogPermission"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; version="1"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Machine name="."<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; access="Write"/&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;/IPermission&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; ...<br />&nbsp;&nbsp; &lt;/PermissionSet&gt;  </pre></div></li></li></li>
  </ol>
  <blockquote>
    <b>Note</b>&nbsp;&nbsp;&nbsp;At the time of writing, you must set <b>access="administer"</b> to be able to write to the event log from a partial trust application.<b></b></blockquote>
  <h3>Creating Event Sources</h3>
  <p>If your application needs to use application specific event sources, you should create them at installation time when administrator privileges are available. A good approach is to use a .NET installer class, which can be instantiated by the Windows Installer (if you are using .msi deployment) or by the InstallUtil.exe system utility.</p>
  <p>If you are unable to create event sources at installation time, and you are in deployment, the administrator should manually create new event source entry beneath the following registry key</p>
  <div>
    <pre>
      <b>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\&lt;LogName&gt;</b>
    </pre>
  </div>
  <blockquote>
    <b>Note</b>&nbsp;&nbsp;&nbsp;You should not grant write permission to the ASP.NET process account (or any impersonated account if your application uses impersonation) on the <b>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\ </b>registry key. If you allow write access to this key and the account is compromised, the attacker can modify any log-related setting, including access control to the log, for any log on the system.</blockquote>
  <h2>FileIOPermission</h2>
  <p>If you need to allow your application to access files outside of the application's virtual directory hierarchy, you can create a custom policy file based on the medium trust file, and then modify the <b>FileIOPermission</b>.</p>
  <p>For example, the following definition enables an application to read files in the "C:\SomeDir" directory.</p>
  <div>
    <pre>&lt;IPermission<br />&nbsp; class="FileIOPermission"<br />&nbsp; version="1"<br />&nbsp; Read="C:\SomeDir;&#36;AppDir&#36;"<br />&nbsp; Write="&#36;AppDir&#36;"<br />&nbsp; Append="&#36;AppDir&#36;"<br />&nbsp; PathDiscovery="&#36;AppDir&#36;"<br />/&gt;  </pre>
  </div>
  <p>By letting applications access files beyond the application's virtual directory hierarchy, you diminish the ability of code access security to provide application isolation. If you have multiple applications on a single server, you need to protect resources, such as files with ACLs, and use separate identities for each application.</p>
  <h1>Developing for Medium Trust</h1>
  <p>To help design and develop your applications for medium trust, consider the following: </p>
  <ul>
    <li>
      <b>Identify the types of resources that your application needs to access and the privileged operations it needs to perform</b>. <p>You need to know which code access security permissions your application requires.&nbsp; </p><li><b>Know what permissions are available at medium trust</b>. <p>The best way to learn what permissions are available is to open and examine the web_MediumTrust.config file in the following folder: &#37;windir&#37;\Microsoft.NET\Framework\&#123;Version&#125;\CONFIG. </p><li><b>Configure your development environment and your application's Web.config file for medium trust</b>. <p>Do this at the start of development so that you can immediately see what permission requests fail and what issues need to be addressed. </p><li><b>For existing applications, consider using the Permcalc tool</b>. <p>If you have an existing application that you want to run at medium trust, consider using the Permcalc tool to help you determine precisely which permissions your application needs. You should also make sure that extensive testing is performed to verify that all code paths through your application have been executed. Failure to do so can lead to unexpected security exceptions at run time. </p></li></li></li></li>
  </ul>
  <p>The best approach is to target your trust level before you begin design and development work and to design and develop specifically for this trust level. Common causes of security exceptions when you switch an existing application to medium trust include: </p>
  <ul>
    <li>Calling unmanaged code. <li>Accessing the registry. <li>Writing to the event log. <li>Connecting to databases other than SQL Server. <li>Accessing Web resources on remote servers. <li>Accessing the file system beyond your application's virtual directory hierarchy.</li></li></li></li></li></li>
  </ul>
  <hr />
  <p>Adapted from Microsoft patterns & practices guidance.</p>