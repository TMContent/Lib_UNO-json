<h1>What to Check For</h1>
  <p>Ensure your application logs all important operations relevant to the application's security model. Such operations include, but are not limited to, authentication attempts, change of user accounts and activation of new accounts. </p>
  <h1>Why</h1>
  <p>A log trail of security operations can help you recognize application misuse and/or malicious activity. It can also help you track what happened in order to assess damage and improve future protections.</p>
  <h1>How to Check</h1>
  <p>Use the following steps to verify your application logs important security operations.</p>
  <ol>
    <li>
      <p>
        <strong>Enumerate important operations your application performs. </strong>Review your application's architecture and security objectives to determine which operations are important to log. In general, you should log anything that can help you recognize or track malicious attack on your system. This could include:</p>
      <ul>
        <li>
          <strong>Authentication attempts:</strong> Verify that&amp;nbsp;your application logs all authentication attempts whether they are successful or not. You may choose to include additional information such as remote host IP/name. Logging authentication attempts provides a record when accounts have been compromised or your application has been used for malicious activities. <li><strong>Account changes:</strong> Verify&amp;nbsp; that your application logs all changes made to a user's account. Such changes include, but are not limited to, change of password/PIN, account details, and contact information. Such logs are useful when tracking the damage caused by a breach or when enforcing a lockout policy. <li><strong>Transactions performed by logged-in users:</strong> Verify that&amp;nbsp;your application logs all transactions performed by a logged-in user that have some value. For instance, you should log e-commerce purchases since they have monetary value. It is also recommended to log the occurrence of user transactions when sensitive data is involved; however, do not log the actual sensitive data. <li><strong>Creation, activation, and locking/unlocking of accounts:</strong> Verify that your application logs all operations regarding the creation, activation, and lockout of users. Logged information should include remote IP and a valid e-mail address. These logs can be useful when investigating compromised accounts and non-legitimate users. <li><strong>System and security related administrative operations:</strong> Verify that&amp;nbsp;your application logs all events pertaining to the overall wellness of your application. Examples of such would be configuring, starting and terminating your application, auditing events, etc. </li></li></li></li></li>
      </ul>
      <li>
        <p>
          <strong>Identify the logging mechanism. </strong>Determining the logging mechanism ensures that you understand what information is being logged and&amp;nbsp;where. Whenever possible, ASP.NET Health Monitoring should be used for logging. Code which uses of Health Monitoring will contain references to one or more event providers (sinks for generated log data) which inherit from <strong>System.Web.Management.WebEventProvider</strong>, and one or more events (classes which capture log data) which inherit from <strong>System.Web.Management.WebAuditEvent</strong>. If an ad-hoc log generation mechanism is being used, you will need to trace through all the code manually to make sure that it is called at all appropriate points and that all the generated log messages actually make it to a log store.</p>
        <li>
          <p>
            <strong>Audit the application logs. </strong>Audit log message contents generated from important operations identified from Step 1. If there are no available logs to audit, use your application to generate logged sample data from the application's components that perform important operations. During the log audit, verify the following:</p>
          <ul>
            <li>
              <strong>Correct logging level for each activity are used.</strong> Assigning incorrect severity level to log messages would allow malicious activities go un-noticed. <li><strong>Both successful and failed events are logged</strong>. Successful addition of high privilege accounts may imply attackers are able to gain access to your system. Not logging those events allow serious damage to be done. </li></li>
          </ul>
        </li>
      </li>
    </li>
  </ol>
  <h1>Problem Example</h1>
  <p>An e-commerce site does hundreds of transactions an hour, but only has basic web and database logs. When an attacker finds a flaw in the application's security implementation, it gets lost in the noise of all of the other site traffic, as not all security events are specifically logged. The attacks aren't noticed until they've made a serious financial dent, and when they are, forensics and problem solving are complicated by the fact that critical data was never logged by the system, and that there is no way to correlate the information which exists into a business-level view of the system.</p>
  <h1>Related Guideline</h1>
  <ul>
    <li>
      <a href="/article/a053c4e4-2aad-41b9-b60b-e0fdeffd39f4">Guideline: Log Important Security Operations</a>
    </li>
  </ul>
  <hr />
  <p>Adapted from Microsoft patterns &amp; practices guidance. </p>