<h2>What to Check For</h2><p>Verify that change of first-use passwords is forced.
</p>
<h2>Why</h2><p>Force the change of the first-use password to make sure that only the user knows the password. Otherwise, whoever set the first-use password will also know it.
</p>
<h2>How to Check</h2><p>To verify that change of first-use passwords is forced:
</p><ol>
<li> <strong>Set the first-use password for a user.</strong> Have an administrator create a new user account and set a first-use password for it.</li>
<li> <strong>Verify that the user is forced to change the first-use password.</strong> Login as this new user account and make sure that you are forced to change the first-use password. Remove this user account after testing.</li>
</ol>
<h2>How to Fix</h2><p>To force the change of the first-use password:
</p><ol>
<li> <strong>Identify authentication code.</strong> Make a spreadsheet about the code that implements authentication in the application. Record the names of the functions and the source code files containing them in the spreadsheet.</li>
<li> <strong>Check if the password needs to be changed.</strong> Identify the function that validates the entered passwords. If it doesn't already do so, modify it to check whether the password needs to be changed. The easiest way to do this is to have a flag associated with the stored authentication credentials that indicates whether a given password needs to be changed. For example, if password hashes are stored in a relational database table, the flag can be an additional boolean column or field in the table schema.The value of this field should be checked during authentication to determine whether the user needs to change the password.</li>
<li> <strong>Trigger password change after first successful authentication.</strong> Find code that validates the entered passwords. If it doesn't already do so, modify it to prompt the user to change the password after successfully entering the password, if the password changing flag is set. The user should not be able to do anything until the password is changed. This prevents the user from ignoring the password change prompt.</li>
<li> <strong>Set a flag to force password change on passwords that are assigned to the user.</strong> Find code that allows setting the user's password by an administrator. If it doesn't already do so, modify it to set the flag that indicates that the user has to change the password upon successful authentication.</li>
</ol>