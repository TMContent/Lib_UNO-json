<h1>Applies To</h1><p>All applications.
</p><h1>Description</h1><p>A business rule defines the constraints on how the application interacts at a high level. Business rules define the procedures that must be followed, the relationships that must be maintained between assets, and the set of rules around who's allowed to take which actions. All systems have business rules, whether very simple ones, like those around a read-only web site, or complex ones, like those embedded in a complex ERP system. The business rules of a system rarely exist in any specifically concrete form, and are normally spread throughout the application in a very ad-hoc manner, making them hard to audit and maintain.
</p><p>
In an attack against the business rules of a system, the attacker subverts the functionality of a system, instead of merely breaking the underlying code. If an application can be attacked through its business rules, it means that either the rules are not being enforced properly throughout the entire system, or that the rules of the system (often and especially the rules which determine relationships between modules, instead of intramodule rules) are not entirely consistent. This inconsistency can be exploited by an attacker. The fact that business rule attacks usually work entirely within the bounds of the system makes them much harder to detect and prevent. A simple code audit will not be sufficient to find these issues. Furthermore, because business rules define the basic function and purpose of an application, attacks against business rules are often some of the more profitable attacks for an attacker, and the more devastating ones for a victim.
</p><h1>Impact</h1><ul><li>Elevation of privilege: In the strictest sense, most of the issues from a business rule will be elevation of privilege issues, allowing the attacker to do things which are normally prohibited.</li>
<li>Information disclosure: Information disclosure issues are part and parcel of the elevation of privilege issues.</li>
<li>Denial of service: In more complicated applications, it is often the case that subverting the business rules of an application can make it effectively non-functional, resulting in deadlock of one kind or another.</li>
</ul><h1>Vulnerabilities</h1><ul><li>Internal inconsistencies in the business rules of the system.</li>
<li>Failure to enforce business rules uniformly at all points in the system.</li>
</ul><h1>Countermeasures</h1><ul><li>Document the business rules of the system in a single place.</li>
<li>Generate a threat model of the application and carefully analyze the business rules as specified.</li>
<li>Centralize business rule code for easier auditing.</li>
<li>Audit the application code to ensure that all pathways through the system enforce the business rules as specified, and that no extra functionality exists in the system beyond that specified in the rules of the system.</li>
</ul><h1>Additional Resources</h1><ul><li>For more information on Business Logic, see: <a href="http://en.wikipedia.org/wiki/Business_logic">http://en.wikipedia.org/wiki/Business_logic</a></li>
<li>For more information on Threat Modeling, see: <a href="http://msdn2.microsoft.com/en-us/security/aa570413.aspx">http://msdn2.microsoft.com/en-us/security/aa570413.aspx</a></li>
</ul><h1>Related Items</h1><ul><li><a href="468c8d7a-ffc6-49ad-bef5-1886fd809a96">Attack: Denial of Service Attack</a></li>
<li><a href="4d3185fd-1e48-40af-bc07-71206c40806b">Attack: Trust Relationship Attack</a></li>
<li><a href="7e2fe1a5-ad30-4805-8421-767275dea35e">Attack: Repudiation Attack</a></li>
<li><a href="35de0530-71f4-4578-926d-bc0d25c12f45">Attack: Creation of False Transaction Attack</a></li>
<li><a href="96a66ca5-91b1-4c5a-80eb-fd0da97713ae">Attack: Social Engineering Attack</a></li>
<li><a href="8482159c-5ec2-4b89-9c65-9af765030ff5">Attack: Information Disclosure Attack</a></li>
</ul>