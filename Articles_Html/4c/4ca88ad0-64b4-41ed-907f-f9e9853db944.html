<p>##What to Check For##</p>
<p>Verify that authentication keys are protected.</p>
<p>##Why##</p>
<p>When authentication (or access) keys are lost, stolen, or compromised, the possessor can gain access to any objects that are accessible with the associated AWS account. Authentication keys (access key ID and secret access key) are generated so that programmatic requests can be sent to AWS. For this reason, security best practice is to restrict permissions for all AWS IAM user account keys for least privilege.</p>
<p>If the AWS root authentication keys are lost, the keys can be used to access all resources and billing information. For this reason, do not use the AWS account root access keys and, if possible, do not generate these keys. Note that the root access keys cannot be restricted by permissions or policy.</p>
<p>The management of secret authentication information of users is required by section A.9.2.4 of ISO/IEC 27001:2013. A formal management process is required to control the allocation of the authentication keys.</p>
<p>##When##</p>
<p>Authentication keys are protected under all scenarios, and there should be no exceptions to this rule.</p>
<ol>
<li>
<p><strong>Design and Testing.</strong> Examine the proposed use of authentication keys in an application, and use built-in safeguards and management features. For example, a testing role can be established, with IAM managing the issuance and management of credentials for access. These credentials are protected by IAM, and inherently more secure than user-generated keys. Consider using Cognito for mobile applications, where a user's identity is shared among multiple devices. Note that web applications might not benefit from Cognito functionality.</p>
</li>
<li>
<p><strong>Deployment</strong> Eliminate any development and testing keys by revoking assignment to rules and/or changing group permissions.</p>
</li>
<li>
<p><strong>Periodic Security Checks.</strong> When security audits or reports are reviewed, unnecessary authentication keys may be identified. These keys are removed to prevent any future misuse.</p>
</li>
</ol>
<p>##How to Check##</p>
<p>To verify that authentication keys are protected:</p>
<ol>
<li>
<p><strong>Make sure root keys are protected.</strong> Find out where the root keys are stored. Make sure they are used as little as possible and not stored on somebody's personal workstation. Determine if the security of the root keys is up to your organization's standards.</p>
</li>
<li>
<p><strong>Make sure that MFA is used.</strong> Make a list of all IAM users and verify that each IAM user account has MFA enabled and properly configured.</p>
</li>
<li>
<p><strong>Make sure that roles are used by applications.</strong> Identify all applications that use services on other instances than the ones hosting the application itself. Examine such applications to make sure that credentials used for accessing services are not hardcoded into the application or stored somewhere on the instance hosting the application; IAM roles should be used to access services instead.</p>
</li>
<li>
<p><strong>(For mobile applications) Verify that Cognito services are used.</strong> Examine mobile applications to make sure that Cognito services are used instead of hardcoding access credentials into the application. Unless there are clear advantages to doing writing custom authentication code, Cognito should be used for authentication in mobile applications that leverage cloud services.</p>
</li>
</ol>
<p>##How to Fix##</p>
<p>Include these best practices in your formal management plan to ensure the security of accounts and associated authentication keys. For more information about Best Practices for Managing AWS Access Keys, see http://docs.aws.amazon.com/IAM/latest/UserGuide/.</p>
<ol>
<li>
<p><strong>Protect root keys.</strong> Store root keys in a secure location and use them as little as possible. For example, an encrypted memory card that is kept offline as much as possible is one way to protect root keys.</p>
</li>
<li>
<p><strong>Enable MFA for privileged users.</strong> Turn on Multi-Factor Authentication (MFA) for privileged IAM users to help safeguard sensitive resources or APIs to which they have access.</p>
</li>
<li>
<p><strong>Use roles for applications.</strong> On EC2 instances, use IAM roles for applications that require credentials to access other services. Do not embed keys in an application. Assigning roles is more secure, since IAM provides temporary credentials, and automatic rotation, for the instance.</p>
</li>
<li>
<p><strong>Delegate by role.</strong> Users from other AWS accounts may require access to your AWS account resources. Use roles for this purpose, and do not share your credentials or authentication keys.</p>
</li>
<li>
<p><strong>Rotate credentials regularly.</strong> Password guidelines and rotation are specified in your password policy. The parameters can be made stricter as your security policy evolves. Authentication keys can be rotated regularly for greater protection.</p>
</li>
<li>
<p><strong>Remove unnecessary credentials.</strong> Generate a credential report for IAM users. Review the status and necessity of the credentials, and eliminate unnecessary passwords, keys and MFAs.</p>
</li>
<li>
<p><strong>Use AWS credentials file.</strong> AWS SDKs and AWS CLI automatically use credentials stored in the AWS credentials file.</p>
</li>
<li>
<p><strong>Use environment variables.</strong> User environment variables are used on a multi-tenant system. Do not use system environment variables with credentials.</p>
</li>
<li>
<p><strong>Use Cognito identity and sync services</strong> Temporary, limited-privilege credentials are provided to authenticated and unauthenticated users through an identity pool you assign to an IAM role.</p>
</li>
</ol>
<p>##Additional Resources##</p>
<ul>
<li><a href="http://docs.aws.amazon.com/cognito/devguide/" title="Amazon Cognito Developer Guide">Amazon Cognito Developer Guide</a></li>
<li><a href="http://aws.amazon.com/compliance/aws-whitepapers/" title="Amazon Web Services: Overview of Security Processes">Amazon Web Services: Overview of Security Processes</a></li>
<li><a href="http://aws.amazon.com/security/" title="AWS Security Best Practices">AWS Security Best Practices</a></li>
<li><a href="http://docs.aws.amazon.com/IAM/latest/UserGuide/policies_overview.html" title="AWS IAM: Using IAM">AWS Identity and Access Management: Using IAM</a></li>
<li><a href="http://www.iso.org/iso/catalogue_detail?csnumber=54534" title="ISO/IEC 27001:2013 - Information Management Security Systems Requirements">ISO/IEC 27001:2013 - Information technology - Security techniques - Information security management systems - Requirements</a></li>
</ul>
