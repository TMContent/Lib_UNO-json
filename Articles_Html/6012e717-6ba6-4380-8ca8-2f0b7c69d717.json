{
  "id": "6012e717-6ba6-4380-8ca8-2f0b7c69d717",
  "checksum": "3fd7477e07f84da285ae73ff596a0d8ee0da1900",
  "words": {
    "10": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "15": [
      "p"
    ],
    "20": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "h1",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "li",
      "li",
      "strong",
      "li",
      "p",
      "span",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "span",
      "span",
      "span",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li"
    ],
    "applications": [
      "ul",
      "li"
    ],
    "written": [
      "ul",
      "li"
    ],
    "using": [
      "ul",
      "li",
      "p",
      "ol",
      "li",
      "p"
    ],
    "servlets": [
      "ul",
      "li"
    ],
    "or": [
      "ul",
      "li",
      "ol",
      "li",
      "p",
      "span"
    ],
    "jsp": [
      "ul",
      "li"
    ],
    "what": [
      "h1"
    ],
    "do": [
      "h1",
      "ol",
      "li",
      "p",
      "strong"
    ],
    "protect": [
      "p",
      "p",
      "title"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "span",
      "span",
      "span",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "pre",
      "pre",
      "pre",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "confidentiality": [
      "p"
    ],
    "of": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "span",
      "span",
      "li",
      "p",
      "p",
      "p"
    ],
    "session": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "pre",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "strong",
      "p",
      "pre",
      "li",
      "p",
      "span",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "span",
      "span",
      "p",
      "p",
      "pre",
      "p",
      "p",
      "pre",
      "pre",
      "ul",
      "ul",
      "li",
      "li",
      "a",
      "title"
    ],
    "cookies": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "span",
      "span",
      "ul",
      "li",
      "title"
    ],
    "why": [
      "h1"
    ],
    "are": [
      "p",
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "p",
      "strong",
      "p"
    ],
    "used": [
      "p",
      "ol",
      "li",
      "p",
      "span",
      "p",
      "p"
    ],
    "by": [
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "span"
    ],
    "an": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "span",
      "span",
      "span"
    ],
    "application": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "span",
      "pre",
      "pre"
    ],
    "identify": [
      "p"
    ],
    "associated": [
      "p",
      "p",
      "p"
    ],
    "with": [
      "p",
      "p",
      "p"
    ],
    "a": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "span",
      "li",
      "p",
      "span"
    ],
    "particular": [
      "p"
    ],
    "user": [
      "p",
      "p",
      "pre"
    ],
    "protecting": [
      "p"
    ],
    "can": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "span",
      "span",
      "li",
      "p",
      "span"
    ],
    "help": [
      "p"
    ],
    "prevent": [
      "p",
      "ol",
      "li",
      "ul",
      "li"
    ],
    "attacker": [
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "span"
    ],
    "from": [
      "p",
      "ol",
      "li",
      "p",
      "span"
    ],
    "hijacking": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "span",
      "li",
      "p",
      "span"
    ],
    "and": [
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "a"
    ],
    "as": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "strong",
      "li",
      "li",
      "p",
      "p",
      "span",
      "span"
    ],
    "legitimate": [
      "p"
    ],
    "when": [
      "h1",
      "ol",
      "ol",
      "li",
      "p",
      "span",
      "li",
      "p",
      "span",
      "p",
      "p",
      "pre"
    ],
    "if": [
      "p"
    ],
    "your": [
      "p",
      "ol",
      "li",
      "p",
      "span"
    ],
    "uses": [
      "p"
    ],
    "maintain": [
      "p"
    ],
    "user's": [
      "p",
      "ol",
      "li",
      "p",
      "p"
    ],
    "state": [
      "p",
      "p"
    ],
    "then": [
      "p"
    ],
    "use": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "span",
      "span"
    ],
    "this": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "span",
      "li",
      "p"
    ],
    "guideline": [
      "p"
    ],
    "cookie": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "span",
      "span",
      "ul",
      "li",
      "a"
    ],
    "how": [
      "h1"
    ],
    "following": [
      "p",
      "p",
      "p"
    ],
    "steps": [
      "p"
    ],
    "secure": [
      "p",
      "ol",
      "li",
      "p",
      "span",
      "em"
    ],
    "not": [
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "strong"
    ],
    "allow": [
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "p",
      "strong"
    ],
    "users": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "choose": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "their": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "own": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "identifiers": [
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "strong"
    ],
    "java": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "automatically": [
      "ol",
      "li",
      "p",
      "p"
    ],
    "assigns": [
      "ol",
      "li",
      "p"
    ],
    "random": [
      "ol",
      "li",
      "p"
    ],
    "ids": [
      "ol",
      "li",
      "p"
    ],
    "its": [
      "ol",
      "li",
      "p"
    ],
    "sessions": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "span",
      "span",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "p",
      "ul",
      "li"
    ],
    "which": [
      "ol",
      "li",
      "p"
    ],
    "minimizes": [
      "ol",
      "li",
      "p"
    ],
    "risk": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "another": [
      "ol",
      "li",
      "p"
    ],
    "same": [
      "ol",
      "li",
      "p"
    ],
    "id": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "span"
    ],
    "in": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "span",
      "span",
      "li",
      "p",
      "span",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "invoke": [
      "ol",
      "li",
      "p"
    ],
    "httpservletrequestgetsession:": [
      "ol",
      "li",
      "p"
    ],
    "httpsession": [
      "ol",
      "li",
      "pre",
      "p",
      "pre",
      "pre",
      "ul",
      "li",
      "a"
    ],
    "=": [
      "ol",
      "ol",
      "li",
      "pre",
      "li",
      "p",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "requestgetsession();": [
      "ol",
      "li",
      "pre"
    ],
    "invalidate": [
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "p",
      "p"
    ],
    "identifier": [
      "ol",
      "li",
      "strong"
    ],
    "on": [
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "p",
      "span",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "login": [
      "ol",
      "li",
      "strong"
    ],
    "well": [
      "ol",
      "li",
      "strong"
    ],
    "logout": [
      "ol",
      "li",
      "strong",
      "p",
      "pre",
      "p",
      "pre"
    ],
    "ensure": [
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "p",
      "strong"
    ],
    "reused": [
      "ol",
      "li",
      "strong"
    ],
    "is": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "span",
      "span",
      "span",
      "span",
      "pre"
    ],
    "portion": [
      "ol",
      "li"
    ],
    "approach": [
      "ol",
      "li"
    ],
    "necessary": [
      "ol",
      "li"
    ],
    "httpsessioninvalidate": [
      "ol",
      "ol",
      "li",
      "em",
      "li",
      "p",
      "em"
    ],
    "accomplish": [
      "ol",
      "ol",
      "li",
      "li",
      "p"
    ],
    "after": [
      "ol",
      "li"
    ],
    "has": [
      "ol",
      "li"
    ],
    "been": [
      "ol",
      "li"
    ],
    "invalidated": [
      "ol",
      "li",
      "pre"
    ],
    "call": [
      "ol",
      "li"
    ],
    "below": [
      "ol",
      "li"
    ],
    "will": [
      "ol",
      "li"
    ],
    "generate": [
      "ol",
      "li"
    ],
    "new": [
      "ol",
      "li"
    ],
    "identifierhttpsession": [
      "ol",
      "li"
    ],
    "requestgetsession(true);": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "time-out": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "set": [
      "ol",
      "ol",
      "li",
      "p",
      "span",
      "li",
      "p",
      "span"
    ],
    "expiration": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "time": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "for": [
      "ol",
      "ol",
      "li",
      "p",
      "span",
      "li",
      "p",
      "span",
      "p",
      "p",
      "pre",
      "p",
      "pre",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li"
    ],
    "helps": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "minimize": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "threat": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "giving": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "smaller": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "window": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "opportunity": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "depending": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "appropriate": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "timeout": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "be": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "span",
      "span",
      "li",
      "p",
      "span",
      "p"
    ],
    "anywhere": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "minutes": [
      "ol",
      "li",
      "p",
      "span",
      "p"
    ],
    "setting": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "should": [
      "ol",
      "li",
      "p",
      "span",
      "p",
      "pre"
    ],
    "expire": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "done": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "through": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "httpsessionsetmaxinactiveinterval": [
      "ol",
      "li",
      "p",
      "span",
      "em"
    ],
    "code": [
      "ol",
      "li",
      "p",
      "span",
      "p",
      "p",
      "p",
      "p"
    ],
    "via": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "session-timeout": [
      "ol",
      "li",
      "p",
      "span",
      "em"
    ],
    "configuration": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "webxml": [
      "ol",
      "ol",
      "li",
      "p",
      "span",
      "li",
      "p",
      "span"
    ],
    "file": [
      "ol",
      "ol",
      "li",
      "p",
      "span",
      "li",
      "p",
      "span"
    ],
    "terminate": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "allowing": [
      "ol",
      "li",
      "p"
    ],
    "reduces": [
      "ol",
      "li",
      "p"
    ],
    "being": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "span"
    ],
    "hijacked": [
      "ol",
      "li",
      "p"
    ],
    "sent": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "span"
    ],
    "over": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "span",
      "span"
    ],
    "encrypted": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "channels": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "span"
    ],
    "mark": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "tls": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "span",
      "span",
      "span"
    ],
    "cookiesetsecure": [
      "ol",
      "li",
      "p",
      "span",
      "em"
    ],
    "require": [
      "ol",
      "li",
      "p",
      "span",
      "p"
    ],
    "sending": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "span",
      "span"
    ],
    "out": [
      "ol",
      "li",
      "p",
      "span",
      "pre"
    ],
    "given": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "it": [
      "ol",
      "li",
      "p",
      "span",
      "ul",
      "li"
    ],
    "recommended": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "avoid": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "unencrypted": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "made": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "much": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "easier": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "servletrequestissecure": [
      "ol",
      "li",
      "p",
      "span",
      "em"
    ],
    "verify": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "whether": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "there": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "cookie-secure": [
      "ol",
      "li",
      "p",
      "span",
      "em"
    ],
    "attribute": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "that": [
      "ol",
      "li",
      "p",
      "span",
      "p",
      "p"
    ],
    "sessiond": [
      "ol",
      "li",
      "p",
      "span"
    ],
    "httpservletrequestgetsession": [
      "em"
    ],
    "note": [
      "p",
      "strong"
    ],
    "pci": [
      "p"
    ],
    "dss": [
      "p"
    ],
    "requirements": [
      "p"
    ],
    "idle": [
      "p"
    ],
    "locked": [
      "p"
    ],
    "password": [
      "p"
    ],
    "unlock": [
      "p"
    ],
    "problem": [
      "h1"
    ],
    "example": [
      "h1",
      "h1"
    ],
    "shows": [
      "p",
      "p"
    ],
    "function": [
      "p",
      "p"
    ],
    "loginmodule": [
      "p",
      "em",
      "p",
      "em"
    ],
    "relying": [
      "p",
      "p"
    ],
    "jaas": [
      "p",
      "p"
    ],
    "authentication": [
      "p",
      "p",
      "p",
      "p"
    ],
    "removes": [
      "p",
      "p"
    ],
    "all": [
      "p",
      "p"
    ],
    "tokens": [
      "p",
      "p"
    ],
    "current": [
      "p",
      "p"
    ],
    "but": [
      "p"
    ],
    "fails": [
      "p"
    ],
    "public": [
      "pre",
      "pre"
    ],
    "boolean": [
      "pre",
      "pre"
    ],
    "logout)": [
      "pre",
      "pre"
    ],
    "throws": [
      "pre",
      "pre"
    ],
    "loginexception{": [
      "pre",
      "pre"
    ],
    "subjectgetprincipals().remove(usertoken);": [
      "pre",
      "pre"
    ],
    "clearcredentials);": [
      "pre",
      "pre"
    ],
    "usertoken": [
      "pre",
      "pre"
    ],
    "null": [
      "pre",
      "pre"
    ],
    "//": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "have": [
      "pre"
    ],
    "here": [
      "pre"
    ],
    "log": [
      "pre",
      "pre"
    ],
    "event": [
      "pre",
      "pre"
    ],
    "consult": [
      "pre",
      "pre"
    ],
    "logging": [
      "pre",
      "pre",
      "pre"
    ],
    "section": [
      "pre",
      "pre"
    ],
    "more": [
      "pre",
      "pre",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li"
    ],
    "details": [
      "pre",
      "pre"
    ],
    "return": [
      "pre",
      "pre"
    ],
    "true}": [
      "pre",
      "pre"
    ],
    "solution": [
      "h1"
    ],
    "invalidates": [
      "p",
      "pre"
    ],
    "commongetcurrentsession();": [
      "pre"
    ],
    "sessioninvalidate();": [
      "pre"
    ],
    "additional": [
      "h1"
    ],
    "resources": [
      "h1"
    ],
    "information": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "http": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "see": [
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li"
    ],
    "documentation": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "interface": [
      "ul",
      "li",
      "a"
    ],
    "sdk": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "class": [
      "ul",
      "li",
      "a"
    ],
    "learn": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "about": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "parameter": [
      "ul",
      "ul",
      "li",
      "li",
      "a"
    ],
    "manipulation": [
      "ul",
      "ul",
      "li",
      "li",
      "a"
    ],
    "ways": [
      "ul",
      "li"
    ],
    "prediction": [
      "ul",
      "ul",
      "li",
      "li",
      "a"
    ],
    "attacks": [
      "ul",
      "li"
    ],
    "credential": [
      "ul",
      "li",
      "a"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "What to Do",
      "Why",
      "When",
      "How",
      "Problem Example",
      "Solution Example",
      "Additional Resources"
    ],
    "ul": [
      "Applications written using Servlets or JSP.",
      "For more information on HTTP sessions, see: Documentation for Interface HttpSession in Java SDK. \n    For more information on HTTP cookies, see: Documentation for Class Cookie in Java SDK. \n    To learn more about parameter manipulation and ways to prevent it, see: Parameter Manipulation. \n    To learn more about session prediction attacks, see: Credential and Session Prediction."
    ],
    "li": [
      "Applications written using Servlets or JSP.",
      "Do not allow users to choose their own session identifiers. Java automatically assigns random IDs to its sessions which minimizes the risk of an attacker hijacking another user's session by using the same session ID. To use sessions in Java, invoke HttpServletRequest.getSession:\n      HttpSession session = request.getSession();",
      "Invalidate the session identifier on login (as well as logout) to ensure session identifiers are not reused. This is a portion of the approach necessary to prevent session hijacking. Use HttpSession.invalidate to accomplish this. After the session has been invalidated, the call below will generate a new session identifier.HttpSession session = request.getSession(true);",
      "Time-out sessions. \n      Set an expiration time for sessions. This helps minimize the threat of session hijacking by giving an attacker a smaller window of opportunity. Depending on your application, an appropriate timeout can be anywhere from 10 to 20 minutes. Setting when sessions should expire can be done through HttpSession.setMaxInactiveInterval in code, or via the session-timeout configuration in the web.xml file.",
      "Allow users to terminate their sessions. Allowing users to invalidate their sessions reduces the risk of session being hijacked. Use HttpSession.invalidate to accomplish this.",
      "Ensure cookies are sent over encrypted channels. \n      Mark cookies sent over TLS as Secure. Use Cookie.setSecure to require TLS when sending out the given cookie. It is recommended to avoid sending session cookies over unencrypted channels as session hijacking is made much easier. Use ServletRequest.isSecure to verify whether TLS is being used. There is a cookie-secure attribute that can be set for the sessiond id cookie in the web.xml file.",
      "For more information on HTTP sessions, see: Documentation for Interface HttpSession in Java SDK.",
      "For more information on HTTP cookies, see: Documentation for Class Cookie in Java SDK.",
      "To learn more about parameter manipulation and ways to prevent it, see: Parameter Manipulation.",
      "To learn more about session prediction attacks, see: Credential and Session Prediction."
    ],
    "p": [
      "Protect the confidentiality of session cookies.",
      "Session cookies are used by an application to identify the session associated with a particular user. Protecting session cookies can help prevent an attacker from hijacking the session and using the application as a legitimate user.",
      "If your application uses cookies to maintain a user's session state, then use this guideline to protect the cookie.",
      "Use the following steps to secure session cookies:",
      "Do not allow users to choose their own session identifiers. Java automatically assigns random IDs to its sessions which minimizes the risk of an attacker hijacking another user's session by using the same session ID. To use sessions in Java, invoke HttpServletRequest.getSession:",
      "HttpSession session = request.getSession(true);",
      "Time-out sessions. \n      Set an expiration time for sessions. This helps minimize the threat of session hijacking by giving an attacker a smaller window of opportunity. Depending on your application, an appropriate timeout can be anywhere from 10 to 20 minutes. Setting when sessions should expire can be done through HttpSession.setMaxInactiveInterval in code, or via the session-timeout configuration in the web.xml file.",
      "",
      "Allow users to terminate their sessions. Allowing users to invalidate their sessions reduces the risk of session being hijacked. Use HttpSession.invalidate to accomplish this.",
      "Ensure cookies are sent over encrypted channels. \n      Mark cookies sent over TLS as Secure. Use Cookie.setSecure to require TLS when sending out the given cookie. It is recommended to avoid sending session cookies over unencrypted channels as session hijacking is made much easier. Use ServletRequest.isSecure to verify whether TLS is being used. There is a cookie-secure attribute that can be set for the sessiond id cookie in the web.xml file.",
      "",
      "Note: PCI DSS requirements state that sessions that are idle for 15 minutes should be locked automatically and require the user's password to unlock.",
      "The following code shows the logout function of the LoginModule used when relying on JAAS for authentication. The code removes all authentication tokens associated with the current session but fails to invalidate the session.",
      "The following code shows the logout function of the LoginModule used when relying on JAAS for authentication. The code removes all authentication tokens associated with the current session and invalidates the session."
    ],
    "ol": [
      "Do not allow users to choose their own session identifiers. Java automatically assigns random IDs to its sessions which minimizes the risk of an attacker hijacking another user's session by using the same session ID. To use sessions in Java, invoke HttpServletRequest.getSession:\n      HttpSession session = request.getSession();\n    \n    \n      Invalidate the session identifier on login (as well as logout) to ensure session identifiers are not reused. This is a portion of the approach necessary to prevent session hijacking. Use HttpSession.invalidate to accomplish this. After the session has been invalidated, the call below will generate a new session identifier.HttpSession session = request.getSession(true);\n    \n      \n      Time-out sessions. \n      Set an expiration time for sessions. This helps minimize the threat of session hijacking by giving an attacker a smaller window of opportunity. Depending on your application, an appropriate timeout can be anywhere from 10 to 20 minutes. Setting when sessions should expire can be done through HttpSession.setMaxInactiveInterval in code, or via the session-timeout configuration in the web.xml file.\n    \n    \n      \n        Allow users to terminate their sessions. Allowing users to invalidate their sessions reduces the risk of session being hijacked. Use HttpSession.invalidate to accomplish this.\n    \n    \n      \n      Ensure cookies are sent over encrypted channels. \n      Mark cookies sent over TLS as Secure. Use Cookie.setSecure to require TLS when sending out the given cookie. It is recommended to avoid sending session cookies over unencrypted channels as session hijacking is made much easier. Use ServletRequest.isSecure to verify whether TLS is being used. There is a cookie-secure attribute that can be set for the sessiond id cookie in the web.xml file."
    ],
    "strong": [
      "Do not allow users to choose their own session identifiers.",
      "Invalidate the session identifier on login (as well as logout) to ensure session identifiers are not reused.",
      "Time-out sessions.",
      "Allow users to terminate their sessions.",
      "Ensure cookies are sent over encrypted channels.",
      "Note:"
    ],
    "em": [
      "HttpServletRequest.getSession",
      "HttpSession.invalidate",
      "HttpSession.setMaxInactiveInterval",
      "session-timeout",
      "HttpSession.invalidate",
      "Secure",
      "Cookie.setSecure",
      "ServletRequest.isSecure",
      "cookie-secure",
      "LoginModule",
      "LoginModule"
    ],
    "pre": [
      "HttpSession session = request.getSession();",
      "HttpSession session = request.getSession(true);",
      "public boolean logout() throws LoginException{      subject.getPrincipals().remove(userToken);      clearCredentials();      userToken = null;      // The application should have invalidated the session here.      // Log the logout event. Consult the Logging section for more details      return true;}",
      "public boolean logout() throws LoginException{      subject.getPrincipals().remove(userToken);      clearCredentials();      userToken = null;      // The application invalidates the session when      // the user is logging out      HttpSession session = common.getCurrentSession();      session.invalidate();      // Log the logout event. Consult the Logging section for more details      return true;}"
    ],
    "span": [
      "Set an expiration time for sessions. This helps minimize the threat of session hijacking by giving an attacker a smaller window of opportunity. Depending on your application, an appropriate timeout can be anywhere from 10 to 20 minutes. Setting when sessions should expire can be done through HttpSession.setMaxInactiveInterval in code, or via the session-timeout configuration in the web.xml file.",
      "Mark cookies sent over TLS as Secure. Use Cookie.setSecure to require TLS when sending out the given cookie. It is recommended to avoid sending session cookies over unencrypted channels as session hijacking is made much easier. Use ServletRequest.isSecure to verify whether TLS is being used. There is a cookie-secure attribute that can be set for the sessiond id cookie in the web.xml file."
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "a": [
      "Interface HttpSession",
      "Class Cookie",
      "Parameter Manipulation",
      "Credential and Session Prediction"
    ]
  },
  "links": [
    {
      "href": "http://download.oracle.com/javaee/1.3/api/javax/servlet/http/HttpSession.html",
      "text": "Interface HttpSession"
    },
    {
      "href": "http://download.oracle.com/javaee/1.3/api/javax/servlet/http/Cookie.html",
      "text": "Class Cookie"
    },
    {
      "href": "http://www.cgisecurity.com/owasp/html/ch11s04.html",
      "text": "Parameter Manipulation"
    },
    {
      "href": "http://www.webappsec.org/projects/threat/classes/credential_session_prediction.shtml",
      "text": "Credential and Session Prediction"
    }
  ],
  "html": "<h1>Applies to</h1>\n  <ul>\n    <li>Applications written using Servlets or JSP.</li>\n  </ul>\n  <h1>What to Do</h1>\n  <p>Protect the confidentiality of session cookies.</p>\n  <h1>Why</h1>\n  <p>Session cookies are used by an application to identify the session associated with a particular user. Protecting session cookies can help prevent an attacker from hijacking the session and using the application as a legitimate user.</p>\n  <h1>When</h1>\n  <p>If your application uses cookies to maintain a user's session state, then use this guideline to protect the cookie.</p>\n  <h1>How</h1>\n  <p>Use the following steps to secure session cookies:</p>\n  <ol>\n    <li>\n      <p>\n        <strong>Do not allow users to choose their own session identifiers. </strong>Java automatically assigns random IDs to its sessions which minimizes the risk of an attacker hijacking another user's session by using the same session ID. To use sessions in Java, invoke <em>HttpServletRequest.getSession</em>:</p>\n      <pre>HttpSession session = request.getSession();</pre>\n    </li>\n    <li>\n      <strong>Invalidate the session identifier on login (as well as logout) to ensure session identifiers are not reused.</strong> This is a portion of the approach necessary to prevent session hijacking. Use <em>HttpSession.invalidate</em> to accomplish this. After the session has been invalidated, the call below will generate a new session identifier.<p /><pre>HttpSession session = request.getSession(true);</pre></li>\n    <li>\n      <p />\n      <strong>Time-out sessions. </strong>\n      <span>Set an expiration time for sessions. This helps minimize the threat of session hijacking by giving an attacker a smaller window of opportunity. Depending on your application, an appropriate timeout can be anywhere from 10 to 20 minutes. Setting when sessions should expire can be done through <em>HttpSession.setMaxInactiveInterval</em> in code, or via the <em>session-timeout</em> configuration in the web.xml file.<p /></span>\n    </li>\n    <li>\n      <p>\n        <strong>Allow users to terminate their sessions. </strong>Allowing users to invalidate their sessions reduces the risk of session being hijacked. Use <em>HttpSession.invalidate</em> to accomplish this.</p>\n    </li>\n    <li>\n      <p />\n      <strong>Ensure cookies are sent over encrypted channels. </strong>\n      <span>Mark cookies sent over TLS as <em>Secure</em>. Use <em>Cookie.setSecure</em> to require TLS when sending out the given cookie. It is recommended to avoid sending session cookies over unencrypted channels as session hijacking is made much easier. Use <em>ServletRequest.isSecure</em> to verify whether TLS is being used. There is a <em>cookie-secure</em> attribute that can be set for the sessiond id cookie in the web.xml file.<p /></span>\n    </li>\n  </ol>\n  <p>\n    <strong>Note:</strong> PCI DSS requirements state that sessions that are idle for 15 minutes should be locked automatically and require the user's password to unlock.</p>\n  <h1>Problem Example</h1>\n  <p>The following code shows the logout function of the <em>LoginModule</em> used when relying on JAAS for authentication. The code removes all authentication tokens associated with the current session but fails to invalidate the session. </p>\n  <pre>public boolean logout() throws LoginException{<br />      subject.getPrincipals().remove(userToken);<br /><br />      clearCredentials();<br />      userToken = null;<br /><br />      // The application should have invalidated the session here.<br /><br />      // Log the logout event. Consult the Logging section for more details<br /><br />      return true;<br />}</pre>\n  <h1>Solution Example</h1>\n  <p>The following code shows the logout function of the <em>LoginModule</em> used when relying on JAAS for authentication. The code removes all authentication tokens associated with the current session and invalidates the session.</p>\n  <pre>public boolean logout() throws LoginException{<br />      subject.getPrincipals().remove(userToken);<br /><br />      clearCredentials();<br />      userToken = null;<br /><br />      // The application invalidates the session when<br />      // the user is logging out<br />      HttpSession session = common.getCurrentSession();<br />      session.invalidate();<br /><br />      // Log the logout event. Consult the Logging section for more details<br /><br />      return true;<br />}</pre>\n  <h1>Additional Resources</h1>\n  <ul>\n    <li>For more information on HTTP sessions, see: Documentation for <a href=\"http://download.oracle.com/javaee/1.3/api/javax/servlet/http/HttpSession.html\">Interface HttpSession</a> in Java SDK. </li>\n    <li>For more information on HTTP cookies, see: Documentation for <a href=\"http://download.oracle.com/javaee/1.3/api/javax/servlet/http/Cookie.html\">Class Cookie</a> in Java SDK. </li>\n    <li>To learn more about parameter manipulation and ways to prevent it, see: <a href=\"http://www.cgisecurity.com/owasp/html/ch11s04.html\">Parameter Manipulation</a>. </li>\n    <li>To learn more about session prediction attacks, see: <a href=\"http://www.webappsec.org/projects/threat/classes/credential_session_prediction.shtml\">Credential and Session Prediction</a>.</li>\n  </ul>"
}