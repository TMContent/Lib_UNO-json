{
  "id": "004526a6-5b2f-4094-94fa-a80d818c0a41",
  "checksum": "4838fb895f405401d92c05f0b0875f7e9e406963",
  "words": {
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "li",
      "p",
      "title"
    ],
    "c++": [
      "ul",
      "li",
      "ol",
      "li",
      "p"
    ],
    "what": [
      "h1"
    ],
    "do": [
      "h1"
    ],
    "canonicalize": [
      "p",
      "p",
      "p",
      "title"
    ],
    "all": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "strong",
      "title"
    ],
    "input": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "title"
    ],
    "used": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "strong",
      "title"
    ],
    "identify": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "strong",
      "title"
    ],
    "resources": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "h1",
      "title"
    ],
    "such": [
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "p"
    ],
    "as": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "p"
    ],
    "filenames": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "paths": [
      "p"
    ],
    "named": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "pipes": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "etc": [
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "why": [
      "h1"
    ],
    "there": [
      "p",
      "p",
      "p"
    ],
    "are": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "often": [
      "p",
      "p"
    ],
    "many": [
      "p",
      "p",
      "p"
    ],
    "ways": [
      "p",
      "p"
    ],
    "address": [
      "p"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p"
    ],
    "same": [
      "p",
      "p",
      "p",
      "p"
    ],
    "resource": [
      "p"
    ],
    "by": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "li",
      "p"
    ],
    "name": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "an": [
      "p"
    ],
    "attacker": [
      "p"
    ],
    "may": [
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "try": [
      "p"
    ],
    "bypass": [
      "p"
    ],
    "validation": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "routines": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "perform": [
      "p",
      "p"
    ],
    "unauthorized": [
      "p"
    ],
    "access": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "strong"
    ],
    "supplying": [
      "p"
    ],
    "obfuscated": [
      "p"
    ],
    "canonicalization": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "ul",
      "li"
    ],
    "defeats": [
      "p"
    ],
    "obfuscation": [
      "p"
    ],
    "and": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "li",
      "li",
      "p",
      "p"
    ],
    "helps": [
      "p"
    ],
    "validate": [
      "p"
    ],
    "data": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "attempts": [
      "p"
    ],
    "when": [
      "h1"
    ],
    "before": [
      "p"
    ],
    "using": [
      "p"
    ],
    "it": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "for": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "p",
      "li",
      "p",
      "ul",
      "li"
    ],
    "how": [
      "h1"
    ],
    "means": [
      "p"
    ],
    "reducing": [
      "p"
    ],
    "simplest": [
      "p"
    ],
    "form": [
      "p"
    ],
    "one": [
      "p"
    ],
    "example": [
      "p"
    ],
    "is": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p"
    ],
    "addressing": [
      "p"
    ],
    "files": [
      "p",
      "ol",
      "li",
      "p",
      "strong"
    ],
    "-": [
      "p"
    ],
    "file": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p"
    ],
    "on": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "strong",
      "li",
      "p",
      "strong",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong"
    ],
    "a": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "li",
      "p"
    ],
    "windows": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong"
    ],
    "system": [
      "p"
    ],
    "be": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "addressed": [
      "p"
    ],
    "c\\file,": [
      "p"
    ],
    "c\\\\file,": [
      "p"
    ],
    ".\\file,": [
      "p"
    ],
    ".\\..\\..\\file,": [
      "p"
    ],
    "particularly": [
      "p"
    ],
    "important": [
      "p"
    ],
    "systems": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "strong",
      "li",
      "p",
      "strong",
      "li",
      "p"
    ],
    "that": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p"
    ],
    "use": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "p",
      "strong",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p"
    ],
    "unicode": [
      "p",
      "p"
    ],
    "because": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "different": [
      "p"
    ],
    "strings": [
      "p"
    ],
    "have": [
      "p"
    ],
    "meaning": [
      "p"
    ],
    "os": [
      "p"
    ],
    "following": [
      "p"
    ],
    "actions": [
      "p"
    ],
    "functions": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "p"
    ],
    "or": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "p"
    ],
    "folders": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "unix-type": [
      "ol",
      "li",
      "p"
    ],
    "devices": [
      "ol",
      "li",
      "p"
    ],
    "other": [
      "ol",
      "li",
      "p"
    ],
    "accessed": [
      "ol",
      "li",
      "p"
    ],
    "add": [
      "ol",
      "li",
      "p"
    ],
    "code": [
      "ol",
      "li",
      "p"
    ],
    "canonicalizes": [
      "ol",
      "li",
      "p"
    ],
    "validates": [
      "ol",
      "li",
      "p"
    ],
    "this": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "recommended": [
      "ol",
      "li",
      "p"
    ],
    "create": [
      "ol",
      "li",
      "p"
    ],
    "separate": [
      "ol",
      "li",
      "p"
    ],
    "class": [
      "ol",
      "li",
      "p"
    ],
    "library": [
      "ol",
      "li",
      "p"
    ],
    "include": [
      "ol",
      "li",
      "p"
    ],
    "canonicalizing": [
      "ol",
      "li",
      "p"
    ],
    "in": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "realpath)": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "posix": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "standard": [
      "ol",
      "li",
      "p"
    ],
    "includes": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "function": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p"
    ],
    "which": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "suitable": [
      "ol",
      "li",
      "p"
    ],
    "canonicalize_file_name)": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong"
    ],
    "gilbc": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "glibc": [
      "ol",
      "li",
      "p"
    ],
    "works": [
      "ol",
      "li",
      "p"
    ],
    "lot": [
      "ol",
      "li",
      "p"
    ],
    "like": [
      "ol",
      "li",
      "p"
    ],
    "realpath),": [
      "ol",
      "li",
      "p"
    ],
    "but": [
      "ol",
      "li",
      "p"
    ],
    "automatically": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "allocated": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "new": [
      "ol",
      "li",
      "p"
    ],
    "buffer": [
      "ol",
      "li",
      "p"
    ],
    "its": [
      "ol",
      "li",
      "p"
    ],
    "output": [
      "ol",
      "li",
      "p"
    ],
    "free": [
      "ol",
      "li",
      "p"
    ],
    "memory": [
      "ol",
      "li",
      "p"
    ],
    "after": [
      "ol",
      "li",
      "p"
    ],
    "not": [
      "ol",
      "li",
      "p"
    ],
    "done": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "don't": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "rely": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "getfullpathname)": [
      "ol",
      "li",
      "p"
    ],
    "however": [
      "ol",
      "li",
      "p"
    ],
    "very": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "limited": [
      "ol",
      "li",
      "p"
    ],
    "provides": [
      "ol",
      "li",
      "p"
    ],
    "low": [
      "ol",
      "li",
      "p"
    ],
    "degree": [
      "ol",
      "li",
      "p"
    ],
    "of": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p"
    ],
    "assurance": [
      "ol",
      "li",
      "p"
    ],
    "acls": [
      "ol",
      "li",
      "p"
    ],
    "implement": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "filesystem": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "security": [
      "ol",
      "li",
      "p"
    ],
    "avoid": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "making": [
      "ol",
      "li",
      "p"
    ],
    "decisions": [
      "ol",
      "li",
      "p"
    ],
    "based": [
      "ol",
      "li",
      "p"
    ],
    "folder": [
      "ol",
      "li",
      "p"
    ],
    "names": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "time-of-check-to-time-of-use": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "vulnerabilities": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "most": [
      "ol",
      "li",
      "p"
    ],
    "unix": [
      "ol",
      "li",
      "p"
    ],
    "versions": [
      "ol",
      "li",
      "p"
    ],
    "common": [
      "ol",
      "li",
      "p"
    ],
    "calls": [
      "ol",
      "li",
      "p"
    ],
    "handles": [
      "ol",
      "li",
      "p"
    ],
    "instead": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "openat": [
      "ol",
      "li",
      "p"
    ],
    "statat": [
      "ol",
      "li",
      "p"
    ],
    "accessat": [
      "ol",
      "li",
      "p"
    ],
    "these": [
      "ol",
      "li",
      "p"
    ],
    "ones": [
      "ol",
      "li",
      "p"
    ],
    "toctou": [
      "ol",
      "li",
      "p"
    ],
    "additional": [
      "h1"
    ],
    "more": [
      "ul",
      "li"
    ],
    "information": [
      "ul",
      "li"
    ],
    "about": [
      "ul",
      "li"
    ],
    "please": [
      "ul",
      "li"
    ],
    "see": [
      "ul",
      "li"
    ],
    "https//www.securecoding.cert.org/confluence/display/cplusplus/fio02-cpp.+canonicalize+path+names+originating+from+untrusted+sources": [
      "ul",
      "li",
      "a"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "What to Do",
      "Why",
      "When",
      "How",
      "Additional Resources"
    ],
    "ul": [
      "C++",
      "For more information about canonicalization, please see https://www.securecoding.cert.org/confluence/display/cplusplus/FIO02-CPP.+Canonicalize+path+names+originating+from+untrusted+sources"
    ],
    "li": [
      "C++",
      "Identify all functions used to access resources, such as files or folders, by name. On UNIX-type systems, named pipes and devices are other resources that may be accessed by name. Add code that canonicalizes and validates this input. It is recommended to create a separate class or library for data validation routines and include functions for canonicalizing input in it.",
      "Use realpath() on POSIX systems. The POSIX C++ standard includes a realpath() function, which is suitable for canonicalization.",
      "Use canonicalize_file_name() on gilbc systems. Glibc includes a canonicalize_file_name() function, which works a lot like realpath(), but automatically allocated a new buffer for its output. Free the memory allocated by canonicalize_file_name() after canonicalization, because that is not done automatically.",
      "Don't rely on canonicalization in Windows. Canonicalization in Windows is done by the GetFullPathName() function, however this function is very limited and provides a very low degree of assurance. Use ACLs on Windows to implement filesystem security and avoid making decisions based on file or folder names.",
      "Avoid time-of-check-to-time-of-use vulnerabilities. Most Unix systems implement versions of common filesystem calls that use file handles instead of file names, such as openat, statat, accessat, etc. Use these functions instead of the ones that use filenames to avoid TOCTOU vulnerabilities.",
      "For more information about canonicalization, please see https://www.securecoding.cert.org/confluence/display/cplusplus/FIO02-CPP.+Canonicalize+path+names+originating+from+untrusted+sources"
    ],
    "p": [
      "Canonicalize all input used to identify resources, such as filenames, paths, named pipes, etc.",
      "There are often many ways to address the same resource by name. An attacker may try to bypass validation routines to perform unauthorized access by supplying obfuscated input. Canonicalization defeats obfuscation and helps validate data access attempts.",
      "Canonicalize all input used to identify resources before using it for access.",
      "Canonicalization means reducing to the simplest form. There are often many ways to access the same resources by name. One example is addressing files - the same file on a Windows system may be addressed as file, C:\\file, C:\\\\file, ..\\file, ..\\..\\..\\file, etc. Canonicalization is particularly important for systems that use unicode, because there are many different unicode strings that have the same meaning to the OS.",
      "Perform the following actions to canonicalize all input used to identify resources:",
      "Identify all functions used to access resources, such as files or folders, by name. On UNIX-type systems, named pipes and devices are other resources that may be accessed by name. Add code that canonicalizes and validates this input. It is recommended to create a separate class or library for data validation routines and include functions for canonicalizing input in it.",
      "Use realpath() on POSIX systems. The POSIX C++ standard includes a realpath() function, which is suitable for canonicalization.",
      "Use canonicalize_file_name() on gilbc systems. Glibc includes a canonicalize_file_name() function, which works a lot like realpath(), but automatically allocated a new buffer for its output. Free the memory allocated by canonicalize_file_name() after canonicalization, because that is not done automatically.",
      "Don't rely on canonicalization in Windows. Canonicalization in Windows is done by the GetFullPathName() function, however this function is very limited and provides a very low degree of assurance. Use ACLs on Windows to implement filesystem security and avoid making decisions based on file or folder names.",
      "Avoid time-of-check-to-time-of-use vulnerabilities. Most Unix systems implement versions of common filesystem calls that use file handles instead of file names, such as openat, statat, accessat, etc. Use these functions instead of the ones that use filenames to avoid TOCTOU vulnerabilities."
    ],
    "ol": [
      "Identify all functions used to access resources, such as files or folders, by name. On UNIX-type systems, named pipes and devices are other resources that may be accessed by name. Add code that canonicalizes and validates this input. It is recommended to create a separate class or library for data validation routines and include functions for canonicalizing input in it. \r\n      \r\n        \r\n          Use realpath() on POSIX systems. The POSIX C++ standard includes a realpath() function, which is suitable for canonicalization.\r\n        \r\n          \r\n            Use canonicalize_file_name() on gilbc systems. Glibc includes a canonicalize_file_name() function, which works a lot like realpath(), but automatically allocated a new buffer for its output. Free the memory allocated by canonicalize_file_name() after canonicalization, because that is not done automatically.\r\n          \r\n            \r\n              Don't rely on canonicalization in Windows. Canonicalization in Windows is done by the GetFullPathName() function, however this function is very limited and provides a very low degree of assurance. Use ACLs on Windows to implement filesystem security and avoid making decisions based on file or folder names.\r\n            \r\n              \r\n                Avoid time-of-check-to-time-of-use vulnerabilities. Most Unix systems implement versions of common filesystem calls that use file handles instead of file names, such as openat, statat, accessat, etc. Use these functions instead of the ones that use filenames to avoid TOCTOU vulnerabilities."
    ],
    "strong": [
      "Identify all functions used to access resources, such as files or folders, by name.",
      "Use realpath() on POSIX systems.",
      "Use canonicalize_file_name() on gilbc systems.",
      "Don't rely on canonicalization in Windows.",
      "Avoid time-of-check-to-time-of-use vulnerabilities."
    ],
    "a": [
      "https://www.securecoding.cert.org/confluence/display/cplusplus/FIO02-CPP.+Canonicalize+path+names+originating+from+untrusted+sources"
    ]
  },
  "links": [
    {
      "href": "https://www.securecoding.cert.org/confluence/display/cplusplus/FIO02-CPP.+Canonicalize+path+names+originating+from+untrusted+sources",
      "text": "https://www.securecoding.cert.org/confluence/display/cplusplus/FIO02-CPP.+Canonicalize+path+names+originating+from+untrusted+sources"
    }
  ],
  "html": "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>C&#43;&#43;</li>\r\n  </ul>\r\n  <h1>What to Do</h1>\r\n  <p>Canonicalize all input used to identify resources, such as filenames, paths, named pipes, etc.</p>\r\n  <h1>Why</h1>\r\n  <p>There are often many ways to address the same resource by name. An attacker may try to bypass validation routines to perform unauthorized access by supplying obfuscated input. Canonicalization defeats obfuscation and helps validate data access attempts.</p>\r\n  <h1>When</h1>\r\n  <p>Canonicalize all input used to identify resources before using it for access.</p>\r\n  <h1>How</h1>\r\n  <p>Canonicalization means reducing to the simplest form. There are often many ways to access the same resources by name. One example is addressing files - the same file on a Windows system may be addressed as file, C:\\file, C:\\\\file, ..\\file, ..\\..\\..\\file, etc. Canonicalization is particularly important for systems that use unicode, because there are many different unicode strings that have the same meaning to the OS.</p>\r\n  <p>Perform the following actions to canonicalize all input used to identify resources:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Identify all functions used to access resources, such as files or folders, by name.</strong> On UNIX-type systems, named pipes and devices are other resources that may be accessed by name. Add code that canonicalizes and validates this input. It is recommended to create a separate class or library for data validation routines and include functions for canonicalizing input in it. </p>\r\n      <li>\r\n        <p>\r\n          <strong>Use realpath() on POSIX systems.</strong> The POSIX C&#43;&#43; standard includes a realpath() function, which is suitable for canonicalization.</p>\r\n        <li>\r\n          <p>\r\n            <strong>Use canonicalize_file_name() on gilbc systems.</strong> Glibc includes a canonicalize_file_name() function, which works a lot like realpath(), but automatically allocated a new buffer for its output. Free the memory allocated by canonicalize_file_name() after canonicalization, because that is not done automatically.</p>\r\n          <li>\r\n            <p>\r\n              <strong>Don't rely on canonicalization in Windows.</strong> Canonicalization in Windows is done by the GetFullPathName() function, however this function is very limited and provides a very low degree of assurance. Use ACLs on Windows to implement filesystem security and avoid making decisions based on file or folder names.</p>\r\n            <li>\r\n              <p>\r\n                <strong>Avoid time-of-check-to-time-of-use vulnerabilities.</strong> Most Unix systems implement versions of common filesystem calls that use file handles instead of file names, such as openat, statat, accessat, etc. Use these functions instead of the ones that use filenames to avoid TOCTOU vulnerabilities.</p>\r\n            </li>\r\n          </li>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ol>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>For more information about canonicalization, please see <a href=\"https://www.securecoding.cert.org/confluence/display/cplusplus/FIO02-CPP.&#43;Canonicalize&#43;path&#43;names&#43;originating&#43;from&#43;untrusted&#43;sources\">https://www.securecoding.cert.org/confluence/display/cplusplus/FIO02-CPP.&#43;Canonicalize&#43;path&#43;names&#43;originating&#43;from&#43;untrusted&#43;sources</a></li>\r\n  </ul>"
}