{
  "id": "07964c6c-e9ae-4411-865c-c322f8ac2ec9",
  "checksum": "35afcf7dc95287045d9aa90c33a5b71a5a436a8f",
  "words": {
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "h1",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p"
    ],
    "php": [
      "ul",
      "li",
      "ul",
      "li",
      "h1",
      "h1"
    ],
    "what": [
      "h1",
      "ol",
      "li",
      "p"
    ],
    "do": [
      "h1",
      "p",
      "ul",
      "li",
      "a"
    ],
    "not": [
      "p",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "show": [
      "p"
    ],
    "sql": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "error": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "ul",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "h1",
      "ul",
      "li",
      "a",
      "h1",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "messages": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "ul",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "why": [
      "h1"
    ],
    "should": [
      "p"
    ],
    "be": [
      "p"
    ],
    "displayed": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "prevent": [
      "p",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "disclosing": [
      "p"
    ],
    "information": [
      "p",
      "ul",
      "li"
    ],
    "about": [
      "p",
      "ul",
      "li"
    ],
    "the": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "strong",
      "li",
      "p",
      "li",
      "p"
    ],
    "database": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "li",
      "p",
      "p",
      "ul",
      "li"
    ],
    "potential": [
      "p"
    ],
    "attackers": [
      "p"
    ],
    "how": [
      "h1"
    ],
    "displaying": [
      "p"
    ],
    "identify": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "strong"
    ],
    "extraction": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "layers)": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "used": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a"
    ],
    "by": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "application": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "p"
    ],
    "review": [
      "ol",
      "li",
      "p"
    ],
    "engines)": [
      "ol",
      "li",
      "p"
    ],
    "and": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "ul",
      "li",
      "p"
    ],
    "abstraction": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "are": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "strong",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "whether": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "search": [
      "ol",
      "li",
      "p"
    ],
    "code": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "for": [
      "ol",
      "li",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "calls": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "functions": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "that": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong"
    ],
    "may": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "li",
      "p"
    ],
    "disclose": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "p"
    ],
    "errors": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "examine": [
      "ol",
      "li",
      "p"
    ],
    "such": [
      "ol",
      "li",
      "p"
    ],
    "see": [
      "ol",
      "li",
      "p",
      "ul",
      "li"
    ],
    "if": [
      "ol",
      "li",
      "p"
    ],
    "it": [
      "ol",
      "li",
      "p"
    ],
    "result": [
      "ol",
      "li",
      "p"
    ],
    "in": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "ul",
      "li",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "being": [
      "ol",
      "li",
      "p"
    ],
    "a": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "ul",
      "li",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "list": [
      "ol",
      "li",
      "p"
    ],
    "of": [
      "ol",
      "li",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "common": [
      "ol",
      "li",
      "p"
    ],
    "engines": [
      "ol",
      "li",
      "p"
    ],
    "layers": [
      "ol",
      "li",
      "p"
    ],
    "corresponding": [
      "ol",
      "li",
      "p"
    ],
    "is": [
      "ol",
      "li",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a"
    ],
    "below": [
      "ol",
      "li",
      "p"
    ],
    "dba": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "strong"
    ],
    "uses": [
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "php's": [
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "built": [
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "handler": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "pdo": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "strong"
    ],
    "throws": [
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "pdoexception": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "odbc": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "strong"
    ],
    "odbc_error)": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "odbc_errormsg)": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "postgres": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "strong"
    ],
    "pg_last_error),": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "pg_result_error_field),": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "pg_result_error)": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "sqlite3": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "strong"
    ],
    "sqlite3:lasterrorcode,": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "sqlite3:lasterrormsg": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "sqlite": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "strong"
    ],
    "sqlite_error_string),": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "sqlite_last_error)": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "sqlsrv": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "strong"
    ],
    "sqlsrv_errors)": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "mssql": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "strong"
    ],
    "mssql_get_last_message)": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "mysqli": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "strong"
    ],
    "mysqli_connect_errno),": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "mysqli_connect_error),": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "mysqli_errno),": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "mysqli_error),": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "$mysqli-connect_errno,": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "$mysqli-connect_error,": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "$myssqli-errno,": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "$mysqli-error": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "mysql": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "strong"
    ],
    "mysql_error),": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "mysql_errno)": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "em"
    ],
    "remove": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong"
    ],
    "displays": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "all": [
      "ol",
      "li",
      "p"
    ],
    "to functions": [
      "ol",
      "li",
      "p"
    ],
    "or": [
      "ol",
      "li",
      "p"
    ],
    "those": [
      "ol",
      "li",
      "p"
    ],
    "additional": [
      "h1"
    ],
    "resources": [
      "h1"
    ],
    "more": [
      "ul",
      "li"
    ],
    "extensions": [
      "ul",
      "li"
    ],
    "please": [
      "ul",
      "li"
    ],
    "http//us.php.net/manual/en/refs.database.php": [
      "ul",
      "li",
      "a"
    ],
    "handling": [
      "h1",
      "ul",
      "li",
      "a",
      "h1",
      "ul",
      "li",
      "a"
    ],
    "guidelines": [
      "h1"
    ],
    "use": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "structured": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "exception": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "global": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "unhandled": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "exceptions": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "include": [
      "ul",
      "li",
      "a"
    ],
    "debugging": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "data": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "output": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "disclosure": [
      "ul",
      "li",
      "a",
      "title"
    ],
    "display": [
      "ul",
      "li",
      "a"
    ],
    "simple": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "checklists": [
      "h1"
    ],
    "included": [
      "ul",
      "li",
      "a"
    ],
    "disclosed": [
      "ul",
      "li",
      "a"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "What to Do",
      "Why",
      "How",
      "Additional Resources",
      "PHP Error Handling Guidelines",
      "PHP Error Handling Checklists"
    ],
    "ul": [
      "PHP",
      "DBA: uses php's built in error handler. \r\n            \r\n              \r\n                PDO: throws a PDOException\r\n              \r\n                \r\n                  odbc:\r\n                  odbc_error() and odbc_errormsg()\r\n                \r\n                  \r\n                    Postgres:\r\n                    pg_last_error(), pg_result_error_field(), pg_result_error()\r\n                  \r\n                  \r\n                    \r\n                      SQLite3:\r\n                      SQLite3::lastErrorCode, SQLite3::lastErrorMsg\r\n                    \r\n                    \r\n                      \r\n                        SQLite:\r\n                        sqlite_error_string(), sqlite_last_error()\r\n                      \r\n                      \r\n                        \r\n                          SQLSRV:\r\n                          sqlsrv_errors()\r\n                        \r\n                        \r\n                          \r\n                            mssql:\r\n                            mssql_get_last_message()\r\n                          \r\n                          \r\n                            \r\n                              mysqli:\r\n                              mysqli_connect_errno(), mysqli_connect_error(), mysqli_errno(), mysqli_error(), $mysqli->connect_errno, $mysqli->connect_error, $myssqli->errno, $mysqli->error\r\n                            \r\n                            \r\n                              \r\n                                mysql:\r\n                                 mysql_error(), mysql_errno()",
      "For more information about PHP database extensions, please see  http://us.php.net/manual/en/refs.database.php",
      "Use Structured Exception Handling\r\n    \r\n    \r\n      Use a Global Exception Handler for Unhandled Exceptions\r\n    \r\n    \r\n      Do Not Include Debugging Data in Output\r\n    \r\n    \r\n      Prevent Disclosure of SQL Errors\r\n    \r\n    \r\n      Display Simple Error Messages",
      "Structured Exception Handling Is Used\r\n    \r\n    \r\n      A Global Exception Handler Is Used for Unhandled Exceptions\r\n    \r\n    \r\n      Debugging Data Is Not Included in Output\r\n    \r\n    \r\n      SQL Error Messages Are Not Disclosed\r\n    \r\n    \r\n      Simple Error Messages Are Used"
    ],
    "li": [
      "PHP",
      "Identify the database extraction layer(s) used by the application. Review the application to identify what database engine(s) and abstraction layer(s) are used.",
      "Identify whether SQL error messages are displayed. Search application code for calls to functions that may disclose SQL errors. Examine such code to see if it may result in SQL error messages being displayed. A list of common database engines and database abstraction layers and the corresponding functions that may disclose errors is below:\r\n        \r\n          \r\n            \r\n              DBA: uses php's built in error handler. \r\n            \r\n              \r\n                PDO: throws a PDOException\r\n              \r\n                \r\n                  odbc:\r\n                  odbc_error() and odbc_errormsg()\r\n                \r\n                  \r\n                    Postgres:\r\n                    pg_last_error(), pg_result_error_field(), pg_result_error()\r\n                  \r\n                  \r\n                    \r\n                      SQLite3:\r\n                      SQLite3::lastErrorCode, SQLite3::lastErrorMsg\r\n                    \r\n                    \r\n                      \r\n                        SQLite:\r\n                        sqlite_error_string(), sqlite_last_error()\r\n                      \r\n                      \r\n                        \r\n                          SQLSRV:\r\n                          sqlsrv_errors()\r\n                        \r\n                        \r\n                          \r\n                            mssql:\r\n                            mssql_get_last_message()\r\n                          \r\n                          \r\n                            \r\n                              mysqli:\r\n                              mysqli_connect_errno(), mysqli_connect_error(), mysqli_errno(), mysqli_error(), $mysqli->connect_errno, $mysqli->connect_error, $myssqli->errno, $mysqli->error\r\n                            \r\n                            \r\n                              \r\n                                mysql:\r\n                                 mysql_error(), mysql_errno()",
      "DBA: uses php's built in error handler.",
      "PDO: throws a PDOException",
      "odbc:\r\n                  odbc_error() and odbc_errormsg()",
      "Postgres:\r\n                    pg_last_error(), pg_result_error_field(), pg_result_error()",
      "SQLite3:\r\n                      SQLite3::lastErrorCode, SQLite3::lastErrorMsg",
      "SQLite:\r\n                        sqlite_error_string(), sqlite_last_error()",
      "SQLSRV:\r\n                          sqlsrv_errors()",
      "mssql:\r\n                            mssql_get_last_message()",
      "mysqli:\r\n                              mysqli_connect_errno(), mysqli_connect_error(), mysqli_errno(), mysqli_error(), $mysqli->connect_errno, $mysqli->connect_error, $myssqli->errno, $mysqli->error",
      "mysql:\r\n                                 mysql_error(), mysql_errno()",
      "Remove code that displays SQL error messages. Remove all calls to functions that may disclose SQL error messages or remove the code that displays those error messages.",
      "For more information about PHP database extensions, please see  http://us.php.net/manual/en/refs.database.php",
      "Use Structured Exception Handling",
      "Use a Global Exception Handler for Unhandled Exceptions",
      "Do Not Include Debugging Data in Output",
      "Prevent Disclosure of SQL Errors",
      "Display Simple Error Messages",
      "Structured Exception Handling Is Used",
      "A Global Exception Handler Is Used for Unhandled Exceptions",
      "Debugging Data Is Not Included in Output",
      "SQL Error Messages Are Not Disclosed",
      "Simple Error Messages Are Used"
    ],
    "p": [
      "Do not show SQL error messages.",
      "SQL error messages should not be displayed to prevent disclosing information about the database to potential attackers.",
      "To prevent displaying SQL error messages:",
      "Identify the database extraction layer(s) used by the application. Review the application to identify what database engine(s) and abstraction layer(s) are used.",
      "Identify whether SQL error messages are displayed. Search application code for calls to functions that may disclose SQL errors. Examine such code to see if it may result in SQL error messages being displayed. A list of common database engines and database abstraction layers and the corresponding functions that may disclose errors is below:",
      "DBA: uses php's built in error handler.",
      "PDO: throws a PDOException",
      "odbc:\r\n                  odbc_error() and odbc_errormsg()",
      "Postgres:\r\n                    pg_last_error(), pg_result_error_field(), pg_result_error()",
      "SQLite3:\r\n                      SQLite3::lastErrorCode, SQLite3::lastErrorMsg",
      "SQLite:\r\n                        sqlite_error_string(), sqlite_last_error()",
      "SQLSRV:\r\n                          sqlsrv_errors()",
      "mssql:\r\n                            mssql_get_last_message()",
      "mysqli:\r\n                              mysqli_connect_errno(), mysqli_connect_error(), mysqli_errno(), mysqli_error(), $mysqli->connect_errno, $mysqli->connect_error, $myssqli->errno, $mysqli->error",
      "mysql:\r\n                                 mysql_error(), mysql_errno()",
      "Remove code that displays SQL error messages. Remove all calls to functions that may disclose SQL error messages or remove the code that displays those error messages."
    ],
    "ol": [
      "Identify the database extraction layer(s) used by the application. Review the application to identify what database engine(s) and abstraction layer(s) are used.\r\n      \r\n        \r\n          Identify whether SQL error messages are displayed. Search application code for calls to functions that may disclose SQL errors. Examine such code to see if it may result in SQL error messages being displayed. A list of common database engines and database abstraction layers and the corresponding functions that may disclose errors is below:\r\n        \r\n          \r\n            \r\n              DBA: uses php's built in error handler. \r\n            \r\n              \r\n                PDO: throws a PDOException\r\n              \r\n                \r\n                  odbc:\r\n                  odbc_error() and odbc_errormsg()\r\n                \r\n                  \r\n                    Postgres:\r\n                    pg_last_error(), pg_result_error_field(), pg_result_error()\r\n                  \r\n                  \r\n                    \r\n                      SQLite3:\r\n                      SQLite3::lastErrorCode, SQLite3::lastErrorMsg\r\n                    \r\n                    \r\n                      \r\n                        SQLite:\r\n                        sqlite_error_string(), sqlite_last_error()\r\n                      \r\n                      \r\n                        \r\n                          SQLSRV:\r\n                          sqlsrv_errors()\r\n                        \r\n                        \r\n                          \r\n                            mssql:\r\n                            mssql_get_last_message()\r\n                          \r\n                          \r\n                            \r\n                              mysqli:\r\n                              mysqli_connect_errno(), mysqli_connect_error(), mysqli_errno(), mysqli_error(), $mysqli->connect_errno, $mysqli->connect_error, $myssqli->errno, $mysqli->error\r\n                            \r\n                            \r\n                              \r\n                                mysql:\r\n                                 mysql_error(), mysql_errno()\r\n                              \r\n                            \r\n                          \r\n                        \r\n                      \r\n                    \r\n                  \r\n                \r\n              \r\n            \r\n          \r\n        \r\n        \r\n          \r\n            Remove code that displays SQL error messages. Remove all calls to functions that may disclose SQL error messages or remove the code that displays those error messages."
    ],
    "strong": [
      "Identify the database extraction layer(s) used by the application.",
      "Identify whether SQL error messages are displayed.",
      "DBA:",
      "PDO:",
      "odbc:",
      "Postgres:",
      "SQLite3:",
      "SQLite:",
      "SQLSRV:",
      "mssql:",
      "mysqli:",
      "mysql:",
      "Remove code that displays SQL error messages."
    ],
    "em": [
      "PDOException",
      "odbc_error()",
      "odbc_errormsg()",
      "pg_last_error(), pg_result_error_field(), pg_result_error()",
      "SQLite3::lastErrorCode, SQLite3::lastErrorMsg",
      "sqlite_error_string(), sqlite_last_error()",
      "sqlsrv_errors()",
      "mssql_get_last_message()",
      "mysqli_connect_errno(), mysqli_connect_error(), mysqli_errno(), mysqli_error(), $mysqli->connect_errno, $mysqli->connect_error, $myssqli->errno, $mysqli->error",
      "mysql_error(), mysql_errno()"
    ],
    "a": [
      "http://us.php.net/manual/en/refs.database.php",
      "Use Structured Exception Handling",
      "Use a Global Exception Handler for Unhandled Exceptions",
      "Do Not Include Debugging Data in Output",
      "Prevent Disclosure of SQL Errors",
      "Display Simple Error Messages",
      "Structured Exception Handling Is Used",
      "A Global Exception Handler Is Used for Unhandled Exceptions",
      "Debugging Data Is Not Included in Output",
      "SQL Error Messages Are Not Disclosed",
      "Simple Error Messages Are Used"
    ]
  },
  "links": [
    {
      "href": "http://us.php.net/manual/en/refs.database.php",
      "text": "http://us.php.net/manual/en/refs.database.php"
    },
    {
      "href": "/article/a706450d-653c-4928-84ea-b9f754db8644",
      "text": "Use Structured Exception Handling"
    },
    {
      "href": "/article/8f5ac742-ecc6-4909-9aaa-2501572b5d2f",
      "text": "Use a Global Exception Handler for Unhandled Exceptions"
    },
    {
      "href": "/article/967c7738-7281-485c-8d5a-500d049c9493",
      "text": "Do Not Include Debugging Data in Output"
    },
    {
      "href": "/article/07964c6c-e9ae-4411-865c-c322f8ac2ec9",
      "text": "Prevent Disclosure of SQL Errors"
    },
    {
      "href": "/article/fd1d911e-c8ad-4951-a047-62e5b422f094",
      "text": "Display Simple Error Messages"
    },
    {
      "href": "/article/3fcd2a1c-d362-4a89-954d-b31a7c93df7f",
      "text": "Structured Exception Handling Is Used"
    },
    {
      "href": "/article/7a4f9032-7abb-409a-b00b-58d8e890c6ea",
      "text": "A Global Exception Handler Is Used for Unhandled Exceptions"
    },
    {
      "href": "/article/ecf79124-a122-4509-8ca3-a6abce9f04d4",
      "text": "Debugging Data Is Not Included in Output"
    },
    {
      "href": "/article/9d0fcbd1-210a-4c8c-a50c-8153e45d06e3",
      "text": "SQL Error Messages Are Not Disclosed"
    },
    {
      "href": "/article/7e9f8f71-a09e-44c2-adf6-80261985ed26",
      "text": "Simple Error Messages Are Used"
    }
  ],
  "html": "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>PHP</li>\r\n  </ul>\r\n  <h1>What to Do</h1>\r\n  <p>Do not show SQL error messages.</p>\r\n  <h1>Why</h1>\r\n  <p>SQL error messages should not be displayed to prevent disclosing information about the database to potential attackers.</p>\r\n  <h1>How</h1>\r\n  <p>To prevent displaying SQL error messages:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Identify the database extraction layer(s) used by the application. </strong>Review the application to identify what database engine(s) and abstraction layer(s) are used.</p>\r\n      <li>\r\n        <p>\r\n          <strong>Identify whether SQL error messages are displayed.</strong> Search application code for calls to functions that may disclose SQL errors. Examine such code to see if it may result in SQL error messages being displayed. A list of common database engines and database abstraction layers and the corresponding functions that may disclose errors is below:</p>\r\n        <ul>\r\n          <li>\r\n            <p>\r\n              <strong>DBA:</strong> uses php's built in error handler. </p>\r\n            <li>\r\n              <p>\r\n                <strong>PDO:</strong> throws a <em>PDOException</em></p>\r\n              <li>\r\n                <p>\r\n                  <strong>odbc:</strong>\r\n                  <em>odbc_error()</em> and <em>odbc_errormsg()</em></p>\r\n                <li>\r\n                  <p>\r\n                    <strong>Postgres:</strong>\r\n                    <em>pg_last_error(), pg_result_error_field(), pg_result_error()</em>\r\n                  </p>\r\n                  <li>\r\n                    <p>\r\n                      <strong>SQLite3:</strong>\r\n                      <em>SQLite3::lastErrorCode, SQLite3::lastErrorMsg</em>\r\n                    </p>\r\n                    <li>\r\n                      <p>\r\n                        <strong>SQLite:</strong>\r\n                        <em>sqlite_error_string(), sqlite_last_error()</em>\r\n                      </p>\r\n                      <li>\r\n                        <p>\r\n                          <strong>SQLSRV:</strong>\r\n                          <em>sqlsrv_errors()</em>\r\n                        </p>\r\n                        <li>\r\n                          <p>\r\n                            <strong>mssql:</strong>\r\n                            <em>mssql_get_last_message()</em>\r\n                          </p>\r\n                          <li>\r\n                            <p>\r\n                              <strong>mysqli:</strong>\r\n                              <em>mysqli_connect_errno(), mysqli_connect_error(), mysqli_errno(), mysqli_error(), &#36;mysqli-&gt;connect_errno, &#36;mysqli-&gt;connect_error, &#36;myssqli-&gt;errno, &#36;mysqli-&gt;error</em>\r\n                            </p>\r\n                            <li>\r\n                              <p>\r\n                                <strong>mysql:</strong>\r\n                                <em> mysql_error(), mysql_errno()</em>\r\n                              </p>\r\n                            </li>\r\n                          </li>\r\n                        </li>\r\n                      </li>\r\n                    </li>\r\n                  </li>\r\n                </li>\r\n              </li>\r\n            </li>\r\n          </li>\r\n        </ul>\r\n        <li>\r\n          <p>\r\n            <strong>Remove code that displays SQL error messages.</strong> Remove all calls to&nbsp;functions that may disclose SQL error messages or remove the code that displays those error messages.</p>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ol>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>For more information about PHP database extensions, please see&nbsp; <a href=\"http://us.php.net/manual/en/refs.database.php\">http://us.php.net/manual/en/refs.database.php</a></li>\r\n  </ul>\r\n  <h1>PHP Error Handling Guidelines</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/a706450d-653c-4928-84ea-b9f754db8644\">Use Structured Exception Handling</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/8f5ac742-ecc6-4909-9aaa-2501572b5d2f\">Use a Global Exception Handler for Unhandled Exceptions</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/967c7738-7281-485c-8d5a-500d049c9493\">Do Not Include Debugging Data in Output</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/07964c6c-e9ae-4411-865c-c322f8ac2ec9\">Prevent Disclosure of SQL Errors</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/fd1d911e-c8ad-4951-a047-62e5b422f094\">Display Simple Error Messages</a>\r\n    </li>\r\n  </ul>\r\n  <h1>PHP Error Handling Checklists</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/3fcd2a1c-d362-4a89-954d-b31a7c93df7f\">Structured Exception Handling Is Used</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/7a4f9032-7abb-409a-b00b-58d8e890c6ea\">A Global Exception Handler Is Used for Unhandled Exceptions</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/ecf79124-a122-4509-8ca3-a6abce9f04d4\">Debugging Data Is Not Included in Output</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/9d0fcbd1-210a-4c8c-a50c-8153e45d06e3\">SQL Error Messages Are Not Disclosed</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/7e9f8f71-a09e-44c2-adf6-80261985ed26\">Simple Error Messages Are Used</a>\r\n    </li>\r\n  </ul>"
}