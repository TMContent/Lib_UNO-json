{
  "id": "693e1ae5-e381-41fd-93f7-844aaeca3ef8",
  "checksum": "89f5cd9cfe56c72e37e5c4c1fe16c4501ab78c47",
  "words": {
    "what": [
      "h1"
    ],
    "to": [
      "h1",
      "p",
      "h1",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "a",
      "a",
      "li",
      "li",
      "li",
      "li",
      "a",
      "a"
    ],
    "check": [
      "h1",
      "h1",
      "ol",
      "li",
      "p",
      "strong"
    ],
    "for": [
      "h1",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "p",
      "p"
    ],
    "ensure": [
      "p"
    ],
    "that&nbspall": [
      "p"
    ],
    "sensitive": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "ul",
      "li",
      "a",
      "title"
    ],
    "data": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "ul",
      "li",
      "a",
      "title"
    ],
    "stored": [
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "within": [
      "p"
    ],
    "configuration": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "files": [
      "p",
      "p",
      "ol",
      "li",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "is": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "p",
      "title"
    ],
    "protected": [
      "p",
      "p",
      "p",
      "title"
    ],
    "why": [
      "h1"
    ],
    "sections": [
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "p"
    ],
    "typically": [
      "p"
    ],
    "contain": [
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "privacy-sensitive": [
      "p"
    ],
    "resource": [
      "p",
      "p"
    ],
    "access": [
      "p",
      "p"
    ],
    "credentials": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "e.g.,": [
      "p"
    ],
    "a": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "connection": [
      "p",
      "ol",
      "li",
      "ul",
      "ul",
      "li",
      "p",
      "ul",
      "li",
      "a"
    ],
    "string": [
      "p"
    ],
    "sql": [
      "p"
    ],
    "server": [
      "p",
      "p"
    ],
    "includes": [
      "p"
    ],
    "username": [
      "p"
    ],
    "and": [
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "password.": [
      "p"
    ],
    "as": [
      "p"
    ],
    "precautionary": [
      "p"
    ],
    "measure": [
      "p"
    ],
    "they": [
      "p",
      "p"
    ],
    "should": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "p"
    ],
    "not": [
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "be": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "p"
    ],
    "in": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p"
    ],
    "plaintext": [
      "p",
      "p"
    ],
    "because": [
      "p"
    ],
    "an": [
      "p"
    ],
    "attacker": [
      "p"
    ],
    "that": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "strong",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "can": [
      "p"
    ],
    "compromise": [
      "p"
    ],
    "or": [
      "p"
    ],
    "otherwise": [
      "p"
    ],
    "obtain": [
      "p",
      "p"
    ],
    "copy": [
      "p"
    ],
    "of": [
      "p",
      "ol",
      "li",
      "p",
      "p"
    ],
    "the": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "a"
    ],
    "file": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "will": [
      "p",
      "p"
    ],
    "able": [
      "p",
      "p"
    ],
    "read": [
      "p"
    ],
    "those": [
      "p"
    ],
    "values": [
      "p"
    ],
    "if": [
      "p"
    ],
    "are": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p",
      "strong"
    ],
    "adequately": [
      "p"
    ],
    "how": [
      "h1",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "li",
      "a"
    ],
    "verify": [
      "p",
      "ol",
      "li",
      "p",
      "strong"
    ],
    "inside": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "use": [
      "p",
      "ol",
      "li",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "following": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p",
      "p"
    ],
    "steps": [
      "p"
    ],
    "identify": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "all": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "locate": [
      "ol",
      "li",
      "p"
    ],
    "examples": [
      "ol",
      "li",
      "p"
    ],
    "include": [
      "ol",
      "li",
      "p"
    ],
    "but": [
      "ol",
      "li",
      "p"
    ],
    "limited": [
      "ol",
      "li",
      "p"
    ],
    "strings": [
      "ol",
      "li",
      "ul",
      "ul",
      "li",
      "ul",
      "li",
      "a"
    ],
    "encryption": [
      "ol",
      "li",
      "ul",
      "ul",
      "li"
    ],
    "keys": [
      "ol",
      "ol",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "p"
    ],
    "hashing": [
      "ol",
      "li",
      "ul",
      "ul",
      "li"
    ],
    "salts": [
      "ol",
      "li",
      "ul",
      "ul",
      "li"
    ],
    "directory": [
      "ol",
      "li",
      "ul",
      "ul",
      "li"
    ],
    "paths": [
      "ol",
      "li",
      "ul",
      "ul",
      "li"
    ],
    "webconfig": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p",
      "p",
      "p"
    ],
    "known": [
      "ol",
      "li",
      "p"
    ],
    "frequently": [
      "ol",
      "li",
      "p"
    ],
    "appsettings": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "connectionstrings": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "identity": [
      "ol",
      "ol",
      "li",
      "ul",
      "li",
      "li",
      "pre"
    ],
    "sessionstate": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "however": [
      "ol",
      "li",
      "p"
    ],
    "cannot": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "encrypted": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "strong",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "processmodel": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "runtime": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "mscorlib": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "startup": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "systemruntime.remoting": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "configprotecteddata": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "satelliteassemblies": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "cryptographysettings": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "cryptonamemapping": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "cryptoclasses": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "encrypting": [
      "ol",
      "li",
      "p"
    ],
    "ensures": [
      "ol",
      "li",
      "p"
    ],
    "its": [
      "ol",
      "li",
      "p"
    ],
    "confidentiality": [
      "ol",
      "li",
      "p"
    ],
    "case": [
      "ol",
      "li",
      "p"
    ],
    "this": [
      "ol",
      "li",
      "p"
    ],
    "compromised": [
      "ol",
      "li",
      "p"
    ],
    "once": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "application": [
      "ol",
      "li",
      "p"
    ],
    "accesses": [
      "ol",
      "li",
      "p"
    ],
    "it": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "decrypt": [
      "ol",
      "li",
      "p"
    ],
    "just": [
      "ol",
      "li",
      "p"
    ],
    "before": [
      "ol",
      "li",
      "p"
    ],
    "you": [
      "ol",
      "li",
      "p"
    ],
    "have": [
      "ol",
      "li",
      "p"
    ],
    "located": [
      "ol",
      "li",
      "p"
    ],
    "your": [
      "ol",
      "li",
      "p"
    ],
    "look": [
      "ol",
      "li",
      "p"
    ],
    "like": [
      "ol",
      "li",
      "p"
    ],
    "connectionstrings>": [
      "ol",
      "li",
      "pre"
    ],
    "encrypteddata>": [
      "ol",
      "li",
      "pre"
    ],
    "cipherdata>": [
      "ol",
      "li",
      "pre"
    ],
    "ciphervalue>ghafqew234a21...</ciphervalue>": [
      "ol",
      "li",
      "pre"
    ],
    "/cipherdata>": [
      "ol",
      "li",
      "pre"
    ],
    "/encrypteddata></connectionstrings>": [
      "ol",
      "li",
      "pre"
    ],
    "windows": [
      "ol",
      "li",
      "p",
      "strong",
      "p"
    ],
    "impersonation": [
      "ol",
      "li",
      "p",
      "strong",
      "p"
    ],
    "using": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "aspnet_setreg": [
      "ol",
      "li",
      "p",
      "strong",
      "ul",
      "li",
      "strong"
    ],
    "utility": [
      "ol",
      "li",
      "p",
      "strong",
      "ul",
      "ul",
      "li",
      "li",
      "a"
    ],
    "altered": [
      "ol",
      "li",
      "p"
    ],
    "point": [
      "ol",
      "li",
      "p"
    ],
    "appropriate": [
      "ol",
      "li",
      "p"
    ],
    "registry": [
      "ol",
      "li",
      "p"
    ],
    "example": [
      "ol",
      "li",
      "p",
      "h1"
    ],
    "impersonate=\"true\"": [
      "ol",
      "li",
      "pre",
      "pre"
    ],
    "username=\"registryhklm\\software\\myapp\\identity\\aspnet_setreg,username\"": [
      "ol",
      "li",
      "pre"
    ],
    "password=\"registryhklm\\software\\myapp\\identity\\aspnet_setreg,password\"/>": [
      "ol",
      "li",
      "pre"
    ],
    "problem": [
      "h1"
    ],
    "segment": [
      "p"
    ],
    "illustrates": [
      "p"
    ],
    "responsible": [
      "p"
    ],
    "providing": [
      "p"
    ],
    "database": [
      "p"
    ],
    "valid": [
      "p"
    ],
    "unfortunately": [
      "p"
    ],
    "information": [
      "p"
    ],
    "therefore": [
      "p"
    ],
    "anybody": [
      "p"
    ],
    "with": [
      "p"
    ],
    "..<connectionstrings>": [
      "pre"
    ],
    "add": [
      "pre",
      "pre"
    ],
    "name=\"pubs\"": [
      "pre"
    ],
    "connectionstring=\"server=localhostintegrated": [
      "pre",
      "pre"
    ],
    "security=truedatabase=pubs\"": [
      "pre"
    ],
    "providername=\"systemdata.sqlclient\"/>": [
      "pre"
    ],
    "name=\"northwind\"": [
      "pre"
    ],
    "security=truedatabase=northwind\"": [
      "pre"
    ],
    "providername=\"systemdata.sqlclient\"/></connectionstrings>...<identity": [
      "pre"
    ],
    "username=\"testacct\"": [
      "pre"
    ],
    "password=\"testpass\"/...": [
      "pre"
    ],
    "additional": [
      "h1"
    ],
    "resources": [
      "h1"
    ],
    "learn": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "more": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "about": [
      "ul",
      "li"
    ],
    "visit": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "aspnet": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "encrypt": [
      "ul",
      "li",
      "a"
    ],
    "session": [
      "ul",
      "li",
      "a"
    ],
    "state": [
      "ul",
      "li",
      "a"
    ],
    "configure": [
      "ul",
      "li"
    ],
    "httpforbiddenhandler": [
      "ul",
      "li"
    ],
    "protect": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "types": [
      "ul",
      "li",
      "a"
    ],
    "related": [
      "h1"
    ],
    "guideline": [
      "h1",
      "ul",
      "li",
      "a"
    ],
    "adapted": [
      "p"
    ],
    "from": [
      "p"
    ],
    "microsoft": [
      "p"
    ],
    "patterns": [
      "p"
    ],
    "&": [
      "p"
    ],
    "practices": [
      "p"
    ],
    "guidance": [
      "p"
    ],
    "sink]": [
      "title"
    ]
  },
  "tags": {
    "h1": [
      "What to Check For",
      "Why",
      "How to Check",
      "Problem Example",
      "Additional Resources",
      "Related Guideline"
    ],
    "p": [
      "Ensure that&nbsp;all sensitive data stored within configuration files is protected.",
      "Configuration sections typically contain privacy-sensitive resource access credentials (e.g., a connection string for a SQL server resource includes a username and password). As a precautionary measure, they should not be stored in plaintext, because an attacker that can compromise a server or otherwise obtain a copy of the file will be able to read those values if they are not adequately protected.",
      "To verify that sensitive data inside configuration files is protected use the following steps:",
      "Identify all sensitive data. Locate all sensitive data that is stored inside the configuration files. Examples of sensitive data include, but are not limited to:",
      "The following sections inside web.config are known to frequently contain sensitive data:",
      "However, the following sections inside web.config cannot be encrypted:",
      "Verify that sensitive data is encrypted. Encrypting the sensitive data inside the configuration file ensures its confidentiality in case this file is compromised. Once the application accesses the configuration file, it should decrypt the sensitive data just before use. Once you have located your sensitive data in web.config it should look like the following:",
      "Check that credentials for Windows impersonation are encrypted using the aspnet_setreg utility. The web.config should be altered to point to the appropriate registry keys that contain the encrypted credentials. For example:",
      "The following segment illustrates the configuration sections of web.config responsible for providing a database connection and the valid credentials for Windows impersonation. Unfortunately, the information inside web.config is in plaintext; therefore, anybody with access to the configuration file will be able to obtain the credentials.",
      "Adapted from Microsoft patterns & practices guidance."
    ],
    "ol": [
      "Identify all sensitive data. Locate all sensitive data that is stored inside the configuration files. Examples of sensitive data include, but are not limited to:\n      \n        \n          credentials connection strings encryption keys hashing salts directory paths \n        \n        \n          The following sections inside web.config are known to frequently contain sensitive data:\n          \n            appSettings connectionStrings identity sessionState\n          \n          \n            However, the following sections inside web.config cannot be encrypted:\n            \n              processModel runtime mscorlib startup system.runtime.remoting configProtectedData satelliteassemblies cryptographySettings cryptoNameMapping cryptoClasses \n            \n          \n        \n      \n      \n        \n          Verify that sensitive data is encrypted. Encrypting the sensitive data inside the configuration file ensures its confidentiality in case this file is compromised. Once the application accesses the configuration file, it should decrypt the sensitive data just before use. Once you have located your sensitive data in web.config it should look like the following:\n        <connectionStrings>  <EncryptedData>    <CipherData>      <CipherValue>GHAFQEW234A21...</CipherValue>    </CipherData>  </EncryptedData></connectionStrings>\n        \n          \n            Check that credentials for Windows impersonation are encrypted using the aspnet_setreg utility. The web.config should be altered to point to the appropriate registry keys that contain the encrypted credentials. For example:\n          <identity impersonate=\"true\" userName=\"registry:HKLM\\Software\\MyApp\\Identity\\ASPNET_SETREG,userName\"                             password=\"registry:HKLM\\Software\\MyApp\\Identity\\ASPNET_SETREG,password\"/>"
    ],
    "li": [
      "Identify all sensitive data. Locate all sensitive data that is stored inside the configuration files. Examples of sensitive data include, but are not limited to:\n      \n        \n          credentials connection strings encryption keys hashing salts directory paths",
      "credentials",
      "connection strings",
      "encryption keys",
      "hashing salts",
      "directory paths",
      "The following sections inside web.config are known to frequently contain sensitive data:\n          \n            appSettings connectionStrings identity sessionState",
      "appSettings",
      "connectionStrings",
      "identity",
      "sessionState",
      "However, the following sections inside web.config cannot be encrypted:\n            \n              processModel runtime mscorlib startup system.runtime.remoting configProtectedData satelliteassemblies cryptographySettings cryptoNameMapping cryptoClasses",
      "processModel",
      "runtime",
      "mscorlib",
      "startup",
      "system.runtime.remoting",
      "configProtectedData",
      "satelliteassemblies",
      "cryptographySettings",
      "cryptoNameMapping",
      "cryptoClasses",
      "Verify that sensitive data is encrypted. Encrypting the sensitive data inside the configuration file ensures its confidentiality in case this file is compromised. Once the application accesses the configuration file, it should decrypt the sensitive data just before use. Once you have located your sensitive data in web.config it should look like the following:\n        <connectionStrings>  <EncryptedData>    <CipherData>      <CipherValue>GHAFQEW234A21...</CipherValue>    </CipherData>  </EncryptedData></connectionStrings>",
      "Check that credentials for Windows impersonation are encrypted using the aspnet_setreg utility. The web.config should be altered to point to the appropriate registry keys that contain the encrypted credentials. For example:\n          <identity impersonate=\"true\" userName=\"registry:HKLM\\Software\\MyApp\\Identity\\ASPNET_SETREG,userName\"                             password=\"registry:HKLM\\Software\\MyApp\\Identity\\ASPNET_SETREG,password\"/>",
      "To learn more about the aspnet_setreg utility, visit: How to use the ASP.NET utility to encrypt credentials and session state connection strings.",
      "To learn more how to configure HttpForbiddenHandler, visit: HOW TO: Use ASP.NET to Protect File Types.",
      "Guideline: Protect Sensitive Data Inside Configuration Files"
    ],
    "strong": [
      "Identify all sensitive data.",
      "web.config",
      "cannot",
      "Verify that sensitive data is encrypted.",
      "Check that credentials for Windows impersonation are encrypted using the aspnet_setreg utility.",
      "aspnet_setreg"
    ],
    "ul": [
      "credentials connection strings encryption keys hashing salts directory paths",
      "credentials connection strings encryption keys hashing salts directory paths",
      "appSettings connectionStrings identity sessionState",
      "processModel runtime mscorlib startup system.runtime.remoting configProtectedData satelliteassemblies cryptographySettings cryptoNameMapping cryptoClasses",
      "To learn more about the aspnet_setreg utility, visit: How to use the ASP.NET utility to encrypt credentials and session state connection strings. To learn more how to configure HttpForbiddenHandler, visit: HOW TO: Use ASP.NET to Protect File Types.",
      "Guideline: Protect Sensitive Data Inside Configuration Files"
    ],
    "pre": [
      "<connectionStrings>  <EncryptedData>    <CipherData>      <CipherValue>GHAFQEW234A21...</CipherValue>    </CipherData>  </EncryptedData></connectionStrings>",
      "<identity impersonate=\"true\" userName=\"registry:HKLM\\Software\\MyApp\\Identity\\ASPNET_SETREG,userName\"                             password=\"registry:HKLM\\Software\\MyApp\\Identity\\ASPNET_SETREG,password\"/>",
      "...<connectionStrings>  <add name=\"Pubs\" connectionString=\"Server=localhost;Integrated Security=True;Database=Pubs\"   providerName=\"System.Data.SqlClient\"/>  <add name=\"Northwind\" connectionString=\"Server=localhost;Integrated Security=True;Database=Northwind\"    providerName=\"System.Data.SqlClient\"/></connectionStrings>...<identity impersonate=\"true\" userName=\"testAcct\" password=\"testPass\"/>..."
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "a": [
      "How to use the ASP.NET utility to encrypt credentials and session state connection strings",
      "HOW TO: Use ASP.NET to Protect File Types",
      "Guideline: Protect Sensitive Data Inside Configuration Files"
    ],
    "hr": [
      ""
    ]
  },
  "links": [
    {
      "href": "http://support.microsoft.com/kb/329290",
      "text": "How to use the ASP.NET utility to encrypt credentials and session state connection strings"
    },
    {
      "href": "http://support.microsoft.com/kb/815152",
      "text": "HOW TO: Use ASP.NET to Protect File Types"
    },
    {
      "href": "/article/faada3f5-3f50-42fc-b863-5058e3d848cb",
      "text": "Guideline: Protect Sensitive Data Inside Configuration Files"
    }
  ],
  "html": "<h1>What to Check For</h1>\n  <p>Ensure that&amp;nbsp;all sensitive data stored within configuration files is protected.</p>\n  <h1>Why</h1>\n  <p>Configuration sections typically contain privacy-sensitive resource access credentials (e.g., a connection string for a SQL server resource includes a username and password). As a precautionary measure, they should not be stored in plaintext, because an attacker that can compromise a server or otherwise obtain a copy of the file will be able to read those values if they are not adequately protected.</p>\n  <h1>How to Check</h1>\n  <p>To verify that sensitive data inside configuration files is protected use the following steps:</p>\n  <ol>\n    <li>\n      <p>\n        <strong>Identify all sensitive data. </strong>Locate all sensitive data that is stored inside the configuration files. Examples of sensitive data include, but are not limited to:</p>\n      <ul>\n        <ul>\n          <li>credentials <li>connection strings <li>encryption keys <li>hashing salts <li>directory paths </li></li></li></li></li>\n        </ul>\n        <li>\n          <p>The following sections inside <strong>web.config</strong> are known to frequently contain sensitive data:</p>\n          <ul>\n            <li>appSettings <li>connectionStrings <li>identity <li>sessionState</li></li></li></li>\n          </ul>\n          <li>\n            <p>However, the following sections inside web.config <strong>cannot</strong> be encrypted:</p>\n            <ul>\n              <li>processModel <li>runtime <li>mscorlib <li>startup <li>system.runtime.remoting <li>configProtectedData <li>satelliteassemblies <li>cryptographySettings <li>cryptoNameMapping <li>cryptoClasses </li></li></li></li></li></li></li></li></li></li>\n            </ul>\n          </li>\n        </li>\n      </ul>\n      <li>\n        <p>\n          <strong>Verify that sensitive data is encrypted. </strong>Encrypting the sensitive data inside the configuration file ensures its confidentiality in case this file is compromised. Once the application accesses the configuration file, it should decrypt the sensitive data just before use. Once you have located your sensitive data in web.config it should look like the following:</p>\n        <pre>&lt;connectionStrings&gt;<br />  &lt;EncryptedData&gt;<br />    &lt;CipherData&gt;<br />      &lt;CipherValue&gt;GHAFQEW234A21...&lt;/CipherValue&gt;<br />    &lt;/CipherData&gt;<br />  &lt;/EncryptedData&gt;<br />&lt;/connectionStrings&gt;</pre>\n        <li>\n          <p>\n            <strong>Check that credentials for Windows impersonation are encrypted using the aspnet_setreg utility. </strong>The web.config should be altered to point to the appropriate registry keys that contain the encrypted credentials. For example:</p>\n          <pre>&lt;identity impersonate=\"true\" userName=\"registry:HKLM\\Software\\MyApp\\Identity\\ASPNET_SETREG,userName\"<br />                             password=\"registry:HKLM\\Software\\MyApp\\Identity\\ASPNET_SETREG,password\"/&gt;</pre>\n        </li>\n      </li>\n    </li>\n  </ol>\n  <h1>Problem Example</h1>\n  <p>The following segment illustrates the configuration sections of web.config responsible for providing a database connection and the valid credentials for Windows impersonation. Unfortunately, the information inside web.config is in plaintext; therefore, anybody with access to the configuration file will be able to obtain the credentials.</p>\n  <pre>...<br />&lt;connectionStrings&gt;<br />  &lt;add name=\"Pubs\" connectionString=\"Server=localhost;Integrated Security=True;Database=Pubs\"<br />   providerName=\"System.Data.SqlClient\"/&gt;<br />  &lt;add name=\"Northwind\" connectionString=\"Server=localhost;Integrated Security=True;Database=Northwind\"<br />    providerName=\"System.Data.SqlClient\"/&gt;<br />&lt;/connectionStrings&gt;<br />...<br />&lt;identity impersonate=\"true\" userName=\"testAcct\" password=\"testPass\"/&gt;<br />...</pre>\n  <h1>Additional Resources</h1>\n  <ul>\n    <li>To learn more about the <strong>aspnet_setreg</strong> utility, visit: <a href=\"http://support.microsoft.com/kb/329290\">How to use the ASP.NET utility to encrypt credentials and session state connection strings</a>. <li>To learn more how to configure HttpForbiddenHandler, visit: <a href=\"http://support.microsoft.com/kb/815152\">HOW TO: Use ASP.NET to Protect File Types</a>.</li></li>\n  </ul>\n  <h1>Related Guideline</h1>\n  <ul>\n    <li>\n      <a href=\"/article/faada3f5-3f50-42fc-b863-5058e3d848cb\">Guideline: Protect Sensitive Data Inside Configuration Files</a>\n    </li>\n  </ul>\n  <hr />\n  <p>Adapted from Microsoft patterns &amp; practices guidance. </p>"
}