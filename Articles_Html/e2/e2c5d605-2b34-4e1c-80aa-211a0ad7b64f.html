<h2>Applies To</h2><ul><li> HTML5</li>
<li> Server-side</li>
</ul><h2>What to Do</h2><p>Validate all user input by using whitelist (positive) input validation. Whitelist input validation allows only the set of input that is explicitly defined as valid, as opposed to blacklist input validation, which filters out known bad input.
</p><h2>Why</h2><p>Whitelist input validation can prevent SQL injection and cross-site scripting (XSS) vulnerabilities.
</p><h2>How</h2><p>To validate all user input using whitelist input validation:
</p><ol>
<li> <strong>Identify all entry points for user input.</strong> Make a list of all possible sources of user input in your application, such as form fields, POST/GET parameters, cookies, etc. </li>
<li> <strong>Identify all types of input accepted by the application.</strong> For each source of user input on the list, define valid characters, length, format, and range (for numerical values).</li>
<li> <strong>Define an input validation subsystem.</strong> Define a set of validator functions that should be used to validate each type of input handled by the application. Input should be validated on the server. </li>
<li> <strong>Validate characters.</strong> Restrict the acceptable range of characters in text input by using regular expressions.</li>
<li> <strong>Validate length.</strong> Add code to check that the length of the user input is valid.</li>
<li> <strong>Validate format.</strong> If the input type has a specific pattern, such as a date or a phone number, add code to use regular expressions to ensure that user input matches the input type specified by the application. Use regular expressions to enforce strong password requirements.</li>
<li> <strong>Validate range.</strong> Restrict the acceptable range of numerical input by comparing the input to the maximum and minimum acceptable values.</li>
<li> <strong>(Optional) Reject and respond to known bad input.</strong> This step does not add much actual security, but it is included here to let you know that such an option exists. The input validation subsystem may check for known attack strings and respond to these likely attacks by doing things like logging detailed user information, alerting the administrator, blocking the user's IP address for some time, and displaying an error message to the attacker informing that you are onto him and reminding him of the consequences.</li>
<li> <strong>(Optional) Encode input that will be displayed as output.</strong> If the input is going to be displayed back through the web application, consider adding code to encode it to prevent cross-site scripting attacks.</li>
</ol><h2>Essential Server-side Security Guidelines</h2><ul><li> <a href="e2c5d605-2b34-4e1c-80aa-211a0ad7b64f">Validate All Input</a></li>
<li> <a href="397488da-ce91-4768-9ad9-1e6928980d72">Use Prepared Statements for SQL Queries</a></li>
<li> <a href="496b6306-dca6-48b6-920e-67e768dbe334">Encode Input Included in Output</a></li>
<li> <a href="45d61f0a-c4d3-44f0-93b1-d8205cd13fbe">Force Reauthentication when Executing Critical Functionality</a></li>
<li> <a href="fdb460e6-5d18-4e35-a093-4b260155d79e">Include Unique Tokens in HTTP Requests</a></li>
<li> <a href="00000000-0000-0000-0000-0000007ecacc">Use Role-based Authorization</a></li>
<li> <a href="1445abaf-4bb9-474c-b7e4-7bf58fe80f39">URL-Encode Data in HTTP Response Headers</a></li>
</ul><h2>Essential Server-side Security Checklist Items</h2><ul><li> <a href="8dfa8088-a6cb-4062-8a44-0df8f2bc1cc4">All Input Is Validated</a></li>
<li> <a href="b5fb44c5-1702-42cf-b6be-894c511af7ac">Prepared Statements Are Used for SQL Queries</a></li>
<li> <a href="0ee9bc9f-c363-4a2d-be89-f84c069bda65">Input Included in Output Is Encoded</a></li>
<li> <a href="1c2b0859-c898-4f1c-b826-21392a7fc773">Reauthentication Is Enforced When Executing Critical Functionality</a></li>
<li> <a href="a2ef2a76-e562-4dd0-af9e-a6eb2b76c0d3">Unique Tokens Are Included in HTTP Requests</a></li>
<li> <a href="00000000-0000-0000-0000-0000008495ec">Role-based Authorization Is Used</a></li>
<li> <a href="3eb26600-9126-493a-a3cf-9d4b9815efc9">Data in HTTP Response Headers Is URL-Encoded</a></li></ul>