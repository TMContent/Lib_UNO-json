{
  "id": "e9748936-6e22-4c56-94e9-7f8522e4f06d",
  "checksum": "f2c45f73962a31a760c9e97870e360bd2bd9c367",
  "words": {
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "h1",
      "p",
      "p",
      "p",
      "p"
    ],
    "c++": [
      "ul",
      "li"
    ],
    "what": [
      "h1"
    ],
    "do": [
      "h1"
    ],
    "convert": [
      "p",
      "title"
    ],
    "integers": [
      "p",
      "title"
    ],
    "in": [
      "p",
      "p",
      "p"
    ],
    "a": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "p",
      "pre",
      "pre",
      "pre"
    ],
    "way": [
      "p"
    ],
    "that": [
      "p",
      "p"
    ],
    "does": [
      "p"
    ],
    "not": [
      "p"
    ],
    "cause": [
      "p"
    ],
    "truncation": [
      "p",
      "p"
    ],
    "or": [
      "p",
      "p"
    ],
    "lose": [
      "p"
    ],
    "sign": [
      "p"
    ],
    "information": [
      "p"
    ],
    "why": [
      "h1"
    ],
    "if": [
      "p",
      "p"
    ],
    "data": [
      "p"
    ],
    "is": [
      "p",
      "p",
      "p"
    ],
    "lost": [
      "p"
    ],
    "during": [
      "p"
    ],
    "conversion": [
      "p",
      "p",
      "p",
      "p"
    ],
    "an": [
      "p",
      "p",
      "p"
    ],
    "unpredictable/unintended": [
      "p"
    ],
    "value": [
      "p",
      "p"
    ],
    "may": [
      "p",
      "p",
      "p",
      "p"
    ],
    "be": [
      "p",
      "p"
    ],
    "stored": [
      "p"
    ],
    "variable": [
      "p",
      "p",
      "p",
      "p"
    ],
    "this": [
      "p"
    ],
    "used": [
      "p"
    ],
    "for": [
      "p"
    ],
    "program": [
      "p"
    ],
    "flow": [
      "p"
    ],
    "control": [
      "p"
    ],
    "memory": [
      "p"
    ],
    "operations": [
      "p",
      "p"
    ],
    "array": [
      "p"
    ],
    "indexing": [
      "p"
    ],
    "arbitrary": [
      "p"
    ],
    "code": [
      "p",
      "p"
    ],
    "execution": [
      "p"
    ],
    "vulnerability": [
      "p"
    ],
    "result": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "how": [
      "h1"
    ],
    "identify": [
      "p"
    ],
    "all": [
      "p"
    ],
    "integer": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "add": [
      "p",
      "p"
    ],
    "range": [
      "p",
      "p"
    ],
    "checks": [
      "p",
      "p"
    ],
    "verify": [
      "p"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "of": [
      "p",
      "p"
    ],
    "valid": [
      "p"
    ],
    "before": [
      "p",
      "p"
    ],
    "assigning": [
      "p",
      "p"
    ],
    "problem": [
      "h1",
      "p"
    ],
    "example": [
      "h1",
      "h1",
      "p"
    ],
    "following": [
      "p"
    ],
    "because": [
      "p"
    ],
    "unsigned": [
      "p",
      "pre",
      "pre"
    ],
    "has": [
      "p"
    ],
    "larger": [
      "p"
    ],
    "maximum": [
      "p"
    ],
    "than": [
      "p"
    ],
    "signed": [
      "p",
      "pre"
    ],
    "exact": [
      "p"
    ],
    "error": [
      "p"
    ],
    "different": [
      "p",
      "p"
    ],
    "on": [
      "p"
    ],
    "platforms": [
      "p"
    ],
    "short": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "=": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "50000signed": [
      "pre"
    ],
    "b": [
      "pre",
      "pre"
    ],
    "static_castsigned": [
      "pre",
      "pre"
    ],
    "short(a);": [
      "pre"
    ],
    "solution": [
      "h1"
    ],
    "fix": [
      "p"
    ],
    "above": [
      "p"
    ],
    "50000if": [
      "pre"
    ],
    "shrt_min": [
      "pre"
    ],
    "&&": [
      "pre"
    ],
    "shrt_max": [
      "pre"
    ],
    "short(a);else": [
      "pre"
    ],
    "{/*handle": [
      "pre"
    ],
    "error*/}": [
      "pre"
    ],
    "related": [
      "h1"
    ],
    "items": [
      "h1"
    ],
    "protect": [
      "ul",
      "li",
      "a"
    ],
    "against": [
      "ul",
      "li",
      "a"
    ],
    "overflows": [
      "ul",
      "li",
      "a"
    ],
    "correctly": [
      "title"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "What to Do",
      "Why",
      "How",
      "Problem Example",
      "Solution Example",
      "Related Items"
    ],
    "ul": [
      "C++",
      "Protect Against Integer Overflows"
    ],
    "li": [
      "C++",
      "Protect Against Integer Overflows"
    ],
    "p": [
      "Convert integers in a way that does not cause truncation or lose sign information.",
      "If data is lost during conversion, an unpredictable/unintended value may be stored in a variable. If this variable is used for program flow control, memory operations, or array indexing, an arbitrary code execution vulnerability may result.",
      "Identify all integer conversion operations. Add range checks to verify that the result of integer conversion is valid before assigning the result to a variable.",
      "The following code may result in truncation, because an unsigned integer has a larger maximum value than a signed integer. The exact error may be different on different platforms.",
      "To fix the problem example above, add range checks before assigning the result of conversion to a variable."
    ],
    "pre": [
      "unsigned short a = 50000;signed short b = static_cast<signed short>(a);",
      "unsigned short a = 50000;if (a > SHRT_MIN && a < SHRT_MAX) signed short b = static_cast<signed short>(a);else {/*handle error*/}"
    ],
    "br": [
      "",
      "",
      "",
      ""
    ],
    "a": [
      "Protect Against Integer Overflows"
    ]
  },
  "links": [
    {
      "href": "/article/6c6f0d93-0d5b-4aa4-97b0-9e69535b3345",
      "text": "Protect Against Integer Overflows"
    }
  ],
  "html": "<h1>Applies to</h1>\n  <ul>\n    <li>C&#43;&#43;</li>\n  </ul>\n  <h1>What to Do</h1>\n  <p>Convert integers in a way that does not cause truncation or lose sign information.</p>\n  <h1>Why</h1>\n  <p>If data is lost during conversion, an unpredictable/unintended value may be stored in a variable. If this variable is used for program flow control, memory operations, or array indexing, an arbitrary code execution vulnerability may result.</p>\n  <h1>How</h1>\n  <p>Identify all integer conversion operations. Add range checks to verify that the result of integer conversion is valid before assigning the result to a variable.</p>\n  <h1>Problem Example</h1>\n  <p>The following code may result in truncation, because an unsigned integer has a larger maximum value than a signed integer. The exact error may be different on different platforms.</p>\n  <pre>unsigned short a = 50000;<br />signed short b = static_cast&lt;signed short&gt;(a);</pre>\n  <h1>Solution Example</h1>\n  <p>To fix the problem example above, add range checks before assigning the result of conversion to a variable.</p>\n  <pre>unsigned short a = 50000;<br />if (a &gt; SHRT_MIN && a &lt; SHRT_MAX) signed short b = static_cast&lt;signed short&gt;(a);<br />else &#123;/&#42;handle error&#42;/&#125;</pre>\n  <h1>Related Items</h1>\n  <ul>\n    <li>\n      <a href=\"/article/6c6f0d93-0d5b-4aa4-97b0-9e69535b3345\">Protect Against Integer Overflows</a>\n    </li>\n  </ul>\n  <br />"
}