<h2>Applies To</h2><ul><li> PHP</li>
</ul><h2>What to Do</h2><p>Throttle sensitive and resource intensive operations.
</p><h2>Why</h2><p>Throttle sensitive and resource intensive operations to thwart automated attack tools.
</p><h2>How</h2><p>To throttle sensitive and resource intensive operations:
</p><ol>
<li> <strong>Identify code that implements sensitive operations.</strong> Make a spreadsheet about sensitive operations performed by the application and the code that implements them. Some examples of sensitive operations are: authentication, user management, administrative actions, and file uploads.</li>
<li> <strong>Identify code that implements resource intensive operations.</strong> Make a spreadsheet about resource intensive operations performed by the application and the code that implements them. Some examples are: search functionality, anything that performs expensive database lookups, anything that performs a lot of computations, anything that performs a lot of disk access, anything that takes up a lot of memory, anything that sends a lot of network traffic, anything that sends email.</li>
<li> <strong>Choose a throttling mechanism.</strong> Choose  a throttling mechanism for each sensitive and resource intensive operation. Some common throttling mechanisms are: CAPTCHA, time-out per user session, and time-out per IP. The amount of throttling depends on the amount of resources available to the application and the cost of performing the operation that is being throttled. It is recommended to only allow authenticated users to perform sensitive and resource intensive operations and to impose time-outs per user session. For example, only authenticated users should be allowed to perform searches and only one search per second. Authentication is a sensitive operation that cannot be performed by authenticated users, so it can be throttled either by IP, using a CAPTCHA, using time-outs per username or using time-outs per session. It is recommended to throttle authentication by IP and by time-outs per username. (A session state can be created for unauthenticated users and this session state can be used to impose time-outs on authentication but this isn't sufficient, because the attacker can drop the session state cookie.) </li>
<li> <strong>Add throttling to sensitive operations.</strong> Add code that implements the chosen throttling mechanism to each sensitive operation.</li>
<li> <strong>Add throttling to resource intensive operations.</strong> Add code that implements the chosen throttling mechanism to each resource intensive operation.</li>
</ol>