<h1>Applies to</h1>
  <ul>
    <li>PHP</li>
  </ul>
  <h1>What to Do</h1>
  <p>Log important security operations, such as:</p>
  <ul>
    <li>Authentication attempts <li>Creating user accounts <li>Removing user accounts <li>Changing user access privileges <li>Changing group membership </li></li></li></li></li>
  </ul>
  <h1>Why</h1>
  <p>Logging security operations may help detect an attacker's presence if he tries to create unauthorized user accounts or make other unauthorized changes to the system.</p>
  <h1>How</h1>
  <p>Perform the following actions to implement logging of important security operations:</p>
  <ol>
    <li>
      <p>
        <strong>Define logging requirements.</strong> Make a list of critical security events that should be logged. Some examples are:</p>
      <ul>
        <li>Authentication attempts <li>Creating user accounts <li>Locking and unlocking user accounts <li>Removing user accounts <li>Changing user access privileges <li>Changing group membership <li>Changing passwords <li>Changing user account details <li>Financial transactions <li>Making changes to the application configuration <li>Starting the application <li>Terminating the application </li></li></li></li></li></li></li></li></li></li></li></li>
      </ul>
      <li>
        <p>
          <strong>Identify log entry details.</strong> For each important security operation on the list, make a list of details that should be included in the log entries. Some examples are:</p>
        <ul>
          <li>User identification <li>Type of event <li>Date and time stamp <li>Success or failure indication <li>Source of event <li>Names or other identifiers of affected data or resources </li></li></li></li></li></li>
        </ul>
        <li>
          <p>
            <strong>Identify code that implements security operations.</strong> For each important security operation on the list, make a list of functions that implement this operation.</p>
          <li>
            <p>
              <strong>Identify the logging subsystem.</strong> The logging subsystem should provide an API that allows generating log entries from application code. If the API or the logging subsystem don't exist, write them. Make a list of functions that may be used to generate log entries and collect documentation about how to use them.</p>
            <li>
              <p>
                <strong>Add code that logs important security operations.</strong> Use the list of functions that implement important security operations to add code that generates log entries whenever these operations take place. Log both successful and failed events. Use the list of logging APIs when writing code that generates log entries. Use the list of log entry details when writing code that generates log entries to make sure that the log entries include all the relevant information.</p>
            </li>
          </li>
        </li>
      </li>
    </li>
  </ol>
  <h1>Logging Guidelines</h1>
  <ul>
    <li>
      <a href="/article/2121fb95-1840-401b-98c7-4fb14b23730f">Centralize Logging</a>
      <li>
        <a href="/article/235c0d6e-2aa8-4b14-892e-d71790937c98">Protect Log Files</a>
        <li>
          <a href="/article/3aef9249-12f2-44cd-bffa-2d88bcf3ce13">Log Important Event Details</a>
          <li>
            <a href="/article/6430ffee-d18e-42d4-bf3d-53fd7b21846e">Do Not Log Sensitive Information</a>
            <li>
              <a href="/article/599dd454-45b6-4b28-a528-f61830cb4181">Log Important Security Operations</a>
              <li>
                <a href="/article/1af37399-b9ca-4d4d-af0b-83f4676c2b5a">Log Unusual Activity</a>
                <li>
                  <a href="/article/6672a0ec-f74d-4039-b6cd-1c268f87d680">Log Important Business Operations</a>
                  <li>
                    <a href="/article/ca55d261-5ee5-45a4-9fd7-6738364ef470">Monitor the Use of Privileged Accounts</a>
                    <li>
                      <a href="/article/322f3f59-a0bc-4056-9657-3d3ac2a60140">Log Authentication Events</a>
                    </li>
                  </li>
                </li>
              </li>
            </li>
          </li>
        </li>
      </li>
    </li>
  </ul>
  <h1>Logging Checklists</h1>
  <ul>
    <li>
      <a href="/article/5f786a98-c099-4762-8d14-71909fe5a6a0">Logging Is Centralized</a>
      <li>
        <a href="/article/a73d5b9a-26db-48cd-b743-2ab9e6a62b8f">Log Files Are Protected</a>
        <li>
          <a href="/article/b675b081-1681-481a-a72e-ba19775fbd80">Important Event Details Are Logged</a>
          <li>
            <a href="/article/a7b0a818-7af1-4a1b-8bed-f99e1c7280ed">Sensitive Information Is Not Logged</a>
            <li>
              <a href="/article/fe193f22-c665-4a66-bbdb-c3597c517b3c">Important Security Operations Are Logged</a>
              <li>
                <a href="/article/c45bfc8a-0b24-43ad-993f-fc9facd5e6ff">Unusual Activity Is Logged</a>
                <li>
                  <a href="/article/7da7f6b6-21ff-4a51-b57b-c5345dc46716">Important Business Operations Are Logged</a>
                  <li>
                    <a href="/article/2414f5c5-3a50-4a85-9305-e64260e8421e">The Use of Privileged Accounts Is Monitored</a>
                    <li>
                      <a href="/article/db6938c1-d962-449a-9d4f-3cc3776993c2">Authentication Events Are Logged</a>
                    </li>
                  </li>
                </li>
              </li>
            </li>
          </li>
        </li>
      </li>
    </li>
  </ul>