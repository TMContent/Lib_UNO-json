<h2>Applies To</h2>
<ul>
<li>PHP</li>
</ul>
<h2>What to Do</h2>
<p>Escape HTML special characters in all user input that is displayed on web pages.</p>
<h2>Why</h2>
<p>It is important to properly encode all user-controlled data before it is outputted to a dynamically generated Web page. If data is not encoded then it will make its way to the browser in its original representation, which could be executable script code, causing the browser to interpret and run it. The most common case is of user-controlled input making its way into plain HTML; in this case it should be HTML-encoded before being inserted into the page.</p>
<h2>How</h2>
<p>To escape HTML characters in user input:</p>
<ol>
<li><strong>Identify all pages that display data entered by users.</strong> Enumerate all the pages in the application. Make a list of all the pages that display user input.</li>
<li><strong>Use htmlentities() whenever displaying data entered by users.</strong> Review each page that displays data entered by users. Verify that PHP code in each page uses htmlentities() to escape special characters in user input before displaying it to the user, like this:<pre><code>echo htmlentities($userinput);
</code></pre>
where $userinput is a string that contains user input.</li>
<li><strong>Define your own, non-HTML special characters, if tags are required for user input.</strong> Many interactive web applications offer the users functionality to post links, images and other content that requires special tags to be rendered correctly. One solution is to define a custom syntax specific for your application to allow users to post rich content. One common solution is to use square brackets, such as [], instead of the &lt;&gt; brackets used by HTML, and then translate the [] brackets into &lt;&gt; when rendering user input. This approach requires positive input validation to be safe.</li>
<li><strong>Write a parser for handling non-HTML special characters, if tags are required for user input.</strong> Use positive input validation to make sure that only allowed tags are rendered. For example, a user may be allowed to display bold text by using a [b] tag, instead of HTML <code>&lt;b&gt;</code>. The parser should then be allowed to only translate the square brackets into &lt;&gt; if the only thing inside the brackets is &quot;b&quot;. Writing such a parser is application-specific and non-trivial - a lot of care has to be taken when writing this parser to prevent XSS vulnerabilities.</li>
</ol>
