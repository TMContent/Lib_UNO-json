{
  "id": "636b0c98-34d0-4aed-bf06-35f80a6e5551",
  "checksum": "adcfee09e4b3ff411868102e3dcab8f9fd02fcbf",
  "words": {
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "h1",
      "p",
      "h1",
      "p",
      "h1",
      "p",
      "ol",
      "li",
      "p",
      "strong"
    ],
    "scala": [
      "p"
    ],
    "and": [
      "p"
    ],
    "play": [
      "p"
    ],
    "framework": [
      "p"
    ],
    "21.0+": [
      "p"
    ],
    "what": [
      "h1"
    ],
    "check": [
      "h1",
      "h1"
    ],
    "for": [
      "h1",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "ul",
      "li"
    ],
    "verify": [
      "p",
      "p",
      "ol",
      "li",
      "p",
      "strong"
    ],
    "that": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "ol",
      "li",
      "p"
    ],
    "sessions": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "strong",
      "p",
      "ol",
      "li",
      "p",
      "strong",
      "title"
    ],
    "are": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "title"
    ],
    "invalidated": [
      "p",
      "p",
      "ol",
      "li",
      "p",
      "strong",
      "ol",
      "li",
      "p",
      "title"
    ],
    "when": [
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "users": [
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "log": [
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "out": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "p",
      "title"
    ],
    "why": [
      "h1"
    ],
    "invalidating": [
      "p"
    ],
    "makes": [
      "p"
    ],
    "it": [
      "p"
    ],
    "harder": [
      "p"
    ],
    "hijack": [
      "p"
    ],
    "them": [
      "p"
    ],
    "how": [
      "h1",
      "h1",
      "ol",
      "li",
      "p"
    ],
    "identify": [
      "ol",
      "li",
      "p",
      "strong",
      "ol",
      "li",
      "p",
      "strong"
    ],
    "logout": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "strong",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "ul",
      "li"
    ],
    "functionality find": [
      "ol",
      "li",
      "p",
      "ol",
      "li",
      "p"
    ],
    "code": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "strong"
    ],
    "is": [
      "ol",
      "li",
      "p",
      "ol",
      "li",
      "p"
    ],
    "responsible": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "ol",
      "li",
      "p"
    ],
    "the": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p"
    ],
    "functionality": [
      "ol",
      "li",
      "p",
      "strong",
      "ol",
      "li",
      "p",
      "strong"
    ],
    "upon": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "logout look": [
      "ol",
      "li",
      "p"
    ],
    "presence": [
      "ol",
      "li",
      "p"
    ],
    "of": [
      "ol",
      "li",
      "p"
    ],
    "in": [
      "ol",
      "li",
      "p"
    ],
    "functions": [
      "ol",
      "li",
      "p"
    ],
    "logging": [
      "ol",
      "li",
      "p"
    ],
    "fix": [
      "h1"
    ],
    "invalidate": [
      "p",
      "ol",
      "li",
      "p",
      "strong"
    ],
    "add": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "below": [
      "ol",
      "li",
      "p"
    ],
    "function": [
      "ol",
      "li",
      "p"
    ],
    "shows": [
      "ol",
      "li",
      "p"
    ],
    "session": [
      "ol",
      "li",
      "p"
    ],
    "should": [
      "ol",
      "li",
      "p"
    ],
    "be": [
      "ol",
      "li",
      "p"
    ],
    "on": [
      "ol",
      "li",
      "p"
    ],
    "def": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "gotologoutsucceededimplicit": [
      "ol",
      "li",
      "pre"
    ],
    "request": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "requestheader:": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "result": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "=": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "pre",
      "pre",
      "pre"
    ],
    "{": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "gotologoutsucceededlogoutsucceeded(request))": [
      "ol",
      "li",
      "pre"
    ],
    "}": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "gotologoutsucceededresult:": [
      "ol",
      "li",
      "pre"
    ],
    "result(implicit": [
      "ol",
      "li",
      "pre"
    ],
    "requestcookies.get(cookiename)": [
      "ol",
      "li",
      "pre"
    ],
    "flatmap": [
      "ol",
      "li",
      "pre"
    ],
    "cookieutilverifyhmac": [
      "ol",
      "li",
      "pre"
    ],
    "foreach": [
      "ol",
      "li",
      "pre"
    ],
    "idcontainerremove": [
      "ol",
      "li",
      "pre"
    ],
    "resultdiscardingcookies(discardingcookie(cookiename))": [
      "ol",
      "li",
      "pre"
    ],
    "additional": [
      "h1"
    ],
    "resources": [
      "h1"
    ],
    "information": [
      "ul",
      "li"
    ],
    "about": [
      "ul",
      "li"
    ],
    "functionlity": [
      "ul",
      "li"
    ],
    "please": [
      "ul",
      "li"
    ],
    "see https//github.com/t2v/play20-auth/blob/master/module/src/main/scala/jp/t2v/lab/play2/auth/loginlogout.scala": [
      "ul",
      "li"
    ],
    "https//github.com/t2v/play20-auth/blob/master/module/src/main/scala/jp/t2v/lab/play2/auth/loginlogout.scala": [
      "a"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "What to Check For",
      "Why",
      "How to Check",
      "How to Fix",
      "Additional Resources"
    ],
    "p": [
      "Scala and Play Framework 2.1.0+",
      "Verify that sessions are invalidated when users log out.",
      "Invalidating sessions when users log out makes it harder to hijack them.",
      "To verify that sessions are invalidated when users log out:",
      "Identify logout functionality. Find code that is responsible for the logout functionality.",
      "Verify that sessions are invalidated upon logout. Look for the presence of code in functions that are responsible for logging out.",
      "",
      "To invalidate sessions when users log out:",
      "Identify logout functionality. Find code that is responsible for the logout functionality.",
      "Add code to invalidate sessions. The below function shows how the session should be invalidated on logout.",
      ""
    ],
    "br": [
      "",
      ""
    ],
    "ol": [
      "Identify logout functionality. Find code that is responsible for the logout functionality.\r\n    \r\n    \r\n      \r\n        Verify that sessions are invalidated upon logout. Look for the presence of code in functions that are responsible for logging out.",
      "Identify logout functionality. Find code that is responsible for the logout functionality.\r\n    \r\n    \r\n      \r\n        Add code to invalidate sessions. The below function shows how the session should be invalidated on logout.\r\n       def gotoLogoutSucceeded(implicit request: RequestHeader): Result = {\r\n    gotoLogoutSucceeded(logoutSucceeded(request))\r\n  }\r\n\r\n  def gotoLogoutSucceeded(result: => Result)(implicit request: RequestHeader): Result = {\r\n    request.cookies.get(cookieName) flatMap CookieUtil.verifyHmac foreach idContainer.remove\r\n    result.discardingCookies(DiscardingCookie(cookieName))\r\n  }"
    ],
    "li": [
      "Identify logout functionality. Find code that is responsible for the logout functionality.",
      "Verify that sessions are invalidated upon logout. Look for the presence of code in functions that are responsible for logging out.",
      "Identify logout functionality. Find code that is responsible for the logout functionality.",
      "Add code to invalidate sessions. The below function shows how the session should be invalidated on logout.\r\n       def gotoLogoutSucceeded(implicit request: RequestHeader): Result = {\r\n    gotoLogoutSucceeded(logoutSucceeded(request))\r\n  }\r\n\r\n  def gotoLogoutSucceeded(result: => Result)(implicit request: RequestHeader): Result = {\r\n    request.cookies.get(cookieName) flatMap CookieUtil.verifyHmac foreach idContainer.remove\r\n    result.discardingCookies(DiscardingCookie(cookieName))\r\n  }",
      "For information about Logout functionlity, please see https://github.com/t2v/play20-auth/blob/master/module/src/main/scala/jp/t2v/lab/play2/auth/LoginLogout.scala"
    ],
    "strong": [
      "Identify logout functionality.",
      "Verify that sessions are invalidated upon logout.",
      "Identify logout functionality.",
      "Add code to invalidate sessions."
    ],
    "pre": [
      "def gotoLogoutSucceeded(implicit request: RequestHeader): Result = {\r\n    gotoLogoutSucceeded(logoutSucceeded(request))\r\n  }\r\n\r\n  def gotoLogoutSucceeded(result: => Result)(implicit request: RequestHeader): Result = {\r\n    request.cookies.get(cookieName) flatMap CookieUtil.verifyHmac foreach idContainer.remove\r\n    result.discardingCookies(DiscardingCookie(cookieName))\r\n  }"
    ],
    "ul": [
      "For information about Logout functionlity, please see https://github.com/t2v/play20-auth/blob/master/module/src/main/scala/jp/t2v/lab/play2/auth/LoginLogout.scala"
    ],
    "a": [
      "https://github.com/t2v/play20-auth/blob/master/module/src/main/scala/jp/t2v/lab/play2/auth/LoginLogout.scala"
    ],
    "div": [
      ""
    ]
  },
  "links": [
    {
      "href": "https://github.com/t2v/play20-auth/blob/master/module/src/main/scala/jp/t2v/lab/play2/auth/LoginLogout.scala",
      "text": "https://github.com/t2v/play20-auth/blob/master/module/src/main/scala/jp/t2v/lab/play2/auth/LoginLogout.scala"
    }
  ],
  "html": "<h1>Applies to</h1>\r\n  <p>Scala and Play Framework 2.1.0+<br /></p>\r\n  <h1>What to Check For</h1>\r\n  <p>Verify that sessions are invalidated when users log out.</p>\r\n  <h1>Why</h1>\r\n  <p>Invalidating sessions when users log out makes it harder to hijack them.</p>\r\n  <h1>How to Check</h1>\r\n  <p>To verify that sessions are invalidated when users log out:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Identify logout functionality.</strong>&nbsp;Find code that is responsible for the logout functionality.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Verify that sessions are invalidated upon logout.</strong>&nbsp;Look for the presence of code in functions that are responsible for logging out.</p>\r\n    </li>\r\n  </ol>\r\n  <h1>How to Fix</h1>\r\n  <p />\r\n  <p>To invalidate sessions when users log out:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Identify logout functionality.</strong>&nbsp;Find code that is responsible for the logout functionality.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Add code to invalidate sessions.</strong> The below function shows how the session should be invalidated on logout.</p>\r\n      <pre> def gotoLogoutSucceeded(implicit request: RequestHeader): Result = {\r\n    gotoLogoutSucceeded(logoutSucceeded(request))\r\n  }\r\n\r\n  def gotoLogoutSucceeded(result: =&gt; Result)(implicit request: RequestHeader): Result = {\r\n    request.cookies.get(cookieName) flatMap CookieUtil.verifyHmac foreach idContainer.remove\r\n    result.discardingCookies(DiscardingCookie(cookieName))\r\n  }</pre>\r\n    </li>\r\n  </ol>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>For information about Logout functionlity, please see&nbsp;<a href=\"https://github.com/t2v/play20-auth/blob/master/module/src/main/scala/jp/t2v/lab/play2/auth/LoginLogout.scala\">https://github.com/t2v/play20-auth/blob/master/module/src/main/scala/jp/t2v/lab/play2/auth/LoginLogout.scala</a></li>\r\n  </ul>\r\n  <div>\r\n    <br />\r\n  </div>\r\n  <p />"
}