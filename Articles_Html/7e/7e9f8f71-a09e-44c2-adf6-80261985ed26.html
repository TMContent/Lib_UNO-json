<h1>Applies to</h1>
  <ul>
    <li>PHP</li>
  </ul>
  <h1>What to Check For</h1>
  <p>Verify that error messages are simple and don't give away too much information. Check that detailed information is written to protected log files.</p>
  <h1>Why</h1>
  <p>Error messages should be simple to prevent attackers from gathering sensitive information from them. Simple error messages also may be more user-friendly. Detailed error information should be written to protected log files, where it cannot be accessed by attackers.</p>
  <h1>How to Check</h1>
  <p>To verify that error messages don't give away too much information:</p>
  <ol>
    <li>
      <p />
      <strong>Verify that PHP error messages are disabled.</strong> Examine the <em>php.ini</em> file to make sure the display_errors directive is used to disable PHP error messages, like so:<pre>display_errors = off</pre><li><p><strong>Make sure that a global exception handler is used.</strong> If a global exception handler is not used, PHP may display detailed error messages if the application crashes. Search for calls to the set_exception_handler function to make sure a global exception handler is used.</p><li><p><strong>Identify all exception handlers and other error handling code.</strong> Review application code to find all code that handles errors. One way is to search for keywords such as "<em>try</em>", "<em>catch</em>", "<em>throw</em>", "<em>set_error_handler</em>", and &#8220;<em>set_exception_handler</em>". Ideally, exception handling should be used instead of error handling. </p><li><p><strong>Verify that error messages don't give away too much information.</strong> Examine the error messages that are likely to be displayed. Be careful not to disclose sensitive information in error messages. One thing to watch out for is disclosing information implicitly by displaying different messages for different scenarios. For example, displaying a message "The password is incorrect" when the password does not match an existing user and displaying "The username is incorrect" when the username is not valid - this is an example of volunteering too much information; using this information an attacker may infer what usernames exist on the system and focus on attacking existing accounts, thus making his attacks more efficient. Display as little information as possible to let the user know that an error has taken place and that the situation is under control. If some user action is required to recover from the error or to prevent the error from taking place again, that information may be included in the error message.</p><li><p><strong>Verify that detailed information is logged.</strong> Examine exception handling code to make sure it collects information about the application state and write this information to a log file that is not accessible by unprivileged users.</p></li></li></li></li></li>
  </ol>
  <h1>How to Fix</h1>
  <p>To display simple error messages:</p>
  <ol>
    <li>
      <p />
      <strong>Disable PHP error messages.</strong> Use the display_errors directive in php.ini to disable PHP error messages, like so:<pre>display_errors = off</pre><li><p><strong>Identify all exception handlers and other error handling code.</strong> Review application code to find all code that handles errors. One way is to search for keywords such as "<em>try</em>", "<em>catch</em>", "<em>throw</em>", "<em>set_error_handler</em>", and &#8220;<em>set_exception_handler</em>". Ideally, exception handling should be used instead of error handling.</p><li><p><strong>Log detailed error information.</strong> Add code to exception handlers that collects information about the application state and records it in log files. Make sure log files are not exposed to unprivileged users. Be careful not to log sensitive information, such as passwords and other secrets in log entries.</p><li><p><strong>Show simple error messages. </strong>Be careful not to disclose sensitive information in error messages. One thing to watch out for is disclosing information implicitly by displaying different messages for different scenarios. For example, displaying a message "The password is incorrect" when the password does not match an existing user and displaying "The username is incorrect" when the username is not valid - this is an example of volunteering too much information; using this information an attacker may infer what usernames exist on the system and focus on attacking existing accounts, thus making his attacks more efficient. Display as little information as possible to let the user know that an error has taken place and that the situation is under control. If some user action is required to recover from the error or to prevent the error from taking place again, that information may be included in the error message. Write error messages with these considerations in mind. Add code to exception handlers that displays the simple error messages.</p></li></li></li></li>
  </ol>
  <h1>PHP Error Handling Guidelines</h1>
  <ul>
    <li>
      <a href="/article/a706450d-653c-4928-84ea-b9f754db8644">Use Structured Exception Handling</a>
    </li>
    <li>
      <a href="/article/8f5ac742-ecc6-4909-9aaa-2501572b5d2f">Use a Global Exception Handler for Unhandled Exceptions</a>
    </li>
    <li>
      <a href="/article/967c7738-7281-485c-8d5a-500d049c9493">Do Not Include Debugging Data in Output</a>
    </li>
    <li>
      <a href="/article/07964c6c-e9ae-4411-865c-c322f8ac2ec9">Prevent Disclosure of SQL Errors</a>
    </li>
    <li>
      <a href="/article/fd1d911e-c8ad-4951-a047-62e5b422f094">Display Simple Error Messages</a>
    </li>
  </ul>
  <h1>PHP Error Handling Checklists</h1>
  <ul>
    <li>
      <a href="/article/3fcd2a1c-d362-4a89-954d-b31a7c93df7f">Structured Exception Handling Is Used</a>
    </li>
    <li>
      <a href="/article/7a4f9032-7abb-409a-b00b-58d8e890c6ea">A Global Exception Handler Is Used for Unhandled Exceptions</a>
    </li>
    <li>
      <a href="/article/ecf79124-a122-4509-8ca3-a6abce9f04d4">Debugging Data Is Not Included in Output</a>
    </li>
    <li>
      <a href="/article/9d0fcbd1-210a-4c8c-a50c-8153e45d06e3">SQL Error Messages Are Not Disclosed</a>
    </li>
    <li>
      <a href="/article/7e9f8f71-a09e-44c2-adf6-80261985ed26">Simple Error Messages Are Used</a>
    </li>
  </ul>