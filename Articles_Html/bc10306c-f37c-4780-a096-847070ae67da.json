{
  "id": "bc10306c-f37c-4780-a096-847070ae67da",
  "checksum": "f03df632b17f619cbf0cbb08d82331430d11659f",
  "words": {
    "what": [
      "h1"
    ],
    "to": [
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "check": [
      "h1",
      "p",
      "h1"
    ],
    "for": [
      "h1",
      "p",
      "ul",
      "li",
      "a"
    ],
    "ensure": [
      "p",
      "p",
      "pre"
    ],
    "structured": [
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "exception": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "title"
    ],
    "handling": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "ul",
      "li",
      "a",
      "title"
    ],
    "is": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "title"
    ],
    "used": [
      "p",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "catch": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "error": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "conditions": [
      "p"
    ],
    "why": [
      "h1"
    ],
    "using": [
      "p",
      "p",
      "pre",
      "pre"
    ],
    "helps": [
      "p"
    ],
    "protect": [
      "p"
    ],
    "your": [
      "p",
      "p",
      "p"
    ],
    "application": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "from": [
      "p",
      "pre",
      "p"
    ],
    "denial": [
      "p"
    ],
    "of": [
      "p",
      "p",
      "p",
      "p"
    ],
    "service": [
      "p"
    ],
    "attacks": [
      "p"
    ],
    "and can": [
      "p"
    ],
    "be": [
      "p",
      "p"
    ],
    "fail": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "securely for": [
      "p"
    ],
    "instance": [
      "p"
    ],
    "when": [
      "p",
      "p",
      "p",
      "p"
    ],
    "impersonation": [
      "p"
    ],
    "you": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "can": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "use": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "return": [
      "p"
    ],
    "a": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "p",
      "ul",
      "li",
      "a"
    ],
    "lower": [
      "p"
    ],
    "privilege": [
      "p"
    ],
    "level": [
      "p"
    ],
    "in": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre"
    ],
    "event": [
      "p"
    ],
    "an": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre"
    ],
    "error exception": [
      "p"
    ],
    "handling also": [
      "p"
    ],
    "simplifies": [
      "p"
    ],
    "and": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "de-clutters": [
      "p"
    ],
    "code": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "which": [
      "p"
    ],
    "improves": [
      "p"
    ],
    "robustness": [
      "p"
    ],
    "how": [
      "h1",
      "h1"
    ],
    "all": [
      "p"
    ],
    "that": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "pre"
    ],
    "may": [
      "p",
      "p",
      "p",
      "p"
    ],
    "should": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "either be": [
      "p"
    ],
    "enclosed": [
      "p",
      "p"
    ],
    "try/catch/finally": [
      "p",
      "p"
    ],
    "block": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "or": [
      "p",
      "p",
      "p"
    ],
    "caught": [
      "p",
      "p"
    ],
    "by": [
      "p",
      "p"
    ],
    "global": [
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "handler": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "while": [
      "p"
    ],
    "not": [
      "p",
      "p",
      "p",
      "p"
    ],
    "exceptions": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "handle": [
      "p",
      "p",
      "p"
    ],
    "catching": [
      "p"
    ],
    "close": [
      "p",
      "pre"
    ],
    "source": [
      "p"
    ],
    "improve": [
      "p"
    ],
    "messages": [
      "p"
    ],
    "both": [
      "p"
    ],
    "user": [
      "p",
      "p"
    ],
    "experience": [
      "p"
    ],
    "debugging": [
      "p"
    ],
    "purposes": [
      "p"
    ],
    "try": [
      "p",
      "p"
    ],
    "statement": [
      "p"
    ],
    "such": [
      "p"
    ],
    "as": [
      "p",
      "pre",
      "pre"
    ],
    "try{": [
      "p",
      "pre"
    ],
    "//error": [
      "p",
      "pre",
      "p",
      "pre"
    ],
    "prone": [
      "p",
      "pre"
    ],
    "code}": [
      "p",
      "pre",
      "p",
      "pre",
      "p",
      "pre"
    ],
    "follow": [
      "p"
    ],
    "if": [
      "p",
      "p",
      "pre"
    ],
    "want": [
      "p"
    ],
    "execute": [
      "p"
    ],
    "including": [
      "p",
      "p"
    ],
    "resource": [
      "p"
    ],
    "cleanup": [
      "p",
      "p",
      "p",
      "p",
      "pre"
    ],
    "necessary": [
      "p"
    ],
    "condition": [
      "p",
      "p"
    ],
    "any": [
      "p",
      "p"
    ],
    "work": [
      "p"
    ],
    "needed": [
      "p"
    ],
    "secure": [
      "p"
    ],
    "state": [
      "p"
    ],
    "blocks": [
      "p",
      "p"
    ],
    "are": [
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "right": [
      "p"
    ],
    "place": [
      "p"
    ],
    "do": [
      "p",
      "pre"
    ],
    "logging": [
      "p"
    ],
    "and add": [
      "p"
    ],
    "more": [
      "p"
    ],
    "information": [
      "p",
      "p"
    ],
    "existing": [
      "p"
    ],
    "most": [
      "p"
    ],
    "cases": [
      "p"
    ],
    "rethrown": [
      "p"
    ],
    "so": [
      "p"
    ],
    "handlers": [
      "p",
      "ul",
      "li",
      "a"
    ],
    "above": [
      "p"
    ],
    "react": [
      "p"
    ],
    "appropriately you": [
      "p"
    ],
    "only": [
      "p"
    ],
    "consume": [
      "p"
    ],
    "completely": [
      "p"
    ],
    "catchsomeexceptionclass": [
      "p",
      "pre"
    ],
    "e{": [
      "p",
      "pre"
    ],
    "it": [
      "p"
    ],
    "ok": [
      "p"
    ],
    "try/finally": [
      "p",
      "p"
    ],
    "without": [
      "p"
    ],
    "especially": [
      "p"
    ],
    "cannot": [
      "p"
    ],
    "just": [
      "p"
    ],
    "need": [
      "p"
    ],
    "make": [
      "p"
    ],
    "sure": [
      "p"
    ],
    "run": [
      "p"
    ],
    "next": [
      "p"
    ],
    "create": [
      "p"
    ],
    "finally": [
      "p"
    ],
    "performs": [
      "p"
    ],
    "other": [
      "p",
      "pre"
    ],
    "operations": [
      "p"
    ],
    "occur": [
      "p"
    ],
    "regardless": [
      "p",
      "p"
    ],
    "whether": [
      "p"
    ],
    "succeeds": [
      "p"
    ],
    "fails": [
      "p",
      "p"
    ],
    "finally{": [
      "p",
      "pre"
    ],
    "//resource": [
      "p",
      "pre"
    ],
    "fix": [
      "h1"
    ],
    "thrown": [
      "p"
    ],
    "resources": [
      "p"
    ],
    "disposed": [
      "p"
    ],
    "properly": [
      "p"
    ],
    "directly": [
      "p"
    ],
    "problem": [
      "h1"
    ],
    "example": [
      "h1",
      "h1"
    ],
    "aspnet": [
      "p",
      "p"
    ],
    "has": [
      "p",
      "p"
    ],
    "connect": [
      "p",
      "p"
    ],
    "sql": [
      "p",
      "p",
      "p"
    ],
    "database": [
      "p",
      "p",
      "p"
    ],
    "however": [
      "p"
    ],
    "wrapped": [
      "p",
      "p"
    ],
    "with": [
      "p",
      "p"
    ],
    "connection": [
      "p",
      "p",
      "pre"
    ],
    "times": [
      "p",
      "p"
    ],
    "out": [
      "p",
      "p"
    ],
    "then": [
      "p"
    ],
    "displays": [
      "p"
    ],
    "details": [
      "p"
    ],
    "sensitive": [
      "p"
    ],
    "protected": [
      "pre"
    ],
    "void": [
      "pre"
    ],
    "page_loadobject": [
      "pre"
    ],
    "sender": [
      "pre"
    ],
    "eventargs": [
      "pre"
    ],
    "e": [
      "pre"
    ],
    "{": [
      "pre",
      "pre"
    ],
    "sqlconnection": [
      "pre"
    ],
    "cn": [
      "pre"
    ],
    "=": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "new": [
      "pre",
      "pre",
      "pre"
    ],
    "sqlconnectionconfigurationmanager.connectionstrings[\"mydbconn\"].tostring()))": [
      "pre"
    ],
    "sqlcommand": [
      "pre"
    ],
    "cmd": [
      "pre"
    ],
    "sqlcommand\"select": [
      "pre"
    ],
    "count*)": [
      "pre"
    ],
    "authors\"": [
      "pre"
    ],
    "cn;": [
      "pre"
    ],
    "cnopen();": [
      "pre"
    ],
    "sqldatareader": [
      "pre"
    ],
    "rdr": [
      "pre"
    ],
    "cmdexecutereader(commandbehavior.closeconnection);": [
      "pre"
    ],
    "rdrread();": [
      "pre"
    ],
    "responsewrite(rdr[0].tostring());": [
      "pre"
    ],
    "//read": [
      "pre"
    ],
    "value": [
      "pre"
    ],
    "}": [
      "pre",
      "pre"
    ],
    "solution": [
      "h1"
    ],
    "handles": [
      "p"
    ],
    "gracefully": [
      "p"
    ],
    "systemdata.sqlclient;using": [
      "pre"
    ],
    "systemsecurity;sqlconnection": [
      "pre"
    ],
    "conn": [
      "pre"
    ],
    "sqlconnection\"...\");try{": [
      "pre"
    ],
    "connopen();": [
      "pre"
    ],
    "//": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "some": [
      "pre"
    ],
    "operation": [
      "pre"
    ],
    "might": [
      "pre"
    ],
    "cause": [
      "pre"
    ],
    "calling": [
      "pre"
    ],
    "early": [
      "pre"
    ],
    "possible": [
      "pre"
    ],
    "connclose();": [
      "pre",
      "pre"
    ],
    "..": [
      "pre"
    ],
    "potentially": [
      "pre"
    ],
    "long": [
      "pre"
    ],
    "operations}finally{": [
      "pre"
    ],
    "conn.state==connectionstate.open)": [
      "pre"
    ],
    "closed}": [
      "pre"
    ],
    "related": [
      "h1"
    ],
    "items": [
      "h1"
    ],
    "unhandled": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "adapted": [
      "p"
    ],
    "microsoft": [
      "p"
    ],
    "patterns": [
      "p"
    ],
    "&": [
      "p"
    ],
    "practices": [
      "p"
    ],
    "guidance": [
      "p"
    ]
  },
  "tags": {
    "h1": [
      "What to Check For",
      "Why",
      "How to Check",
      "How to Fix",
      "Problem Example",
      "Solution Example",
      "Related Items"
    ],
    "p": [
      "Check to ensure structured exception handling is used to catch error conditions.",
      "Using exception handling helps to protect your application from denial of service attacks and can be used to fail securely. For instance, when using impersonation you can use exception handling to return to a lower privilege level in the event of an error. Exception handling also simplifies and de-clutters the application code, which improves robustness.",
      "All code in your application that may fail should either be enclosed in a Try/Catch/Finally block or caught by a global exception handler.  While you should not catch exceptions that can not handle, catching exceptions close to the source can improve error messages both for user experience and debugging purposes.",
      "The code that may fail should be enclosed in a Try statement such as:",
      "Try{    //error prone code}",
      "",
      "A Catch block may follow the Try block if you want to execute error handling code including resource cleanup necessary in an error condition and any work needed to fail to a secure state.  Catch blocks are the right place to do exception logging and add more information to the existing exception.  In most cases you should rethrown the exception so that exception handlers above your code can react appropriately. You should only consume an exception if you can handle the error completely:",
      "Catch(SomeExceptionClass e){    //error handling code}",
      "",
      "It is ok to use Try/Finally without a Catch block, especially when you cannot handle the exception and just need to make sure cleanup code is run.  You should next create a Finally block that performs cleanup or any other operations that should occur regardless of whether the code succeeds or fails",
      "Finally{    //resource cleanup code}",
      "Use Try/Catch/Finally blocks to catch exceptions thrown by code that may fail.  Use Try/Finally to ensure resources are disposed properly regardless of an error condition. Use a global error handler to catch exceptions not caught directly in the code.",
      "An ASP.NET application has code to connect to a SQL database.  However, the code is not wrapped with an exception handler and when the connection times out the application fails, then displays exception details to the user including sensitive SQL database information.",
      "An ASP.NET application has code to connect to a SQL database.  The code is wrapped with an exception handler and when the connection times out the application handles the error gracefully.",
      "Adapted from Microsoft patterns & practices guidance."
    ],
    "pre": [
      "Try{    //error prone code}",
      "Catch(SomeExceptionClass e){    //error handling code}",
      "Finally{    //resource cleanup code}",
      "protected void Page_Load(object sender, EventArgs e)  {      using (SqlConnection cn = new SqlConnection(ConfigurationManager.ConnectionStrings[\"MyDbConn\"].ToString()))      {          SqlCommand cmd = new SqlCommand(\"SELECT COUNT(*) FROM authors\", cn);          cn.Open();          SqlDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection);          rdr.Read();          Response.Write(rdr[0].ToString());\t //read a value      }  }",
      "using System.Data.SqlClient;using System.Security;SqlConnection conn = new SqlConnection(\"...\");try{    conn.Open();    // Do some operation that might cause an exception.    // Calling Close as early as possible.    conn.Close();    // ... other potentially long operations.}finally{    if (conn.State==ConnectionState.Open)        conn.Close();  // ensure that the connection is closed.}"
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "ul": [
      "Global Error Handlers are used to Catch Unhandled Exceptions\r\n      \r\n        Use Structured Exception Handling\r\n        \r\n          Use a Global Exception Handler for Unhandled Exceptions"
    ],
    "li": [
      "Global Error Handlers are used to Catch Unhandled Exceptions",
      "Use Structured Exception Handling",
      "Use a Global Exception Handler for Unhandled Exceptions"
    ],
    "a": [
      "Global Error Handlers are used to Catch Unhandled Exceptions",
      "Use Structured Exception Handling",
      "Use a Global Exception Handler for Unhandled Exceptions"
    ],
    "hr": [
      ""
    ]
  },
  "links": [
    {
      "href": "/article/2e16a65a-25d2-4ea9-a513-e020d2408241",
      "text": "Global Error Handlers are used to Catch Unhandled Exceptions"
    },
    {
      "href": "/article/9557bf26-cc8e-4bcc-8588-3e07d127b4fc",
      "text": "Use Structured Exception Handling"
    },
    {
      "href": "/article/33a894ce-2061-4741-be92-1d063c9cf057",
      "text": "Use a Global Exception Handler for Unhandled Exceptions"
    }
  ],
  "html": "<h1>What to Check For</h1>\r\n  <p>Check to ensure structured exception handling is used to catch error conditions.</p>\r\n  <h1>Why</h1>\r\n  <p>Using exception handling helps to protect your application from denial of service attacks and&nbsp;can be used to fail securely.&nbsp;For instance, when using impersonation you can use exception handling to return to a lower privilege level in the event of an error.&nbsp;Exception handling&nbsp;also simplifies and de-clutters the application code, which improves robustness.</p>\r\n  <h1>How to Check</h1>\r\n  <p>All code in your application that may fail should either&nbsp;be enclosed in a Try/Catch/Finally block or caught by a global exception handler.&nbsp; While you should not catch exceptions that can not handle, catching exceptions close to the source can improve error messages both for user experience and debugging purposes.&nbsp;&nbsp;</p>\r\n  <p>The code that may fail should be enclosed in a Try statement such as:</p>\r\n  <p />\r\n  <pre>Try<br />&#123;<br />    //error prone code<br />&#125;</pre>\r\n  <p />\r\n  <p>A Catch block may follow the Try block if you want to execute error handling code including resource cleanup necessary in an error condition and any work needed to fail to a secure state.&nbsp; Catch blocks are the right place to do exception logging and&nbsp;add more information to the existing exception.&nbsp; In most cases you should rethrown the exception so that exception handlers above your code can react appropriately.&nbsp;You should only consume an exception if you can handle the error completely:</p>\r\n  <p />\r\n  <pre>Catch(SomeExceptionClass e)<br />&#123;<br />    //error handling code<br />&#125;</pre>\r\n  <p />\r\n  <p>It is ok to use Try/Finally without a Catch block, especially when you cannot handle the exception and just need to make sure cleanup code is run.&nbsp; You should next create a Finally block that performs cleanup or any other operations that should occur regardless of whether the code succeeds or fails</p>\r\n  <p />\r\n  <pre>Finally<br />&#123;<br />    //resource cleanup code<br />&#125;</pre>\r\n  <h1>How to Fix</h1>\r\n  <p>Use Try/Catch/Finally blocks to catch exceptions thrown by code that may fail.&nbsp; Use Try/Finally to ensure resources are disposed properly regardless of an error condition. Use a global error handler to catch exceptions not caught directly in the code.</p>\r\n  <h1>Problem Example</h1>\r\n  <p>An ASP.NET application has code to connect to a SQL database.&nbsp; However, the code is not wrapped with an exception handler and when the connection times out the application fails, then displays exception details to the user including sensitive SQL database information.</p>\r\n  <pre>  protected void Page_Load(object sender, EventArgs e)<br />  &#123;<br />      using (SqlConnection cn = new SqlConnection(ConfigurationManager.ConnectionStrings&#91;\"MyDbConn\"&#93;.ToString()))<br />      &#123;<br />          SqlCommand cmd = new SqlCommand(\"SELECT COUNT(&#42;) FROM authors\", cn);<br />          cn.Open();<br />          SqlDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection);<br />          rdr.Read();<br />          Response.Write(rdr&#91;0&#93;.ToString());<br />&#9; //read a value<br />      &#125;<br />  &#125;&nbsp;</pre>\r\n  <h1>Solution Example</h1>\r\n  <p>An ASP.NET application has code to connect to a SQL database.&nbsp; The code is wrapped with an exception handler and when the connection times out the application handles the error gracefully.</p>\r\n  <pre>using System.Data.SqlClient;<br />using System.Security;<br />SqlConnection conn = new SqlConnection(\"...\");<br />try&#123;<br />    conn.Open();<br />    // Do some operation that might cause an exception.<br />    // Calling Close as early as possible.<br />    conn.Close();<br />    // ... other potentially long operations.<br />&#125;<br />finally&#123;<br />    if (conn.State==ConnectionState.Open)<br />        conn.Close();<br />  // ensure that the connection is closed.<br />&#125;</pre>\r\n  <h1>Related Items</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/2e16a65a-25d2-4ea9-a513-e020d2408241\">Global Error Handlers are used to Catch Unhandled Exceptions</a>\r\n      <li>\r\n        <a href=\"/article/9557bf26-cc8e-4bcc-8588-3e07d127b4fc\">Use Structured Exception Handling</a>\r\n        <li>\r\n          <a href=\"/article/33a894ce-2061-4741-be92-1d063c9cf057\">Use a Global Exception Handler for Unhandled Exceptions</a>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ul>\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns & practices guidance. </p>"
}