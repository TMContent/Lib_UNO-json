<h1>Description</h1><p>File canonicalization vulnerabilities allow attackers to access unauthorized resources by entering obscure file names or paths. The process of resolving different forms of input that refer to the same standard name (the canonical name) is called canonicalization. Code is particularly susceptible to canonicalization issues if it makes security decisions based on the name of a resource that is passed to the program as input. Files, paths, host names, and URLs are resource types that are vulnerable to canonicalization because, in each case, there are many different ways to represent the same name.
</p><h2>Impact</h2><p>Exploiting file canonicalization vulnerabilities allows attackers to access files that are outside of the scope of those allowed by the application. The exact capabilities that a file canonicalization vulnerability may grant to an attacker depend on which operation is performed by the vulnerable code. If the vulnerable code reads from a poorly canonicalized file location, then the attacker will be able to read files for which he has no authorized access. And, if the vulnerable code writes to a poorly canonicalized file location, then the attacker will be able to write to files for which he has no authorized access. The damage potential of file canonicalization vulnerabilities is limited by the operating system access controls imposed on the vulnerable application. If the vulnerable application is running under a limited user account, then the attacker will only be able to access files that can be accessed by that limited user account. In practice, file canonicalization vulnerabilities are most likely to be used to read sensitive files, especially those that may contain authentication credentials or configuration settings; to read source code; to overwrite source code files with malicious code; and to overwrite configuration files with malicious data. The objective of exploiting file canonicalization vulnerabilities is typically to gain unauthorized access to the web application server and to be able to execute arbitrary code with the same permissions as the user account used by the vulnerable application.
</p><h1>Countermeasures</h1><p>To prevent this vulnerability type, avoid file name or path input, validate all input, and do not rely on client-side validation for security.
</p><p>
Avoid file name or path input:</p><ul>
<li> <a href="30a85330-dbcd-456e-8538-aa9aff177821">Avoid File Name Or Path Input</a></li>
</ul><p>
Validate all input:</p><ul>
<li> <a href="3de41277-0cc1-4ebc-8dd7-e96d161aa0ef">Validate All Input</a></li>
<li> <a href="e59923e7-c2fb-4a75-8db7-a9a91e869f74">Validate Input for Length, Range, Format, And Type</a></li>
</ul><p>
Do not rely on client-side validation for security:</p><ul>
<li> <a href="14d4d65c-8bba-4fef-8261-e76895882942">Do Not Rely on Client-side Validation</a></li>
</ul><h1>Application Check</h1><p>To check for adequate protection against this vulnerability type, ensure that file name and path input are avoided, all input is validated, and client-side validation is not relied on for security.
</p><p>
File name and path input are avoided:</p><ul>
<li> <a href="45e085ee-668e-409c-93d8-6ee578085c47">The Application Avoids File Name And Path Input</a></li>
</ul><p>
All input is validated:</p><ul>
<li> <a href="a210fcb7-f142-4c2e-844a-c43e0859f90d">All Input Is Validated</a></li>
<li> <a href="0e71dd64-87d1-4cf5-9569-ea320f209977">Input Is Validated for Length, Range, Format, And Type</a></li>
</ul><p>
Client-side validation is not relied on for security:</p><ul>
<li> <a href="eda2c482-6e7f-4370-9d2f-deeca845c82b">Client-side Validation Is Not Relied On</a></li>
</ul><h1>Computer Based Training Links</h1><p>Use the following Computer Based Training course(s) to learn more about File Canonicalization including techniques for remediation and prevention.
</p><h2>Creating Secure C# Code</h2><p>This course will provide a deep understanding of application security risks and secure coding standards for C# applications. The main lesson guides students through the concepts underlying the coding principles and illustrates real-world best practices and techniques, and the labs allow students to test what they have learned.
</p><p>
<a href="https://teamprofessor.absorbtraining.com/ninja/#/courses/course/127608">COD 314 Creating Secure C# Code</a>.
</p><h2>Creating Secure Code – .NET 4.0 Foundations</h2><p>This course will provide a deep understanding of application security risks and secure coding standards for C# applications. The main lesson guides students through the concepts underlying the coding principles and illustrates real-world best practices and techniques, and the labs allow students to test what they have learned.
</p><p>
<a href="https://teamprofessor.absorbtraining.com/ninja/#/courses/course/127611">COD 215 Creating Secure Code – .NET 4.0 Foundations</a>.
</p><p>
<em>Valid login credentials and enrollment in the course itself are required to access Team Professor content. If you need login credentials, please contact support@securityinnovation.com for help.</em>
</p><h1>Additional Resources</h1><ul><li> For more information about canonicalization, please see <a href="http://en.wikipedia.org/wiki/Canonicalization">http://en.wikipedia.org/wiki/Canonicalization</a></li>
<li> For more information about canonicalization, please see <a href="https://www.owasp.org/index.php/Canonicalization,_locale_and_Unicode">https://www.owasp.org/index.php/Canonicalization,_locale_and_Unicode</a></li></ul>