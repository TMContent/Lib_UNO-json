<h1>What to Check For</h1>
  <p>Ensure that your application does not cache sensitive data at any level.</p>
  <h1>Why</h1>
  <ul>
    <li>Sensitive data that is cached on the client may persist for the lifespan of the client's browser â€” or longer. Attackers may retrieve sensitive information from the browser cache, especially in non-trusted environments such as shared computers. </li>
    <li>Pages containing sensitive data that are cached on the server may be retrieved by, or sent to, the wrong user following an attack. This would lead to a serious information-disclosure problem. </li>
    <li>Caches&amp;nbsp;that exist at middle tier or database levels can also frequently be exploited by attackers.</li>
  </ul>
  <h1>How to Check</h1>
  <p>Use the following steps to ensure that your application does not perform caching when handling sensitive data:</p>
  <ol>
    <li>
      <p>
        <strong>Identify sensitive data. </strong>Sensitive data is any information that is kept secret and should be disclosed only to authorized parties. Common examples of sensitive data include, but are not limited to, names of customers, government issued ID numbers, credit card and other financial information, passwords, and private keys. Some industries, such as health care and banking, have regulatory standards that define sensitive information. Use regulatory requirements, as they apply to your application, to identify sensitive data. Sensitive data can be defined as follows:</p>
      <ul>
        <li>Information that either contains personally identifiable information or can be used to derive personally identifiable information that should not be shared with others. </li>
        <li>Information that a user provides that they would not want shared with other users of the application. </li>
        <li>Information that comes from an external trusted source that is not designed to be shared with users.</li>
      </ul>
    </li>
    <li>
      <p>
        <strong>Ensure that HTTP headers are used to prevent caching</strong>. Your application can use certain HTTP headers to prevent certain content from being cached. Ensure that the following techniques are used:</p>
      <ul>
        <li>
          <p>Verify that sensitive content contains the header "Pragma: No-Cache" in the outputted HTML document. Example: </p>
          <pre>&lt;HTML&gt;<br />    &lt;HEAD&gt;<br />        &lt;HTTP-EQUIV="PRAGMA" CONTENT="NO-CACHE"&gt;<br />        ...<br />    &lt;/HEAD&gt;<br />    &lt;BODY&gt;<br />        ...<br />    &lt;/BODY&gt;<br />&lt;/HTML&gt;</pre>
        </li>
        <li>
          <p>Verify that your application includes the "Cache-Control: no-cache" header in the outputted HTTP response. Example:</p>
          <p />
          <pre>Response.Cache.SetCacheability(HttpCacheability.NoCache);</pre>
        </li>
      </ul>
    </li>
    <li>
      <p>
        <strong>Ensure that output caching is disabled. </strong>Make sure that all pages in your application that contain sensitive information have output caching turned off by adding the <strong>@OutputCache directive</strong> as follows:</p>
      <pre>&lt;%@ OutputCache Location="None"%&gt;</pre>
      <p>If your application uses its own internal custom data caching layers they must also be designed so that&amp;nbsp;sensitive data is not cached.</p>
    </li>
    <li>
      <p>
        <strong>Verify that sensitive data is not stored in hidden fields or script variables. </strong>Check all hidden fields and client-side scripts in your application. Verify that no sensitive data is stored in a hidden field or a script variable. Ensure all sensitive data that needs to be passed back to the application is stored inside server-side sessions. An example of storing sensitive data into hidden fields:</p>
      <pre>&lt;input type="hidden" name="ccNum" value="4111111111111111"&gt; </pre>
    </li>
    <li>
      <p>
        <strong>Ensure that sensitive data is not cached within the application or in the database unless it is stored securely. </strong>Trace the paths that sensitive data takes through the system, paying particular attention to places where it may be combined with less sensitive data; mixed data is still just as sensitive, but is often handled like non-sensitive data. In each place where sensitive data is persisted, even temporarily, ensure that it is cleaned up after use and that access is controlled appropriately. If data is persisted beyond what is needed for immediate use, refactor the system so that only non-sensitive data is cached, or store the data in the cache securely (for example, encrypt it).</p>
    </li>
  </ol>
  <h1>Problem Example</h1>
  <p>Consider the following web page containing the cached username and password in the form of input fields. This web page can potentially find its way to the client cache, where a copy of it will remain indefinitely.</p>
  <pre>&lt;HTML&gt;<br />  ...<br />  &lt;INPUT type="hidden" id="username" name="username" value="Kilroy" /&gt;<br />  &lt;INPUT type="hidden" id="password" name="password" value="Iwashere" /&gt;<br />  ...<br />&lt;/HTML&gt;</pre>
  <hr />
  <p>Adapted from Microsoft patterns &amp; practices guidance. </p>