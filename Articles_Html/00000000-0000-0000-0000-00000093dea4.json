{
  "id": "00000000-0000-0000-0000-00000093dea4",
  "checksum": "724f459c5d52e42c9f532e7d94a4e1782cd728a2",
  "words": {
    "13": [
      "pre"
    ],
    "401": [
      "ol",
      "li",
      "pre",
      "pre"
    ],
    "6455": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "applies": [
      "h2"
    ],
    "to": [
      "h2",
      "h2",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "p",
      "p",
      "pre",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "html5": [
      "ul",
      "li",
      "p",
      "p",
      "ol",
      "li"
    ],
    "what": [
      "h2"
    ],
    "do": [
      "h2",
      "ul",
      "li",
      "a"
    ],
    "when": [
      "p",
      "h2",
      "p"
    ],
    "implementing": [
      "p",
      "p"
    ],
    "a": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "websocket": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong",
      "strong",
      "li",
      "li",
      "h2",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "h2",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "title"
    ],
    "server": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "p",
      "p",
      "p",
      "pre"
    ],
    "as": [
      "p",
      "pre"
    ],
    "part": [
      "p"
    ],
    "of": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "pre",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "an": [
      "p",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "web": [
      "p",
      "p"
    ],
    "application": [
      "p",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "check": [
      "p",
      "p",
      "ol",
      "li",
      "strong",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "title"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "strong",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "pre",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "a",
      "a",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "title",
      "title"
    ],
    "request": [
      "p",
      "ol",
      "li",
      "strong",
      "p",
      "p",
      "pre",
      "p"
    ],
    "header": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "strong",
      "li",
      "strong",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "for": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "strong",
      "li",
      "p",
      "p",
      "pre"
    ],
    "origin": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong",
      "li",
      "strong",
      "p",
      "p",
      "pre",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "title"
    ],
    "restrict": [
      "p",
      "p"
    ],
    "direct": [
      "p"
    ],
    "access": [
      "p",
      "p"
    ],
    "outside": [
      "p"
    ],
    "application’s": [
      "p"
    ],
    "intended": [
      "p",
      "p"
    ],
    "page": [
      "p"
    ],
    "why": [
      "h2"
    ],
    "by": [
      "p"
    ],
    "checking": [
      "p",
      "ol",
      "li"
    ],
    "you": [
      "p"
    ],
    "can": [
      "p"
    ],
    "allowing": [
      "p"
    ],
    "requests": [
      "p"
    ],
    "only": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li"
    ],
    "from": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "same": [
      "p",
      "ol",
      "li"
    ],
    "or": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "strong",
      "pre"
    ],
    "specified": [
      "p",
      "p",
      "p"
    ],
    "domains": [
      "p",
      "p"
    ],
    "this": [
      "p",
      "p",
      "ol",
      "li"
    ],
    "prevents": [
      "p"
    ],
    "potentially": [
      "p"
    ],
    "malicious": [
      "p"
    ],
    "connections": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "use": [
      "p",
      "ol",
      "li",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "guideline": [
      "p"
    ],
    "accept": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "strong"
    ],
    "browser": [
      "p"
    ],
    "how": [
      "h2"
    ],
    "configure": [
      "ol",
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "li"
    ],
    "sec-websocket-origin": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "strong"
    ],
    "value": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong",
      "strong",
      "li",
      "pre"
    ],
    "older": [
      "ol",
      "li",
      "strong"
    ],
    "clients": [
      "ol",
      "li",
      "strong"
    ],
    "newer": [
      "ol",
      "li",
      "strong"
    ],
    "clients.": [
      "ol",
      "li",
      "strong"
    ],
    "add": [
      "ol",
      "li"
    ],
    "code": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "configuration": [
      "ol",
      "li"
    ],
    "file": [
      "ol",
      "li"
    ],
    "in": [
      "ol",
      "li",
      "pre",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "accordance": [
      "ol",
      "li"
    ],
    "with": [
      "ol",
      "ol",
      "li",
      "li",
      "p"
    ],
    "your": [
      "ol",
      "li"
    ],
    "language": [
      "ol",
      "li"
    ],
    "example": [
      "ol",
      "ol",
      "li",
      "li",
      "h2",
      "h2"
    ],
    "php-websocket": [
      "ol",
      "li"
    ],
    "which": [
      "ol",
      "ol",
      "li",
      "li",
      "strong"
    ],
    "is": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "pre",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a"
    ],
    "open": [
      "ol",
      "li"
    ],
    "source": [
      "ol",
      "li"
    ],
    "php": [
      "ol",
      "li"
    ],
    "implementation": [
      "ol",
      "li"
    ],
    "library": [
      "ol",
      "li"
    ],
    "following": [
      "ol",
      "li",
      "p"
    ],
    "method": [
      "ol",
      "li"
    ],
    "call": [
      "ol",
      "li"
    ],
    "set": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "$server-setcheckorigin(true);.": [
      "ol",
      "li"
    ],
    "reads": [
      "ol",
      "li"
    ],
    "specify": [
      "ol",
      "li",
      "strong"
    ],
    "allowed": [
      "ol",
      "ol",
      "li",
      "strong",
      "li"
    ],
    "origins": [
      "ol",
      "ol",
      "li",
      "strong",
      "li"
    ],
    "will": [
      "ol",
      "li",
      "strong"
    ],
    "residing": [
      "ol",
      "li"
    ],
    "on": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "it": [
      "ol",
      "li"
    ],
    "“same": [
      "ol",
      "li"
    ],
    "origin”": [
      "ol",
      "li"
    ],
    "if": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "and": [
      "ol",
      "li",
      "p",
      "pre",
      "pre"
    ],
    "both": [
      "ol",
      "li"
    ],
    "reside": [
      "ol",
      "li"
    ],
    "webexample.com,": [
      "ol",
      "li"
    ],
    "origin=": [
      "ol",
      "li",
      "tt"
    ],
    "webexample.com.": [
      "ol",
      "li"
    ],
    "iterate": [
      "ol",
      "li",
      "strong"
    ],
    "through": [
      "ol",
      "li",
      "strong"
    ],
    "headers": [
      "ol",
      "li",
      "strong"
    ],
    "find": [
      "ol",
      "li",
      "strong"
    ],
    "null": [
      "ol",
      "li"
    ],
    "does": [
      "ol",
      "li"
    ],
    "not": [
      "ol",
      "li",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "match": [
      "ol",
      "li"
    ],
    "close": [
      "ol",
      "li",
      "pre"
    ],
    "connection": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "stream": [
      "ol",
      "li"
    ],
    "response": [
      "ol",
      "li",
      "pre"
    ],
    "$server-setcheckorigin(true);": [
      "tt"
    ],
    "webexample.com": [
      "tt"
    ],
    "$example_origins": [
      "pre",
      "pre"
    ],
    "=": [
      "pre",
      "pre"
    ],
    "array'example.com',’web.example.com’);\n\nforeach": [
      "pre"
    ],
    "$origin": [
      "pre"
    ],
    "{": [
      "pre"
    ],
    "$server-setallowedorigin($origin);": [
      "pre"
    ],
    "$origin_ips]": [
      "pre"
    ],
    "gethostbyname$origin);\n}\nif": [
      "pre"
    ],
    "!in_array($_server[\"remote_addr\"],": [
      "pre"
    ],
    "$origin_ips)": [
      "pre"
    ],
    "{\n//": [
      "pre"
    ],
    "send": [
      "pre",
      "pre"
    ],
    "response}\nelse": [
      "pre"
    ],
    "{//": [
      "pre"
    ],
    "begin": [
      "pre",
      "pre"
    ],
    "tunnel}": [
      "pre"
    ],
    "problem": [
      "h2"
    ],
    "shows": [
      "p"
    ],
    "handshake": [
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "client": [
      "p",
      "p",
      "p",
      "pre",
      "p"
    ],
    "doesn’t": [
      "p"
    ],
    "host": [
      "p"
    ],
    "1270.0.1,": [
      "p"
    ],
    "while": [
      "p"
    ],
    "sending": [
      "p"
    ],
    "192168.56.1.": [
      "p"
    ],
    "responds": [
      "p"
    ],
    "upgrade": [
      "p",
      "pre"
    ],
    "opens": [
      "p"
    ],
    "websockets": [
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "tunnel": [
      "p",
      "pre",
      "ul",
      "li",
      "a"
    ],
    "request\n\ncache-control:no-cache\nconnection:upgrade\ncookie:zdedebuggerpresent=php,phtml,php3\nhost:127.0.0.1:8000\norigin:http://192.168.56.1\npragma:no-cache\nsec-websocket-extensions:x-webkit-deflate-frame\nsec-websocket-key:r2umga2xhgvsan8uoo8xoa==\nconnection:": [
      "pre"
    ],
    "upgradesec-websocket-version:13\n\n\nserver": [
      "pre"
    ],
    "response\n\nconnection:upgrade\nsec-websocket-accept:6dntsira+zkxhdcl0oibmdi/by0=\nupgrade:websocket": [
      "pre"
    ],
    "solution": [
      "h2"
    ],
    "correct": [
      "p"
    ],
    "situation": [
      "p"
    ],
    "domain):": [
      "p"
    ],
    "//": [
      "pre"
    ],
    "pseudo": [
      "pre"
    ],
    "domain": [
      "pre"
    ],
    "webexample.com\n\nif": [
      "pre"
    ],
    "empty": [
      "pre"
    ],
    "!=": [
      "pre"
    ],
    "webexample.com\nthen": [
      "pre"
    ],
    "http": [
      "pre"
    ],
    "streamelse": [
      "pre"
    ],
    "proceed": [
      "pre"
    ],
    "get": [
      "pre"
    ],
    "ws//127.0.0.1:8000/demo": [
      "pre"
    ],
    "http/11\npragma:": [
      "pre"
    ],
    "no-cacheorigin:": [
      "pre"
    ],
    "http//192.168.56.1\nhost:": [
      "pre"
    ],
    "1270.0.1:8000\nsec-websocket-key:": [
      "pre"
    ],
    "hibzrh6epvt4ranabn6doa==upgrade:": [
      "pre"
    ],
    "websocketsec-websocket-extensions:": [
      "pre"
    ],
    "x-webkit-deflate-framecache-control:": [
      "pre"
    ],
    "no-cachecookie:": [
      "pre"
    ],
    "zdedebuggerpresent=phpphtml,php3\nconnection:": [
      "pre"
    ],
    "upgradesec-websocket-version:": [
      "pre"
    ],
    "guidelines": [
      "h2"
    ],
    "validate": [
      "ul",
      "li",
      "a"
    ],
    "data": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "coming": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "tls/ssl": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "encrypt": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "attribute": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "messages": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "latest": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "rfc": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "standard": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "tcp": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "via": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "checklist": [
      "h2"
    ],
    "items": [
      "h2"
    ],
    "validated": [
      "ul",
      "li",
      "a"
    ],
    "checked": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "used": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "tunneled": [
      "ul",
      "li",
      "a"
    ]
  },
  "tags": {
    "h2": [
      "Applies To",
      "What to Do",
      "Why",
      "When",
      "How",
      "Problem Example",
      "Solution Example",
      "WebSocket Guidelines",
      "WebSocket Checklist Items"
    ],
    "ul": [
      "HTML5",
      "Validate Data Coming from WebSockets\n Check the Origin Header in the WebSocket Handshake\n Use TLS/SSL to Encrypt WebSocket Connections\n Check the Origin Attribute of WebSocket Messages\n Use the Latest WebSocket RFC 6455 Standard\n Do Not Tunnel TCP via WebSockets",
      "Data Coming from WebSockets Is Validated\n The Origin Header in WebSocket Handshake is Checked\n TLS/SSL is Used to Encrypt WebSocket Connections\n The Origin Attribute of WebSocket Messages Is Checked\n Latest RFC 6455 Standard is Used\n TCP Is Not Tunneled via WebSockets"
    ],
    "li": [
      "HTML5",
      "Configure the WebSocket server to check the Sec-WebSocket-Origin header value (for older WebSocket clients) or Origin header value (for newer clients). Add code to the configuration file in accordance with your server language. For example, for PHP-WebSocket, which is an open source PHP implementation of a WebSocket server library, use the following method call to set origin checking: $server->setCheckOrigin(true);. This reads the value of  Sec-WebSocket-Origin  or  origin.",
      "Specify the allowed origins from which the server will accept connections.  For example, to accept connections only from an HTML5 application residing on the same server, configure it to accept connections from the “same origin” only. If the WebSocket server and the application both reside on web.example.com, configure the WebSocket server to accept only from Origin= web.example.com.",
      "Iterate through the request headers to find the Origin or Sec-WebSocket-Origin header. If the value is null or does not match the set of allowed origins, close the connection stream with a 401 response.",
      "Validate Data Coming from WebSockets",
      "Check the Origin Header in the WebSocket Handshake",
      "Use TLS/SSL to Encrypt WebSocket Connections",
      "Check the Origin Attribute of WebSocket Messages",
      "Use the Latest WebSocket RFC 6455 Standard",
      "Do Not Tunnel TCP via WebSockets",
      "Data Coming from WebSockets Is Validated",
      "The Origin Header in WebSocket Handshake is Checked",
      "TLS/SSL is Used to Encrypt WebSocket Connections",
      "The Origin Attribute of WebSocket Messages Is Checked",
      "Latest RFC 6455 Standard is Used",
      "TCP Is Not Tunneled via WebSockets"
    ],
    "p": [
      "When implementing a WebSocket server as a part of an HTML5 web application, check the request header for origin to restrict direct access outside of the application’s intended web page.",
      "By checking the origin, you can restrict access to the WebSocket server, allowing requests only from the same origin or specified domains. This prevents potentially malicious connections.",
      "Use this guideline when implementing a WebSocket server intended to accept HTML5 browser connections from specified domains.",
      "To check for origin:",
      "",
      "The following code shows a handshake from client to server. The server doesn’t check for the origin of the client. The host is 127.0.0.1, while the client sending the request is 192.168.56.1. The server responds with the Upgrade connection request and opens a WebSockets tunnel.",
      "",
      "To correct the situation, check for the specified origin (domain):",
      "Client Request:"
    ],
    "ol": [
      "Configure the WebSocket server to check the Sec-WebSocket-Origin header value (for older WebSocket clients) or Origin header value (for newer clients). Add code to the configuration file in accordance with your server language. For example, for PHP-WebSocket, which is an open source PHP implementation of a WebSocket server library, use the following method call to set origin checking: $server->setCheckOrigin(true);. This reads the value of  Sec-WebSocket-Origin  or  origin.\n Specify the allowed origins from which the server will accept connections.  For example, to accept connections only from an HTML5 application residing on the same server, configure it to accept connections from the “same origin” only. If the WebSocket server and the application both reside on web.example.com, configure the WebSocket server to accept only from Origin= web.example.com.\n Iterate through the request headers to find the Origin or Sec-WebSocket-Origin header. If the value is null or does not match the set of allowed origins, close the connection stream with a 401 response."
    ],
    "strong": [
      "Configure the WebSocket server to check the Sec-WebSocket-Origin header value (for older WebSocket clients) or Origin header value (for newer clients).",
      "Specify the allowed origins from which the server will accept connections.",
      "Iterate through the request headers to find the Origin or Sec-WebSocket-Origin header."
    ],
    "tt": [
      "$server->setCheckOrigin(true);",
      "Origin= web.example.com"
    ],
    "pre": [
      "$example_origins = array('example.com',’web.example.com’);\n\nforeach ($example_origins as $origin) {\n    $server->setAllowedOrigin($origin);\n    $origin_ips[] = gethostbyname($origin);\n}\nif (!in_array($_SERVER[\"REMOTE_ADDR\"], $origin_ips)) {\n\n// send 401 response\n}\nelse {\n// begin tunnel\n}",
      "Client Request:\n\nCache-Control:no-cache\nConnection:Upgrade\nCookie:ZDEDebuggerPresent=php,phtml,php3\nHost:127.0.0.1:8000\nOrigin:http://192.168.56.1\nPragma:no-cache\nSec-WebSocket-Extensions:x-webkit-deflate-frame\nSec-WebSocket-Key:R2umga2XHgVSaN8UOO8xOA==\nConnection: Upgrade\nSec-WebSocket-Version:13\n\n\nServer Response:\n\nConnection:Upgrade\nSec-WebSocket-Accept:6dNTSIra+ZKXHDcl0oIbmdi/BY0=\nUpgrade:websocket",
      "// pseudo code for server in domain web.example.com\n\nIF \n Origin Value IS empty OR != web.example.com\nTHEN\n Send HTTP Response of 401 AND close the stream\nELSE \n Proceed to upgrade connection request and begin the tunnel",
      "GET ws://127.0.0.1:8000/demo HTTP/1.1\nPragma: no-cache\nOrigin: http://192.168.56.1\nHost: 127.0.0.1:8000\nSec-WebSocket-Key: HIbzrH6epVT4RANaBn6dOA==\nUpgrade: websocket\nSec-WebSocket-Extensions: x-webkit-deflate-frame\nCache-Control: no-cache\nCookie: ZDEDebuggerPresent=php,phtml,php3\nConnection: Upgrade\nSec-WebSocket-Version: 13"
    ],
    "br": [
      "",
      ""
    ],
    "a": [
      "Validate Data Coming from WebSockets",
      "Check the Origin Header in the WebSocket Handshake",
      "Use TLS/SSL to Encrypt WebSocket Connections",
      "Check the Origin Attribute of WebSocket Messages",
      "Use the Latest WebSocket RFC 6455 Standard",
      "Do Not Tunnel TCP via WebSockets",
      "Data Coming from WebSockets Is Validated",
      "The Origin Header in WebSocket Handshake is Checked",
      "TLS/SSL is Used to Encrypt WebSocket Connections",
      "The Origin Attribute of WebSocket Messages Is Checked",
      "Latest RFC 6455 Standard is Used",
      "TCP Is Not Tunneled via WebSockets"
    ]
  },
  "links": [
    {
      "href": "00000000-0000-0000-0000-000000869806",
      "text": "Validate Data Coming from WebSockets"
    },
    {
      "href": "00000000-0000-0000-0000-00000093dea4",
      "text": "Check the Origin Header in the WebSocket Handshake"
    },
    {
      "href": "00000000-0000-0000-0000-0000005f2e4a",
      "text": "Use TLS/SSL to Encrypt WebSocket Connections"
    },
    {
      "href": "00000000-0000-0000-0000-000000736a21",
      "text": "Check the Origin Attribute of WebSocket Messages"
    },
    {
      "href": "00000000-0000-0000-0000-0000005326a8",
      "text": "Use the Latest WebSocket RFC 6455 Standard"
    },
    {
      "href": "00000000-0000-0000-0000-00000085bc2f",
      "text": "Do Not Tunnel TCP via WebSockets"
    },
    {
      "href": "00000000-0000-0000-0000-00000086537e",
      "text": "Data Coming from WebSockets Is Validated"
    },
    {
      "href": "00000000-0000-0000-0000-00000077e316",
      "text": "The Origin Header in WebSocket Handshake is Checked"
    },
    {
      "href": "bd870268-f104-4f6f-ba0d-6628dc34eb2a",
      "text": "TLS/SSL is Used to Encrypt WebSocket Connections"
    },
    {
      "href": "00000000-0000-0000-0000-0000002f39d7",
      "text": "The Origin Attribute of WebSocket Messages Is Checked"
    },
    {
      "href": "18d5564d-00a4-4afe-a853-707269df2566",
      "text": "Latest RFC 6455 Standard is Used"
    },
    {
      "href": "00000000-0000-0000-0000-00000091ce5a",
      "text": "TCP Is Not Tunneled via WebSockets"
    }
  ],
  "html": "<h2>Applies To</h2><ul><li> HTML5</li>\n</ul><h2>What to Do</h2><p>When implementing a WebSocket server as a part of an HTML5 web application, check the request header for origin to restrict direct access outside of the application’s intended web page.\n</p><h2>Why</h2><p>By checking the origin, you can restrict access to the WebSocket server, allowing requests only from the same origin or specified domains. This prevents potentially malicious connections.\n</p><h2>When</h2><p>Use this guideline when implementing a WebSocket server intended to accept HTML5 browser connections from specified domains.\n</p><h2>How</h2><p>To check for origin:\n</p><ol>\n<li> <strong>Configure the WebSocket server to check the Sec-WebSocket-Origin header value (for older WebSocket clients) or Origin header value (for newer clients).</strong> Add code to the configuration file in accordance with your server language. For example, for PHP-WebSocket, which is an open source PHP implementation of a WebSocket server library, use the following method call to set origin checking: <tt>$server-&gt;setCheckOrigin(true);</tt>. This reads the value of  Sec-WebSocket-Origin  or  origin.</li>\n<li> <strong>Specify the allowed origins from which the server will accept connections.</strong>  For example, to accept connections only from an HTML5 application residing on the same server, configure it to accept connections from the “same origin” only. If the WebSocket server and the application both reside on web.example.com, configure the WebSocket server to accept only from <tt>Origin= web.example.com</tt>.</li>\n<li> <strong>Iterate through the request headers to find the Origin or Sec-WebSocket-Origin header.</strong> If the value is null or does not match the set of allowed origins, close the connection stream with a 401 response.</li>\n</ol><pre>\n\n$example_origins = array('example.com',’web.example.com’);\n\nforeach ($example_origins as $origin) {\n    $server-&gt;setAllowedOrigin($origin);\n    $origin_ips[] = gethostbyname($origin);\n}\nif (!in_array($_SERVER[\"REMOTE_ADDR\"], $origin_ips)) {\n\n// send 401 response\n}\nelse {\n// begin tunnel\n}\n\n\n</pre><p>\n<br></p><h2>Problem Example</h2><p>The following code shows a handshake from client to server. The server doesn’t check for the origin of the client. The host is 127.0.0.1, while the client sending the request is 192.168.56.1. The server responds with the Upgrade connection request and opens a WebSockets tunnel.\n</p><pre>\n\nClient Request:\n\nCache-Control:no-cache\nConnection:Upgrade\nCookie:ZDEDebuggerPresent=php,phtml,php3\nHost:127.0.0.1:8000\nOrigin:http://192.168.56.1\nPragma:no-cache\nSec-WebSocket-Extensions:x-webkit-deflate-frame\nSec-WebSocket-Key:R2umga2XHgVSaN8UOO8xOA==\nConnection: Upgrade\nSec-WebSocket-Version:13\n\n\nServer Response:\n\nConnection:Upgrade\nSec-WebSocket-Accept:6dNTSIra+ZKXHDcl0oIbmdi/BY0=\nUpgrade:websocket\n\n</pre><p>\n<br></p><h2>Solution Example</h2><p>To correct the situation, check for the specified origin (domain):\n</p><pre>\n\n// pseudo code for server in domain web.example.com\n\nIF \n Origin Value IS empty OR != web.example.com\nTHEN\n Send HTTP Response of 401 AND close the stream\nELSE \n Proceed to upgrade connection request and begin the tunnel\n\n</pre><p>\nClient Request:\n</p><pre>\n\nGET ws://127.0.0.1:8000/demo HTTP/1.1\nPragma: no-cache\nOrigin: http://192.168.56.1\nHost: 127.0.0.1:8000\nSec-WebSocket-Key: HIbzrH6epVT4RANaBn6dOA==\nUpgrade: websocket\nSec-WebSocket-Extensions: x-webkit-deflate-frame\nCache-Control: no-cache\nCookie: ZDEDebuggerPresent=php,phtml,php3\nConnection: Upgrade\nSec-WebSocket-Version: 13\n\n</pre>\n<h2>WebSocket Guidelines</h2><ul><li> <a href=\"00000000-0000-0000-0000-000000869806\">Validate Data Coming from WebSockets</a></li>\n<li> <a href=\"00000000-0000-0000-0000-00000093dea4\">Check the Origin Header in the WebSocket Handshake</a></li>\n<li> <a href=\"00000000-0000-0000-0000-0000005f2e4a\">Use TLS/SSL to Encrypt WebSocket Connections</a></li>\n<li> <a href=\"00000000-0000-0000-0000-000000736a21\">Check the Origin Attribute of WebSocket Messages</a></li>\n<li> <a href=\"00000000-0000-0000-0000-0000005326a8\">Use the Latest WebSocket RFC 6455 Standard</a></li>\n<li> <a href=\"00000000-0000-0000-0000-00000085bc2f\">Do Not Tunnel TCP via WebSockets</a></li>\n</ul><h2>WebSocket Checklist Items</h2><ul><li> <a href=\"00000000-0000-0000-0000-00000086537e\">Data Coming from WebSockets Is Validated</a></li>\n<li> <a href=\"00000000-0000-0000-0000-00000077e316\">The Origin Header in WebSocket Handshake is Checked</a></li>\n<li> <a href=\"bd870268-f104-4f6f-ba0d-6628dc34eb2a\">TLS/SSL is Used to Encrypt WebSocket Connections</a></li>\n<li> <a href=\"00000000-0000-0000-0000-0000002f39d7\">The Origin Attribute of WebSocket Messages Is Checked</a></li>\n<li> <a href=\"18d5564d-00a4-4afe-a853-707269df2566\">Latest RFC 6455 Standard is Used</a></li>\n<li> <a href=\"00000000-0000-0000-0000-00000091ce5a\">TCP Is Not Tunneled via WebSockets</a></li>\n</ul>"
}