<h1>Applies to</h1>
  <ul>
    <li>PHP</li>
  </ul>
  <h1>What to Check For</h1>
  <p>Verify that a global exception handler is used to catch unhandled exceptions.</p>
  <h1>Why</h1>
  <p>Unhandled exceptions can be a serious stumbling block to an application's performance and security. Unhandled exceptions must be avoided as they can result in the application entering an unknown state and/or revealing sensitive internal application details. Using a global exception handler will prevent unhandled exceptions.</p>
  <h1>How to Check</h1>
  <p>To verify that a global exception handler is used to catch unhandled exceptions:</p>
  <ol>
    <li>
      <p>
        <strong>Verify that a global exception handler is set.</strong> Search for calls to the <em>set_exception_handler</em> function. </p>
      <li>
        <p>
          <strong>Verify that all code that throws exceptions is covered.</strong> Review code to make sure that all scripts that may throw exceptions are covered by the global exception handler.</p>
      </li>
    </li>
  </ol>
  <h1>How to Fix</h1>
  <p>To use a global exception handler to for unhandled exceptions:</p>
  <ol>
    <li>
      <p>
        <strong>Define a global exception handler. </strong>Write a function that will handle all uncaught exceptions. Place this function in the error handling subsystem. The global exception handler should accept the exception object as a parameter.</p>
      <li>
        <p>
          <strong>Log detailed exception information.</strong> Add code to the global exception handler to get as much information as possible from the exception object that is passed as the parameter. Log the </p>
        <li>
          <p>
            <strong>Show a simple error message.</strong> Be careful not to give away too much information to attackers. Write a simple message that lets the user know that the application has crashed, but the situation is under control. Add code that displays the error message to the global exception handler.</p>
          <li>
            <p />
            <strong>Clean up and exit gracefully.</strong> Add code to the global exception handler to do the following as necessary: <ul><li>Close any open file handles. <li>Remove any temporary files used by the application. <li>Check file system permissions and reset them if necessary. <li>Close any open connections, including database connections. <li>Free any external resources in use.</li></li></li></li></li></ul><li><p><strong>Set the global exception handler.</strong> Use the <em>set_exception_handler</em> function to set the global exception handler somewhere early on in the application flow. Add the call to the <em>set_exception_handler</em> early on in every script just to be sure.</p><p><strong>Note:</strong> certain types of errors cannot be handled with user-defined error handlers in scripts that have a global exception handler. Error handling is different from exception handling. Exception handling is a newer and more logical approach than error handling. It is recommended to use exception handling instead of error handling.</p></li></li>
        </li>
      </li>
    </li>
  </ol>
  <h1>Additional Resources</h1>
  <ul>
    <li>For more information about the <em>set_exception_handler</em> function and setting a global exception handler, see <a href="http://php.net/manual/en/function.set-exception-handler.php">http://php.net/manual/en/function.set-exception-handler.php</a><li>For more information about setting a global exception handler in PHP, see <a href="http://www.w3schools.com/php/func_error_set_exception_handler.asp">http://www.w3schools.com/php/func_error_set_exception_handler.asp</a><li>For more information about PHP exception handling, see <a href="http://www.w3schools.com/php/php_exception.asp">http://www.w3schools.com/php/php_exception.asp</a></li></li></li>
  </ul>