{
  "id": "00000000-0000-0000-0000-0000006bb239",
  "checksum": "fd13aabb22e910d00d9fb4fe81a76aae4f02514b",
  "words": {
    "applies": [
      "h2"
    ],
    "to": [
      "h2",
      "h2",
      "p",
      "p",
      "h2",
      "p",
      "h2",
      "p",
      "p"
    ],
    "aspnet": [
      "ul",
      "li"
    ],
    "what": [
      "h2"
    ],
    "check": [
      "h2",
      "h2",
      "p"
    ],
    "for": [
      "h2",
      "p",
      "ol",
      "li"
    ],
    "ensure": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong"
    ],
    "that": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li"
    ],
    "all": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li"
    ],
    "xml": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "strong",
      "li",
      "li",
      "li",
      "strong",
      "p",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "data": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "strong",
      "li",
      "p",
      "title"
    ],
    "is": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "title"
    ],
    "syntactically": [
      "p"
    ],
    "validated": [
      "p",
      "p",
      "title"
    ],
    "on": [
      "p"
    ],
    "the": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "server": [
      "p"
    ],
    "by": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "using": [
      "p",
      "ol",
      "li",
      "p",
      "p",
      "p",
      "pre",
      "title"
    ],
    "an": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "schema": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "title"
    ],
    "why": [
      "h2"
    ],
    "attacker": [
      "p"
    ],
    "passing": [
      "p"
    ],
    "malicious": [
      "p"
    ],
    "input": [
      "p"
    ],
    "can": [
      "p",
      "p"
    ],
    "attempt": [
      "p"
    ],
    "injection": [
      "p"
    ],
    "attacks": [
      "p"
    ],
    "aim": [
      "p"
    ],
    "exploit": [
      "p"
    ],
    "your": [
      "p"
    ],
    "application": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "strong"
    ],
    "overwriting": [
      "p"
    ],
    "disclose": [
      "p"
    ],
    "information": [
      "p"
    ],
    "from": [
      "p"
    ],
    "arbitrary": [
      "p"
    ],
    "uris": [
      "p"
    ],
    "or": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "p"
    ],
    "cause": [
      "p"
    ],
    "parser": [
      "p"
    ],
    "crash": [
      "p"
    ],
    "process": [
      "p"
    ],
    "slowly": [
      "p"
    ],
    "how": [
      "h2",
      "h2"
    ],
    "this": [
      "p"
    ],
    "problem": [
      "p"
    ],
    "use": [
      "p",
      "p"
    ],
    "following": [
      "p"
    ],
    "steps": [
      "p"
    ],
    "identify": [
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "strong"
    ],
    "areas": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong"
    ],
    "where": [
      "ol",
      "ol",
      "li",
      "li",
      "strong"
    ],
    "generates": [
      "ol",
      "li",
      "strong"
    ],
    "consumes": [
      "ol",
      "li",
      "strong"
    ],
    "during": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "design": [
      "ol",
      "li"
    ],
    "phase": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "enumerate": [
      "ol",
      "li"
    ],
    "generated": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "parsed": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "examine": [
      "ol",
      "li"
    ],
    "code": [
      "ol",
      "li"
    ],
    "implementation": [
      "ol",
      "li"
    ],
    "may": [
      "ol",
      "li"
    ],
    "have": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "been": [
      "ol",
      "li"
    ],
    "missed": [
      "ol",
      "li"
    ],
    "schemas": [
      "ol",
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "li",
      "strong"
    ],
    "which": [
      "ol",
      "li",
      "strong",
      "p",
      "p"
    ],
    "describe": [
      "ol",
      "li",
      "strong"
    ],
    "should": [
      "ol",
      "li"
    ],
    "associated": [
      "ol",
      "li"
    ],
    "such": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "as": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "xsd": [
      "ol",
      "li",
      "p"
    ],
    "file": [
      "ol",
      "li"
    ],
    "and": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "being": [
      "ol",
      "li"
    ],
    "used": [
      "ol",
      "li"
    ],
    "quality": [
      "ol",
      "li",
      "strong"
    ],
    "of": [
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "p",
      "p"
    ],
    "tightly": [
      "ol",
      "li",
      "p"
    ],
    "define": [
      "ol",
      "li"
    ],
    "structure": [
      "ol",
      "li"
    ],
    "format": [
      "ol",
      "li"
    ],
    "built-in": [
      "ol",
      "li"
    ],
    "custom": [
      "ol",
      "li"
    ],
    "defined": [
      "ol",
      "li"
    ],
    "element": [
      "ol",
      "li"
    ],
    "types": [
      "ol",
      "li"
    ],
    "xsdate.": [
      "ol",
      "li"
    ],
    "xsdate": [
      "em"
    ],
    "fix": [
      "h2"
    ],
    "be": [
      "p"
    ],
    "systemxml.xmlreader": [
      "p",
      "em"
    ],
    "systemxml.xmlreadersettings": [
      "p",
      "em"
    ],
    "classes": [
      "p"
    ],
    "instantiate": [
      "p",
      "p"
    ],
    "xmlreadersettings": [
      "p",
      "p",
      "em",
      "em"
    ],
    "object": [
      "p",
      "p",
      "p"
    ],
    "xmlschemasetschemas": [
      "p",
      "em"
    ],
    "property": [
      "p",
      "p"
    ],
    "add": [
      "p"
    ],
    "one": [
      "p"
    ],
    "more": [
      "p"
    ],
    "files": [
      "p"
    ],
    "then": [
      "p"
    ],
    "set": [
      "p"
    ],
    "validationtype": [
      "p",
      "em"
    ],
    "validationtypeschema.": [
      "p"
    ],
    "finally": [
      "p"
    ],
    "xmlreader": [
      "p",
      "em"
    ],
    "xmlreadercreate()": [
      "p",
      "em"
    ],
    "method": [
      "p"
    ],
    "takes": [
      "p"
    ],
    "validationtypeschema": [
      "em"
    ],
    "example": [
      "p",
      "p"
    ],
    "validation": [
      "p",
      "p"
    ],
    "errors": [
      "p"
    ],
    "will": [
      "p"
    ],
    "result": [
      "p"
    ],
    "in": [
      "p"
    ],
    "exception": [
      "p",
      "em"
    ],
    "systemxml;\nusing": [
      "pre"
    ],
    "systemxml.schema;\nxmlreadersettings": [
      "pre"
    ],
    "xmlsettings": [
      "pre"
    ],
    "=": [
      "pre",
      "pre",
      "pre"
    ],
    "new": [
      "pre"
    ],
    "xmlreadersettings);\nxmlsettings.schemas.add(\"http://www.example.com/types\",": [
      "pre"
    ],
    "\"typesxsd\");\nxmlsettings.validationtype": [
      "pre"
    ],
    "validationtypeschema;\nxmlreader": [
      "pre"
    ],
    "xmldata": [
      "pre"
    ],
    "xmlreadercreate(\"data.xml\",": [
      "pre"
    ],
    "xmlsettings;": [
      "pre"
    ],
    "describes": [
      "p"
    ],
    "a": [
      "p",
      "title"
    ],
    "person": [
      "p"
    ],
    "defines": [
      "p"
    ],
    "four": [
      "p"
    ],
    "elements": [
      "p"
    ],
    "name": [
      "p"
    ],
    "dob": [
      "p"
    ],
    "phone": [
      "p"
    ],
    "employmentstatus": [
      "p"
    ],
    "!--?xml": [
      "pre"
    ],
    "version=\"10\"?-->\n<xs:schema": [
      "pre"
    ],
    "xmlnsxs=\"http://www.w3.org/2001/xmlschema\">": [
      "pre"
    ],
    "xs:element": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "name=\"person\"": [
      "pre"
    ],
    "xs:complextype>": [
      "pre"
    ],
    "xs:sequence>": [
      "pre"
    ],
    "name=\"name\"": [
      "pre"
    ],
    "xs:simpletype>": [
      "pre",
      "pre",
      "pre"
    ],
    "xs:restriction": [
      "pre",
      "pre",
      "pre"
    ],
    "base=\"xsstring\">": [
      "pre",
      "pre",
      "pre"
    ],
    "xs:pattern": [
      "pre",
      "pre"
    ],
    "value=\"a-za-z": [
      "pre"
    ],
    "+\"></xs:pattern>": [
      "pre"
    ],
    "/xs:restriction>": [
      "pre",
      "pre",
      "pre"
    ],
    "/xs:simpletype>": [
      "pre",
      "pre",
      "pre"
    ],
    "/xs:element>": [
      "pre",
      "pre",
      "pre"
    ],
    "name=\"dob\"": [
      "pre"
    ],
    "type=\"xsdate\"></xs:element>": [
      "pre"
    ],
    "name=\"phone\"": [
      "pre"
    ],
    "value=\"0-9]{10}\"></xs:pattern>": [
      "pre"
    ],
    "name=\"employmentstatus\"": [
      "pre"
    ],
    "xs:enumeration": [
      "pre",
      "pre"
    ],
    "value=\"unemployed\"</xs:enumeration>": [
      "pre"
    ],
    "value=\"employed\"</xs:enumeration>": [
      "pre"
    ],
    "/xs:sequence>": [
      "pre"
    ],
    "/xs:complextype>": [
      "pre"
    ],
    "/xs:element>\n</xs:schema>": [
      "pre"
    ]
  },
  "tags": {
    "h2": [
      "Applies To",
      "What to Check For",
      "Why",
      "How To Check",
      "How To Fix"
    ],
    "ul": [
      "ASP.NET"
    ],
    "li": [
      "ASP.NET",
      "Identify all areas where the application generates or consumes XML data. During the design phase, enumerate all areas where XML data is generated or parsed by the application. Examine the code during the implementation phase for areas that may have been missed.",
      "Identify XML schemas which describe the XML data. All XML data generated or parsed should have an associated XML schema such as an XSD file, and ensure that the schema is being used.",
      "Ensure quality of XML schemas. Ensure that the XML schemas tightly define the structure and format of the XML data by using built-in and custom defined element types such as xs:date."
    ],
    "p": [
      "Ensure that all XML data is syntactically validated on the server by using an XML schema.",
      "An attacker passing malicious XML input can attempt XML injection attacks that aim to exploit your application by overwriting XML data, disclose information from arbitrary URIs, or cause the XML parser to crash or process slowly.",
      "To check for this problem, use the following steps:",
      "XML can be validated using the System.Xml.XmlReader and the System.Xml.XmlReaderSettings classes. Instantiate an XmlReaderSettings object and use the XmlSchemaSetSchemas property to add one or more XSD files. Then set the ValidationType property to ValidationType.Schema. Finally instantiate an XmlReader object using the XmlReader.Create() method which takes the XML Data and the XmlReaderSettings object.",
      "An example of validation using an XML Schema, XML validation errors will result in an Exception.",
      "An example of an XML Schema which describes a person and tightly defines four elements, name, dob, phone, and employmentStatus:"
    ],
    "ol": [
      "Identify all areas where the application generates or consumes XML data. During the design phase, enumerate all areas where XML data is generated or parsed by the application. Examine the code during the implementation phase for areas that may have been missed.\n Identify XML schemas which describe the XML data. All XML data generated or parsed should have an associated XML schema such as an XSD file, and ensure that the schema is being used.\n Ensure quality of XML schemas. Ensure that the XML schemas tightly define the structure and format of the XML data by using built-in and custom defined element types such as xs:date."
    ],
    "strong": [
      "Identify all areas where the application generates or consumes XML data.",
      "Identify XML schemas which describe the XML data.",
      "Ensure quality of XML schemas."
    ],
    "em": [
      "xs:date",
      "System.Xml.XmlReader",
      "System.Xml.XmlReaderSettings",
      "XmlReaderSettings",
      "XmlSchemaSetSchemas",
      "ValidationType",
      "ValidationType.Schema",
      "XmlReader",
      "XmlReader.Create()",
      "XmlReaderSettings",
      "Exception"
    ],
    "pre": [
      "using System.Xml;\nusing System.Xml.Schema;\nXmlReaderSettings xmlSettings = new XmlReaderSettings();\nxmlSettings.Schemas.Add(\"http://www.example.com/types\", \"types.xsd\");\nxmlSettings.ValidationType = ValidationType.Schema;\nXmlReader xmlData = XmlReader.Create(\"data.xml\", xmlSettings);",
      "<!--?xml version=\"1.0\"?-->\n<xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\">\n  <xs:element name=\"person\">\n    <xs:complextype>\n      <xs:sequence>\n        <xs:element name=\"name\">\n          <xs:simpletype>\n            <xs:restriction base=\"xs:string\">\n              <xs:pattern value=\"[a-zA-Z ]+\"></xs:pattern>\n            </xs:restriction>\n          </xs:simpletype>\n        </xs:element>\n        <xs:element name=\"dob\" type=\"xs:date\"></xs:element>\n        <xs:element name=\"phone\">\n          <xs:simpletype>\n            <xs:restriction base=\"xs:string\">\n              <xs:pattern value=\"[0-9]{10}\"></xs:pattern>\n            </xs:restriction>\n          </xs:simpletype>\n        </xs:element>\n        <xs:element name=\"employmentStatus\">\n          <xs:simpletype>\n            <xs:restriction base=\"xs:string\">\n              <xs:enumeration value=\"Unemployed\"></xs:enumeration>\n              <xs:enumeration value=\"Employed\"></xs:enumeration>\n            </xs:restriction>\n          </xs:simpletype>\n        </xs:element>\n      </xs:sequence>\n    </xs:complextype>\n  </xs:element>\n</xs:schema>"
    ]
  },
  "links": [],
  "html": "<h2>Applies To</h2><ul><li> ASP.NET</li>\n</ul><h2>What to Check For</h2><p>Ensure that all XML data is syntactically validated on the server by using an XML schema.\n</p><h2>Why</h2><p>An attacker passing malicious XML input can attempt XML injection attacks that aim to exploit your application by overwriting XML data, disclose information from arbitrary URIs, or cause the XML parser to crash or process slowly.\n</p><h2>How To Check</h2><p>To check for this problem, use the following steps:</p><ol>\n<li> <strong>Identify all areas where the application generates or consumes XML data.</strong> During the design phase, enumerate all areas where XML data is generated or parsed by the application. Examine the code during the implementation phase for areas that may have been missed.</li>\n<li> <strong>Identify XML schemas which describe the XML data.</strong> All XML data generated or parsed should have an associated XML schema such as an XSD file, and ensure that the schema is being used.</li>\n<li> <strong>Ensure quality of XML schemas.</strong> Ensure that the XML schemas tightly define the structure and format of the XML data by using built-in and custom defined element types such as <em>xs:date</em>.</li>\n</ol><h2>How To Fix</h2><p>XML can be validated using the <em>System.Xml.XmlReader</em> and the <em>System.Xml.XmlReaderSettings</em> classes. Instantiate an <em>XmlReaderSettings</em> object and use the <em>XmlSchemaSetSchemas</em> property to add one or more XSD files. Then set the <em>ValidationType</em> property to <em>ValidationType.Schema</em>. Finally instantiate an <em>XmlReader</em> object using the <em>XmlReader.Create()</em> method which takes the XML Data and the <em>XmlReaderSettings</em> object.\n</p><p>\nAn example of validation using an XML Schema, XML validation errors will result in an <em>Exception</em>.</p><pre>using System.Xml;\nusing System.Xml.Schema;\nXmlReaderSettings xmlSettings = new XmlReaderSettings();\nxmlSettings.Schemas.Add(\"http://www.example.com/types\", \"types.xsd\");\nxmlSettings.ValidationType = ValidationType.Schema;\nXmlReader xmlData = XmlReader.Create(\"data.xml\", xmlSettings);\n</pre><p>\nAn example of an XML Schema which describes a person and tightly defines four elements, name, dob, phone, and employmentStatus:</p><pre>&lt;!--?xml version=\"1.0\"?--&gt;\n&lt;xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"&gt;\n  &lt;xs:element name=\"person\"&gt;\n    &lt;xs:complextype&gt;\n      &lt;xs:sequence&gt;\n        &lt;xs:element name=\"name\"&gt;\n          &lt;xs:simpletype&gt;\n            &lt;xs:restriction base=\"xs:string\"&gt;\n              &lt;xs:pattern value=\"[a-zA-Z ]+\"&gt;&lt;/xs:pattern&gt;\n            &lt;/xs:restriction&gt;\n          &lt;/xs:simpletype&gt;\n        &lt;/xs:element&gt;\n        &lt;xs:element name=\"dob\" type=\"xs:date\"&gt;&lt;/xs:element&gt;\n        &lt;xs:element name=\"phone\"&gt;\n          &lt;xs:simpletype&gt;\n            &lt;xs:restriction base=\"xs:string\"&gt;\n              &lt;xs:pattern value=\"[0-9]{10}\"&gt;&lt;/xs:pattern&gt;\n            &lt;/xs:restriction&gt;\n          &lt;/xs:simpletype&gt;\n        &lt;/xs:element&gt;\n        &lt;xs:element name=\"employmentStatus\"&gt;\n          &lt;xs:simpletype&gt;\n            &lt;xs:restriction base=\"xs:string\"&gt;\n              &lt;xs:enumeration value=\"Unemployed\"&gt;&lt;/xs:enumeration&gt;\n              &lt;xs:enumeration value=\"Employed\"&gt;&lt;/xs:enumeration&gt;\n            &lt;/xs:restriction&gt;\n          &lt;/xs:simpletype&gt;\n        &lt;/xs:element&gt;\n      &lt;/xs:sequence&gt;\n    &lt;/xs:complextype&gt;\n  &lt;/xs:element&gt;\n&lt;/xs:schema&gt;\n</pre>"
}