<h1>Applies To</h1><p>All software applications.
</p><h1>Description</h1><p>Many applications assume that malicious software will never be executed on the local machine. However, in today's world of ubiquitous spyware, viruses, and Trojans, relying on this assumption can lead to the loss of sensitive information like credentials. If an attacker can somehow trick a user into installing malicious software, it may be possible to perform a local machine credential sniffing attack, in which the attacker recovers sensitive information from the file system or other local machine resources. An attacker may look through temporary files, registry keys, swap files, config files, and so on, to discover sensitive data such as username/password pairs, database connection strings, or other data that should be protected.
</p><h1>Impact</h1><ul><li>Information disclosure.</li>
</ul><h1>Vulnerabilities</h1><ul><li>Failure to use proper encryption techniques.</li>
<li>Using default or insecure permission sets.</li>
<li>Writing sensitive data to locations discoverable by attackers.</li>
</ul><h1>Countermeasures</h1><ul><li>Do not write any sensitive information out to the file system or registry in plaintext.</li>
<li>Encrypt any sensitive data that must be stored.</li>
<li>Explicitly set permissions on temporary files.</li>
<li>Keep sensitive information in memory for as little time as possible.</li>
<li>Overwrite sensitive data files on disk using a secure delete function.</li>
</ul><h1>Example</h1><p><strong>Sensitive Data in Temporary Files:</strong> To free up space in memory, an application writes an encryption key to the disk as a temporary file while it's not in use. When the encryption key is no longer used, the developer calls the File.Delete operation which deletes the file from disk.
</p><p>
In this case it is trivial for an attacker to open an application that allows her to read the contents of the file from disk, even after the delete function had been called.
</p><p>
To ensure the contents of this file is unrecoverable, it must be securely deleted by overwriting the bits on disk. The file should always be protected with encryption or with explicitly set permissions to make sure that the file is not discoverable before it is deleted.
</p><h1>Additional Resources</h1><ul><li>For more information on SDelete, see: <a href="http://technet.microsoft.com/en-us/sysinternals/bb897443.aspx">http://technet.microsoft.com/en-us/sysinternals/bb897443.aspx</a></li>
<li>For more information on Wipe: Secure File Deletion, see: <a href="http://wipe.sourceforge.net/">http://wipe.sourceforge.net/</a></li>
<li>For more information on Insecure Temporary Files, see: <a href="http://www.owasp.org/index.php/Insecure_Temporary_File">http://www.owasp.org/index.php/Insecure_Temporary_File</a></li>
</ul><h1>Related Items</h1><ul><li><a href="8482159c-5ec2-4b89-9c65-9af765030ff5">Attack: Information Disclosure Attack</a></li>
<li><a href="ad7b18e3-a8a0-4e87-b1a8-908e11449481">Attack: Network Credential Sniffing Attack</a></li>
<li><a href="88892358-450e-4bbc-afd9-ede9393e53a8">Attack: Sniff Memory for Secrets Attack</a></li>
<li><a href="da5df934-30f1-453b-9d5b-9a9288ef78c1">Attack: API Hijacking Attack</a></li>
</ul>
