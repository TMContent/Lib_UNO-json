<h1>Applies to</h1>
  <ul>
    <li>Microsoft&#174; Windows Communication Foundation (WCF) 3.5 <li>Microsoft Visual Studio&#174; 2008</li></li>
  </ul>
  <h1>Description</h1>
  <p>You should use a Windows service when you have to support transports like TCP, MSMQ, named pipes. Windows services have advantages over self hosting in that they give the benefit of automatic startup, service lifetime is controlled by the operating system, it is easier to run under a least privileged account and the Windows service host will restart your service if it fails. Windows services can be managed in the Service Control Manager in the Microsoft Management Console (MMC).</p>
  <p>Use the following steps to host your WCF service in a Windows Service.</p>
  <ol>
    <li>Create a Windows Service Project using Visual Studio 2008<li>Add service installers to the Windows Service Project<li>Override OnStart and OnStop methods to Start and stop the service inside the Windows Service, as shown in the following code example.<ol><pre>using System;<br />using System.Collections.Generic;<br />using System.ComponentModel;<br />using System.Data;<br />using System.Diagnostics;<br />using System.Linq;<br />using System.ServiceProcess;<br />using System.Text;<br />using System.ServiceModel;</pre><pre>namespace WindowsService1<br />&#123;<br />    public partial class WCFServiceHost1 : ServiceBase<br />    &#123;<br />        internal static ServiceHost myServiceHost = null; </pre><pre>        public WCFServiceHost1()<br />        &#123;<br />            InitializeComponent();<br />        &#125;<br />        protected override void OnStart(string&#91;&#93; args)<br />        &#123;<br />            if (myServiceHost &#33;= null)<br />            &#123;<br />                myServiceHost.Close();<br />            &#125;<br />            myServiceHost = new ServiceHost(typeof(Service1));<br />            myServiceHost.Open();<br />        &#125;<br />        protected override void OnStop()<br />        &#123;<br />            if (myServiceHost &#33;= null)<br />            &#123;<br />                myServiceHost.Close();<br />                myServiceHost = null;<br />            &#125;<br />        &#125;<br />    &#125;<br />&#125;</pre></ol><li>Install the Windows service using the InstallUtil.exe command from the Visual Studio 2008 command prompt.</li></li></li></li>
  </ol>
  <h1>Additional Resources</h1>
  <ul>
    <li>For more information see &#8220;How to Host WCF in a Windows Service Using TCP&#8221; at <a href="http://www.codeplex.com/WCFSecurityGuide/Wiki/Print.aspx?title=How&#37;20To&#37;20-&#37;20Host&#37;20WCF&#37;20in&#37;20a&#37;20Windows&#37;20Service&#37;20Using&#37;20TCP&version=1&action=Print">http://www.codeplex.com/WCFSecurityGuide/Wiki/Print.aspx?title=How&#37;20To&#37;20-&#37;20Host&#37;20WCF&#37;20in&#37;20a&#37;20Windows&#37;20Service&#37;20Using&#37;20TCP&version=1&action=Print</a><li>For more information see &#8220;How to: Host a WCF Service in a Managed Windows Service&#8221; at <a href="http://msdn.microsoft.com/en-us/library/ms733069.aspx">http://msdn.microsoft.com/en-us/library/ms733069.aspx</a><br /></li></li>
  </ul>
  <hr />
  <p>Adapted from Microsoft patterns & practices guidance.</p>