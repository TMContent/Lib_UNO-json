<h2>What to Do</h2>
  <p>Inputs should be decoded and canonicalized to the application's current internal representation before being validated (CWE-180). Make sure that the application does not decode the same input twice (CWE-174). Such errors could be used to bypass whitelist
 validation schemes by introducing dangerous inputs after they have been checked.</p>
  <h2>How</h2>
  <p>Use a built-in path canonicalization function (such as <em>realpath()</em> in C) that produces the canonical version of the pathname, which effectively removes ".." sequences and symbolic links (CWE-23, CWE-59). This includes:</p>
  <ul>
    <li>
      <em>realpath()</em> in C </li>
    <li>
      <em>getCanonicalPath()</em> in Java </li>
    <li>
      <em>GetFullPath()</em> in ASP.NET </li>
    <li>
      <em>realpath()</em> or <em>abs_path()</em> in Perl </li>
    <li>
      <em>realpath()</em> in PHP</li>
  </ul>
  <h2>Additional Resources</h2>
  <ul>
    <li>For more information about "CWE-180: Incorrect Behavior Order: Validate Before Canonicalize", please see
<a href="http://cwe.mitre.org/data/definitions/180.html">http://cwe.mitre.org/data/definitions/180.html</a></li>
    <li>For more information about "CWE-174: Double Decoding of the Same Data", please see
<a href="http://cwe.mitre.org/data/definitions/174.html">http://cwe.mitre.org/data/definitions/174.html</a></li>
    <li>For more information about "CWE-23: Relative Path Traversal", please see <a href="http://cwe.mitre.org/data/definitions/23.html">
http://cwe.mitre.org/data/definitions/23.html</a></li>
    <li>For more information about "CWE-59: Improper Link Resolution Before File Access ('Link Following')", please see
<a href="http://cwe.mitre.org/data/definitions/59.html">http://cwe.mitre.org/data/definitions/59.html</a></li>
  </ul>