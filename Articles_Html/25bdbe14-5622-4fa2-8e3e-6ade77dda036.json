{
  "id": "25bdbe14-5622-4fa2-8e3e-6ade77dda036",
  "checksum": "2a6c902013639f1eda1a5c38397045eca49dce07",
  "words": {
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "pre",
      "pre",
      "pre",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "pre",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "c#": [
      "ul",
      "li"
    ],
    "summary": [
      "h1"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "ul",
      "li",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "purpose": [
      "p"
    ],
    "of": [
      "p",
      "p",
      "ul",
      "li",
      "pre",
      "pre",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "this": [
      "p",
      "ul",
      "li",
      "p"
    ],
    "code": [
      "p",
      "p",
      "p"
    ],
    "snippet": [
      "p"
    ],
    "is": [
      "p",
      "p",
      "p"
    ],
    "illustrate": [
      "p"
    ],
    "how": [
      "p"
    ],
    "owner": [
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "p",
      "p"
    ],
    "an": [
      "p",
      "p",
      "pre",
      "p",
      "pre",
      "pre",
      "pre",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "rsa": [
      "p",
      "pre",
      "p",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "p",
      "p",
      "p",
      "title"
    ],
    "key": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "pre",
      "pre",
      "pre",
      "p",
      "pre",
      "pre",
      "pre",
      "pre",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "pre",
      "pre",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "title",
      "title"
    ],
    "pair": [
      "p",
      "p",
      "pre",
      "pre",
      "p",
      "title"
    ],
    "should": [
      "p",
      "ul",
      "li"
    ],
    "export": [
      "p",
      "pre",
      "title"
    ],
    "public": [
      "p",
      "ul",
      "li",
      "pre",
      "pre",
      "pre",
      "pre",
      "p",
      "pre",
      "pre",
      "pre",
      "ul",
      "li",
      "p",
      "pre",
      "p",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "data": [
      "p",
      "p",
      "pre",
      "pre",
      "p",
      "p",
      "p"
    ],
    "for": [
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "ul",
      "li",
      "pre",
      "p",
      "title"
    ],
    "distribution": [
      "p",
      "title"
    ],
    "we": [
      "p"
    ],
    "save": [
      "p"
    ],
    "xml": [
      "p",
      "pre",
      "pre",
      "pre"
    ],
    "file": [
      "p",
      "pre",
      "p",
      "pre",
      "ul",
      "li",
      "p",
      "pre",
      "p"
    ],
    "that": [
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "p"
    ],
    "can": [
      "p",
      "p",
      "ul",
      "li",
      "p"
    ],
    "be": [
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p"
    ],
    "communicated": [
      "p"
    ],
    "recipients": [
      "p"
    ],
    "who": [
      "p",
      "p"
    ],
    "will": [
      "p",
      "ul",
      "li"
    ],
    "then": [
      "p",
      "p"
    ],
    "able": [
      "p"
    ],
    "send": [
      "p",
      "ul",
      "li",
      "p"
    ],
    "encrypted": [
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "p",
      "p"
    ],
    "messages": [
      "p",
      "ul",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "p"
    ],
    "only": [
      "p",
      "ul",
      "li",
      "pre",
      "ul",
      "li",
      "p"
    ],
    "read": [
      "p",
      "ul",
      "li",
      "pre"
    ],
    "objective": [
      "h1"
    ],
    "securely": [
      "ul",
      "li",
      "p"
    ],
    "distribute": [
      "ul",
      "li"
    ],
    "component": [
      "ul",
      "li"
    ],
    "a": [
      "ul",
      "li",
      "ul",
      "li",
      "pre",
      "pre",
      "pre",
      "pre",
      "p",
      "p"
    ],
    "registry-stored": [
      "ul",
      "li"
    ],
    "keypair": [
      "ul",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "pre"
    ],
    "other": [
      "ul",
      "li"
    ],
    "parties": [
      "ul",
      "li"
    ],
    "use": [
      "ul",
      "li",
      "p",
      "p"
    ],
    "encrypt": [
      "ul",
      "li"
    ],
    "scenarios": [
      "h1"
    ],
    "distributed": [
      "ul",
      "li",
      "p"
    ],
    "client-server": [
      "ul",
      "li"
    ],
    "architecture": [
      "ul",
      "li"
    ],
    "where": [
      "ul",
      "li"
    ],
    "clients": [
      "ul",
      "li"
    ],
    "need": [
      "ul",
      "ul",
      "li",
      "li",
      "p"
    ],
    "confidential": [
      "ul",
      "li"
    ],
    "server": [
      "ul",
      "li"
    ],
    "but": [
      "ul",
      "li"
    ],
    "don't": [
      "ul",
      "li"
    ],
    "ever": [
      "ul",
      "li"
    ],
    "those": [
      "ul",
      "li"
    ],
    "application": [
      "ul",
      "li"
    ],
    "does": [
      "ul",
      "li",
      "p"
    ],
    "not": [
      "ul",
      "li",
      "ul",
      "li",
      "p"
    ],
    "want": [
      "ul",
      "li"
    ],
    "maintain": [
      "ul",
      "li",
      "p"
    ],
    "dedicated": [
      "ul",
      "li"
    ],
    "store": [
      "ul",
      "li",
      "pre"
    ],
    "encryption": [
      "ul",
      "li",
      "ul",
      "li",
      "p",
      "p"
    ],
    "purposes": [
      "ul",
      "li"
    ],
    "solution": [
      "h1"
    ],
    "example": [
      "h1",
      "h1",
      "p"
    ],
    "void": [
      "pre",
      "pre"
    ],
    "serializeandsaversapublickeyrsacryptoserviceprovider": [
      "pre"
    ],
    "myrsa": [
      "pre",
      "pre"
    ],
    "string": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "filename{": [
      "pre"
    ],
    "//": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "convert": [
      "pre",
      "pre"
    ],
    "passing": [
      "pre",
      "pre"
    ],
    "\"false\"": [
      "pre"
    ],
    "retrieves": [
      "pre"
    ],
    "instead": [
      "pre"
    ],
    "both": [
      "pre",
      "p",
      "pre",
      "ul",
      "li"
    ],
    "private": [
      "pre",
      "p",
      "pre",
      "pre",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p"
    ],
    "and": [
      "pre",
      "p",
      "p",
      "pre",
      "pre",
      "pre",
      "pre",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "pre",
      "pre",
      "p"
    ],
    "publickeyxml": [
      "pre"
    ],
    "=": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "myrsatoxmlstring(false);": [
      "pre"
    ],
    "write": [
      "pre",
      "pre"
    ],
    "out": [
      "pre"
    ],
    "location": [
      "pre"
    ],
    "your": [
      "pre"
    ],
    "choosing": [
      "pre"
    ],
    "streamwriter": [
      "pre"
    ],
    "keywriter": [
      "pre",
      "pre"
    ],
    "new": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "streamwriterfilename);": [
      "pre"
    ],
    "keywriterwrite(publickeyxml);": [
      "pre"
    ],
    "keywriterclose();}": [
      "pre"
    ],
    "problem": [
      "h1"
    ],
    "following": [
      "p",
      "p",
      "p",
      "p"
    ],
    "demonstrates": [
      "p"
    ],
    "generation": [
      "p"
    ],
    "storage": [
      "p"
    ],
    "keys": [
      "p",
      "ul",
      "li",
      "p"
    ],
    "on": [
      "p"
    ],
    "system": [
      "p",
      "ul",
      "li"
    ],
    "csp": [
      "pre"
    ],
    "class": [
      "pre"
    ],
    "automatically": [
      "pre"
    ],
    "generates": [
      "pre"
    ],
    "material//": [
      "pre"
    ],
    "during": [
      "pre"
    ],
    "constructionmyrsa": [
      "pre"
    ],
    "rsacryptoserviceprovider);": [
      "pre"
    ],
    "/////": [
      "pre",
      "pre"
    ],
    "in": [
      "pre",
      "p",
      "p",
      "p",
      "p"
    ],
    "registry": [
      "pre",
      "pre"
    ],
    "using": [
      "pre",
      "ul",
      "li",
      "pre",
      "p"
    ],
    "dpapi": [
      "pre"
    ],
    "acl": [
      "pre"
    ],
    "-": [
      "pre"
    ],
    "\"true\"": [
      "pre"
    ],
    "retrieves//": [
      "pre"
    ],
    "from": [
      "pre",
      "pre",
      "p",
      "title"
    ],
    "cspstring": [
      "pre"
    ],
    "keypairxml": [
      "pre"
    ],
    "myrsatoxmlstring(true);": [
      "pre"
    ],
    "open": [
      "pre",
      "p"
    ],
    "up": [
      "pre",
      "p"
    ],
    "into": [
      "pre"
    ],
    "stringstreamwriter": [
      "pre"
    ],
    "streamwriter@\"c:\\temp\\rsakeypair.xml\");keywriter.write(keypairxml);keywriter.close();": [
      "pre"
    ],
    "if": [
      "ul",
      "li"
    ],
    "becomes": [
      "ul",
      "li"
    ],
    "compromised": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "may": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "exposed": [
      "ul",
      "li"
    ],
    "confidentiality": [
      "ul",
      "li",
      "p"
    ],
    "any": [
      "ul",
      "li",
      "p"
    ],
    "could": [
      "ul",
      "li"
    ],
    "distributing": [
      "ul",
      "li"
    ],
    "allow": [
      "ul",
      "li"
    ],
    "anyone": [
      "ul",
      "li",
      "p"
    ],
    "with": [
      "ul",
      "li"
    ],
    "access": [
      "ul",
      "li"
    ],
    "decrypt": [
      "ul",
      "li",
      "p"
    ],
    "have": [
      "ul",
      "li"
    ],
    "been": [
      "ul",
      "li"
    ],
    "intended": [
      "ul",
      "li"
    ],
    "default": [
      "ul",
      "li"
    ],
    "size": [
      "ul",
      "li"
    ],
    "provide": [
      "ul",
      "li"
    ],
    "sufficient": [
      "ul",
      "li"
    ],
    "strength": [
      "ul",
      "li"
    ],
    "security": [
      "ul",
      "li"
    ],
    "test": [
      "h1"
    ],
    "case": [
      "h1"
    ],
    "classes": [
      "p"
    ],
    "must": [
      "p",
      "p"
    ],
    "included": [
      "p",
      "p"
    ],
    "project": [
      "p"
    ],
    "making": [
      "p"
    ],
    "sample": [
      "p"
    ],
    "provided": [
      "p"
    ],
    "above": [
      "p"
    ],
    "systemio;using": [
      "pre"
    ],
    "systemsecurity;using": [
      "pre"
    ],
    "systemsecurity.accesscontrol;using": [
      "pre"
    ],
    "systemsecurity.cryptography;using": [
      "pre"
    ],
    "systemtext;using": [
      "pre"
    ],
    "microsoftwin32;": [
      "pre"
    ],
    "execute": [
      "p"
    ],
    "c\\temp\\rsa_publickey.xml": [
      "pre"
    ],
    "see": [
      "p"
    ],
    "static": [
      "pre"
    ],
    "mainstring[]": [
      "pre"
    ],
    "args{": [
      "pre"
    ],
    "generate": [
      "pre"
    ],
    "filename": [
      "pre",
      "pre"
    ],
    "rsacryptoserviceprovider2048);": [
      "pre"
    ],
    "@\"c\\temp\\publickey.xml\";": [
      "pre"
    ],
    "serialize": [
      "pre"
    ],
    "serializeandsaversapublickeymyrsa,": [
      "pre"
    ],
    "filename;}": [
      "pre"
    ],
    "expected": [
      "h1"
    ],
    "result": [
      "h1"
    ],
    "output": [
      "p"
    ],
    "\"c\\temp\\rsa_publickey.xml\":": [
      "p"
    ],
    "rsakeyvalue>": [
      "pre"
    ],
    "modulus>": [
      "pre"
    ],
    "tnlagajwxxxyj+2qpx6q/mhzzf23xsvvovoblz1y7rbtlky4n2nlcgxfr6mqcttwkf": [
      "pre"
    ],
    "wshq7yeax6rvfhhrhdahlcsg7g3amw2bsobxwuijd81zenkywrw8t0gjnignr46+pq": [
      "pre"
    ],
    "o1xi7r9aa+pgaluhuzbbgjk2wialrjspltr5ojdr4vjlziag/vqmjvxiopfv1qi2hf": [
      "pre"
    ],
    "lm86jgicrd47l0k44tkwyhaj4pn1nsomjpeb0p9m9t3od/c+yzgkk+ij1nwqwg02h/": [
      "pre"
    ],
    "exroao6yfkb3xijnv69gv+zlgc+qssxs7bs7cdzqmqvsylxuxkyz5bqg++raywm4l0": [
      "pre"
    ],
    "56whtirg8mqq==": [
      "pre"
    ],
    "/modulus>": [
      "pre"
    ],
    "exponent>": [
      "pre"
    ],
    "aqab": [
      "pre"
    ],
    "/exponent></rsakeyvalue>": [
      "pre"
    ],
    "more": [
      "h1"
    ],
    "information": [
      "h1"
    ],
    "algorithm": [
      "p"
    ],
    "also": [
      "p"
    ],
    "knows": [
      "p"
    ],
    "as": [
      "p"
    ],
    "asymmetric": [
      "p"
    ],
    "cryptography": [
      "p",
      "p"
    ],
    "which": [
      "p"
    ],
    "distinct": [
      "p"
    ],
    "are": [
      "p"
    ],
    "created": [
      "p"
    ],
    "operations": [
      "p"
    ],
    "makes": [
      "p"
    ],
    "while": [
      "p"
    ],
    "decryption": [
      "p"
    ],
    "requires": [
      "p"
    ],
    "offers": [
      "p"
    ],
    "advantage": [
      "p"
    ],
    "over": [
      "p"
    ],
    "symmetric": [
      "p"
    ],
    "because": [
      "p"
    ],
    "secret": [
      "p"
    ],
    "used": [
      "p"
    ],
    "message": [
      "p",
      "p"
    ],
    "shared": [
      "p"
    ],
    "order": [
      "p",
      "p"
    ],
    "support": [
      "p"
    ],
    "recipient": [
      "p"
    ],
    "stored": [
      "p"
    ],
    "individual's": [
      "p"
    ],
    "however": [
      "p"
    ],
    "freely": [
      "p"
    ],
    "by": [
      "p"
    ],
    "wishes": [
      "p"
    ],
    "additional": [
      "h1"
    ],
    "resources": [
      "h1"
    ],
    "rsacryptoserviceprovider.net):": [
      "ul",
      "li"
    ],
    "http//msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrsacryptoserviceproviderclassctortopic.asp": [
      "ul",
      "li",
      "a"
    ],
    "adapted": [
      "p"
    ],
    "microsoft": [
      "p"
    ],
    "patterns": [
      "p"
    ],
    "&": [
      "p"
    ],
    "practices": [
      "p"
    ],
    "guidance": [
      "p"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "Summary",
      "Objective",
      "Scenarios",
      "Solution Example",
      "",
      "Problem Example",
      "Test Case",
      "Expected Result",
      "More Information",
      "Additional Resources"
    ],
    "ul": [
      "C#",
      "Securely distribute the public component of a registry-stored keypair that other parties can use to only encrypt messages for the key owner",
      "Distributed client-server architecture where clients need to send confidential encrypted messages to the server but don't need to ever read those messages Application does not want to maintain a dedicated key store for encryption purposes",
      "If the file system becomes compromised the private key may be exposed and the confidentiality of any encrypted messages using this keypair could be compromised. Distributing both public and private keys will allow anyone with access to the private key to decrypt messages that should have been intended for only the owner of the keypair. Default encryption key size may not provide sufficient strength and security",
      "RSACryptoServiceProvider(.NET): http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrsacryptoserviceproviderclassctortopic.asp"
    ],
    "li": [
      "C#",
      "Securely distribute the public component of a registry-stored keypair that other parties can use to only encrypt messages for the key owner",
      "Distributed client-server architecture where clients need to send confidential encrypted messages to the server but don't need to ever read those messages",
      "Application does not want to maintain a dedicated key store for encryption purposes",
      "If the file system becomes compromised the private key may be exposed and the confidentiality of any encrypted messages using this keypair could be compromised.",
      "Distributing both public and private keys will allow anyone with access to the private key to decrypt messages that should have been intended for only the owner of the keypair.",
      "Default encryption key size may not provide sufficient strength and security",
      "RSACryptoServiceProvider(.NET): http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrsacryptoserviceproviderclassctortopic.asp"
    ],
    "p": [
      "The purpose of this code snippet is to illustrate how the owner of an RSA key pair should export public key data for distribution. We save the key data to an XML file that can be communicated to recipients, who will then be able to send encrypted messages to the owner that only the key owner can read.",
      "The following example demonstrates the generation of an RSA key pair and storage of both the public and private keys on the file system.",
      "The following classes must be included in any project making use of the sample code provided above:",
      "Execute the following code and then open up the file",
      "to see only the public key data included.",
      "The following data is output to the file \"C:\\temp\\rsa_publickey.xml\":",
      "RSA is an algorithm for public key (also knows as asymmetric) cryptography in which distinct public and private keys are created. Encryption operations makes use of the public key while decryption requires the private key. This offers an advantage over symmetric cryptography because the secret key used to decrypt a message does not need to be shared in order to support encryption of messages to a recipient.",
      "The RSA private key must be securely stored in order to maintain the confidentiality of data encrypted using an individual's public RSA key. However, the public key can be freely distributed by the owner of the key pair to anyone who wishes to send an encrypted message to that owner.",
      "Adapted from Microsoft patterns & practices guidance."
    ],
    "pre": [
      "public void SerializeAndSaveRSAPublicKey(RSACryptoServiceProvider myRSA, string fileName){            // Convert the RSA public key to an xml string (passing \"false\" retrieves            // only the public key instead of both the private and public key            string publicKeyXml = myRSA.ToXmlString(false);",
      "// Write the XML data out to the file location of your choosing            StreamWriter keyWriter = new StreamWriter(fileName);            keyWriter.Write(publicKeyXml);            keyWriter.Close();}",
      "// The RSA CSP class automatically generates public and private key material// during constructionmyRSA = new RSACryptoServiceProvider();",
      "///// Store in the registry using DPAPI and a Registry ACL /////",
      "// Convert the RSA public key to an xml string - passing \"true\" retrieves// both the private and public key data from the RSA CSPstring keyPairXml = myRSA.ToXmlString(true);",
      "// Open up the key pair file and read into a stringStreamWriter keyWriter = new StreamWriter(@\"C:\\temp\\rsakeypair.xml\");keyWriter.Write(keyPairXml);keyWriter.Close();",
      "using System.IO;using System.Security;using System.Security.AccessControl;using System.Security.Cryptography;using System.Text;using Microsoft.Win32;",
      "C:\\temp\\rsa_publickey.xml",
      "static void Main(string[] args){    // Generate an RSA keypair and a filename for export    myRSA = new RSACryptoServiceProvider(2048);    string fileName = @\"C:\\temp\\publickey.xml\";",
      "// Serialize the public key from an RSA key pair and write to a file    SerializeAndSaveRSAPublicKey(myRSA, fileName);}",
      "<RSAKeyValue>",
      "<Modulus>                tnLAgAJwXXxYj+2QPX6q/mHZZf23xSvvovoBlZ1Y7RbTlkY4N2nlcGxfR6mQcTTWKf                WShQ7yEaX6rVfhhRhdaHLCsg7g3AmW2BsoBxWUijD81ZeNKyWrw8t0gjnigNR46+Pq                O1Xi7R9aA+PgaluhuZBBgJK2wIAlRJSPlTr5OjDr4vJlZiAG/VqmJVXioPfv1QI2hf                LM86JgIcrD47L0K44tKwyhAj4PN1nsomjPeb0P9m9t3od/c+yZGKk+iJ1nwQwG02H/                EXROaO6YFKb3xijNv69gv+ZLGc+qssXs7Bs7CdzqmQvSylxuXkYz5bQG++raYWm4l0                56WhtIRG8mqQ==           </Modulus>           <Exponent>                AQAB           </Exponent></RSAKeyValue>"
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "a": [
      "http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrsacryptoserviceproviderclassctortopic.asp"
    ],
    "hr": [
      ""
    ]
  },
  "links": [
    {
      "href": "http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrsacryptoserviceproviderclassctortopic.asp",
      "text": "http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrsacryptoserviceproviderclassctortopic.asp"
    }
  ],
  "html": "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>C#</li>\r\n  </ul>\r\n  <h1>Summary</h1>\r\n  <p>The purpose of this code snippet is to illustrate how the owner of an RSA key pair should export public key data for distribution. We save the key data to an XML file that can be communicated to recipients, who will then be able to send encrypted messages to the owner that only the key owner can read.</p>\r\n  <h1>Objective</h1>\r\n  <ul>\r\n    <li>Securely distribute the public component of a registry-stored keypair that other parties can use to only encrypt messages for the key owner</li>\r\n  </ul>\r\n  <h1>Scenarios</h1>\r\n  <ul>\r\n    <li>Distributed client-server architecture where clients need to send confidential encrypted messages to the server but don't need to ever read those messages <li>Application does not want to maintain a dedicated key store for encryption purposes</li></li>\r\n  </ul>\r\n  <h1>Solution Example</h1>\r\n  <pre>public void SerializeAndSaveRSAPublicKey(RSACryptoServiceProvider myRSA, string fileName)<br />&#123;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Convert the RSA public key to an xml string (passing \"false\" retrieves<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // only the public key instead of both the private and public key<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string publicKeyXml = myRSA.ToXmlString(false);</pre>\r\n  <pre>\r\n    <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Write the XML data out to the file location of your choosing<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; StreamWriter keyWriter = new StreamWriter(fileName);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; keyWriter.Write(publicKeyXml);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; keyWriter.Close();<br />&#125;</pre>\r\n  <h1>&nbsp;</h1>\r\n  <h1>Problem Example</h1>\r\n  <p>The following example demonstrates the generation of an RSA key pair and storage of both the public and private keys on the file system. </p>\r\n  <pre>// The RSA CSP class automatically generates public and private key material<br />// during construction<br />myRSA = new RSACryptoServiceProvider();</pre>\r\n  <pre>\r\n    <br />///// Store in the registry using DPAPI and a Registry ACL /////</pre>\r\n  <pre>\r\n    <br />// Convert the RSA public key to an xml string - passing \"true\" retrieves<br />// both the private and public key data from the RSA CSP<br />string keyPairXml = myRSA.ToXmlString(true);</pre>\r\n  <pre>\r\n    <br />// Open up the key pair file and read into a string<br />StreamWriter keyWriter = new StreamWriter(&#64;\"C:\\temp\\rsakeypair.xml\");<br />keyWriter.Write(keyPairXml);<br />keyWriter.Close();</pre>\r\n  <ul>\r\n    <li>If the file system becomes compromised the private key may be exposed and the confidentiality of any encrypted messages using this keypair could be compromised. <li>Distributing both public and private keys will allow anyone with access to the private key to decrypt messages that should have been intended for only the owner of the keypair. <li>Default encryption key size may not provide sufficient strength and security</li></li></li>\r\n  </ul>\r\n  <h1>Test Case</h1>\r\n  <p>The following classes must be included in any project making use of the sample code provided above:</p>\r\n  <pre>using System.IO;<br />using System.Security;<br />using System.Security.AccessControl;<br />using System.Security.Cryptography;<br />using System.Text;<br />using Microsoft.Win32;</pre>\r\n  <p>Execute the following code and then open up the file </p>\r\n  <pre>C:\\temp\\rsa_publickey.xml </pre>\r\n  <p>to see only the public key data included.</p>\r\n  <pre>static void Main(string&#91;&#93; args)<br />&#123;<br />&nbsp;&nbsp;&nbsp; // Generate an RSA keypair and a filename for export<br />&nbsp;&nbsp;&nbsp; myRSA = new RSACryptoServiceProvider(2048);<br />&nbsp;&nbsp;&nbsp; string fileName = &#64;\"C:\\temp\\publickey.xml\";</pre>\r\n  <pre>\r\n    <br />&nbsp;&nbsp;&nbsp; // Serialize the public key from an RSA key pair and write to a file<br />&nbsp;&nbsp;&nbsp; SerializeAndSaveRSAPublicKey(myRSA, fileName);<br />&#125;</pre>\r\n  <h1>Expected Result</h1>\r\n  <p>The following data is output to the file \"C:\\temp\\rsa_publickey.xml\":</p>\r\n  <pre>&lt;RSAKeyValue&gt;</pre>\r\n  <pre>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Modulus&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tnLAgAJwXXxYj&#43;2QPX6q/mHZZf23xSvvovoBlZ1Y7RbTlkY4N2nlcGxfR6mQcTTWKf<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WShQ7yEaX6rVfhhRhdaHLCsg7g3AmW2BsoBxWUijD81ZeNKyWrw8t0gjnigNR46&#43;Pq<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; O1Xi7R9aA&#43;PgaluhuZBBgJK2wIAlRJSPlTr5OjDr4vJlZiAG/VqmJVXioPfv1QI2hf<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LM86JgIcrD47L0K44tKwyhAj4PN1nsomjPeb0P9m9t3od/c&#43;yZGKk&#43;iJ1nwQwG02H/<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EXROaO6YFKb3xijNv69gv&#43;ZLGc&#43;qssXs7Bs7CdzqmQvSylxuXkYz5bQG&#43;&#43;raYWm4l0<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 56WhtIRG8mqQ==<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Modulus&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Exponent&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; AQAB<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Exponent&gt;<br />&lt;/RSAKeyValue&gt;</pre>\r\n  <h1>More Information</h1>\r\n  <p>RSA is an algorithm for public key (also knows as asymmetric) cryptography in which distinct public and private keys are created. Encryption operations makes use of the public key while decryption requires the private key. This offers an advantage over symmetric cryptography because the secret key used to decrypt a message does not need to be shared in order to support encryption of messages to a recipient. </p>\r\n  <p>The RSA private key must be securely stored in order to maintain the confidentiality of data encrypted using an individual's public RSA key. However, the public key can be freely distributed by the owner of the key pair to anyone who wishes to send an encrypted message to that owner. </p>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>RSACryptoServiceProvider(.NET): <a href=\"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrsacryptoserviceproviderclassctortopic.asp\">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrsacryptoserviceproviderclassctortopic.asp</a></li>\r\n  </ul>\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns & practices guidance.</p>"
}