<h2>What to Check For</h2>
<p>Verify that data passed to stored SQL procedures is parameterized.</p>
<h2>Why</h2>
<p>Using dynamic SQL in stored procedures to build queries that include user input may result in SQL injection vulnerabilities, unless user input is explicitly parameterized inside the stored procedures themselves and never treated as SQL syntax.</p>
<h2>How to Check</h2>
<p>To verify that dynamic SQL in stored procedures is parameterized:</p>
<ol>
<li>
<p><strong>Identify all stored procedures.</strong> Review the application code and examine the database(s) it uses to identify all stored procedures that use dynamic SQL.</p>
</li>
<li>
<p><strong>Review all stored procedures.</strong> Examine each stored procedure that uses dynamic SQL to make sure that user input is placed into parameters and never treated as SQL syntax.</p>
</li>
</ol>
<h2>How to Fix</h2>
<p>To parameterize dynamic SQL in stored procedures:</p>
<ol>
<li>
<p><strong>Identify all stored procedures.</strong> Review the application code and examine the database(s) it uses to identify all stored procedures that use dynamic SQL.</p>
</li>
<li>
<p><strong>Review all stored procedures.</strong> Examine each stored procedure to make sure that user input is placed in parameters and never treated as SQL syntax.</p>
</li>
<li>
<p><strong>Rewrite affected stored procedures.</strong> Rewrite each stored procedure that does not explicitly parameterize untrusted data. The exact syntax for this is different for different platforms. Refer to your database server vendor's documentation for information about using parameterized stored procedures.</p>
</li>
</ol>
