<h1>What to Check For</h1>
  <p>Ensure your application separates the account administration from the main application interface.</p>
  <h1>Why</h1>
  <p>Account administration requires higher privileges than the main application interface. Separating the two interfaces decreases the risk of a normal user being able to escalate privileges to that of an administrator.</p>
  <h1>How to Check</h1>
  <p>Take the following steps to verify that the account administration interface is separate from the main application interface: </p>
  <ol>
    <li>
      <p>
        <strong>Verify that your application allows only privileged users to administer all accounts. </strong>Review your application's design and verify that it specifies separation of administrative and main application interfaces.</p>
      <ul>
        <li>Check that only valid privileged users can access your application's administrative interface. <li>Ensure that your application's administrative interface uses a separate authentication module than the rest of your application, as this decreases the risk of privilege escalation attacks. <li>Check that different session IDs are used for the administrative and main application interfaces.</li></li></li>
      </ul>
      <li>
        <p>
          <strong>Ensure that your application allows users to administer their own accounts. </strong>Check that your application has been designed to let users administer their own accounts. Verify the following to enforce extra security precautions as users are allowed access to sensitive data:</p>
        <ul>
          <li>
            <p>
              <strong>User ID is tracked on server</strong>: Ensure that a user is tracked using a unique, randomly generated session ID, which is verified on the server side.</p>
            <li>
              <p>
                <strong>Re-authentication is enforced</strong>: Verify that privileged users are forced to re-authenticate when performing actions such as changing passwords.</p>
              <li>
                <p>
                  <strong>Account is modified in sections</strong>: Check that account information is split into separate sections such as credentials, personal data, contact information, and additional information, and is modified on a per-section basis to reduce the risk of information leakage when the user is updating his or her account.</p>
                <li>
                  <p>
                    <strong>Connection is secure</strong>: Verify that your application uses TLS when privileged users are performing transactions of sensitive nature.</p>
                  <li>
                    <p />
                    <strong>Server Configuration</strong>: Verify that your application's environment has enabled HTTPS so that transactions of a sensitive nature are transmitted only over HTTPS connections. Check if the <strong><forms></forms></strong> element in your application's web.config file has the <strong>requireSSL</strong> attribute set to <strong>true</strong> when performing forms-based authentication
                </li>
                </li>
              </li>
            </li>
          </li>
        </ul>
      </li>
    </li>
  </ol>
  <h1>Problem Example</h1>
  <p>The following snippet shows the HTTP requests that an administrator makes when accessing the main and administrative interfaces of the application. Because the administrative interface is not separated from the application, an administrator can use a single session to use and to administer the application. Therefore, a vulnerability such as cross-site scripting in the main application interface will expose the administrative interface as well.</p>
  <pre>GET /myapp/ HTTP/1.1<br />Accept: */*Accept-Encoding: gzip, deflate<br />User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)<br />Host: <a href="http://www.example.com/">www.example.com</a><br />Connection: Keep-Alive<br />Cookie: <strong>ASP.NET_SessionId=b25tnpbv1wwzp355rddxodv0<br /></strong>GET /myapp/admin.aspx HTTP/1.1<br />Accept: */*<br />Accept-Encoding: gzip, deflate<br />User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 2.0.50727; .NET CLR 1.1.4322)<br />Host: <a href="http://www.example.com/">www.example.com</a><br />Connection: Keep-Alive<br />Cookie: <strong>ASP.NET_SessionId=b25tnpbv1wwzp355rddxodv0</strong></pre>
  <h1>Additional Resources</h1>
  <ul>
    <li>To learn more about securing forms authentication, see <a href="http://support.microsoft.com/kb/813829">Help Secure Forms Authentication by Using Secure Sockets Layer (SSL) </a>.</li>
  </ul>
  <h1>Related Guideline</h1>
  <ul>
    <li>
      <a href="/article/fc7f567f-bbfc-434c-aaa5-23d79b458605">Guideline: Separate Account Administration from the Main Application Interface (ASP.NET)</a>
    </li>
  </ul>
  <hr />
  <p>Adapted from Microsoft patterns & practices guidance. </p>