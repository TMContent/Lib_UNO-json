<h1>What to Check For</h1>
  <p>Ensure that ASP.NET session state is properly protected from sniffing and guessing attacks by changing default values, disabling unused services and protecting your out-of-process state service.</p>
  <h1>Why</h1>
  <p>Attackers often use known attack vectors to attack an application; changing or disabling these services can minimize the attack surface of the application.</p>
  <p>Attackers will often use port scanners as a first attempt to learn more about the application under attack, and changing the port can impede their progress. Attackers may attack the Out-of-Process session state management server directly to gain access to the system.</p>
  <h1>How to Check</h1>
  <p>Take the following steps to ensure that the ASP.NET session state is properly protected:</p>
  <ol>
    <li>
      <p>
        <strong>Verify that the default session state port is changed. </strong>Verify that the port value in the following key is different from the default value of 42424:</p>
      <pre>HKLM\SYSTEM\CurrentControlSet\Services\aspnet_state\Parameters </pre>
    </li>
    <li>
      <p>
        <strong>Ensure the out-of-process session state management is properly secured. </strong>Keep in mind the following considerations when verifying the security of the out-of-process state management:</p>
      <ul>
        <li>Verify that the service operates using the Network Service account or another low-privileged account. </li>
        <li>Ensure that the session state communication channel is protected. </li>
        <li>Using Step 1, verify that the default session state port is changed. </li>
        <li>Verify that the session state connection strings are secured.</li>
      </ul>
    </li>
    <li>
      <p>
        <strong>If unused, verify that the ASP.NET state service is turned off.</strong>
      </p>
      <ol>
        <li>Navigate to Administrative Tools <strong>-&gt;</strong> Internet Information Services. </li>
        <li>Select the appropriate instance of IIS that is associated with your application. </li>
        <li>Right-click on the IIS instance and select Properties. </li>
        <li>Select the Configuration option under the Home Directory tab. </li>
        <li>Navigate to the Options tab. </li>
        <li>Verify that the "Enable session state" option in unchecked. </li>
      </ol>
    </li>
  </ol>
  <h1>Problem Example</h1>
  <p>
    <strong>Consider the following problem if you are using the default port for session state</strong>
  </p>
  <p>MyApp is a financial application that utilizes ASP.NET state service. Because the ASP.NET State Server is running with its default port configuration, it would be easy for a skilled attacker to discover and attack the service. </p>
  <p>
    <strong>Consider the following problem if your application does not require the session state</strong>
  </p>
  <p>MyApp is a monitoring tool. Although it does not require the ASP.NET state service, its administrators have not disabled the service, allowing a skilled attacker to compromise the application through the ASP.NET state service.</p>
  <br />
  <hr />
  <p>Adapted from Microsoft patterns & practices guidance. </p>