<h2>Applies To</h2><ul><li> Web Applications</li>
</ul>
<h2>What to Check For</h2><p>Make sure that search engines are blocked from indexing sensitive areas on your site.
</p>
<h2>Why</h2><p>If a search engine indexes sensitive data on your web site, an attacker will be able to retrieve that data from the search engine.
</p>
<h2>How to Check</h2><p>To make sure that search engines are blocked from indexing sensitive areas on your site:
</p><ol>
<li> <strong>Identify sensitive URI locations.</strong> Enumerate all the URIs that lead to sensitive data in your application. These URIs will usually correspond to the filesystem structure of the application, but sometimes they will be produced dynamically by the application itself. Whatever the case, consider how the URIs look from the perspective of the client when enumerating the locations of the sensitive data. It is strongly recommended to prevent indexing of any administrative pages.</li>
<li> <strong>Examine the robots.txt file.</strong> Make sure that the robots.txt file is present in the web root directory of the server and that is web accessible. Use a web browser to check if the robots.txt file is available at /robots.txt URI on your site. Review the robots.txt file to make sure that it includes rules that block search engines from indexing each of the sensitive URIs on your site.</li>
<li> <strong>Examine search engine caches.</strong> Use popular web search engines to execute search queries that include sensitive URI locations on your server.  See if these locations have already been cached. If sensitive data has already been cached, it should be purged automatically some time later when the search engine crawls your site again and parses the robots.txt file correctly. If that is not acceptable, consider contacting the search engine operator and asking them to remove the sensitive data from their caches.</li>
</ol>
<h2>How to Fix</h2><p>To block search engines from indexing sensitive data on your site by using a robots.txt file:
</p><ol>
<li> <strong>Identify sensitive URI locations.</strong> Enumerate all the URIs that lead to sensitive data in your application. These URIs will usually correspond to the filesystem structure of the application, but sometimes they will be produced dynamically by the application itself. Whatever the case, consider how the URIs look from the perspective of the client when enumerating the locations of the sensitive data. It is strongly recommended to prevent indexing of any administrative pages.</li>
<li> <strong>Write a robots.txt file.</strong> The robots.txt file has a simple syntax. Study the reference at the link at the bottom of this page, and write a robots.txt file that prevents indexing of all the sensitive URI locations.</li>
<li> <strong>Upload the robots.txt file to the web site.</strong> Upload the robots.txt file to the web root directory on your application server. </li>
<li> <strong>(Optional) Examine search engine caches.</strong> Use popular web search engines to execute search queries that include sensitive URI locations on your server. See if these locations have already been cached. If sensitive data has already been cached, it should be purged automatically some time later when the search engine crawls your site again and parses the robots.txt file correctly. If that is not acceptable, consider contacting the search engine operator and asking them to remove the sensitive data from their caches.</li>
</ol>
<h2>Additional Resources</h2><ul><li> For information about the robots.txt file syntax, see <a href="http://www.w3.org/TR/html4/appendix/notes.html#h-B.4.1.1">http://www.w3.org/TR/html4/appendix/notes.html#h-B.4.1.1</a></li>
</ul>