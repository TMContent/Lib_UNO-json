{
  "id": "0089dded-bd3d-4513-b479-624629634b4a",
  "checksum": "0456d9cb3201b2a200acdbbad6025f5d2cc14dcc",
  "words": {
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p"
    ],
    "net": [
      "p"
    ],
    "applications": [
      "p",
      "p",
      "p"
    ],
    "java": [
      "p",
      "p",
      "ul",
      "li"
    ],
    "and": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "written": [
      "p"
    ],
    "in": [
      "p",
      "pre",
      "p"
    ],
    "any": [
      "p",
      "ul",
      "li",
      "p"
    ],
    "other": [
      "p"
    ],
    "language": [
      "p"
    ],
    "which": [
      "p",
      "p"
    ],
    "supports": [
      "p"
    ],
    "reflection": [
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "title"
    ],
    "description": [
      "h1"
    ],
    "is": [
      "p",
      "p",
      "p",
      "p",
      "pre"
    ],
    "a": [
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p",
      "pre"
    ],
    "programming": [
      "p"
    ],
    "technique": [
      "p"
    ],
    "provided": [
      "p",
      "pre"
    ],
    "by": [
      "p",
      "pre"
    ],
    "an": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "api": [
      "p",
      "ul",
      "li"
    ],
    "that": [
      "p",
      "p",
      "p"
    ],
    "let's": [
      "p"
    ],
    "you": [
      "p"
    ],
    "treat": [
      "p"
    ],
    "class": [
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "pre"
    ],
    "definitions": [
      "p"
    ],
    "themselves": [
      "p"
    ],
    "as": [
      "p",
      "p",
      "p",
      "p"
    ],
    "objects": [
      "p",
      "p"
    ],
    "it": [
      "p",
      "ul",
      "li"
    ],
    "gives": [
      "p"
    ],
    "the": [
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "programmer": [
      "p"
    ],
    "way": [
      "p"
    ],
    "view": [
      "p",
      "p"
    ],
    "modify": [
      "p",
      "p"
    ],
    "members": [
      "p"
    ],
    "such": [
      "p",
      "p"
    ],
    "constructors": [
      "p"
    ],
    "methods": [
      "p"
    ],
    "interfaces": [
      "p"
    ],
    "fields": [
      "p"
    ],
    "at": [
      "p",
      "p"
    ],
    "runtime": [
      "p",
      "p"
    ],
    "this": [
      "p",
      "ul",
      "li"
    ],
    "often": [
      "p"
    ],
    "used": [
      "p",
      "p",
      "p"
    ],
    "for": [
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li"
    ],
    "of": [
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "ul",
      "li",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p"
    ],
    "development": [
      "p"
    ],
    "tools": [
      "p"
    ],
    "browsers": [
      "p"
    ],
    "or": [
      "p",
      "p",
      "p"
    ],
    "gui": [
      "p"
    ],
    "designers": [
      "p"
    ],
    "however": [
      "p"
    ],
    "if": [
      "p",
      "ul",
      "li"
    ],
    "untrusted": [
      "p"
    ],
    "user": [
      "p",
      "li",
      "p",
      "pre"
    ],
    "input": [
      "p",
      "ul",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li"
    ],
    "manipulate": [
      "p"
    ],
    "injection": [
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "title"
    ],
    "possible": [
      "p"
    ],
    "attackers": [
      "p"
    ],
    "may": [
      "p"
    ],
    "be": [
      "p",
      "p",
      "p"
    ],
    "able": [
      "p"
    ],
    "classes": [
      "p"
    ],
    "are": [
      "p"
    ],
    "even": [
      "p"
    ],
    "run": [
      "p"
    ],
    "arbitrary": [
      "p",
      "ul",
      "li"
    ],
    "code": [
      "p",
      "li",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "impact": [
      "h1"
    ],
    "execution": [
      "ul",
      "li"
    ],
    "code\nbypass": [
      "ul"
    ],
    "security": [
      "ul",
      "li"
    ],
    "controls": [
      "ul",
      "li"
    ],
    "bypass": [
      "li"
    ],
    "vulnerabilities": [
      "h1"
    ],
    "failure": [
      "ul",
      "li"
    ],
    "validate": [
      "ul",
      "li",
      "ul",
      "li"
    ],
    "input\nvalidation": [
      "ul"
    ],
    "library": [
      "ul",
      "li"
    ],
    "based": [
      "ul",
      "ul",
      "li",
      "li",
      "p"
    ],
    "solely": [
      "ul",
      "li"
    ],
    "on": [
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li"
    ],
    "name\nloading": [
      "ul"
    ],
    "libraries": [
      "ul",
      "li"
    ],
    "external": [
      "ul",
      "li"
    ],
    "validation": [
      "li",
      "ul",
      "li",
      "a"
    ],
    "name": [
      "li",
      "p",
      "pre"
    ],
    "loading": [
      "li"
    ],
    "countermeasures": [
      "h1"
    ],
    "use": [
      "ul",
      "ul",
      "li",
      "li",
      "li"
    ],
    "vigorous": [
      "ul",
      "li"
    ],
    "whitelist": [
      "ul",
      "li"
    ],
    "style": [
      "ul",
      "li"
    ],
    "checking": [
      "ul",
      "li"
    ],
    "received": [
      "ul",
      "li"
    ],
    "from": [
      "ul",
      "li"
    ],
    "user\nuse": [
      "ul"
    ],
    "signed": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "certificates": [
      "ul",
      "li"
    ],
    "strongly": [
      "ul",
      "li"
    ],
    "assemblies": [
      "ul",
      "li"
    ],
    "only": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "load": [
      "ul",
      "li"
    ],
    "passes": [
      "ul",
      "li"
    ],
    "check": [
      "ul",
      "li"
    ],
    "example": [
      "h1",
      "p"
    ],
    "common": [
      "p"
    ],
    "attack": [
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "a",
      "a",
      "li",
      "li",
      "a",
      "a",
      "li",
      "li",
      "a",
      "a",
      "title"
    ],
    "occurs": [
      "p"
    ],
    "when": [
      "p"
    ],
    "attacker": [
      "p",
      "p"
    ],
    "can": [
      "p"
    ],
    "inject": [
      "p",
      "p"
    ],
    "provide": [
      "p"
    ],
    "less": [
      "p"
    ],
    "secure": [
      "p"
    ],
    "implements": [
      "p"
    ],
    "same": [
      "p"
    ],
    "interface": [
      "p"
    ],
    "one": [
      "p"
    ],
    "meant": [
      "p"
    ],
    "instantiated": [
      "p"
    ],
    "below": [
      "p"
    ],
    "creates": [
      "p"
    ],
    "uses": [
      "p"
    ],
    "http": [
      "p"
    ],
    "connection": [
      "p",
      "p",
      "p"
    ],
    "supplied": [
      "p"
    ],
    "string": [
      "p",
      "pre",
      "pre",
      "p"
    ],
    "defines": [
      "p"
    ],
    "type": [
      "p"
    ],
    "import": [
      "pre"
    ],
    "javalang.reflect.*;\nimport": [
      "pre"
    ],
    "javanet.*;\nclass": [
      "pre"
    ],
    "examplereflection": [
      "pre"
    ],
    "{": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "public": [
      "pre"
    ],
    "static": [
      "pre",
      "pre"
    ],
    "void": [
      "pre"
    ],
    "mainstring[]": [
      "pre"
    ],
    "args": [
      "pre"
    ],
    "mycon": [
      "pre",
      "p",
      "tt"
    ],
    "=": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "\"httpsurlconnection\"": [
      "pre",
      "p",
      "tt"
    ],
    "//": [
      "pre"
    ],
    "httpsurlconnection": [
      "pre",
      "p",
      "tt"
    ],
    "some": [
      "pre"
    ],
    "manner": [
      "pre"
    ],
    "urlconnection": [
      "pre",
      "p",
      "tt"
    ],
    "c": [
      "pre"
    ],
    "urlconnection)createconnection(mycon);": [
      "pre"
    ],
    "cconnect();": [
      "pre"
    ],
    "}": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "object": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "createconnectionstring": [
      "pre"
    ],
    "null": [
      "pre"
    ],
    "try": [
      "pre"
    ],
    "classdef": [
      "pre"
    ],
    "classforname(name);": [
      "pre"
    ],
    "classdefnewinstance();": [
      "pre"
    ],
    "catch": [
      "pre",
      "pre",
      "pre"
    ],
    "instantiationexception": [
      "pre"
    ],
    "e": [
      "pre",
      "pre",
      "pre"
    ],
    "systemout.println(e);": [
      "pre",
      "pre",
      "pre"
    ],
    "illegalaccessexception": [
      "pre"
    ],
    "classnotfoundexception": [
      "pre"
    ],
    "return": [
      "pre"
    ],
    "}}": [
      "pre"
    ],
    "now": [
      "p"
    ],
    "suppose": [
      "p"
    ],
    "could": [
      "p"
    ],
    "\"httpurlconnection\"": [
      "p",
      "tt"
    ],
    "into": [
      "p"
    ],
    "instead": [
      "p",
      "p"
    ],
    "then": [
      "p"
    ],
    "ssl": [
      "p"
    ],
    "secured": [
      "p"
    ],
    "insecure": [
      "p"
    ],
    "will": [
      "p"
    ],
    "created": [
      "p"
    ],
    "leaving": [
      "p"
    ],
    "data": [
      "p"
    ],
    "transit": [
      "p"
    ],
    "unprotected": [
      "p"
    ],
    "application": [
      "p"
    ],
    "does": [
      "p"
    ],
    "not": [
      "p"
    ],
    "know": [
      "p"
    ],
    "differently": [
      "p"
    ],
    "because": [
      "p"
    ],
    "both": [
      "p"
    ],
    "httpurlconnection": [
      "p",
      "tt"
    ],
    "implement": [
      "p"
    ],
    "additional": [
      "h1"
    ],
    "resources": [
      "h1"
    ],
    "more": [
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li"
    ],
    "information": [
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li"
    ],
    "see": [
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li"
    ],
    "https//www.owasp.org/index.php/reflection_injection\nfor": [
      "ul"
    ],
    "trail": [
      "ul",
      "li"
    ],
    "http//docs.oracle.com/javase/tutorial/reflect/index.html\nfor": [
      "ul"
    ],
    "reflections": [
      "ul",
      "li"
    ],
    "http//msdn.microsoft.com/en-us/magazine/cc163408.aspx": [
      "ul",
      "li",
      "a"
    ],
    "https//www.owasp.org/index.php/reflection_injection": [
      "li",
      "a"
    ],
    "http//docs.oracle.com/javase/tutorial/reflect/index.html": [
      "li",
      "a"
    ],
    "related": [
      "h1"
    ],
    "items": [
      "h1"
    ],
    "command": [
      "ul",
      "li",
      "a"
    ],
    "attackattack:": [
      "ul",
      "ul"
    ],
    "client-side": [
      "ul",
      "li",
      "a"
    ],
    "server-side": [
      "ul",
      "li",
      "a"
    ]
  },
  "tags": {
    "h1": [
      "Applies To",
      "Description",
      "Impact",
      "Vulnerabilities",
      "Countermeasures",
      "Example",
      "Additional Resources",
      "Related Items"
    ],
    "p": [
      ".NET applications, Java applications, and applications written in any other language which supports reflection.",
      "Reflection is a programming technique provided by an API that let's you treat class definitions themselves as objects. It gives the programmer a way to view and modify class members such as constructors, methods, interfaces, and fields at runtime. This is often used for the of development tools such as class browsers or GUI designers. However, if untrusted user input is used to manipulate objects at runtime, injection is possible. Attackers may be able to view or modify which classes are used or even run arbitrary code.",
      "A common example of a reflection injection attack occurs when an attacker can inject code to provide the name of a less secure class that implements the same interface as the one meant to be instantiated. The Java code below creates and uses an HTTP connection based on a user supplied string that defines the type.",
      "Now suppose an attacker could inject \"HttpUrlConnection\" into the string mycon instead of \"HttpsUrlConnection\". Then, instead of an SSL secured connection, an insecure connection will be created, leaving the data in transit unprotected. The application does not know any differently, because both HttpUrlConnection and HttpsUrlConnection implement UrlConnection."
    ],
    "ul": [
      "Execution of arbitrary code.\nBypass of security controls.",
      "Failure to validate input.\nValidation of a library based solely on the name.\nLoading libraries based on external input.",
      "Validate input: Use vigorous whitelist style input checking of any input received from the user.\nUse signed certificates: Use strongly signed assemblies only, only load a class if it passes this check.",
      "For more information on Reflection Injection, see: https://www.owasp.org/index.php/Reflection_injection\nFor more information on Trail: The Reflection API for Java, see the http://docs.oracle.com/javase/tutorial/reflect/index.html\nFor more information on Reflections on Reflection, see: http://msdn.microsoft.com/en-us/magazine/cc163408.aspx",
      "Attack: Command Injection Attack\nAttack: Client-side Validation Attack\nAttack: Server-Side Code Injection Attack"
    ],
    "li": [
      "Execution of arbitrary code.",
      "Bypass of security controls.",
      "Failure to validate input.",
      "Validation of a library based solely on the name.",
      "Loading libraries based on external input.",
      "Validate input: Use vigorous whitelist style input checking of any input received from the user.",
      "Use signed certificates: Use strongly signed assemblies only, only load a class if it passes this check.",
      "For more information on Reflection Injection, see: https://www.owasp.org/index.php/Reflection_injection",
      "For more information on Trail: The Reflection API for Java, see the http://docs.oracle.com/javase/tutorial/reflect/index.html",
      "For more information on Reflections on Reflection, see: http://msdn.microsoft.com/en-us/magazine/cc163408.aspx",
      "Attack: Command Injection Attack",
      "Attack: Client-side Validation Attack",
      "Attack: Server-Side Code Injection Attack"
    ],
    "pre": [
      "import java.lang.reflect.*;\nimport java.net.*;\nclass ExampleReflection\n {\n   public static void main(String[] args)\n {\n        String mycon = \"HttpsUrlConnection\";\n         // HttpsUrlConnection is a string provided by the user in some manner\n        URLConnection c = (URLConnection)createConnection(mycon);\n        c.connect();\n   }\n   static Object createConnection(String name)\n {\n        Object object = null;\n        try {\n                Class classdef = Class.forName(name);\n                object = classdef.newInstance();\n        }\n catch (InstantiationException e)\n {\n                System.out.println(e);\n        }\n catch\n (IllegalAccessException e)\n {\n                System.out.println(e);\n        }\n catch (ClassNotFoundException e)\n {\n                System.out.println(e);\n        }\n      return object;   \n}\n}"
    ],
    "tt": [
      "\"HttpUrlConnection\"",
      "mycon",
      "\"HttpsUrlConnection\"",
      "HttpUrlConnection",
      "HttpsUrlConnection",
      "UrlConnection"
    ],
    "a": [
      "https://www.owasp.org/index.php/Reflection_injection",
      "http://docs.oracle.com/javase/tutorial/reflect/index.html",
      "http://msdn.microsoft.com/en-us/magazine/cc163408.aspx",
      "Attack: Command Injection Attack",
      "Attack: Client-side Validation Attack",
      "Attack: Server-Side Code Injection Attack"
    ]
  },
  "links": [
    {
      "href": "https://www.owasp.org/index.php/Reflection_injection",
      "text": "https://www.owasp.org/index.php/Reflection_injection"
    },
    {
      "href": "http://docs.oracle.com/javase/tutorial/reflect/index.html",
      "text": "http://docs.oracle.com/javase/tutorial/reflect/index.html"
    },
    {
      "href": "http://msdn.microsoft.com/en-us/magazine/cc163408.aspx",
      "text": "http://msdn.microsoft.com/en-us/magazine/cc163408.aspx"
    },
    {
      "href": "8698cde2-0fdf-4676-a043-ae90e62f55b8",
      "text": "Attack: Command Injection Attack"
    },
    {
      "href": "1408d3c3-7fc1-4ff0-910e-cdf0e191b669",
      "text": "Attack: Client-side Validation Attack"
    },
    {
      "href": "9d60faca-687b-4c69-91ba-f5712af0fd02",
      "text": "Attack: Server-Side Code Injection Attack"
    }
  ],
  "html": "<h1>Applies To</h1><p>.NET applications, Java applications, and applications written in any other language which supports reflection.\n</p><h1>Description</h1><p>Reflection is a programming technique provided by an API that let's you treat class definitions themselves as objects. It gives the programmer a way to view and modify class members such as constructors, methods, interfaces, and fields at runtime. This is often used for the of development tools such as class browsers or GUI designers. However, if untrusted user input is used to manipulate objects at runtime, injection is possible. Attackers may be able to view or modify which classes are used or even run arbitrary code.\n</p><h1>Impact</h1><ul><li>Execution of arbitrary code.</li>\n<li>Bypass of security controls.</li>\n</ul><h1>Vulnerabilities</h1><ul><li>Failure to validate input.</li>\n<li>Validation of a library based solely on the name.</li>\n<li>Loading libraries based on external input.</li>\n</ul><h1>Countermeasures</h1><ul><li>Validate input: Use vigorous whitelist style input checking of any input received from the user.</li>\n<li>Use signed certificates: Use strongly signed assemblies only, only load a class if it passes this check.</li>\n</ul><h1>Example</h1><p>A common example of a reflection injection attack occurs when an attacker can inject code to provide the name of a less secure class that implements the same interface as the one meant to be instantiated. The Java code below creates and uses an HTTP connection based on a user supplied string that defines the type.\n</p><pre>import java.lang.reflect.*;\nimport java.net.*;\nclass ExampleReflection\n {\n   public static void main(String[] args)\n {\n        String mycon = \"HttpsUrlConnection\";\n         // HttpsUrlConnection is a string provided by the user in some manner\n        URLConnection c = (URLConnection)createConnection(mycon);\n        c.connect();\n   }\n   static Object createConnection(String name)\n {\n        Object object = null;\n        try {\n                Class classdef = Class.forName(name);\n                object = classdef.newInstance();\n        }\n catch (InstantiationException e)\n {\n                System.out.println(e);\n        }\n catch\n (IllegalAccessException e)\n {\n                System.out.println(e);\n        }\n catch (ClassNotFoundException e)\n {\n                System.out.println(e);\n        }\n      return object;   \n}\n}\n</pre><p>\nNow suppose an attacker could inject <tt>\"HttpUrlConnection\"</tt> into the string <tt>mycon</tt> instead of <tt>\"HttpsUrlConnection\"</tt>. Then, instead of an SSL secured connection, an insecure connection will be created, leaving the data in transit unprotected. The application does not know any differently, because both <tt>HttpUrlConnection</tt> and <tt>HttpsUrlConnection</tt> implement <tt>UrlConnection</tt>.\n</p><h1>Additional Resources</h1><ul><li>For more information on Reflection Injection, see: <a href=\"https://www.owasp.org/index.php/Reflection_injection\">https://www.owasp.org/index.php/Reflection_injection</a></li>\n<li>For more information on Trail: The Reflection API for Java, see the <a href=\"http://docs.oracle.com/javase/tutorial/reflect/index.html\">http://docs.oracle.com/javase/tutorial/reflect/index.html</a></li>\n<li>For more information on Reflections on Reflection, see: <a href=\"http://msdn.microsoft.com/en-us/magazine/cc163408.aspx\">http://msdn.microsoft.com/en-us/magazine/cc163408.aspx</a></li>\n</ul><h1>Related Items</h1><ul><li><a href=\"8698cde2-0fdf-4676-a043-ae90e62f55b8\">Attack: Command Injection Attack</a></li>\n<li><a href=\"1408d3c3-7fc1-4ff0-910e-cdf0e191b669\">Attack: Client-side Validation Attack</a></li>\n<li><a href=\"9d60faca-687b-4c69-91ba-f5712af0fd02\">Attack: Server-Side Code Injection Attack</a></li>\n</ul>\n"
}