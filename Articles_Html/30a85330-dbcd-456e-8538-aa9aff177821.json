{
  "id": "30a85330-dbcd-456e-8538-aa9aff177821",
  "checksum": "917e2575a841f4d07f25ce2dfbc34203225cf62e",
  "words": {
    "40": [
      "ul",
      "li"
    ],
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "h1",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p"
    ],
    "aspnet": [
      "ul",
      "li"
    ],
    "what": [
      "h1"
    ],
    "do": [
      "h1",
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "not": [
      "p",
      "p",
      "p"
    ],
    "accept": [
      "p",
      "p"
    ],
    "file": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "strong",
      "title"
    ],
    "names": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "or": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "paths": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "strong"
    ],
    "from": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "users": [
      "p",
      "p"
    ],
    "why": [
      "h1"
    ],
    "accepting": [
      "p"
    ],
    "can": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "result": [
      "p"
    ],
    "in": [
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "attackers": [
      "p"
    ],
    "coercing": [
      "p"
    ],
    "your": [
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "application": [
      "p",
      "p",
      "p"
    ],
    "into": [
      "p"
    ],
    "accessing": [
      "p"
    ],
    "arbitrary": [
      "p"
    ],
    "files": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "and": [
      "p",
      "p"
    ],
    "resources": [
      "p"
    ],
    "when": [
      "h1",
      "ol",
      "li",
      "p"
    ],
    "you": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "should": [
      "p"
    ],
    "never": [
      "p"
    ],
    "a": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "name": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "title"
    ],
    "path": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "title"
    ],
    "user": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "under": [
      "p"
    ],
    "any": [
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "circumstances": [
      "p"
    ],
    "how": [
      "h1"
    ],
    "if": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "control": [
      "p"
    ],
    "over": [
      "p"
    ],
    "is": [
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "absolutely": [
      "p"
    ],
    "necessary": [
      "p"
    ],
    "remove": [
      "p"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p"
    ],
    "responsible": [
      "p"
    ],
    "code": [
      "p"
    ],
    "need": [
      "p"
    ],
    "store": [
      "p",
      "p"
    ],
    "it": [
      "p",
      "p"
    ],
    "database": [
      "p"
    ],
    "other": [
      "p"
    ],
    "non-filesystem": [
      "p"
    ],
    "data": [
      "p"
    ],
    "store keep": [
      "p"
    ],
    "provided": [
      "p"
    ],
    "as": [
      "p",
      "p"
    ],
    "reference": [
      "p"
    ],
    "but": [
      "p"
    ],
    "use": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "form": [
      "p"
    ],
    "of": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p"
    ],
    "canonical": [
      "p"
    ],
    "functionality": [
      "p"
    ],
    "critical": [
      "p"
    ],
    "proper": [
      "p"
    ],
    "working": [
      "p"
    ],
    "then": [
      "p"
    ],
    "validate": [
      "p"
    ],
    "input": [
      "p",
      "title"
    ],
    "for": [
      "p"
    ],
    "directory": [
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "traversal": [
      "p"
    ],
    "canonicalization": [
      "p"
    ],
    "attacks": [
      "p"
    ],
    "check": [
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "p",
      "strong"
    ],
    "ensure": [
      "ol",
      "li",
      "p"
    ],
    "that": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p"
    ],
    "only": [
      "ol",
      "li",
      "p"
    ],
    "refer": [
      "ol",
      "li",
      "p"
    ],
    "within": [
      "ol",
      "li",
      "p"
    ],
    "application's": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "virtual": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p"
    ],
    "hierarchy": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "appropriate": [
      "ol",
      "li",
      "p"
    ],
    "checking": [
      "ol",
      "li",
      "p"
    ],
    "obtain": [
      "ol",
      "li",
      "p"
    ],
    "full": [
      "ol",
      "li",
      "p"
    ],
    "by": [
      "ol",
      "li",
      "p"
    ],
    "using": [
      "ol",
      "li",
      "p"
    ],
    "systemio.path.getfullpath": [
      "ol",
      "li",
      "p",
      "em"
    ],
    "method": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "mappath": [
      "ol",
      "li",
      "p",
      "em"
    ],
    "map": [
      "ol",
      "li",
      "p"
    ],
    "supplied": [
      "ol",
      "li",
      "p"
    ],
    "physical": [
      "ol",
      "li",
      "p"
    ],
    "on": [
      "ol",
      "li",
      "p"
    ],
    "server": [
      "ol",
      "li",
      "p"
    ],
    "overloaded": [
      "ol",
      "li",
      "p"
    ],
    "requestmappath": [
      "ol",
      "li",
      "p",
      "em"
    ],
    "accepts": [
      "ol",
      "li",
      "p"
    ],
    "bool": [
      "ol",
      "li",
      "p",
      "em"
    ],
    "parameter": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "so": [
      "ol",
      "li",
      "p"
    ],
    "prevent": [
      "ol",
      "li",
      "p"
    ],
    "cross-application": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "pre",
      "p"
    ],
    "mapping": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "pre",
      "p"
    ],
    "try{": [
      "ol",
      "li",
      "pre"
    ],
    "string": [
      "ol",
      "li",
      "pre"
    ],
    "mappedpath": [
      "ol",
      "li",
      "pre"
    ],
    "=": [
      "ol",
      "li",
      "pre"
    ],
    "requestmappath(": [
      "ol",
      "li",
      "pre"
    ],
    "inputpathtext,": [
      "ol",
      "li",
      "pre"
    ],
    "requestapplicationpath,": [
      "ol",
      "li",
      "pre"
    ],
    "false;}catch": [
      "ol",
      "li",
      "pre"
    ],
    "httpexception){": [
      "ol",
      "li",
      "pre"
    ],
    "//": [
      "ol",
      "li",
      "pre"
    ],
    "attempted}": [
      "ol",
      "li",
      "pre"
    ],
    "final": [
      "ol",
      "li",
      "p"
    ],
    "false": [
      "ol",
      "li",
      "p",
      "em"
    ],
    "prevents": [
      "ol",
      "li",
      "p"
    ],
    "this": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "means": [
      "ol",
      "li",
      "p"
    ],
    "cannot": [
      "ol",
      "li",
      "p"
    ],
    "successfully": [
      "ol",
      "li",
      "p"
    ],
    "supply": [
      "ol",
      "li",
      "p"
    ],
    "contains": [
      "ol",
      "li",
      "p"
    ],
    "\".\"": [
      "ol",
      "li",
      "p"
    ],
    "traverse": [
      "ol",
      "li",
      "p"
    ],
    "outside": [
      "ol",
      "li",
      "p"
    ],
    "attempt": [
      "ol",
      "li",
      "p"
    ],
    "results": [
      "ol",
      "li",
      "p"
    ],
    "an": [
      "ol",
      "li",
      "p"
    ],
    "exception": [
      "ol",
      "li",
      "p"
    ],
    "type": [
      "ol",
      "li",
      "p"
    ],
    "httpexception": [
      "ol",
      "li",
      "p",
      "em"
    ],
    "adapted": [
      "p"
    ],
    "microsoft": [
      "p"
    ],
    "patterns": [
      "p"
    ],
    "&": [
      "p"
    ],
    "practices": [
      "p"
    ],
    "guidance": [
      "p"
    ],
    "avoid": [
      "title"
    ]
  },
  "tags": {
    "h1": [
      "Applies To",
      "What to Do",
      "Why",
      "When",
      "How"
    ],
    "ul": [
      "ASP.NET 4.0"
    ],
    "li": [
      "ASP.NET 4.0",
      "Check File Names. Ensure that file paths only refer to files within your application's virtual directory hierarchy if that is appropriate. When checking file names, obtain the full name of the file by using the System.IO.Path.GetFullPath method.",
      "Check File Paths. If you use MapPath to map a supplied virtual path to a physical path on the server, use the overloaded Request.MapPath method that accepts a bool parameter so that you can prevent cross-application mapping: \n      try{  string mappedPath = Request.MapPath( inputPath.Text,                         Request.ApplicationPath, false);}catch (HttpException){  // Cross-application mapping attempted}\n      The final false parameter prevents cross-application mapping. This means that a user cannot successfully supply a path that contains \"..\" to traverse outside of your application's virtual directory hierarchy. Any attempt to do this results in an exception of type HttpException."
    ],
    "p": [
      "Do not accept file names or paths from users.",
      "Accepting file names or paths from users can result in attackers coercing your application into accessing arbitrary files and resources.",
      "You should never accept a file name or path from a user under any circumstances.",
      "If user control over file paths or file names is not absolutely necessary, remove the responsible code from the application. If you need to store a file from a user, store it in a database or other non-filesystem data store. Keep the name the user provided as a reference to the file, but do not use it as any form of canonical name.",
      "",
      "If the functionality is critical to the proper working of the application, then validate the input for directory traversal and canonicalization attacks:",
      "Check File Names. Ensure that file paths only refer to files within your application's virtual directory hierarchy if that is appropriate. When checking file names, obtain the full name of the file by using the System.IO.Path.GetFullPath method.",
      "Check File Paths. If you use MapPath to map a supplied virtual path to a physical path on the server, use the overloaded Request.MapPath method that accepts a bool parameter so that you can prevent cross-application mapping:",
      "The final false parameter prevents cross-application mapping. This means that a user cannot successfully supply a path that contains \"..\" to traverse outside of your application's virtual directory hierarchy. Any attempt to do this results in an exception of type HttpException.",
      "Adapted from Microsoft patterns & practices guidance."
    ],
    "ol": [
      "Check File Names. Ensure that file paths only refer to files within your application's virtual directory hierarchy if that is appropriate. When checking file names, obtain the full name of the file by using the System.IO.Path.GetFullPath method. \n    \n    \n      \n        Check File Paths. If you use MapPath to map a supplied virtual path to a physical path on the server, use the overloaded Request.MapPath method that accepts a bool parameter so that you can prevent cross-application mapping: \n      try{  string mappedPath = Request.MapPath( inputPath.Text,                         Request.ApplicationPath, false);}catch (HttpException){  // Cross-application mapping attempted}\n      The final false parameter prevents cross-application mapping. This means that a user cannot successfully supply a path that contains \"..\" to traverse outside of your application's virtual directory hierarchy. Any attempt to do this results in an exception of type HttpException."
    ],
    "strong": [
      "Check File Names.",
      "Check File Paths."
    ],
    "em": [
      "System.IO.Path.GetFullPath",
      "MapPath",
      "Request.MapPath",
      "bool",
      "false",
      "HttpException"
    ],
    "pre": [
      "try{  string mappedPath = Request.MapPath( inputPath.Text,                         Request.ApplicationPath, false);}catch (HttpException){  // Cross-application mapping attempted}"
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "hr": [
      ""
    ]
  },
  "links": [],
  "html": "<h1>Applies To</h1>\n  <ul>\n    <li>ASP.NET 4.0</li>\n  </ul>\n  <h1>What to Do</h1>\n  <p>Do not accept file names or paths from users.</p>\n  <h1>Why</h1>\n  <p>Accepting file names or paths from users can result in attackers coercing your application into accessing arbitrary files and resources.</p>\n  <h1>When</h1>\n  <p>You should never accept a file name or path from a user under any circumstances.</p>\n  <h1>How</h1>\n  <p>If user control over file paths or file names is not absolutely necessary, remove the responsible code from the application. If you need to store a file from a user, store it in a database or other non-filesystem data store.&nbsp;Keep the name the user provided as a reference to the file, but do not use it as any form of canonical name.</p>\n  <p />\n  <p>If the functionality is critical to the proper working of the application, then validate the input for directory traversal and canonicalization attacks:</p>\n  <ol>\n    <li>\n      <p>\n        <strong>Check File Names. </strong>Ensure that file paths only refer to files within your application's virtual directory hierarchy if that is appropriate. When checking file names, obtain the full name of the file by using the <em>System.IO.Path.GetFullPath</em> method. </p>\n    </li>\n    <li>\n      <p>\n        <strong>Check File Paths. </strong>If you use <em>MapPath</em> to map a supplied virtual path to a physical path on the server, use the overloaded <em>Request.MapPath</em> method that accepts a <em>bool</em> parameter so that you can prevent cross-application mapping: </p>\n      <pre>try<br />{<br />  string mappedPath = Request.MapPath( inputPath.Text,<br />                         Request.ApplicationPath, false);<br />}<br />catch (HttpException)<br />{<br />  // Cross-application mapping attempted<br />}</pre>\n      <p>The final <em>false</em> parameter prevents cross-application mapping. This means that a user cannot successfully supply a path that contains \"..\" to traverse outside of your application's virtual directory hierarchy. Any attempt to do this results in an exception of type <em>HttpException</em>.</p>\n    </li>\n  </ol>\n  <hr />\n  <p>Adapted from Microsoft patterns & practices guidance. </p>"
}