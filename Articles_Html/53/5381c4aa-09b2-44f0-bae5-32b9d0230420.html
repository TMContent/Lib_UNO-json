<h1>Applies to</h1>
  <p>Scala and Play Framework 2.1.0+<br /></p>
  <h1>What to Check For</h1>
  <p>Ensure your application enforces a password expiry policy.</p>
  <h1>Why</h1>
  <p>Forcing users to renew their passwords reduces the risk of valid credentials becoming exposed. While this technique can prevent attackers from obtaining the valid credentials through the use of a&amp;nbsp;Credentials Brute Force Attack&amp;nbsp;or a&amp;nbsp;Credentials Dictionary Attack, it can also reduce the business risk associated with any instances of discovered or leaked valid credentials.</p>
  <h1>How to Check</h1>
  <p>Use the following steps to ensure your application has a password expiry policy:</p>
  <ol>
    <li>
      <p>
        <strong>Locate all authentication code.&amp;nbsp;</strong>Identify all authentication procedures throughout your application.</p>
    </li>
    <li>
      <p>
        <strong>Ensure that your application enforces password renewal.&amp;nbsp;</strong>Ensure that your application addresses the need for password renewal throughout the different stages of your application's development lifecycle:</p>
      <ul>
        <li>
          <strong>Requirements</strong>: Check if your application provides a password policy. Ensure that the password policy provides requirements regarding the lifetime of passwords. For example, require that a password will expire after 45 days. </li>
        <li>
          <strong>Design</strong>: Check if all password renewal routines are positioned properly throughout your application's authentication routines. For instance, if a user's password is expired, your application's authentication routine should force the user to renew their password upon a successful logon.</li>
        <li>
          <strong>Implementation</strong>: Check if all password renewal routines implement your application's password policy.</li>
      </ul>
    </li>
  </ol>
  <p>
    <strong>Note</strong>: PCI DSS requirements state that a password must be renewed at most every 90 days and that the new password cannot be the same as the previous four.</p>
  <h1>How to Fix</h1>
  <p>
  </p>
  <p style="margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);">To force users to change their passwords:</p>
  <ol style="margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);">
    <li style="margin: 0px; padding: 0px;">
      <p style="margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em;">
        <strong style="margin: 0px; padding: 0px;">Define a password change policy.&amp;nbsp;</strong>Establish a maximum password age for your application's users. For example, require that users must change passwords every 60 days and privileged users must change passwords every 30 days.</p>
    </li>
    <li style="margin: 0px; padding: 0px;">
      <p style="margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em;">
        <strong style="margin: 0px; padding: 0px;">Design a password change mechanism.&amp;nbsp;</strong>Track the password age and prompt the user to change their password when the password expires. For example, the following SQL transaction will help the application to determine whether a user's password has expired:</p>
      <p style="margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em;">
      </p>
      <pre style="line-height: normal;">sql&gt; select * from passHistory<br />      where userid =  and<br />            last_changed </pre>
      <p />
    </li>
    <li style="margin: 0px; padding: 0px;">
      <p style="margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em;">
        <strong style="margin: 0px; padding: 0px;">Enforce the password change policy.&amp;nbsp;</strong>Embed the change of password mechanism into the authentication routine. The routine should check if the current user is logged in, and if the password has not been changed since a long interval, the user should be forced to change the&amp;nbsp;password.</p>
    </li>
  </ol>
  <p style="margin: 0.5em 0px 1em; padding: 0px; line-height: 1.5em; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);">
    <strong style="margin: 0px; padding: 0px;">Note:</strong>&amp;nbsp;PCI DSS requirements state that a password must be renewed at most every 90 days and that the new password cannot be the same as the previous four.</p>
  <p />