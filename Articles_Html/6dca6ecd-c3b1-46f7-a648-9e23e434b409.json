{
  "id": "6dca6ecd-c3b1-46f7-a648-9e23e434b409",
  "checksum": "dbdf2f72628248a75cf355d06aca2105daba1eba",
  "words": {
    "what": [
      "h1"
    ],
    "to": [
      "h1",
      "p",
      "p",
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "title",
      "title"
    ],
    "check": [
      "h1",
      "p"
    ],
    "for": [
      "h1",
      "p",
      "blockquote",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "ensure": [
      "p"
    ],
    "that": [
      "p",
      "p",
      "p"
    ],
    "your": [
      "p",
      "ul",
      "li",
      "p",
      "p"
    ],
    "application": [
      "p",
      "ul",
      "li",
      "p",
      "p"
    ],
    "uses": [
      "p",
      "p"
    ],
    "dpapi": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "encrypt": [
      "p",
      "p",
      "p",
      "p"
    ],
    "sensitive": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p"
    ],
    "data": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "and": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "title"
    ],
    "avoids": [
      "p"
    ],
    "key": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "management": [
      "p",
      "title"
    ],
    "how": [
      "h1",
      "p"
    ],
    "fix": [
      "h1"
    ],
    "by": [
      "p",
      "blockquote"
    ],
    "using": [
      "p",
      "p",
      "div",
      "pre",
      "div",
      "pre"
    ],
    "data—either": [
      "p"
    ],
    "in": [
      "p",
      "p",
      "p",
      "blockquote",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "memory": [
      "p",
      "p",
      "p",
      "p"
    ],
    "or": [
      "p",
      "p",
      "p",
      "title"
    ],
    "persistent": [
      "p"
    ],
    "stores": [
      "p"
    ],
    "such": [
      "p"
    ],
    "as": [
      "p",
      "p",
      "p"
    ],
    "configuration": [
      "p"
    ],
    "files": [
      "p",
      "p",
      "p"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "p"
    ],
    "registry—you": [
      "p"
    ],
    "avoid": [
      "p"
    ],
    "having": [
      "p"
    ],
    "manage": [
      "p"
    ],
    "protect": [
      "p",
      "title"
    ],
    "encryption": [
      "p",
      "blockquote",
      "blockquote"
    ],
    "with": [
      "p",
      "p",
      "ul",
      "li"
    ],
    "operating": [
      "p"
    ],
    "system": [
      "p"
    ],
    "manages": [
      "p"
    ],
    "protects": [
      "p"
    ],
    "stored": [
      "p",
      "p",
      "p"
    ],
    "aspnet": [
      "p",
      "p"
    ],
    "webconfig": [
      "p"
    ],
    "you": [
      "p",
      "blockquote",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p"
    ],
    "can": [
      "p",
      "p",
      "p"
    ],
    "use": [
      "p",
      "blockquote",
      "blockquote",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "aspnet_regiis": [
      "p",
      "blockquote"
    ],
    "tool": [
      "p",
      "blockquote"
    ],
    "protection": [
      "p"
    ],
    "feature": [
      "p"
    ],
    "provided": [
      "p"
    ],
    "35.": [
      "p"
    ],
    "note   dpapi": [
      "blockquote"
    ],
    "is": [
      "blockquote",
      "blockquote",
      "p",
      "title"
    ],
    "not": [
      "blockquote",
      "p"
    ],
    "recommended": [
      "blockquote"
    ],
    "web": [
      "blockquote"
    ],
    "farm": [
      "blockquote"
    ],
    "scenarios": [
      "blockquote"
    ],
    "because": [
      "blockquote"
    ],
    "of": [
      "blockquote"
    ],
    "machine": [
      "blockquote",
      "p"
    ],
    "affinity": [
      "blockquote"
    ],
    "instead": [
      "blockquote",
      "p"
    ],
    "should": [
      "blockquote",
      "p"
    ],
    "rsa": [
      "blockquote"
    ],
    "which": [
      "blockquote",
      "p"
    ],
    "also": [
      "blockquote"
    ],
    "supported": [
      "blockquote"
    ],
    "note": [
      "b"
    ],
    "protectedmemory": [
      "p",
      "p",
      "b",
      "b",
      "p",
      "b"
    ],
    "class": [
      "p",
      "p",
      "p",
      "p"
    ],
    "provides": [
      "p"
    ],
    "a": [
      "p",
      "p",
      "p"
    ],
    "managed": [
      "p"
    ],
    "wrapper": [
      "p"
    ],
    "text-based": [
      "p"
    ],
    "consider": [
      "p"
    ],
    "securestring": [
      "p",
      "p",
      "b",
      "b"
    ],
    "text": [
      "p"
    ],
    "following": [
      "p",
      "p",
      "p"
    ],
    "example": [
      "p",
      "p"
    ],
    "shows": [
      "p"
    ],
    "encrypting": [
      "p"
    ],
    "decrypting": [
      "p"
    ],
    "systemsecurity.cryptography;using": [
      "div",
      "pre",
      "div",
      "pre"
    ],
    "systemtext;...byte[]": [
      "div",
      "pre",
      "div",
      "pre"
    ],
    "optionalentropy": [
      "div",
      "pre",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre"
    ],
    "=": [
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "{75,4,9,0};byte[]": [
      "div",
      "pre",
      "div",
      "pre"
    ],
    "datatobeencrypted": [
      "div",
      "pre",
      "div",
      "pre"
    ],
    "encodingunicode.getbytes(\"test": [
      "div",
      "pre",
      "div",
      "pre"
    ],
    "string": [
      "div",
      "pre",
      "div",
      "pre"
    ],
    "1211\";protectedmemory.protect(datatobeencrypted,": [
      "div",
      "pre"
    ],
    "memoryprotectionscopesamelogon);protectedmemory.unprotect(datatobeencrypted,": [
      "div",
      "pre"
    ],
    "memoryprotectionscopesamelogon);string": [
      "div",
      "pre"
    ],
    "originaldata": [
      "div",
      "pre",
      "div",
      "pre"
    ],
    "encodingunicode.getstring(datatobeencrypted);": [
      "div",
      "pre"
    ],
    "any": [
      "p"
    ],
    "other": [
      "p",
      "ul",
      "li",
      "p"
    ],
    "store": [
      "p",
      "p",
      "p"
    ],
    "protecteddata": [
      "p",
      "b"
    ],
    "shown": [
      "p"
    ],
    "string\";byte[]": [
      "div",
      "pre"
    ],
    "encrypteddata": [
      "div",
      "pre"
    ],
    "protecteddataprotect(datatobeencrypted,": [
      "div",
      "pre"
    ],
    "dataprotectionscopecurrentuser);byte[]": [
      "div",
      "pre"
    ],
    "decrypteddata": [
      "div",
      "pre"
    ],
    "protecteddataunprotect(encrypteddata,": [
      "div",
      "pre"
    ],
    "dataprotectionscopecurrentuser);": [
      "div",
      "pre"
    ],
    "encodingunicode.getstring(decrypteddata);": [
      "div",
      "pre"
    ],
    "when": [
      "p"
    ],
    "user": [
      "p"
    ],
    "machine-level": [
      "p"
    ],
    "storage": [
      "p",
      "p"
    ],
    "situations": [
      "p"
    ],
    "runs": [
      "ul",
      "li"
    ],
    "on": [
      "ul",
      "ul",
      "li",
      "li",
      "p"
    ],
    "its": [
      "ul",
      "li"
    ],
    "own": [
      "ul",
      "li"
    ],
    "dedicated": [
      "ul",
      "li"
    ],
    "server": [
      "ul",
      "ul",
      "li",
      "li",
      "p"
    ],
    "no": [
      "ul",
      "li"
    ],
    "applications": [
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p"
    ],
    "have": [
      "ul",
      "li"
    ],
    "multiple": [
      "ul",
      "li"
    ],
    "same": [
      "ul",
      "li"
    ],
    "want": [
      "ul",
      "li",
      "p"
    ],
    "those": [
      "ul",
      "li"
    ],
    "be": [
      "ul",
      "li",
      "p"
    ],
    "able": [
      "ul",
      "li"
    ],
    "share": [
      "ul",
      "li"
    ],
    "information": [
      "ul",
      "li"
    ],
    "user-level": [
      "p"
    ],
    "if": [
      "p"
    ],
    "run": [
      "p",
      "p"
    ],
    "shared": [
      "p"
    ],
    "hosting": [
      "p"
    ],
    "environment": [
      "p"
    ],
    "make": [
      "p"
    ],
    "sure": [
      "p"
    ],
    "application's": [
      "p"
    ],
    "accessible": [
      "p"
    ],
    "this": [
      "p"
    ],
    "situation": [
      "p"
    ],
    "each": [
      "p"
    ],
    "under": [
      "p"
    ],
    "separate": [
      "p"
    ],
    "identity": [
      "p",
      "p"
    ],
    "resources": [
      "p"
    ],
    "application—such": [
      "p"
    ],
    "databases—should": [
      "p"
    ],
    "restricted": [
      "p"
    ],
    "adapted": [
      "p"
    ],
    "from": [
      "p"
    ],
    "microsoft": [
      "p"
    ],
    "patterns": [
      "p"
    ],
    "&": [
      "p"
    ],
    "practices": [
      "p"
    ],
    "guidance": [
      "p"
    ],
    "where": [
      "title"
    ],
    "appropriate": [
      "title"
    ],
    "used": [
      "title"
    ],
    "secrets": [
      "title"
    ],
    "reduce": [
      "title"
    ],
    "eliminate": [
      "title"
    ]
  },
  "tags": {
    "h1": [
      "What to Check For",
      "How to Fix"
    ],
    "p": [
      "Check to ensure that your application uses DPAPI to encrypt sensitive data and avoids key management.",
      "",
      "By using DPAPI to encrypt sensitive data—either in memory or in persistent stores, such as configuration files or the registry—you avoid having to manage and protect the encryption key. With DPAPI, the operating system manages and protects the key.",
      "For sensitive data stored in ASP.NET Web.config files, you can use the Aspnet_regiis tool and the data protection feature provided with ASP.NET 3.5.",
      "For sensitive data stored in memory, you can use the ProtectedMemory class which provides a managed wrapper for DPAPI to encrypt the data. For text-based data, consider using SecureString instead. SecureString uses the ProtectedMemory class to encrypt text in memory.",
      "The following example shows how to use the ProtectedMemory class for encrypting and decrypting data in memory.",
      "For sensitive data stored in any other data store, use the ProtectedData class as shown in the following example.",
      "When you use DPAPI, you can use the machine key store or the user key store. Use machine-level key storage in the following situations:",
      "Use user-level key storage if you run your application in a shared hosting environment and you want to make sure that your application's sensitive data is not accessible to other applications on the server. In this situation, each application should run under a separate identity, and the resources for the application—such as files and databases—should be restricted to that identity.",
      "Adapted from Microsoft patterns & practices guidance."
    ],
    "blockquote": [
      "Note   DPAPI encryption is not recommended for use in Web farm scenarios because of machine affinity. Instead, you should use RSA encryption, which is also supported by the Aspnet_regiis tool."
    ],
    "b": [
      "Note",
      "",
      "ProtectedMemory",
      "SecureString",
      "SecureString",
      "ProtectedMemory",
      ".",
      "ProtectedMemory",
      "ProtectedData"
    ],
    "div": [
      "using System.Security.Cryptography;using System.Text;...byte[] optionalEntropy = {7,5,4,9,0};byte[] dataToBeEncrypted = Encoding.Unicode.GetBytes(\"Test String 1211\");ProtectedMemory.Protect(dataToBeEncrypted, MemoryProtectionScope.SameLogon);ProtectedMemory.Unprotect(dataToBeEncrypted, MemoryProtectionScope.SameLogon);string originalData = Encoding.Unicode.GetString(dataToBeEncrypted);",
      "using System.Security.Cryptography;using System.Text;...byte[] optionalEntropy = {7,5,4,9,0};byte[] dataToBeEncrypted = Encoding.Unicode.GetBytes(\"Test String\");byte[] encryptedData = ProtectedData.Protect(dataToBeEncrypted, \t\toptionalEntropy, DataProtectionScope.CurrentUser);byte[] decryptedData = ProtectedData.Unprotect(encryptedData, \t\toptionalEntropy, DataProtectionScope.CurrentUser);            string originalData = Encoding.Unicode.GetString(decryptedData);"
    ],
    "pre": [
      "using System.Security.Cryptography;using System.Text;...byte[] optionalEntropy = {7,5,4,9,0};byte[] dataToBeEncrypted = Encoding.Unicode.GetBytes(\"Test String 1211\");ProtectedMemory.Protect(dataToBeEncrypted, MemoryProtectionScope.SameLogon);ProtectedMemory.Unprotect(dataToBeEncrypted, MemoryProtectionScope.SameLogon);string originalData = Encoding.Unicode.GetString(dataToBeEncrypted);",
      "using System.Security.Cryptography;using System.Text;...byte[] optionalEntropy = {7,5,4,9,0};byte[] dataToBeEncrypted = Encoding.Unicode.GetBytes(\"Test String\");byte[] encryptedData = ProtectedData.Protect(dataToBeEncrypted, \t\toptionalEntropy, DataProtectionScope.CurrentUser);byte[] decryptedData = ProtectedData.Unprotect(encryptedData, \t\toptionalEntropy, DataProtectionScope.CurrentUser);            string originalData = Encoding.Unicode.GetString(decryptedData);"
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "ul": [
      "Your application runs on its own dedicated server with no other applications. You have multiple applications on the same server, and you want those applications to be able to share sensitive information."
    ],
    "li": [
      "Your application runs on its own dedicated server with no other applications.",
      "You have multiple applications on the same server, and you want those applications to be able to share sensitive information."
    ],
    "hr": [
      ""
    ]
  },
  "links": [],
  "html": "<h1>What to Check For</h1>\r\n  <p>Check to ensure that your application uses DPAPI to encrypt sensitive data and avoids key management.</p>\r\n  <p />\r\n  <h1>How to Fix</h1>\r\n  <p>By using DPAPI to encrypt sensitive data&#8212;either in memory or in persistent stores, such as configuration files or the registry&#8212;you avoid having to manage and protect the encryption key. With DPAPI, the operating system manages and protects the key.</p>\r\n  <p>For sensitive data stored in ASP.NET Web.config files, you can use the Aspnet_regiis tool and the data protection feature provided with ASP.NET 3.5.</p>\r\n  <blockquote>\r\n    <b>Note</b>&nbsp;&nbsp;&nbsp;DPAPI encryption is not recommended for use in Web farm scenarios because of machine affinity. Instead, you should use RSA encryption, which is also supported by the Aspnet_regiis tool.<b></b></blockquote>\r\n  <p>For sensitive data stored in memory, you can use the <b>ProtectedMemory </b>class which provides a managed wrapper for DPAPI to encrypt the data. For text-based data, consider using <b>SecureString </b>instead.<b> SecureString</b> uses the <b>ProtectedMemory</b> class to encrypt text in memory<b>.</b></p>\r\n  <p>The following example shows how to use the <b>ProtectedMemory</b> class for encrypting and decrypting data in memory.</p>\r\n  <div>\r\n    <pre>using System.Security.Cryptography;<br />using System.Text;<br />...<br />byte&#91;&#93; optionalEntropy = &#123;7,5,4,9,0&#125;;<br />byte&#91;&#93; dataToBeEncrypted = Encoding.Unicode.GetBytes(\"Test String 1211\");<br />ProtectedMemory.Protect(dataToBeEncrypted, MemoryProtectionScope.SameLogon);<br />ProtectedMemory.Unprotect(dataToBeEncrypted, MemoryProtectionScope.SameLogon);<br />string originalData = Encoding.Unicode.GetString(dataToBeEncrypted);  </pre>\r\n  </div>\r\n  <p>For sensitive data stored in any other data store, use the <b>ProtectedData </b>class as shown in the following example.</p>\r\n  <div>\r\n    <pre>using System.Security.Cryptography;<br />using System.Text;...byte&#91;&#93; optionalEntropy = &#123;7,5,4,9,0&#125;;<br />byte&#91;&#93; dataToBeEncrypted = Encoding.Unicode.GetBytes(\"Test String\");<br />byte&#91;&#93; encryptedData = ProtectedData.Protect(dataToBeEncrypted, <br />&#9;&#9;optionalEntropy, DataProtectionScope.CurrentUser);<br />byte&#91;&#93; decryptedData = ProtectedData.Unprotect(encryptedData, <br />&#9;&#9;optionalEntropy, DataProtectionScope.CurrentUser);<br />            string originalData = Encoding.Unicode.GetString(decryptedData);  </pre>\r\n  </div>\r\n  <p>When you use DPAPI, you can use the machine key store or the user key store. Use machine-level key storage in the following situations: </p>\r\n  <ul>\r\n    <li>Your application runs on its own dedicated server with no other applications. <li>You have multiple applications on the same server, and you want those applications to be able to share sensitive information. </li></li>\r\n  </ul>\r\n  <p>Use user-level key storage if you run your application in a shared hosting environment and you want to make sure that your application's sensitive data is not accessible to other applications on the server. In this situation, each application should run under a separate identity, and the resources for the application&#8212;such as files and databases&#8212;should be restricted to that identity.</p>\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns & practices guidance.</p>"
}