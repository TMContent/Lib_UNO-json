{
  "id": "946a5edb-e8f8-4365-8675-b8a5032c201b",
  "checksum": "ed35951d9c71f682a99fd788ea885d9881202cd8",
  "words": {
    "0": [
      "pre",
      "pre"
    ],
    "9": [
      "pre"
    ],
    "14": [
      "pre"
    ],
    "19": [
      "pre"
    ],
    "24": [
      "pre"
    ],
    "38": [
      "pre"
    ],
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "h1",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p",
      "pre"
    ],
    "applications": [
      "ul",
      "li"
    ],
    "written": [
      "ul",
      "li"
    ],
    "using": [
      "ul",
      "li"
    ],
    "servlets": [
      "ul",
      "li"
    ],
    "or": [
      "ul",
      "li"
    ],
    "jsp": [
      "ul",
      "li"
    ],
    "what": [
      "h1"
    ],
    "do": [
      "h1"
    ],
    "validate": [
      "p",
      "ol",
      "li",
      "p",
      "strong",
      "title"
    ],
    "all": [
      "p",
      "title"
    ],
    "data": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "p",
      "p",
      "title"
    ],
    "that": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "p",
      "pre",
      "pre"
    ],
    "is": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "li",
      "p",
      "p",
      "p",
      "pre",
      "p",
      "pre",
      "pre"
    ],
    "passed": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "between": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "li",
      "p",
      "title"
    ],
    "java": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "li",
      "p",
      "li",
      "p",
      "p",
      "title"
    ],
    "code": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "and": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "p",
      "title"
    ],
    "native": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "p",
      "li",
      "p",
      "title"
    ],
    "why": [
      "h1"
    ],
    "unchecked": [
      "p"
    ],
    "input": [
      "p",
      "p",
      "p",
      "pre"
    ],
    "and/or": [
      "p"
    ],
    "output": [
      "p"
    ],
    "can": [
      "p",
      "p"
    ],
    "lead": [
      "p"
    ],
    "buffer": [
      "p"
    ],
    "overflows": [
      "p"
    ],
    "injection": [
      "p",
      "p"
    ],
    "based": [
      "p"
    ],
    "attacks": [
      "p"
    ],
    "such": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "as": [
      "p",
      "ol",
      "li",
      "p",
      "p"
    ],
    "sql": [
      "p"
    ],
    "cross-site": [
      "p"
    ],
    "scripting": [
      "p"
    ],
    "etc,": [
      "p"
    ],
    "can exploit": [
      "p"
    ],
    "weaknesses": [
      "p"
    ],
    "in": [
      "p"
    ],
    "the": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "p",
      "p",
      "p",
      "p",
      "pre",
      "pre",
      "pre"
    ],
    "application": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p",
      "pre",
      "p",
      "pre"
    ],
    "when": [
      "h1",
      "p"
    ],
    "your": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p"
    ],
    "should": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "always": [
      "p"
    ],
    "verify": [
      "p",
      "p",
      "pre"
    ],
    "how": [
      "h1"
    ],
    "there": [
      "p"
    ],
    "are": [
      "p"
    ],
    "several": [
      "p"
    ],
    "things": [
      "p"
    ],
    "consider": [
      "p"
    ],
    "validating": [
      "p"
    ],
    "input/output": [
      "p"
    ],
    "check": [
      "ol",
      "li",
      "p",
      "strong",
      "pre"
    ],
    "language": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "p",
      "li",
      "p"
    ],
    "barriers": [
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "p"
    ],
    "distinguishing the": [
      "ol",
      "li",
      "p"
    ],
    "boundaries": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "very": [
      "ol",
      "li",
      "p"
    ],
    "important": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "because": [
      "ol",
      "li",
      "p",
      "p"
    ],
    "sandbox": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "provides": [
      "ol",
      "li",
      "p"
    ],
    "multiple": [
      "ol",
      "li",
      "p"
    ],
    "security": [
      "ol",
      "li",
      "p"
    ],
    "checks": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "its": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "p",
      "p"
    ],
    "it": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "know": [
      "ol",
      "li",
      "p"
    ],
    "boundary between where": [
      "ol",
      "li",
      "p"
    ],
    "ends": [
      "ol",
      "li",
      "p"
    ],
    "compiled": [
      "ol",
      "li",
      "p"
    ],
    "begins to": [
      "ol",
      "li",
      "p"
    ],
    "interact directly": [
      "ol",
      "li",
      "p"
    ],
    "with": [
      "ol",
      "li",
      "p"
    ],
    "cpu": [
      "ol",
      "li",
      "p"
    ],
    "so": [
      "ol",
      "li",
      "p"
    ],
    "you": [
      "ol",
      "li",
      "p"
    ],
    "can compensate": [
      "ol",
      "li",
      "p"
    ],
    "for the": [
      "ol",
      "li",
      "p"
    ],
    "lack": [
      "ol",
      "li",
      "p"
    ],
    "of": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "p",
      "pre"
    ],
    "inside": [
      "ol",
      "li",
      "p"
    ],
    "for": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "pre"
    ],
    "length": [
      "ol",
      "li",
      "p",
      "strong",
      "pre"
    ],
    "range": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "format": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "type": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong"
    ],
    "after": [
      "ol",
      "li",
      "p"
    ],
    "discovering": [
      "ol",
      "li",
      "p"
    ],
    "determine": [
      "ol",
      "li",
      "p"
    ],
    "structure": [
      "ol",
      "li",
      "p"
    ],
    "build": [
      "ol",
      "li",
      "p"
    ],
    "a": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "strong",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre"
    ],
    "validator": [
      "ol",
      "li",
      "p"
    ],
    "each": [
      "ol",
      "li",
      "p"
    ],
    "two": [
      "ol",
      "li",
      "p"
    ],
    "environments": [
      "ol",
      "li",
      "p"
    ],
    "construct": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "set": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong"
    ],
    "validators": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong"
    ],
    "centralize": [
      "ol",
      "li",
      "p"
    ],
    "application's": [
      "ol",
      "li",
      "p"
    ],
    "helps": [
      "ol",
      "li",
      "p"
    ],
    "strengthen": [
      "ol",
      "li",
      "p"
    ],
    "by": [
      "ol",
      "li",
      "p"
    ],
    "limiting": [
      "ol",
      "li",
      "p"
    ],
    "amount": [
      "ol",
      "li",
      "p"
    ],
    "scattered": [
      "ol",
      "li",
      "p"
    ],
    "validation": [
      "ol",
      "li",
      "p",
      "p"
    ],
    "throughout": [
      "ol",
      "li",
      "p"
    ],
    "place": [
      "ol",
      "li",
      "p"
    ],
    "on": [
      "ol",
      "li",
      "p"
    ],
    "pass": [
      "ol",
      "li",
      "p"
    ],
    "only": [
      "ol",
      "li",
      "p"
    ],
    "through": [
      "ol",
      "li",
      "p"
    ],
    "problem": [
      "h1"
    ],
    "example": [
      "h1",
      "h1"
    ],
    "following": [
      "p",
      "p"
    ],
    "segment": [
      "p",
      "p",
      "p"
    ],
    "shows": [
      "p",
      "p"
    ],
    "jni": [
      "p",
      "p",
      "p"
    ],
    "utilizes": [
      "p",
      "p"
    ],
    "com": [
      "p",
      "p"
    ],
    "object": [
      "p",
      "p"
    ],
    "making": [
      "p"
    ],
    "assumption": [
      "p"
    ],
    "will": [
      "p"
    ],
    "handle": [
      "p"
    ],
    "does": [
      "p"
    ],
    "not": [
      "p"
    ],
    "valid": [
      "p",
      "pre",
      "pre"
    ],
    "guid": [
      "p",
      "pre",
      "pre",
      "pre",
      "pre",
      "p",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "since": [
      "p"
    ],
    "invalid": [
      "p"
    ],
    "guids": [
      "p"
    ],
    "may": [
      "p"
    ],
    "cause": [
      "p"
    ],
    "unhandled": [
      "p",
      "p"
    ],
    "exceptions": [
      "p",
      "p"
    ],
    "an": [
      "p"
    ],
    "attacker": [
      "p"
    ],
    "force": [
      "p"
    ],
    "disclose": [
      "p"
    ],
    "call": [
      "p"
    ],
    "stack": [
      "p"
    ],
    "possibly": [
      "p"
    ],
    "source": [
      "p"
    ],
    "filenames": [
      "p"
    ],
    "#include": [
      "pre",
      "pre"
    ],
    "jni.h>#include": [
      "pre",
      "pre"
    ],
    "sys/types.h>#include": [
      "pre",
      "pre"
    ],
    "fcntl.h>#include": [
      "pre",
      "pre"
    ],
    "stdio.h>#include": [
      "pre",
      "pre"
    ],
    "atlbase.h>#include": [
      "pre",
      "pre"
    ],
    "windows.h>#include": [
      "pre",
      "pre"
    ],
    "wtypes.h>jniexport": [
      "pre"
    ],
    "jbooleanjnicall": [
      "pre"
    ],
    "java_identifier_invokeobject": [
      "pre",
      "pre"
    ],
    "jnienv": [
      "pre",
      "pre"
    ],
    "*": [
      "pre",
      "pre"
    ],
    "env": [
      "pre",
      "pre"
    ],
    "jobject": [
      "pre",
      "pre"
    ],
    "jobj": [
      "pre",
      "pre"
    ],
    "jstring": [
      "pre",
      "pre"
    ],
    "jguid{": [
      "pre",
      "pre"
    ],
    "hresult": [
      "pre",
      "pre"
    ],
    "result": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "clsid": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "iunknown": [
      "pre",
      "pre"
    ],
    "*piunkn": [
      "pre",
      "pre"
    ],
    "lpwstr": [
      "pre",
      "pre"
    ],
    "jboolean": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "iscopy": [
      "pre",
      "pre"
    ],
    "ret": [
      "pre",
      "pre",
      "pre"
    ],
    "=": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "false": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "char*": [
      "pre",
      "pre"
    ],
    "temp_guid": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "*env)->getstringutfchars(env,": [
      "pre",
      "pre"
    ],
    "jguid": [
      "pre",
      "pre"
    ],
    "&iscopy;": [
      "pre",
      "pre"
    ],
    "//the": [
      "pre"
    ],
    "fails": [
      "pre"
    ],
    "sysallocstringlen0,": [
      "pre",
      "pre"
    ],
    "38;": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "multibytetowidecharcp_acp,": [
      "pre",
      "pre"
    ],
    "-1": [
      "pre",
      "pre"
    ],
    "guidfromstringguid,": [
      "pre",
      "pre"
    ],
    "&clsid;": [
      "pre",
      "pre"
    ],
    "..": [
      "pre",
      "pre"
    ],
    "return": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "ret}": [
      "pre"
    ],
    "solution": [
      "h1"
    ],
    "validated": [
      "p"
    ],
    "being": [
      "p"
    ],
    "reduces": [
      "p"
    ],
    "risk": [
      "p"
    ],
    "wtypes.h>": [
      "pre"
    ],
    "jniexport": [
      "pre"
    ],
    "jnicall": [
      "pre"
    ],
    "//": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "verifies": [
      "pre"
    ],
    "matches": [
      "pre"
    ],
    "criteria": [
      "pre"
    ],
    "if!validguid(temp_guid))": [
      "pre"
    ],
    "{": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "}": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "ret}bool": [
      "pre"
    ],
    "validguidchar": [
      "pre"
    ],
    "*guid{": [
      "pre"
    ],
    "right": [
      "pre"
    ],
    "ifstrlen(guid)": [
      "pre"
    ],
    "!=": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "sample": [
      "pre"
    ],
    "{1ef4a023-143a-4e0e-ad72-69c2c68c2d70}": [
      "pre"
    ],
    "ifguid[0]": [
      "pre"
    ],
    "'{'": [
      "pre"
    ],
    "ifguid[9]": [
      "pre"
    ],
    "'-'": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "ifguid[14]": [
      "pre"
    ],
    "ifguid[19]": [
      "pre"
    ],
    "ifguid[24]": [
      "pre"
    ],
    "ifguid[37]": [
      "pre"
    ],
    "'}'": [
      "pre"
    ],
    "int": [
      "pre"
    ],
    "i=1": [
      "pre"
    ],
    "whilei<37)": [
      "pre"
    ],
    "if(guid[i]": [
      "pre"
    ],
    "'a'": [
      "pre",
      "pre"
    ],
    "&&": [
      "pre",
      "pre",
      "pre"
    ],
    "guidi]": [
      "pre",
      "pre",
      "pre"
    ],
    "'f'": [
      "pre",
      "pre"
    ],
    "||": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "guid[i]": [
      "pre",
      "pre"
    ],
    "'0'": [
      "pre"
    ],
    "'9'": [
      "pre"
    ],
    "else": [
      "pre"
    ],
    "i++": [
      "pre",
      "pre"
    ],
    "ifi": [
      "pre"
    ],
    "==": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "i": [
      "pre",
      "pre",
      "pre"
    ],
    "true}": [
      "pre"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "What to Do",
      "Why",
      "When",
      "How",
      "Problem Example",
      "Solution Example"
    ],
    "ul": [
      "Applications written using Servlets or JSP."
    ],
    "li": [
      "Applications written using Servlets or JSP.",
      "Check language barriers. Distinguishing the boundaries between native and Java code is very important. Because the Java sandbox provides multiple security checks to its code, it is important to know the boundary between where the Java sandbox ends and the compiled code begins to interact directly with the CPU, so you can compensate for the lack of such checks inside the native code.",
      "Validate for length, range, format and type. After discovering the language boundaries, determine the type, format and structure of the data that is passed between Java and native code. Build a validator for each type of data that is passed between the two environments.",
      "Construct a set of validators. Centralize your application's validators as it helps strengthen the code by limiting the amount of scattered validation code throughout your application. Place the set of validators on the language barriers. Your application should pass data between native and Java code only through its set of validators."
    ],
    "p": [
      "Validate all data that is passed between Java code and native code.",
      "Unchecked input and/or output can lead to buffer overflows, injection based attacks such as SQL injection and cross-site scripting, etc., that can exploit weaknesses in the application.",
      "Your application should always verify data that is passed between native code and Java.",
      "There are several things to consider when validating input/output between native and Java code:",
      "Check language barriers. Distinguishing the boundaries between native and Java code is very important. Because the Java sandbox provides multiple security checks to its code, it is important to know the boundary between where the Java sandbox ends and the compiled code begins to interact directly with the CPU, so you can compensate for the lack of such checks inside the native code.",
      "Validate for length, range, format and type. After discovering the language boundaries, determine the type, format and structure of the data that is passed between Java and native code. Build a validator for each type of data that is passed between the two environments.",
      "Construct a set of validators. Centralize your application's validators as it helps strengthen the code by limiting the amount of scattered validation code throughout your application. Place the set of validators on the language barriers. Your application should pass data between native and Java code only through its set of validators.",
      "The following segment shows a JNI code that utilizes a COM object. Making the assumption that the Java code will handle data validation, the JNI segment does not verify that the passed input is a valid GUID. Since invalid GUIDs may cause unhandled exceptions, an attacker can force the application to disclose its call stack and possibly its source filenames.",
      "The following segment shows a JNI code that utilizes a COM object. Because the passed input is validated as being a GUID, the application reduces the risk of unhandled exceptions."
    ],
    "ol": [
      "Check language barriers. Distinguishing the boundaries between native and Java code is very important. Because the Java sandbox provides multiple security checks to its code, it is important to know the boundary between where the Java sandbox ends and the compiled code begins to interact directly with the CPU, so you can compensate for the lack of such checks inside the native code.\n    \n    \n      \n        Validate for length, range, format and type. After discovering the language boundaries, determine the type, format and structure of the data that is passed between Java and native code. Build a validator for each type of data that is passed between the two environments. \n    \n    \n      \n        Construct a set of validators. Centralize your application's validators as it helps strengthen the code by limiting the amount of scattered validation code throughout your application. Place the set of validators on the language barriers. Your application should pass data between native and Java code only through its set of validators."
    ],
    "strong": [
      "Check language barriers.",
      "Validate for length, range, format and type.",
      "Construct a set of validators."
    ],
    "pre": [
      "#include <jni.h>#include <sys/types.h>#include <fcntl.h>#include <stdio.h>#include <atlbase.h>#include <windows.h>#include <wtypes.h>JNIEXPORT jbooleanJNICALL Java_Identifier_invokeObject      (JNIEnv * env, jobject jobj, jstring jguid){      HRESULT result;      CLSID clsid;      IUnknown *pIunkn;      LPWSTR guid;      jboolean iscopy;      jboolean ret = false;      char* temp_guid = (*env)->GetStringUTFChars(env, jguid, &iscopy);      //The application fails to verify that the GUID is valid      guid = SysAllocStringLen(0, 38);      MultiByteToWideChar(CP_ACP, 0, temp_guid, -1, guid, 38);      result = GUIDFromString(guid, &clsid);      ...      return ret;}",
      "#include <jni.h>#include <sys/types.h>#include <fcntl.h>#include <stdio.h>#include <atlbase.h>#include <windows.h>#include <wtypes.h>  JNIEXPORT jboolean JNICALL Java_Identifier_invokeObject      (JNIEnv * env, jobject jobj, jstring jguid){      HRESULT result;      CLSID clsid;      IUnknown *pIunkn;      LPWSTR guid;      jboolean iscopy;      jboolean ret = false;      char* temp_guid = (*env)->GetStringUTFChars(env, jguid, &iscopy);      // The application verifies that the input matches the criteria for a GUID      if(!validGUID(temp_guid))      {            return ret;      }      guid = SysAllocStringLen(0, 38);      MultiByteToWideChar(CP_ACP, 0, temp_guid, -1, guid, 38);      result = GUIDFromString(guid, &clsid);       ...      return ret;}bool validGUID(char *guid){      // Check that GUID is of right length      if(strlen(guid) != 38) return false;      // Sample GUID: {1EF4A023-143A-4e0e-AD72-69C2C68C2D70}      if(guid[0]  != '{') return false;      if(guid[9]  != '-') return false;      if(guid[14] != '-') return false;      if(guid[19] != '-') return false;      if(guid[24] != '-') return false;      if(guid[37] != '}') return false;      int i=1;      while(i<37)      {            if((guid[i] >= 'a' && guid[i] <= 'f')                  || (guid[i] >= 'A' && guid[i] <= 'F')                  || (guid[i] >= '0' && guid[i] <= '9')            {                  // GUID is valid            }            else            {                  return false;            }            i++;            if(i == 9 || i == 14 || i == 19 || i == 24)            {                  i++;            }      }      return true;}"
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ]
  },
  "links": [],
  "html": "<h1>Applies to</h1>\n  <ul>\n    <li>Applications written using Servlets or JSP.</li>\n  </ul>\n  <h1>What to Do</h1>\n  <p>Validate all data that is passed between Java code and native code.</p>\n  <h1>Why</h1>\n  <p>Unchecked input and/or output can lead to buffer overflows, injection based attacks such as SQL injection and cross-site scripting, etc., that can&nbsp;exploit weaknesses in the application.</p>\n  <h1>When</h1>\n  <p>Your application should always verify data that is passed between native code and Java.</p>\n  <h1>How</h1>\n  <p>There are several things to consider when validating input/output between native and Java code: </p>\n  <ol>\n    <li>\n      <p>\n        <strong>Check language barriers. </strong>Distinguishing&nbsp;the boundaries between native and Java code is very important. Because the Java sandbox provides multiple security checks to its code, it is important to know the boundary&nbsp;between&nbsp;where the Java sandbox ends and the compiled code begins&nbsp;to interact&nbsp;directly with the CPU, so you can&nbsp;compensate for&nbsp;the lack of such checks inside the native code.</p>\n    </li>\n    <li>\n      <p>\n        <strong>Validate for length, range, format and type. </strong>After discovering the language boundaries, determine the type, format and structure of the data that is passed between Java and native code. Build a validator for each type of data that is passed between the two environments. </p>\n    </li>\n    <li>\n      <p>\n        <strong>Construct a set of validators. </strong>Centralize your application's validators as it helps strengthen the code by limiting the amount of scattered validation code throughout your application. Place the set of validators on the language barriers. Your application should pass data between native and Java code only through its set of validators.</p>\n    </li>\n  </ol>\n  <h1>Problem Example</h1>\n  <p>The following segment shows a JNI code that utilizes a COM object. Making the assumption that the Java code will handle data validation, the JNI segment does not verify that the passed input is a valid GUID. Since invalid GUIDs may cause unhandled exceptions, an attacker can force the application to disclose its call stack and possibly its source filenames.</p>\n  <pre>#include &lt;jni.h&gt;<br />#include &lt;sys/types.h&gt;<br />#include &lt;fcntl.h&gt;<br />#include &lt;stdio.h&gt;<br />#include &lt;atlbase.h&gt;<br />#include &lt;windows.h&gt;<br />#include &lt;wtypes.h&gt;<br />JNIEXPORT jboolean<br />JNICALL Java_Identifier_invokeObject<br />      (JNIEnv * env, jobject jobj, jstring jguid)<br />{<br />      HRESULT result;<br />      CLSID clsid;<br />      IUnknown *pIunkn;<br />      LPWSTR guid;<br />      jboolean iscopy;<br />      jboolean ret = false;<br />      char* temp_guid = (*env)-&gt;GetStringUTFChars(env, jguid, &iscopy);<br />      //The application fails to verify that the GUID is valid<br />      guid = SysAllocStringLen(0, 38);<br />      MultiByteToWideChar(CP_ACP, 0, temp_guid, -1, guid, 38);<br />      result = GUIDFromString(guid, &clsid);<br />      ...<br />      return ret;<br />}</pre>\n  <h1>Solution Example</h1>\n  <p>The following segment shows a JNI code that utilizes a COM object. Because the passed input is validated as being a GUID, the application reduces the risk of unhandled exceptions.</p>\n  <pre>#include &lt;jni.h&gt;<br />#include &lt;sys/types.h&gt;<br />#include &lt;fcntl.h&gt;<br />#include &lt;stdio.h&gt;<br />#include &lt;atlbase.h&gt;<br />#include &lt;windows.h&gt;<br />#include &lt;wtypes.h&gt;  <br />JNIEXPORT jboolean <br />JNICALL Java_Identifier_invokeObject<br />      (JNIEnv * env, jobject jobj, jstring jguid)<br />{<br />      HRESULT result;<br />      CLSID clsid;<br />      IUnknown *pIunkn;<br />      LPWSTR guid;<br />      jboolean iscopy;<br />      jboolean ret = false;<br />      char* temp_guid = (*env)-&gt;GetStringUTFChars(env, jguid, &iscopy);<br />      // The application verifies that the input matches the criteria for a GUID<br />      if(!validGUID(temp_guid))<br />      {<br />            return ret;<br />      }<br />      guid = SysAllocStringLen(0, 38);<br />      MultiByteToWideChar(CP_ACP, 0, temp_guid, -1, guid, 38);<br />      result = GUIDFromString(guid, &clsid);<br />       ...<br />      return ret;<br />}<br /><br />bool validGUID(char *guid)<br />{<br />      // Check that GUID is of right length<br />      if(strlen(guid) != 38) return false;<br />      // Sample GUID: {1EF4A023-143A-4e0e-AD72-69C2C68C2D70<br />}<br />      if(guid[0]  != '{') return false;<br />      if(guid[9]  != '-') return false;<br />      if(guid[14] != '-') return false;<br />      if(guid[19] != '-') return false;<br />      if(guid[24] != '-') return false;<br />      if(guid[37] != '}') return false;<br />      int i=1;<br />      while(i&lt;37)<br />      {<br />            if((guid[i] &gt;= 'a' && guid[i] &lt;= 'f')<br />                  || (guid[i] &gt;= 'A' && guid[i] &lt;= 'F')<br />                  || (guid[i] &gt;= '0' && guid[i] &lt;= '9')<br />            {<br />                  // GUID is valid<br />            }<br />            else<br />            {<br />                  return false;<br />            }<br />            i++;<br />            if(i == 9 || i == 14 || i == 19 || i == 24)<br />            {<br />                  i++;<br />            }<br />      }<br /><br />      return true;<br />}</pre>\n  <br />"
}