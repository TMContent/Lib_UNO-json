<h1>Applies To</h1><p>Any application with logging enabled.
</p><h1>Description</h1><p>In a false transaction attack, an attacker may attempt to hide malicious requests behind a cloud of false transactions. If the attacker can fill log files up with legitimate looking requests, the attack may go unnoticed. Additionally an attacker may attempt to fill up log space so the logging application can no longer write any new logs to disk. Once the logs have been filled to capacity the attacker is free to conduct attacks, knowing that the malicious requests will not be traceable.
</p><p>
In another type of false transaction attack, the attacker may generate a log entry for a transaction that did not actually happen. The attacker will then return to the victim claiming to have fully executed the transaction. For example the attacker may generate a log or receipt in a companyâ€™s database that implies he purchased an item. The attacker then returns to the company claiming to have purchased the item but never received it. The company checks the logs and notices that indeed the attacker does have an entry in the completed orders database. Since the company has no way of knowing the logs have been tampered with, the company may reimburse the attacker or provide them with the product or service for free.
</p><h1>Impact</h1><ul><li>Repudiation: If the logs are filled, there will be no way to discover what the attacker was able to do.</li>
<li>Denial of Service: If the disk on a production server is filled to capacity, other required services may be denied critical resources.</li>
<li>Falsified transaction data: Transaction logs may contain the only record of a transaction. If an attacker can change this information, he may be able to falsely claim a transaction took place when in fact it did not.</li>
</ul><h1>Vulnerabilities</h1><ul><li>Improperly logging requests.</li>
<li>Logging on production servers.</li>
<li>Improper permissions on transaction logs.</li>
<li>Other vulnerabilities that would lead to an attacker being able to edit or change log data.</li>
</ul><h1>Countermeasures</h1><ul><li>Log requests on a separate server. In the case that the log server is unresponsive, decide whether it is more important to keep the production server up without logging, or to turn off the production server.</li>
<li>Review logs. Create or use a reporting service that will allow you to view possible attacks.</li>
<li>Ensure proper permissions are placed on all log files.</li>
<li>Ensure that you are using the principle of least privilege with SQL or other data stores to make sure there is no other way to change log data.</li>
<li>Ensure that the only way to cause the system to create a log entry is by properly creating the transaction being logged, following all the business rules regarding that transaction.</li>
</ul><h1>Additional Resources</h1><ul><li>For more information about preventing repudiation, see: <a href="http://en.wikipedia.org/wiki/Non-repudiation">http://en.wikipedia.org/wiki/Non-repudiation</a></li>
</ul><h1>Related Items</h1><ul><li><a href="7e2fe1a5-ad30-4805-8421-767275dea35e">Attack: Repudiation Attack</a></li>
<li><a href="b1757bda-0a0d-48e7-b101-3c4088e41878">Attack: SQL Injection Attack</a></li>
<li><a href="4c56f015-31b0-4570-a194-707d9cf6db26">Attack: Business Rule Attack</a></li>
<li><a href="468c8d7a-ffc6-49ad-bef5-1886fd809a96">Attack: Denial of Service Attack</a></li>
</ul>  

