<h2>Applies To</h2>
<ul>
<li>Scala and Play Framework 2.1.0+</li>
</ul>
<h2>What to Check For</h2>
<p>Verify that the &quot;Secure&quot; and &quot;HTTPOnly&quot; flags are set on all sensitive cookies, especially cookies containing session IDs.</p>
<h2>Why</h2>
<p>Set the &quot;Secure&quot; flag on all sensitive cookies to protect the contents of the sensitive cookies from eavesdropping attacks. Setting the &quot;Secure&quot; flag on sensitive cookies ensures they are only transferred over connections that are secured by TLS. The &quot;HTTPOnly&quot; flag prevents the contents of the marked cookie from being accessed by client-side script. This helps protect against Cross-Site Scripting attacks.</p>
<h2>How to Check</h2>
<p>To verify that the &quot;Secure&quot; and &quot;HTTPOnly&quot; flags are set on all sensitive cookies:</p>
<ol>
<li><strong>Verify that TLS is available.</strong> The &quot;Secure&quot; flag forces cookies to be sent over TLS. TLS has to be available for this to work.</li>
<li><strong>Identify sensitive cookies.</strong> Session cookies should always be considered sensitive. Enumerate all cookies used by the application. Make a list of cookies that may contain sensitive information.</li>
<li><strong>Identify code that creates sensitive cookies.</strong> For each sensitive cookie in the list, find the code that creates that cookie.</li>
<li><strong>Verify that the &quot;Secure&quot; and &quot;HTTPOnly&quot; flags are set for each sensitive cookie.</strong> For each piece of code that creates a sensitive cookie, verify that code exists that sets the &quot;Secure&quot; and &quot;HTTPOnly&quot; flags, as follows: In the &quot;application.conf&quot; file, “application.session.httpOnly=true” and &quot;application.session.secure=true”&quot; should be set.</li>
</ol>
<h2>How to Fix</h2>
<p>To set the &quot;Secure&quot; and &quot;HTTPOnly&quot; flags on all sensitive cookies:</p>
<ol>
<li><strong>Verify that TLS is available.</strong> The &quot;Secure&quot; flag forces cookies to be sent over TLS. TLS has to be available for this to work.</li>
<li><strong>Identify sensitive cookies.</strong> Session cookies should always be considered sensitive. Enumerate all cookies used by the application. Make a list of cookies that may contain sensitive information.</li>
<li><strong>Identify code that creates sensitive cookies.</strong> For each sensitive cookie in the list, find the code that creates that cookie.</li>
<li><strong>Set the &quot;Secure&quot; and &quot;HTTPOnly&quot; flags for each sensitive cookie.</strong>  Enable the HTTPOnly flag using “application.session.httpOnly=true” in the “application.conf” file. Enable the Secure flag on the cookie using “application.session.secure=true” in the “application.conf” file.</li>
</ol>
