{
  "id": "00000000-0000-0000-0000-00000069528c",
  "checksum": "eae0509cb205983604f6f3ad4b9ae3910ee9f511",
  "words": {
    "applies": [
      "h2"
    ],
    "to": [
      "h2",
      "h2",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "strong",
      "li",
      "li",
      "strong",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "html5": [
      "ul",
      "li"
    ],
    "and": [
      "ul",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p"
    ],
    "javascript": [
      "ul",
      "li",
      "ol",
      "li",
      "strong",
      "ul",
      "li"
    ],
    "what": [
      "h2"
    ],
    "do": [
      "h2",
      "ol",
      "li"
    ],
    "validate": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "strong",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "a": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "p"
    ],
    "url": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "strong"
    ],
    "before": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "li",
      "strong"
    ],
    "it": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "p"
    ],
    "is": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li"
    ],
    "passed": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "strong",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "strong",
      "li",
      "li",
      "strong",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "eventsource": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "strong",
      "p",
      "tt",
      "p",
      "p",
      "tt",
      "tt",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "constructor": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "strong",
      "p",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "ensure": [
      "p",
      "p",
      "ol",
      "li"
    ],
    "that": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "p"
    ],
    "messages": [
      "p",
      "p"
    ],
    "are": [
      "p",
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "strong",
      "ul",
      "li",
      "a"
    ],
    "being": [
      "p"
    ],
    "sent": [
      "p"
    ],
    "from": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "servers": [
      "p"
    ],
    "you": [
      "p",
      "p",
      "p",
      "ol",
      "li"
    ],
    "expect": [
      "p"
    ],
    "not": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li"
    ],
    "potentially": [
      "p",
      "p"
    ],
    "malicious": [
      "p",
      "p"
    ],
    "source": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "tt",
      "pre",
      "pre"
    ],
    "why": [
      "h2"
    ],
    "if": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "tt"
    ],
    "fail": [
      "p"
    ],
    "could": [
      "p"
    ],
    "receive": [
      "p"
    ],
    "contain": [
      "p"
    ],
    "or": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "incorrect": [
      "p"
    ],
    "data": [
      "p"
    ],
    "when": [
      "h2",
      "p"
    ],
    "always": [
      "p"
    ],
    "how": [
      "h2"
    ],
    "using": [
      "p",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "object": [
      "p",
      "p",
      "p",
      "ul",
      "li"
    ],
    "use": [
      "p",
      "ol",
      "ol",
      "li",
      "strong",
      "li"
    ],
    "regular": [
      "p",
      "ol",
      "li",
      "strong",
      "p"
    ],
    "expression": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "strong",
      "li",
      "strong",
      "p"
    ],
    "regex": [
      "p",
      "ol",
      "li"
    ],
    "make": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "strong"
    ],
    "sure": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "strong"
    ],
    "no": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "scheme": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li"
    ],
    "included": [
      "p",
      "ol",
      "li"
    ],
    "in": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "li"
    ],
    "this": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li"
    ],
    "will": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "force": [
      "p"
    ],
    "be": [
      "p",
      "ol",
      "li"
    ],
    "relative": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong"
    ],
    "current": [
      "p"
    ],
    "web": [
      "p"
    ],
    "page": [
      "p"
    ],
    "script": [
      "p"
    ],
    "which": [
      "p",
      "ol",
      "li"
    ],
    "also": [
      "p"
    ],
    "event": [
      "p"
    ],
    "another": [
      "p"
    ],
    "site": [
      "p",
      "ol",
      "li"
    ],
    "perform": [
      "p",
      "ol",
      "li"
    ],
    "validation": [
      "p",
      "p"
    ],
    "follow": [
      "p"
    ],
    "these": [
      "p"
    ],
    "steps": [
      "p"
    ],
    "locate": [
      "ol",
      "li",
      "strong"
    ],
    "instances": [
      "ol",
      "li",
      "strong"
    ],
    "your": [
      "ol",
      "li",
      "strong"
    ],
    "usage": [
      "ol",
      "li"
    ],
    "of": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "li",
      "p"
    ],
    "as": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "follows": [
      "ol",
      "li"
    ],
    "var": [
      "ol",
      "li",
      "tt",
      "pre",
      "pre"
    ],
    "=": [
      "ol",
      "li",
      "tt",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "new": [
      "ol",
      "li",
      "tt",
      "pre",
      "pre",
      "pre"
    ],
    "eventsource\"eventsource.php\");": [
      "ol",
      "li",
      "tt"
    ],
    "pay": [
      "ol",
      "li"
    ],
    "particular": [
      "ol",
      "li"
    ],
    "attention": [
      "ol",
      "li"
    ],
    "code": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p"
    ],
    "inside": [
      "ol",
      "li"
    ],
    "function": [
      "ol",
      "li"
    ],
    "where": [
      "ol",
      "li"
    ],
    "may": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "provided": [
      "ol",
      "li"
    ],
    "an": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "argument": [
      "ol",
      "li"
    ],
    "other": [
      "ol",
      "li"
    ],
    "determine": [
      "ol",
      "li",
      "strong"
    ],
    "policy": [
      "ol",
      "li",
      "strong"
    ],
    "for": [
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "allowing": [
      "ol",
      "ol",
      "li",
      "li",
      "strong"
    ],
    "sources": [
      "ol",
      "li",
      "strong"
    ],
    "allow": [
      "ol",
      "li"
    ],
    "includes": [
      "ol",
      "li"
    ],
    "“http:”": [
      "ol",
      "li"
    ],
    "“https”)": [
      "ol",
      "li"
    ],
    "at": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li"
    ],
    "beginning": [
      "ol",
      "li"
    ],
    "value": [
      "ol",
      "li"
    ],
    "because": [
      "ol",
      "li"
    ],
    "means": [
      "ol",
      "li"
    ],
    "come": [
      "ol",
      "li"
    ],
    "different": [
      "ol",
      "li"
    ],
    "instead": [
      "ol",
      "li"
    ],
    "should": [
      "ol",
      "li"
    ],
    "consider": [
      "ol",
      "li"
    ],
    "only": [
      "ol",
      "ol",
      "li",
      "li",
      "strong"
    ],
    "urls": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "strong",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "start": [
      "ol",
      "li"
    ],
    "with": [
      "ol",
      "li",
      "p"
    ],
    "check": [
      "ol",
      "li",
      "strong"
    ],
    "length": [
      "ol",
      "ol",
      "li",
      "li",
      "strong"
    ],
    "validating": [
      "ol",
      "li",
      "strong"
    ],
    "property": [
      "ol",
      "li"
    ],
    "size": [
      "ol",
      "li"
    ],
    "domain": [
      "ol",
      "li"
    ],
    "so": [
      "ol",
      "li"
    ],
    "large": [
      "ol",
      "li"
    ],
    "cause": [
      "ol",
      "li"
    ],
    "denial": [
      "ol",
      "li"
    ],
    "service": [
      "ol",
      "li"
    ],
    "dos).": [
      "ol",
      "li"
    ],
    "write": [
      "ol",
      "li",
      "strong"
    ],
    "validates": [
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "p"
    ],
    "path": [
      "ol",
      "li"
    ],
    "following": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "example": [
      "ol",
      "ol",
      "li",
      "li",
      "h2",
      "h2"
    ],
    "uses": [
      "ol",
      "li",
      "p"
    ],
    "negative": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "look-ahead": [
      "ol",
      "li"
    ],
    "group": [
      "ol",
      "li"
    ],
    "format": [
      "ol",
      "li"
    ],
    "?!<expression>)": [
      "ol",
      "li",
      "tt"
    ],
    "^?!https?:)": [
      "ol",
      "li",
      "tt"
    ],
    "s?": [
      "ol",
      "li",
      "tt"
    ],
    "part": [
      "ol",
      "li"
    ],
    "allows": [
      "ol",
      "li"
    ],
    "capture": [
      "ol",
      "li"
    ],
    "both": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "http": [
      "ol",
      "li"
    ],
    "https": [
      "ol",
      "li"
    ],
    "over": [
      "ol",
      "li"
    ],
    "secure": [
      "ol",
      "li"
    ],
    "sockets": [
      "ol",
      "li"
    ],
    "layer": [
      "ol",
      "li"
    ],
    "https).": [
      "ol",
      "li"
    ],
    "?": [
      "ol",
      "li",
      "tt"
    ],
    "character": [
      "ol",
      "li"
    ],
    "matches": [
      "ol",
      "li"
    ],
    "preceding": [
      "ol",
      "li"
    ],
    "expressions)": [
      "ol",
      "li"
    ],
    "occurs": [
      "ol",
      "li"
    ],
    "either": [
      "ol",
      "li"
    ],
    "all": [
      "ol",
      "li"
    ],
    "most": [
      "ol",
      "li"
    ],
    "one": [
      "ol",
      "li"
    ],
    "time": [
      "ol",
      "li"
    ],
    "include": [
      "ol",
      "li",
      "strong"
    ],
    "they": [
      "ol",
      "li",
      "strong"
    ],
    "sourceurl": [
      "ol",
      "li",
      "tt",
      "pre"
    ],
    "variable": [
      "ol",
      "li"
    ],
    "valid": [
      "ol",
      "li"
    ],
    "pattern.test(sourceurl))": [
      "ol",
      "li",
      "tt",
      "pre"
    ],
    "test": [
      "ol",
      "li",
      "strong"
    ],
    "thoroughly": [
      "ol",
      "li",
      "strong"
    ],
    "allowed": [
      "ol",
      "li",
      "strong"
    ],
    "thorough": [
      "ol",
      "li"
    ],
    "testing": [
      "ol",
      "li"
    ],
    "positive": [
      "ol",
      "li"
    ],
    "conditions": [
      "ol",
      "li"
    ],
    "verify": [
      "ol",
      "li"
    ],
    "functionality": [
      "ol",
      "li"
    ],
    "problem": [
      "h2"
    ],
    "calls": [
      "p"
    ],
    "on": [
      "p"
    ],
    "any": [
      "p"
    ],
    "kind": [
      "p"
    ],
    "eventsource\"someserver.php\");": [
      "pre"
    ],
    "solution": [
      "h2"
    ],
    "browser": [
      "p"
    ],
    "supports": [
      "p"
    ],
    "string": [
      "p"
    ],
    "into": [
      "p"
    ],
    "pattern": [
      "pre"
    ],
    "regexp/^(?!https?:)/);\nvar": [
      "pre"
    ],
    "\"http//hacker.example.com\";\n\nif": [
      "pre"
    ],
    "{\tvar": [
      "pre"
    ],
    "eventsourcesourceurl);\n}": [
      "pre"
    ],
    "else": [
      "pre"
    ],
    "{\talert(\"bad": [
      "pre"
    ],
    "url!\";\n}": [
      "pre"
    ],
    "additional": [
      "h2"
    ],
    "resources": [
      "h2"
    ],
    "information": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "about": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "regexp": [
      "ul",
      "li"
    ],
    "see": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "http//www.w3schools.com/jsref/jsref_obj_regexp.asp": [
      "ul",
      "li",
      "a"
    ],
    "server-sent": [
      "ul",
      "li",
      "h2",
      "h2"
    ],
    "events": [
      "ul",
      "li",
      "h2",
      "h2"
    ],
    "http//www.w3.org/tr/eventsource": [
      "ul",
      "li",
      "a"
    ],
    "guideline": [
      "h2"
    ],
    "checklist": [
      "h2"
    ],
    "item": [
      "h2"
    ],
    "validated": [
      "ul",
      "li",
      "a"
    ]
  },
  "tags": {
    "h2": [
      "Applies To",
      "What to Do",
      "Why",
      "When",
      "How",
      "Problem Example",
      "Solution Example",
      "Additional Resources",
      "Server-sent Events Guideline",
      "Server-sent Events Checklist Item"
    ],
    "ul": [
      "HTML5 and JavaScript",
      "For information about the JavaScript RegExp object, see http://www.w3schools.com/jsref/jsref_obj_regexp.asp\n For information about Server-Sent Events, see http://www.w3.org/TR/eventsource",
      "Validate URLs Passed to the EventSource Constructor",
      "URLs Passed to the EventSource Constructor are Validated"
    ],
    "li": [
      "HTML5 and JavaScript",
      "Locate the instances in your JavaScript that use the EventSource constructor. The usage of the EventSource constructor is as follows:  var source = new EventSource(\"eventsource.php\");  Pay particular attention if this code is inside a function where the URL of the source may be provided as an argument from other code.",
      "Determine a policy for allowing sources. Do not allow an EventSource that includes a scheme (“http:” or “https:”) at the beginning of the value, because this means the EventSource may come from a different site. Instead, you should consider only allowing relative URLs, which will not start with the scheme.",
      "Check the length of the URL before validating it. Use the length property to ensure the size of the domain is not so large that it will cause a RegEx denial of service (DoS).",
      "Write a regular expression that validates the URL. Make sure that no scheme is included in the URL, and make sure it is a relative path. The following example uses a negative look-ahead group in the format (?!<expression>) .  ^(?!https?:) \nThe s? part of this expression allows it to capture both HTTP and HTTPS over Secure Sockets Layer (HTTPS). The ? character matches if the preceding expression(s) occurs either not at all or at most one time.",
      "Include the expression to validate URLs before they are passed to the EventSource constructor. For example, the following code validates the sourceUrl variable to make sure it is valid before using it:  if (pattern.test(sourceUrl))",
      "Test the expression thoroughly to make sure only relative URLs are allowed. Perform thorough testing using both positive and negative conditions to verify the functionality.",
      "For information about the JavaScript RegExp object, see http://www.w3schools.com/jsref/jsref_obj_regexp.asp",
      "For information about Server-Sent Events, see http://www.w3.org/TR/eventsource",
      "Validate URLs Passed to the EventSource Constructor",
      "URLs Passed to the EventSource Constructor are Validated"
    ],
    "p": [
      "Validate a URL before it is passed to the EventSource constructor to ensure that messages are being sent from servers you expect, and not from a potentially malicious source.",
      "If you fail to validate a URL passed to the EventSource constructor, you could potentially receive messages that contain malicious or incorrect data.",
      "Always validate a URL passed to the EventSource constructor.",
      "When using the EventSource object, use a regular expression (RegEx object) to make sure that no scheme is included in the URL. This will force the URL to be relative to the current web page or script, which will also ensure that the event source is not from another site. To perform this validation, follow these steps:",
      "The following code calls the constructor on the EventSource object with no validation of any kind:",
      "",
      "The following code validates that the browser supports EventSource, and it uses a regular expression to validate the string passed into the EventSource constructor:",
      ""
    ],
    "ol": [
      "Locate the instances in your JavaScript that use the EventSource constructor. The usage of the EventSource constructor is as follows:  var source = new EventSource(\"eventsource.php\");  Pay particular attention if this code is inside a function where the URL of the source may be provided as an argument from other code. \n Determine a policy for allowing sources. Do not allow an EventSource that includes a scheme (“http:” or “https:”) at the beginning of the value, because this means the EventSource may come from a different site. Instead, you should consider only allowing relative URLs, which will not start with the scheme.\n Check the length of the URL before validating it. Use the length property to ensure the size of the domain is not so large that it will cause a RegEx denial of service (DoS). \n Write a regular expression that validates the URL. Make sure that no scheme is included in the URL, and make sure it is a relative path. The following example uses a negative look-ahead group in the format (?!<expression>) .  ^(?!https?:) \nThe s? part of this expression allows it to capture both HTTP and HTTPS over Secure Sockets Layer (HTTPS). The ? character matches if the preceding expression(s) occurs either not at all or at most one time.\n Include the expression to validate URLs before they are passed to the EventSource constructor. For example, the following code validates the sourceUrl variable to make sure it is valid before using it:  if (pattern.test(sourceUrl)) \n Test the expression thoroughly to make sure only relative URLs are allowed. Perform thorough testing using both positive and negative conditions to verify the functionality."
    ],
    "strong": [
      "Locate the instances in your JavaScript that use the EventSource constructor.",
      "Determine a policy for allowing sources.",
      "Check the length of the URL before validating it.",
      "Write a regular expression that validates the URL.",
      "Include the expression to validate URLs before they are passed to the EventSource constructor.",
      "Test the expression thoroughly to make sure only relative URLs are allowed."
    ],
    "tt": [
      "var source = new EventSource(\"eventsource.php\");",
      "(?!<expression>)",
      "^(?!https?:)",
      "s?",
      "?",
      "sourceUrl",
      "if (pattern.test(sourceUrl))",
      "EventSource",
      "EventSource",
      "EventSource"
    ],
    "br": [
      "",
      "",
      ""
    ],
    "pre": [
      "var source = new EventSource(\"someserver.php\");",
      "var pattern = new RegExp(/^(?!https?:)/);\nvar sourceUrl = \"http://hacker.example.com\";\n\nif (pattern.test(sourceUrl)) {\n\tvar source = new EventSource(sourceUrl);\n} else {\n\talert(\"Bad URL!\");\n}"
    ],
    "a": [
      "http://www.w3schools.com/jsref/jsref_obj_regexp.asp",
      "http://www.w3.org/TR/eventsource",
      "Validate URLs Passed to the EventSource Constructor",
      "URLs Passed to the EventSource Constructor are Validated"
    ]
  },
  "links": [
    {
      "href": "http://www.w3schools.com/jsref/jsref_obj_regexp.asp",
      "text": "http://www.w3schools.com/jsref/jsref_obj_regexp.asp"
    },
    {
      "href": "http://www.w3.org/TR/eventsource",
      "text": "http://www.w3.org/TR/eventsource"
    },
    {
      "href": "00000000-0000-0000-0000-00000069528c",
      "text": "Validate URLs Passed to the EventSource Constructor"
    },
    {
      "href": "00000000-0000-0000-0000-000000010f15",
      "text": "URLs Passed to the EventSource Constructor are Validated"
    }
  ],
  "html": "<h2>Applies To</h2><ul><li> HTML5 and JavaScript</li>\n</ul><h2>What to Do</h2><p>Validate a URL before it is passed to the EventSource constructor to ensure that messages are being sent from servers you expect, and not from a potentially malicious source.\n</p><h2>Why</h2><p>If you fail to validate a URL passed to the EventSource constructor, you could potentially receive messages that contain malicious or incorrect data.\n</p><h2>When</h2><p>Always validate a URL passed to the EventSource constructor.\n</p><h2>How</h2><p>When using the EventSource object, use a regular expression (RegEx object) to make sure that no scheme is included in the URL. This will force the URL to be relative to the current web page or script, which will also ensure that the event source is not from another site. To perform this validation, follow these steps:\n</p><ol>\n<li> <strong>Locate the instances in your JavaScript that use the EventSource constructor.</strong> The usage of the EventSource constructor is as follows: <tt> var source = new EventSource(\"eventsource.php\"); </tt> Pay particular attention if this code is inside a function where the URL of the source may be provided as an argument from other code. </li>\n<li> <strong>Determine a policy for allowing sources.</strong> Do not allow an EventSource that includes a scheme (“http:” or “https:”) at the beginning of the value, because this means the EventSource may come from a different site. Instead, you should consider only allowing relative URLs, which will not start with the scheme.</li>\n<li> <strong>Check the length of the URL before validating it.</strong> Use the length property to ensure the size of the domain is not so large that it will cause a RegEx denial of service (DoS). </li>\n<li> <strong>Write a regular expression that validates the URL.</strong> Make sure that no scheme is included in the URL, and make sure it is a relative path. The following example uses a negative look-ahead group in the format <tt>(?!&lt;expression&gt;) </tt>. <tt> ^(?!https?:) </tt>\nThe <tt>s?</tt> part of this expression allows it to capture both HTTP and HTTPS over Secure Sockets Layer (HTTPS). The <tt>?</tt> character matches if the preceding expression(s) occurs either not at all or at most one time.</li>\n<li> <strong>Include the expression to validate URLs before they are passed to the EventSource constructor.</strong> For example, the following code validates the <tt>sourceUrl</tt> variable to make sure it is valid before using it:<br> <tt> if (pattern.test(sourceUrl)) </tt></li>\n<li> <strong>Test the expression thoroughly to make sure only relative URLs are allowed.</strong> Perform thorough testing using both positive and negative conditions to verify the functionality.</li>\n</ol><h2>Problem Example</h2><p>The following code calls the constructor on the <tt>EventSource</tt> object with no validation of any kind:\n</p><pre>var source = new EventSource(\"someserver.php\");\n</pre><p><br></p><h2>Solution Example</h2><p>The following code validates that the browser supports <tt>EventSource</tt>, and it uses a regular expression to validate the string passed into the <tt>EventSource</tt> constructor:\n</p><pre>var pattern = new RegExp(/^(?!https?:)/);\nvar sourceUrl = \"http://hacker.example.com\";\n\nif (pattern.test(sourceUrl)) {\n\tvar source = new EventSource(sourceUrl);\n} else {\n\talert(\"Bad URL!\");\n}\n</pre><p>\n<br></p><h2>Additional Resources</h2><ul><li> For information about the JavaScript RegExp object, see <a href=\"http://www.w3schools.com/jsref/jsref_obj_regexp.asp\">http://www.w3schools.com/jsref/jsref_obj_regexp.asp</a></li>\n<li> For information about Server-Sent Events, see <a href=\"http://www.w3.org/TR/eventsource\">http://www.w3.org/TR/eventsource</a></li>\n</ul><h2>Server-sent Events Guideline</h2><ul><li> <a href=\"00000000-0000-0000-0000-00000069528c\">Validate URLs Passed to the EventSource Constructor</a></li>\n</ul><h2>Server-sent Events Checklist Item</h2><ul><li> <a href=\"00000000-0000-0000-0000-000000010f15\">URLs Passed to the EventSource Constructor are Validated</a></li>\n</ul>"
}