<h1>What to Do</h1>
  <p>Use&nbsp;Active Directory policy&nbsp;to ensure that your passwords are complex enough to prevent users guessing other users' passwords and to prevent successful dictionary attacks against your user credential store.</p>
  <h1>Why</h1>
  <p>Insufficiently complex passwords may be guessed by attackers, allowing them to compromise user accounts.&nbsp; Strong passwords help to prevent dictionary attacks in the event your password store is compromised.&nbsp; Most users will not choose sufficiently strong passwords without help from the application.</p>
  <h1>When</h1>
  <p>All systems which utilize passwords should enforce strong passwords.&nbsp; The strength of the password and its frequency of change will depend on the security needs of the application, but all applications should enforce basic strong password rules.</p>
  <h1>How</h1>
  <p>Enforcing strong passwords is very simple, and it's one of the easiest ways to improve the security of your site.&nbsp; Follow these steps to do so:</p>
  <ol>
    <li>
      <p>
        <strong>Understand Password Strength Requirements.</strong> By default, the ASP.NET membership providers enforce strong passwords.&nbsp; <b>ActiveDirectoryMembershipProvider</b> ensures that passwords are at least seven characters in length with at least one non-alphanumeric character.&nbsp; This is a reasonable baseline for applications with light security requirements, and there are very few cases where passwords should be permitted to be weaker than this.</p>
      <p>When considering password strength, it's important to ensure that you're matching your strength requirements to the security needs of the application.&nbsp; Requiring very strong passwords for sites with trivial security needs will frustrate your users.&nbsp; On the other hand, don't restrict your users from chosing stronger passwords if they want&#8212;maximum password lengths should be at least 20 characters, and all printable characters should be legal in the password.</p>
      <li>
        <p>
          <strong>Enforce Password Strength Requirements.</strong> There are&nbsp;three attributes which you can use to configure the precise password complexity rules enforced by your the <strong>ActiveDirectoryMembershipProvider</strong>, along with&nbsp;three extra attributes that control account lockouts for failed authentication attempts:</p>
        <ul>
          <li>
            <b>passwordStrengthRegularExpression</b>.&nbsp; The default is blank.&nbsp;&nbsp; All passwords must satisfy this expression. <li><b>minRequiredPasswordLength</b>.&nbsp; The default is 7.&nbsp; All passwords must contain at least this many characters. <li><b>minRequiredNonalphanumericCharacters</b>.&nbsp; The default is 1.&nbsp; All passwords must contain this many non-letter, non-number characters. <li><b>maxInvalidPasswordAttempts</b>.&nbsp; The default is 5.&nbsp; An account is temporarily locked out if more than this many password attempts fail in the tracking window. <li><b>passwordAttemptWindow</b>.&nbsp; The default is 10 (minutes).&nbsp; Failed password attempts are tracked for the length of this window. <li><b>passwordAnswerAttemptLockoutDuration</b>.&nbsp; The default is 30 (minutes).&nbsp; Accounts with too many failed password attempts are locked out for this long.</li></li></li></li></li></li>
        </ul>
        <p>Furthermore, the <b>ActiveDirectoryMembershipProvider</b> also verifies passwords against the default domain password policy, and users must choose passwords which satisfy both sets of requirements.&nbsp; Here's an example of an <b>ActiveDirectoryMembershipProvider</b> configured to require stronger passwords:</p>
        <pre>&lt;membership defaultProvider="MyADMembershipProvider"&gt;&nbsp; <br />   &#9;&lt;providers&gt;    <br />      &#9;&#9;&lt;add name="MyADMembershipProvider"         <br />&#9;&#9;&#9;connectionStringName="ADConnectionString"<br />&#9;&#9;&#9;minRequiredPasswordLength="9"<br />&#9;&#9;&#9;minRequiredNonalphanumericCharacters="2"         <br />&#9;&#9;&#9;passwordStrengthRegularExpression="&#94;(?=.&#42;\d)(?=.&#42;&#91;&#94;\w\d&#93;.&#123;9,20&#125;&#36;"         <br />&#9;&#9;&#9;maxInvalidPasswordAttempts=3         <br />&#9;&#9;&#9;passwordAttemptWindow=20         <br />&#9;&#9;&#9;passwordAnswerAttemptLockoutDuration=60         <br />&#9;&#9;&#9;requiresUniqueEmail="true"          .../&gt;  <br />   &#9;&lt;/providers&gt;<br />&lt;/membership&gt;</pre>
        <li>
          <p>
            <strong>Improve Your Security Further.</strong> For improved pasword strength you can:</p>
          <ul>
            <li>Check that the password contains both upper and lowercase characters as well as nonalphanumeric characters. <li>Check that the password does not contain the username, the user's first or last name (if known), or the host name/site name. <li>Regularly expire passwords and force users to choose new ones.&nbsp; The amount of time between password changes should be determined by your security needs, but every three months is a reasonable default. <li>Prevent users from reusing old passwords.</li></li></li></li>
          </ul>
          <p>If you have a site with very strong security requirements, simply requiring and enforcing strong passwords may not be enough, in which case you should look into two factor authentication, for which a number of schemes exist, including smartcards, USB dongles, clock-synched external devices, and software-only solutions like client-side SSL certificates.</p>
        </li>
      </li>
    </li>
  </ol>
  <h1>Problem Example</h1>
  <p>An online banking web site is using the <strong>ActiveDirectoryMembershipProvider </strong>for their authentication.&nbsp; They only require very simple passwords on the site, and suggest that people use their ATM card PIN as a password.&nbsp; As a result, an attacker is able to brute force user's passwords very quickly, gaining access to both online accounts and many ATM cards.&nbsp; Here's their membership provider configuration:</p>
  <pre>&lt;membership defaultProvider="MyADMembershipProvider"&gt;<br />&#9;&lt;providers&gt;    <br />&#9;&#9;&lt;add name="MyADMembershipProvider"<br />&#9;&#9;&#9;connectionStringName="ADConnectionString"          <br />&#9;&#9;&#9;applicationName="MyAppName"         <br />&#9;&#9;&#9;minRequiredPasswordLength="4"         <br />&#9;&#9;&#9;minRequiredNonalphanumericCharacters="0"         <br />&#9;&#9;&#9;passwordStrengthRegularExpression=""         .../&gt;  <br />&#9;&lt;/providers&gt;<br />&lt;/membership&gt;</pre>
  <h1>Solution Example</h1>
  <p>An online banking web site is using the <strong>ActiveDirectoryMembershipProvider</strong> for their authentication.&nbsp; They require fairly complicated passwords on the site, and remind people not to use passwords they use anywhere else.&nbsp; As a result, an attackers are unable to crack passwords in reasonable numbers of attempts, and the site operations staff can easily detect and lock out intruders by watching their security log.&nbsp; Accounts which are automatically locked by the system for having too many invalid login attempts provide a particularly good indicator of malicious password cracking attempts.&nbsp; Here's their membership provider configuration:</p>
  <pre>&lt;membership defaultProvider="MyADMembershipProvider"&gt;&nbsp; <br />   &#9;&lt;providers&gt;    <br />     &#9;&#9;&lt;add name="MyADMembershipProvider"          <br />                   &#9;connectionStringName="ADConnectionString"          <br /><br />                   &#9;applicationName="MyAppName"         <br /><br />                   &#9;minRequiredPasswordLength="9"         <br /><br />                  &#9;&#9;minRequiredNonalphanumericCharacters="2"         <br />                   &#9;maxInvalidPasswordAttempts=3         <br />&#9;&#9; &#9;passwordAttemptWindow=20         <br />&#9;&#9; &#9;passwordAnswerAttemptLockoutDuration=60 <br />&#9;&#9;&#9;requiresUniqueEmail="true"          .../&gt;<br />   &#9;&lt;/providers&gt;<br />&lt;/membership&gt;</pre>
  <h1>Additional Resources</h1>
  <ul>
    <li>For information on how to enforce strong password policies in Active Directory under Windows 2003, see <a href="http://technet.microsoft.com/en-us/library/cc875814.aspx">Step-by-Step Guide to Enforcing Strong Password Policies</a>.</li>
  </ul>
  <h1>&nbsp;</h1>
  <hr />
  <p>Adapted from Microsoft patterns & practices guidance. </p>