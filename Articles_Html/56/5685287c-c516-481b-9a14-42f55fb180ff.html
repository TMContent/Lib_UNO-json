<h1>Applies to</h1>
  <ul>
    <li>
      <div>Web Application</div>
    </li>
  </ul>
  <h1>What to Check For</h1>
  <p>Check to ensure that the MSADC virtual directory (RDS) is removed or secured.</p>
  <p />
  <h1>How to Fix</h1>
  <p>Remote Data Services (RDS) is a component that enables controlled Internet access to&nbsp;remote data resources through IIS. The RDS interface is provided by Msadcs.dll, which is located in the following directory: program files\common files\system\Msadc.</p>
  <h3>Removing RDS</h3>
  <p>If your applications do not use RDS, remove it.</p>
  <p>
    <b>To remove RDS support</b>
  </p>
  <ol>
    <li>Remove the /MSADC virtual directory mapping from IIS. 
<li>Remove the RDS files and subdirectories at the following location: 
<p>\Program Files\Common Files\System\Msadc </p><li>Remove the following registry key: 
<p>HKLM\System\CurrentControlSet\Services\W3SVC\Parameters\ADCLaunch </p></li></li></li>
  </ol>
  <blockquote>
    <b>Note</b>&nbsp;&nbsp;&nbsp;IISLockdown provides an option to remove the MSADC virtual directory. Note that IISLockdown only removes the virtual directory, not the files or registry key.</blockquote>
  <h3>Securing RDS</h3>
  <p>If your applications require RDS, secure it.</p>
  <p>
    <b>To secure RDS</b>
  </p>
  <ol>
    <li>Delete the samples at the following location: 
<p>\Progam Files\Common Files\System\Msadc\Samples </p><li>Remove the following registry key: 
<p><b>HKLM\System\CurrentControlSet\Services\W3SVC\Parameters\ADCLaunch\VbBusObj.VbBusObjCls</b></p><li>Disable Anonymous access for the MSADC virtual directory in IIS. 
<li>Create a <b>HandlerRequired</b> registry key in the following location: 
<p><b>HKLM\Software\Microsoft\DataFactory\HandlerInfo\</b></p><li>Create a new DWORD value, and set it to <b>1</b> (1 indicates safe mode, while 0 indicates unsafe mode. </li></li></li></li></li>
  </ol>
  <blockquote>
    <b>Note</b>&nbsp;&nbsp;&nbsp;You can use the registry script file Handsafe.reg to change the registry key. The script file is located in the msadc directory: \Program Files\Common Files\System\msadc</blockquote>
  <h1>Additional Resources</h1>
  <p>For more information about securing RDS, see the following: </p>
  <ul>
    <li>MS99-025 Microsoft Security Program: Unauthorized Access to IIS Servers through ODBC Data Access with RDS at <a href="http://www.microsoft.com/technet/security/bulletin/ms99-025.mspx">http://www.microsoft.com/technet/security/bulletin/ms99-025.mspx</a>. 
<li>MS98-004 Microsoft Security Program: Microsoft Security Bulletin: Unauthorized ODBC Data Access with RDS and IIS at <a href="http://www.microsoft.com/technet/security/bulletin/ms98-004.mspx">http://www.microsoft.com/technet/security/bulletin/ms98-004.mspx</a>. 
<li>Microsoft Knowledge Base article 184375, "PRB: Security Implications of RDS 1.5, IIS 3.0 or 4.0, and ODBC." </li></li></li>
  </ul>
  <hr />
  <p>Adapted from Microsoft patterns & practices guidance.</p>