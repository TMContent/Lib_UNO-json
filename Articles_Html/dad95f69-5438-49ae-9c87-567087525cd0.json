{
  "id": "dad95f69-5438-49ae-9c87-567087525cd0",
  "checksum": "577b6a685929e3e8e1e9c6d16ff9b8148dcf107f",
  "words": {
    "0": [
      "pre"
    ],
    "4": [
      "pre"
    ],
    "10": [
      "pre"
    ],
    "100": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "p",
      "p",
      "ul",
      "li",
      "pre",
      "pre",
      "ul",
      "li",
      "p",
      "p"
    ],
    "c#": [
      "ul",
      "li"
    ],
    "summary": [
      "h1"
    ],
    "the": [
      "p",
      "ul",
      "li",
      "pre",
      "p",
      "p",
      "pre",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "pre"
    ],
    "purpose": [
      "p"
    ],
    "of": [
      "p",
      "p",
      "p",
      "pre",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p"
    ],
    "this": [
      "p"
    ],
    "code": [
      "p",
      "p",
      "p"
    ],
    "snippet": [
      "p"
    ],
    "is": [
      "p",
      "ul",
      "li"
    ],
    "illustrate": [
      "p"
    ],
    "how": [
      "p"
    ],
    "generate": [
      "p",
      "pre",
      "ul",
      "li",
      "p"
    ],
    "cryptographically": [
      "p",
      "title"
    ],
    "secure": [
      "p",
      "pre",
      "pre",
      "p",
      "pre",
      "title"
    ],
    "random": [
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "pre",
      "pre",
      "p",
      "pre",
      "pre",
      "p",
      "p",
      "pre",
      "pre",
      "pre",
      "pre",
      "title"
    ],
    "numbers": [
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "pre",
      "title"
    ],
    "for": [
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li"
    ],
    "a": [
      "p",
      "ul",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "pre",
      "pre",
      "p",
      "pre",
      "p",
      "pre"
    ],
    "variety": [
      "p"
    ],
    "applications": [
      "p"
    ],
    "using": [
      "p",
      "p",
      "pre",
      "pre",
      "pre"
    ],
    "net.": [
      "p"
    ],
    "possible": [
      "p"
    ],
    "uses": [
      "p"
    ],
    "cryptographically-secure": [
      "p"
    ],
    "are": [
      "p"
    ],
    "session": [
      "p",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "identifiers": [
      "p"
    ],
    "encryption": [
      "p"
    ],
    "key": [
      "p"
    ],
    "material": [
      "p"
    ],
    "and": [
      "p",
      "pre",
      "pre",
      "p"
    ],
    "default": [
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "or": [
      "p",
      "ul",
      "li",
      "ul",
      "li"
    ],
    "auto-generated": [
      "p"
    ],
    "passwords": [
      "p"
    ],
    "objectives": [
      "h1"
    ],
    "create": [
      "ul",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "pre"
    ],
    "number": [
      "ul",
      "ul",
      "li",
      "li",
      "ul",
      "li",
      "pre",
      "p",
      "pre",
      "pre",
      "pre"
    ],
    "value": [
      "ul",
      "ul",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "whose": [
      "ul",
      "li"
    ],
    "cannot": [
      "ul",
      "li"
    ],
    "be": [
      "ul",
      "li",
      "p"
    ],
    "utilized": [
      "ul",
      "li"
    ],
    "determine": [
      "ul",
      "li"
    ],
    "subsequent": [
      "ul",
      "li"
    ],
    "values": [
      "ul",
      "li"
    ],
    "generated": [
      "ul",
      "li"
    ],
    "by": [
      "ul",
      "li"
    ],
    "same": [
      "ul",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p"
    ],
    "function": [
      "ul",
      "li"
    ],
    "scenarios": [
      "h1"
    ],
    "an": [
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li"
    ],
    "\"un-guessable\"": [
      "ul",
      "li"
    ],
    "identifier": [
      "ul",
      "li"
    ],
    "application": [
      "ul",
      "li"
    ],
    "cookie": [
      "ul",
      "li"
    ],
    "customized": [
      "ul",
      "li"
    ],
    "management": [
      "ul",
      "li"
    ],
    "one-time-use": [
      "ul",
      "li"
    ],
    "use": [
      "ul",
      "ul",
      "li",
      "li",
      "ul",
      "li",
      "p",
      "p"
    ],
    "as": [
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li"
    ],
    "second": [
      "ul",
      "li"
    ],
    "authentication": [
      "ul",
      "li"
    ],
    "factor": [
      "ul",
      "li"
    ],
    "such": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "argument": [
      "ul",
      "li"
    ],
    "within": [
      "ul",
      "li"
    ],
    "forgotten": [
      "ul",
      "li"
    ],
    "email": [
      "ul",
      "li"
    ],
    "password": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "arbitrary": [
      "ul",
      "li"
    ],
    "secret": [
      "ul",
      "li"
    ],
    "from": [
      "ul",
      "li",
      "p"
    ],
    "data": [
      "ul",
      "li",
      "pre",
      "pre"
    ],
    "solution": [
      "h1"
    ],
    "example": [
      "h1",
      "h1",
      "p",
      "p"
    ],
    "static": [
      "pre",
      "pre"
    ],
    "public": [
      "pre",
      "pre",
      "pre"
    ],
    "int": [
      "pre",
      "pre",
      "pre"
    ],
    "securerandomnumber){": [
      "pre"
    ],
    "//": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "rng": [
      "pre"
    ],
    "class": [
      "pre",
      "ul",
      "li"
    ],
    "byte": [
      "pre"
    ],
    "array": [
      "pre"
    ],
    "hold": [
      "pre"
    ],
    "rngcryptoserviceprovider": [
      "pre",
      "ul",
      "li"
    ],
    "securerandom": [
      "pre"
    ],
    "=": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "new": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "rngcryptoserviceprovider);": [
      "pre"
    ],
    "byte]": [
      "pre"
    ],
    "randbytes": [
      "pre"
    ],
    "byte4];": [
      "pre"
    ],
    "bytes": [
      "pre"
    ],
    "convert": [
      "pre"
    ],
    "4-byte": [
      "pre"
    ],
    "integer": [
      "pre"
    ],
    "securerandomgetnonzerobytes(randbytes);": [
      "pre"
    ],
    "returnbitconverter.toint32(randbytes,": [
      "pre"
    ],
    "0);}": [
      "pre"
    ],
    "problem": [
      "h1"
    ],
    "following": [
      "p",
      "p",
      "p"
    ],
    "shows": [
      "p"
    ],
    "generation": [
      "p"
    ],
    "systemrandom": [
      "pre"
    ],
    "classstatic": [
      "pre"
    ],
    "unsecurerandomnumberint": [
      "pre",
      "pre"
    ],
    "seed{": [
      "pre",
      "pre"
    ],
    "creates": [
      "pre",
      "pre"
    ],
    "machine": [
      "pre",
      "ul",
      "li",
      "pre"
    ],
    "time-derived": [
      "pre",
      "pre"
    ],
    "seed": [
      "pre",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "unsecurerandom": [
      "pre",
      "pre"
    ],
    "randomseed);": [
      "pre",
      "pre"
    ],
    "returnunsecurerandom.next());}": [
      "pre",
      "pre"
    ],
    "will": [
      "ul",
      "ul",
      "li",
      "li",
      "p"
    ],
    "always": [
      "ul",
      "li"
    ],
    "return": [
      "ul",
      "li",
      "p"
    ],
    "sequence": [
      "ul",
      "li",
      "p"
    ],
    "-1": [
      "ul",
      "li"
    ],
    "null": [
      "ul",
      "li"
    ],
    "make": [
      "ul",
      "li",
      "p"
    ],
    "time": [
      "ul",
      "li"
    ],
    "which": [
      "ul",
      "li"
    ],
    "easily": [
      "ul",
      "li"
    ],
    "predicted": [
      "ul",
      "li"
    ],
    "test": [
      "h1"
    ],
    "case": [
      "h1"
    ],
    "classes": [
      "p"
    ],
    "must": [
      "p"
    ],
    "included": [
      "p"
    ],
    "in": [
      "p"
    ],
    "any": [
      "p"
    ],
    "project": [
      "p"
    ],
    "making": [
      "p"
    ],
    "sample": [
      "p"
    ],
    "provided": [
      "p"
    ],
    "above": [
      "p"
    ],
    "systemsecurity.cryptography;": [
      "pre"
    ],
    "run": [
      "p"
    ],
    "set": [
      "p"
    ],
    "both": [
      "p"
    ],
    "unsecure": [
      "p",
      "p",
      "pre",
      "pre"
    ],
    "illustrates": [
      "p"
    ],
    "that": [
      "p",
      "p"
    ],
    "two": [
      "p"
    ],
    "calls": [
      "p"
    ],
    "void": [
      "pre"
    ],
    "mainstring[]": [
      "pre"
    ],
    "args{": [
      "pre"
    ],
    "consolewriteline(\"unsecure": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "\"": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "+": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "unsecurerandomnumber-1));": [
      "pre",
      "pre"
    ],
    "unsecurerandomnumber100));": [
      "pre",
      "pre"
    ],
    "consolewriteline(\"\");": [
      "pre"
    ],
    "forint": [
      "pre"
    ],
    "i": [
      "pre",
      "pre"
    ],
    "i++": [
      "pre"
    ],
    "{": [
      "pre"
    ],
    "consolewriteline(\"secure": [
      "pre"
    ],
    "no": [
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "securerandomnumber));": [
      "pre"
    ],
    "}}static": [
      "pre"
    ],
    "expected": [
      "h1"
    ],
    "result": [
      "h1"
    ],
    "534011718unsecure": [
      "pre",
      "pre"
    ],
    "2080427802unsecure": [
      "pre"
    ],
    "2080427802secure": [
      "pre"
    ],
    "1392122031secure": [
      "pre"
    ],
    "-1635401565secure": [
      "pre"
    ],
    "1863340408secure": [
      "pre"
    ],
    "-497957136secure": [
      "pre"
    ],
    "-1444637226secure": [
      "pre"
    ],
    "925340612secure": [
      "pre"
    ],
    "92412438secure": [
      "pre"
    ],
    "-1126434204secure": [
      "pre"
    ],
    "2086044763secure": [
      "pre"
    ],
    "-840759923": [
      "pre"
    ],
    "additional": [
      "h1"
    ],
    "resources": [
      "h1"
    ],
    "http//msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrngcryptoserviceproviderclasstopic.asp": [
      "ul",
      "li",
      "a"
    ],
    "adapted": [
      "p"
    ],
    "microsoft": [
      "p"
    ],
    "patterns": [
      "p"
    ],
    "&": [
      "p"
    ],
    "practices": [
      "p"
    ],
    "guidance": [
      "p"
    ],
    "generating": [
      "title"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "Summary",
      "Objectives",
      "Scenarios",
      "Solution Example",
      "Problem Example",
      "Test Case",
      "Expected Result",
      "Additional Resources"
    ],
    "ul": [
      "C#",
      "Create a random number value whose value cannot be utilized to determine subsequent number values generated by the same function",
      "Create an \"un-guessable\" session identifier or application cookie for customized session management Create a one-time-use number for use as a second authentication factor, such as an argument for use within a forgotten email password Create an arbitrary default secret, such as a default password, from random data",
      "Same seed value will always return the same sequence of numbers Seed value -1 or null will make use of machine time to generate seed, which is easily predicted",
      "RNGCryptoServiceProvider Class: http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrngcryptoserviceproviderclasstopic.asp"
    ],
    "li": [
      "C#",
      "Create a random number value whose value cannot be utilized to determine subsequent number values generated by the same function",
      "Create an \"un-guessable\" session identifier or application cookie for customized session management",
      "Create a one-time-use number for use as a second authentication factor, such as an argument for use within a forgotten email password",
      "Create an arbitrary default secret, such as a default password, from random data",
      "Same seed value will always return the same sequence of numbers",
      "Seed value -1 or null will make use of machine time to generate seed, which is easily predicted",
      "RNGCryptoServiceProvider Class: http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrngcryptoserviceproviderclasstopic.asp"
    ],
    "p": [
      "The purpose of this code snippet is to illustrate how to generate cryptographically secure random numbers for a variety of applications using .NET. Possible uses of cryptographically-secure random numbers are session identifiers, encryption key material and default or auto-generated passwords.",
      "The following example shows generation of a random number using the",
      "The following classes must be included in any project making use of the sample code provided above:",
      "Run the following code to generate a set of both unsecure and secure random numbers. The unsecure example illustrates that two calls to Random that make use of the same seed will return the same sequence of numbers.",
      "Adapted from Microsoft patterns & practices guidance."
    ],
    "pre": [
      "static public int SecureRandomNumber(){            // Create a secure RNG class and a byte array to hold the random data            RNGCryptoServiceProvider secureRandom = new RNGCryptoServiceProvider();            byte[] randBytes = new byte[4];            // Generate 4 bytes of secure random number data and convert to 4-byte integer            secureRandom.GetNonZeroBytes(randBytes);            return(BitConverter.ToInt32(randBytes, 0));}",
      "System.Random class.static public int UnsecureRandomNumber(int seed){            // Creates a random number, using the default machine time-derived seed             Random unsecureRandom = new Random(seed);            return(unsecureRandom.Next());}",
      "using System.Security.Cryptography;",
      "static void Main(string[] args){            // Unsecure Random Number            Console.WriteLine(\"Unsecure Value, Default Seed: \" + UnsecureRandomNumber(-1));            Console.WriteLine(\"Unsecure Value, Default Seed: \" + UnsecureRandomNumber(-1));            Console.WriteLine(\"Unsecure Value, Seed = 100: \" + UnsecureRandomNumber(100));            Console.WriteLine(\"Unsecure Value, Seed = 100: \" + UnsecureRandomNumber(100));            Console.WriteLine(\"\");            // Secure Random Numbers            for(int i = 0; i < 10; i++) {                        Console.WriteLine(\"Secure Value, no seed: \" + SecureRandomNumber());            }}static public int UnsecureRandomNumber(int seed){            // Creates a random number, using the default machine time-derived seed             Random unsecureRandom = new Random(seed);            return(unsecureRandom.Next());}",
      "Unsecure Value, Default Seed: 534011718Unsecure Value, Default Seed: 534011718Unsecure Value, Seed = 100: 2080427802Unsecure Value, Seed = 100: 2080427802Secure Value, no seed: 1392122031Secure Value, no seed: -1635401565Secure Value, no seed: 1863340408Secure Value, no seed: -497957136Secure Value, no seed: -1444637226Secure Value, no seed: 925340612Secure Value, no seed: 92412438Secure Value, no seed: -1126434204Secure Value, no seed: 2086044763Secure Value, no seed: -840759923"
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "a": [
      "http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrngcryptoserviceproviderclasstopic.asp"
    ],
    "hr": [
      ""
    ]
  },
  "links": [
    {
      "href": "http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrngcryptoserviceproviderclasstopic.asp",
      "text": "http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrngcryptoserviceproviderclasstopic.asp"
    }
  ],
  "html": "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>C# </li>\r\n  </ul>\r\n  <h1>Summary</h1>\r\n  <p>The purpose of this code snippet is to illustrate how to generate cryptographically secure random numbers for a variety of applications using .NET. Possible uses of cryptographically-secure random numbers are session identifiers, encryption key material and default or auto-generated passwords.</p>\r\n  <h1>Objectives</h1>\r\n  <ul>\r\n    <li>Create a random number value whose value cannot be utilized to determine subsequent number values generated by the same function </li>\r\n  </ul>\r\n  <h1>Scenarios</h1>\r\n  <ul>\r\n    <li>Create an \"un-guessable\" session identifier or application cookie for customized session management <li>Create a one-time-use number for use as a second authentication factor, such as an argument for use within a forgotten email password <li>Create an arbitrary default secret, such as a default password, from random data </li></li></li>\r\n  </ul>\r\n  <h1>Solution Example</h1>\r\n  <pre>static public int SecureRandomNumber()&#123;<br /><br />            // Create a secure RNG class and a byte array to hold the random data<br />            RNGCryptoServiceProvider secureRandom = new RNGCryptoServiceProvider();<br />            byte&#91;&#93; randBytes = new byte&#91;4&#93;;<br />            // Generate 4 bytes of secure random number data and convert to 4-byte integer<br />            secureRandom.GetNonZeroBytes(randBytes);<br />            return(BitConverter.ToInt32(randBytes, 0));<br />&#125;</pre>\r\n  <h1>Problem Example</h1>\r\n  <p>The following example shows generation of a random number using the </p>\r\n  <pre>System.Random class.static public int UnsecureRandomNumber(int seed)&#123;<br />            // Creates a random number, using the default machine time-derived seed<br />             Random unsecureRandom = new Random(seed);<br />            return(unsecureRandom.Next());<br />&#125;</pre>\r\n  <ul>\r\n    <li>Same seed value will always return the same sequence of numbers <li>Seed value -1 or null will make use of machine time to generate seed, which is easily predicted </li></li>\r\n  </ul>\r\n  <h1>Test Case</h1>\r\n  <p>The following classes must be included in any project making use of the sample code provided above:</p>\r\n  <pre>using System.Security.Cryptography;</pre>\r\n  <p>Run the following code to generate a set of both unsecure and secure random numbers. The unsecure example illustrates that two calls to Random that make use of the same seed will return the same sequence of numbers. </p>\r\n  <pre>static void Main(string&#91;&#93; args)&#123;<br />            // Unsecure Random Number<br />            Console.WriteLine(\"Unsecure Value, Default Seed: \" &#43; UnsecureRandomNumber(-1));<br />            Console.WriteLine(\"Unsecure Value, Default Seed: \" &#43; UnsecureRandomNumber(-1));<br />            Console.WriteLine(\"Unsecure Value, Seed = 100: \" &#43; UnsecureRandomNumber(100));<br />            Console.WriteLine(\"Unsecure Value, Seed = 100: \" &#43; UnsecureRandomNumber(100));<br />            Console.WriteLine(\"\");<br />            // Secure Random Numbers<br />            for(int i = 0; i &lt; 10; i&#43;&#43;) &#123;<br />                        Console.WriteLine(\"Secure Value, no seed: \" &#43; SecureRandomNumber());<br />            &#125;<br />&#125;<br />static public int UnsecureRandomNumber(int seed)&#123;<br />            // Creates a random number, using the default machine time-derived seed<br />             Random unsecureRandom = new Random(seed);<br />            return(unsecureRandom.Next());<br />&#125;</pre>\r\n  <h1>Expected Result</h1>\r\n  <pre>Unsecure Value, Default Seed: 534011718<br />Unsecure Value, Default Seed: 534011718<br />Unsecure Value, Seed = 100: 2080427802<br />Unsecure Value, Seed = 100: 2080427802<br />Secure Value, no seed: 1392122031<br />Secure Value, no seed: -1635401565<br />Secure Value, no seed: 1863340408<br />Secure Value, no seed: -497957136<br />Secure Value, no seed: -1444637226<br />Secure Value, no seed: 925340612<br />Secure Value, no seed: 92412438<br />Secure Value, no seed: -1126434204<br />Secure Value, no seed: 2086044763<br />Secure Value, no seed: -840759923</pre>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>RNGCryptoServiceProvider Class: <a href=\"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrngcryptoserviceproviderclasstopic.asp\">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrngcryptoserviceproviderclasstopic.asp</a></li>\r\n  </ul>\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns & practices guidance.</p>"
}