{
  "id": "61fc8997-a14b-4954-b2ed-84014b21b59d",
  "checksum": "ed49a7e466e6d8084ba9676122d5bc5b3422a2df",
  "words": {
    "0": [
      "pre",
      "p",
      "pre",
      "p"
    ],
    "9": [
      "p",
      "p",
      "p"
    ],
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "h1",
      "p",
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "c++": [
      "ul",
      "li"
    ],
    "what": [
      "h1"
    ],
    "check": [
      "h1",
      "h1"
    ],
    "for": [
      "h1",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li"
    ],
    "double-check": [
      "p"
    ],
    "pointer": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "a",
      "title"
    ],
    "arithmetic": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "a",
      "title"
    ],
    "when": [
      "p"
    ],
    "pointers": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "are": [
      "p"
    ],
    "treated": [
      "p"
    ],
    "as": [
      "p",
      "p",
      "p"
    ],
    "integers": [
      "p",
      "p",
      "p"
    ],
    "why": [
      "h1"
    ],
    "miscalculations": [
      "p",
      "p"
    ],
    "in": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "may": [
      "p",
      "p",
      "p"
    ],
    "result": [
      "p"
    ],
    "buffer": [
      "p",
      "p",
      "pre",
      "pre"
    ],
    "overflows": [
      "p",
      "p"
    ],
    "which": [
      "p",
      "p"
    ],
    "allow": [
      "p"
    ],
    "an": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "attack": [
      "p"
    ],
    "execute": [
      "p"
    ],
    "arbitrary": [
      "p"
    ],
    "code": [
      "p",
      "p"
    ],
    "how": [
      "h1",
      "h1"
    ],
    "search": [
      "p",
      "p"
    ],
    "all": [
      "p",
      "p"
    ],
    "that": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "adds": [
      "p"
    ],
    "verify": [
      "p",
      "p"
    ],
    "being": [
      "p",
      "p"
    ],
    "added": [
      "p",
      "p"
    ],
    "do": [
      "p",
      "p"
    ],
    "not": [
      "p",
      "p",
      "p"
    ],
    "include": [
      "p",
      "p"
    ],
    "memory": [
      "p",
      "p",
      "p",
      "p"
    ],
    "sizes": [
      "p",
      "p"
    ],
    "of": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "objects": [
      "p",
      "p",
      "p"
    ],
    "this": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "is": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "a": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "common": [
      "p",
      "p"
    ],
    "mistake": [
      "p",
      "p"
    ],
    "usually": [
      "p"
    ],
    "involving": [
      "p"
    ],
    "call": [
      "p"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "sizeof)": [
      "p",
      "p"
    ],
    "function": [
      "p",
      "p"
    ],
    "it": [
      "p",
      "p",
      "p"
    ],
    "be": [
      "p"
    ],
    "faster": [
      "p"
    ],
    "but": [
      "p"
    ],
    "thorough": [
      "p"
    ],
    "calls": [
      "p"
    ],
    "and": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "numbers": [
      "p"
    ],
    "fix": [
      "h1"
    ],
    "means": [
      "p"
    ],
    "using": [
      "p",
      "ul",
      "li"
    ],
    "integer": [
      "p",
      "p",
      "p",
      "p"
    ],
    "adding": [
      "p"
    ],
    "some": [
      "p",
      "p"
    ],
    "number": [
      "p"
    ],
    "address": [
      "p",
      "p",
      "p"
    ],
    "another": [
      "p"
    ],
    "location": [
      "p"
    ],
    "most": [
      "p"
    ],
    "commonly": [
      "p"
    ],
    "used": [
      "p"
    ],
    "with": [
      "p"
    ],
    "array": [
      "p",
      "p",
      "p",
      "p"
    ],
    "where": [
      "p"
    ],
    "incremented": [
      "p",
      "p",
      "p"
    ],
    "sequential": [
      "p"
    ],
    "elements": [
      "p"
    ],
    "only": [
      "p"
    ],
    "mathematical": [
      "p"
    ],
    "operator": [
      "p"
    ],
    "available": [
      "p"
    ],
    "addition": [
      "p"
    ],
    "challenge": [
      "p"
    ],
    "here": [
      "p",
      "p",
      "p"
    ],
    "incrementing": [
      "p",
      "p"
    ],
    "by": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "one": [
      "p",
      "p"
    ],
    "actually": [
      "p",
      "p"
    ],
    "increments": [
      "p"
    ],
    "its": [
      "p",
      "p"
    ],
    "value": [
      "p",
      "p",
      "p"
    ],
    "size": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "type": [
      "p"
    ],
    "variable": [
      "p"
    ],
    "points": [
      "p",
      "p"
    ],
    "example": [
      "p",
      "h1",
      "h1"
    ],
    "if": [
      "p"
    ],
    "four-byte": [
      "p"
    ],
    "wide": [
      "p"
    ],
    "programmatically": [
      "p",
      "p",
      "p",
      "p"
    ],
    "increases": [
      "p"
    ],
    "four": [
      "p"
    ],
    "important": [
      "p"
    ],
    "because": [
      "p",
      "p",
      "p"
    ],
    "increment": [
      "p"
    ],
    "multiples": [
      "p"
    ],
    "object": [
      "p"
    ],
    "results": [
      "p"
    ],
    "problem": [
      "h1"
    ],
    "int": [
      "pre",
      "pre"
    ],
    "buffer10];int": [
      "pre",
      "pre"
    ],
    "*pointer": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "=": [
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "+=": [
      "pre",
      "pre"
    ],
    "9*sizeofbuffer);*buffer": [
      "pre"
    ],
    "times": [
      "p"
    ],
    "wrong": [
      "p"
    ],
    "compiler": [
      "p",
      "p"
    ],
    "will": [
      "p",
      "p",
      "p"
    ],
    "automatically": [
      "p",
      "p"
    ],
    "multiple": [
      "p"
    ],
    "resulting": [
      "p"
    ],
    "miscalculation": [
      "p"
    ],
    "written": [
      "p"
    ],
    "unexpected": [
      "p"
    ],
    "solution": [
      "h1"
    ],
    "9*buffer": [
      "pre"
    ],
    "correct": [
      "p"
    ],
    "multiply": [
      "p"
    ],
    "program": [
      "p"
    ],
    "write": [
      "p"
    ],
    "element": [
      "p"
    ],
    "during": [
      "p"
    ],
    "run-time": [
      "p"
    ],
    "additional": [
      "h1"
    ],
    "resources": [
      "h1"
    ],
    "more": [
      "ul",
      "li"
    ],
    "information": [
      "ul",
      "li"
    ],
    "about": [
      "ul",
      "li"
    ],
    "correctly": [
      "ul",
      "li",
      "ul",
      "li",
      "a",
      "title"
    ],
    "please": [
      "ul",
      "li"
    ],
    "see": [
      "ul",
      "li"
    ],
    "https//www.securecoding.cert.org/confluence/display/cplusplus/exp08-cpp.+ensure+pointer+arithmetic+is+used+correctly": [
      "ul",
      "li",
      "a"
    ],
    "related": [
      "h1"
    ],
    "items": [
      "h1"
    ],
    "use": [
      "ul",
      "li",
      "a"
    ],
    "performed": [
      "title"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "What to Check For",
      "Why",
      "How to Check",
      "How to Fix",
      "Problem Example",
      "Solution Example",
      "Additional Resources",
      "Related Items"
    ],
    "ul": [
      "C++",
      "For more information about using pointer arithmetic correctly, please see https://www.securecoding.cert.org/confluence/display/cplusplus/EXP08-CPP.+Ensure+pointer+arithmetic+is+used+correctly",
      "Use Pointer Arithmetic Correctly"
    ],
    "li": [
      "C++",
      "For more information about using pointer arithmetic correctly, please see https://www.securecoding.cert.org/confluence/display/cplusplus/EXP08-CPP.+Ensure+pointer+arithmetic+is+used+correctly",
      "Use Pointer Arithmetic Correctly"
    ],
    "p": [
      "Double-check pointer arithmetic when pointers are treated as integers.",
      "Miscalculations in pointer arithmetic may result in buffer overflows, which may allow an attack to execute arbitrary code.",
      "Search for all code that adds integers to pointers. Verify that integers being added to pointers do not include memory sizes of objects. This is a common mistake, usually involving a call to the sizeof() function. It may be faster but not as thorough to search for all calls to the sizeof() function and verify that numbers added to pointers do not include memory sizes of objects.",
      "Pointer arithmetic means using a pointer as an integer and adding some number to it to address another location in memory. This is most commonly used with a pointer to an array, where the pointer is incremented to address the sequential elements in the array. The only mathematical operator available for pointer arithmetic is addition. The challenge here is that incrementing a pointer by one actually increments its value by the size of the type of the variable it points to. For example, if a pointer points to an array of four-byte wide objects, incrementing the pointer by one programmatically actually increases its value by four. This is important, because a common mistake is to increment pointers by multiples of the size of the object programmatically, which results in miscalculations and buffer overflows.",
      "Here, the pointer is incremented by 9 times the size of an integer programmatically. This is wrong, because the compiler will automatically multiple that value by the size of an integer, resulting in a miscalculation and a 0 being written to some unexpected memory address.",
      "Here, the pointer is incremented by 9 programmatically. This is correct, because the compiler will automatically multiply 9 by the size of an integer and the program will write 0 to an array element during run-time."
    ],
    "pre": [
      "int buffer[10];int *pointer = buffer;",
      "*pointer += 9*sizeof(buffer);*buffer = 0;",
      "int buffer[10];int *pointer = buffer;",
      "*pointer += 9;*buffer = 0;"
    ],
    "br": [
      "",
      "",
      "",
      ""
    ],
    "a": [
      "https://www.securecoding.cert.org/confluence/display/cplusplus/EXP08-CPP.+Ensure+pointer+arithmetic+is+used+correctly",
      "Use Pointer Arithmetic Correctly"
    ]
  },
  "links": [
    {
      "href": "https://www.securecoding.cert.org/confluence/display/cplusplus/EXP08-CPP.+Ensure+pointer+arithmetic+is+used+correctly",
      "text": "https://www.securecoding.cert.org/confluence/display/cplusplus/EXP08-CPP.+Ensure+pointer+arithmetic+is+used+correctly"
    },
    {
      "href": "/article/692215af-bca6-46b8-b237-7a7480ee65dd",
      "text": "Use Pointer Arithmetic Correctly"
    }
  ],
  "html": "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>C&#43;&#43;</li>\r\n  </ul>\r\n  <h1>What to Check For</h1>\r\n  <p>Double-check pointer arithmetic when pointers are treated as integers.</p>\r\n  <h1>Why</h1>\r\n  <p>Miscalculations in pointer arithmetic may result in buffer overflows, which may allow an attack to execute arbitrary code.</p>\r\n  <h1>How to Check</h1>\r\n  <p>Search for all code that adds integers to pointers. Verify that integers being added to pointers do not include memory sizes of objects. This is a common mistake, usually involving a call to the sizeof() function. It may be faster but not as thorough to search for all calls to the sizeof() function and verify that numbers added to pointers do not include memory sizes of objects.</p>\r\n  <h1>How to Fix</h1>\r\n  <p>Pointer arithmetic means using a pointer as an integer and adding some number to it to address another location in memory. This is most commonly used with a pointer to an array, where the pointer is incremented to address the sequential elements in the array. The only mathematical operator available for pointer arithmetic is addition. The challenge here is that incrementing a pointer by one actually increments its value by the size of the type of the variable it points to. For example, if a pointer points to an array of four-byte wide objects, incrementing the pointer by one programmatically actually increases its value by four. This is important, because a common mistake is to increment pointers by multiples of the size of the object programmatically, which results in miscalculations and buffer overflows.</p>\r\n  <h1>Problem Example</h1>\r\n  <pre>int buffer&#91;10&#93;;<br />int &#42;pointer = buffer;</pre>\r\n  <pre>&#42;pointer &#43;= 9&#42;sizeof(buffer);<br />&#42;buffer = 0;</pre>\r\n  <p>Here, the pointer is incremented by 9 times the size of an integer programmatically. This is wrong, because the compiler will automatically multiple that value by the size of an integer, resulting in a miscalculation and a 0 being written to some unexpected memory address.</p>\r\n  <h1>Solution Example</h1>\r\n  <pre>int buffer&#91;10&#93;;<br />int &#42;pointer = buffer;</pre>\r\n  <pre>&#42;pointer &#43;= 9;<br />&#42;buffer = 0;</pre>\r\n  <p>Here, the pointer is incremented by 9 programmatically. This is correct, because the compiler will automatically multiply 9 by the size of an integer and the program will write 0 to an array element during run-time.</p>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>For more information about using pointer arithmetic correctly, please see <a href=\"https://www.securecoding.cert.org/confluence/display/cplusplus/EXP08-CPP.&#43;Ensure&#43;pointer&#43;arithmetic&#43;is&#43;used&#43;correctly\">https://www.securecoding.cert.org/confluence/display/cplusplus/EXP08-CPP.&#43;Ensure&#43;pointer&#43;arithmetic&#43;is&#43;used&#43;correctly</a></li>\r\n  </ul>\r\n  <h1>Related Items</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/692215af-bca6-46b8-b237-7a7480ee65dd\">Use Pointer Arithmetic Correctly</a>\r\n    </li>\r\n  </ul>"
}