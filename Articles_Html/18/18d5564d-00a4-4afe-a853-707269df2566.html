<h2>Applies To</h2><p>Applications written in HTML5 that use WebSockets
</p><h2>What to Check For</h2><p>Using the the WebSockets Implementation Comparison sheet, which is linked below under Additional Resources, determine if the WebSockets server library version that you are using for your application is shown as using the RFC 6455 protocol.
</p> <h2>Why</h2><p>Versions hixie-76/hybi-00 and below are considered insecure. Using the latest RFC 6455 standard can reduce the risk of vulnerabilities such as cache poisoning. 
</p><h2>How To Check</h2><ol><li> <strong>Determine which Server Library you are using for WebSockets.</strong>  Depending on which Web Server and/or Web Application Framework you are using (Jetty, Tornado, etc.), look up the appropriate row in the WebSockets Implementation Comparison sheet, which is linked below under Additional Resources.</li>
<li> <strong>Look at the Protocol Column of the sheet and make sure that RFC 6455 is listed there.</strong>  If you don't see RFC 4655 under Protocol, you are using out-of-date server libraries for WebSockets.</li>
<li> <strong> If you're using an out-of-date server library, select a library that uses RFC 6455 as the protocol.</strong>  Review the comparison sheet to determine a version of server libraries that use RFC 6455 for its protocol.</li>
<li> <strong> If you need to update your server library for WebSockets, follow the instruction in the "How To Fix" section below.</strong>  Download the appropriate server library that supports RFC 6455 as its protocol and install it using the instructions below.</li>
</ol><h2>How To Fix</h2><p>To use the latest RFC 6455 standard to prevent WebSocket stealth attacks:
</p><ol>
<li> <strong>Upgrade the WebSockets serverâ€™s libraries with the latest stable release that uses the RFC 6455 standard.</strong> For example, Tornado, a popular web framework written in Python, has WebSockets libraries that many use as part of their WebSockets server implementation. If you are using Tornado, upgrade to at least Tornado version 2.2, as that version and later provide support for RFC 6455.</li>
<li> <strong>Ensure that backward compatibility is not enabled.</strong> A server implementation that supports RFC 6455 might be configured to be backward compatible with older WebSockets versions in order to support older browsers. In the case of Tornado, backward compatibility is enabled with a line of code: <tt>WebSocketHandler.allow_draft76().</tt> Search the server code or configuration to see if backward compatibility is enabled. If it is, disable it by removing (or commenting out) that line of code. This will ensure the server only allows the RFC 6455 protocol.</li>
</ol><h2>Additional Resources</h2><ul><li> For more information on RFC 6455 - The WebSocket Protocol, see: <a href="http://tools.ietf.org/html/rfc6455">http://tools.ietf.org/html/rfc6455</a></li>
<li> For a Comparison of WebSocket Implementations, see: <a href="http://en.wikipedia.org/wiki/Comparison_of_WebSocket_implementations">http://en.wikipedia.org/wiki/Comparison_of_WebSocket_implementations</a></li>
</ul>
<h2>WebSocket Guidelines</h2><ul><li> <a href="00000000-0000-0000-0000-000000869806">Validate Data Coming from WebSockets</a></li>
<li> <a href="00000000-0000-0000-0000-00000093dea4">Check the Origin Header in the WebSocket Handshake</a></li>
<li> <a href="00000000-0000-0000-0000-0000005f2e4a">Use TLS to Encrypt WebSocket Connections</a></li>
<li> <a href="00000000-0000-0000-0000-000000736a21">Check the Origin Attribute of WebSocket Messages</a></li>
<li> <a href="00000000-0000-0000-0000-0000005326a8">Use the Latest WebSocket RFC 6455 Standard</a></li>
<li> <a href="00000000-0000-0000-0000-00000085bc2f">Do Not Tunnel TCP via WebSockets</a></li>
</ul><h2>WebSocket Checklist Items</h2><ul><li> <a href="00000000-0000-0000-0000-00000086537e">Data Coming from WebSockets Is Validated</a></li>
<li> <a href="00000000-0000-0000-0000-00000077e316">The Origin Header in WebSocket Handshake is Checked</a></li>
<li> <a href="bd870268-f104-4f6f-ba0d-6628dc34eb2a">TLS is Used to Encrypt WebSocket Connections</a></li>
<li> <a href="00000000-0000-0000-0000-0000002f39d7">The Origin Attribute of WebSocket Messages Is Checked</a></li>
<li> <a href="18d5564d-00a4-4afe-a853-707269df2566">Latest RFC 6455 Standard is Used</a></li>
<li> <a href="00000000-0000-0000-0000-00000091ce5a">TCP Is Not Tunneled via WebSockets</a></li>
</ul>
