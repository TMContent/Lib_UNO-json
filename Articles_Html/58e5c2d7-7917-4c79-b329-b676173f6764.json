{
  "id": "58e5c2d7-7917-4c79-b329-b676173f6764",
  "checksum": "f630e0a6e37e3048fe9185d196bac426dc380945",
  "words": {
    "2": [
      "span",
      "p"
    ],
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "span",
      "p",
      "span",
      "span",
      "p",
      "p",
      "span",
      "span",
      "span",
      "span",
      "span",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "span",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "java": [
      "ul",
      "li"
    ],
    "web-based": [
      "ul",
      "li"
    ],
    "applications": [
      "ul",
      "li",
      "span",
      "p"
    ],
    "summary": [
      "h1"
    ],
    "use": [
      "span",
      "p",
      "span",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "the": [
      "span",
      "span",
      "p",
      "p",
      "span",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p",
      "p",
      "span",
      "span",
      "span",
      "span",
      "span",
      "span",
      "span",
      "span",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "span",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "esapi": [
      "span",
      "p",
      "span",
      "p",
      "span",
      "span",
      "p",
      "p",
      "span",
      "ul",
      "li",
      "ul",
      "li",
      "a",
      "title"
    ],
    "library": [
      "span",
      "p",
      "span",
      "p"
    ],
    "override": [
      "span",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "httpservletresponsesendredirect()": [
      "span",
      "p",
      "em",
      "span",
      "p",
      "em"
    ],
    "method": [
      "span",
      "p",
      "span",
      "span",
      "p",
      "p",
      "span",
      "span",
      "p",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "objectives": [
      "h1"
    ],
    "provides": [
      "span",
      "p"
    ],
    "a": [
      "span",
      "span",
      "p",
      "p",
      "span",
      "span",
      "span",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "span",
      "p"
    ],
    "replacement": [
      "span",
      "p"
    ],
    "for": [
      "span",
      "p",
      "span",
      "span",
      "p",
      "p",
      "span",
      "ul",
      "li",
      "li",
      "ul",
      "li",
      "a"
    ],
    "that": [
      "span",
      "span",
      "p",
      "p",
      "span",
      "p",
      "span",
      "p"
    ],
    "validates": [
      "span",
      "p"
    ],
    "redirect": [
      "span",
      "p",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p",
      "span",
      "p"
    ],
    "location": [
      "span",
      "p",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p",
      "span",
      "span",
      "span",
      "pre",
      "p",
      "pre",
      "pre",
      "p",
      "p"
    ],
    "ensure": [
      "span",
      "p"
    ],
    "it": [
      "span",
      "p",
      "span",
      "p",
      "span",
      "p"
    ],
    "is": [
      "span",
      "p",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p",
      "span",
      "span",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "relative": [
      "span",
      "p",
      "span",
      "p"
    ],
    "url": [
      "span",
      "p"
    ],
    "within": [
      "span",
      "p"
    ],
    "application": [
      "span",
      "p",
      "span",
      "span",
      "p",
      "p"
    ],
    "this": [
      "span",
      "p",
      "span",
      "span",
      "p",
      "p",
      "span",
      "p"
    ],
    "prevents": [
      "span",
      "p"
    ],
    "unvalidated": [
      "span",
      "p",
      "span",
      "ul",
      "li"
    ],
    "redirects": [
      "span",
      "p",
      "span",
      "p",
      "span",
      "ul",
      "li",
      "h1",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "h1",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "h1"
    ],
    "which": [
      "span",
      "p",
      "span",
      "span",
      "p",
      "p"
    ],
    "can": [
      "span",
      "p"
    ],
    "lead": [
      "span",
      "p",
      "span",
      "p"
    ],
    "users": [
      "span",
      "p"
    ],
    "dangerous": [
      "span",
      "p",
      "span",
      "span",
      "p",
      "p"
    ],
    "sites": [
      "span",
      "p"
    ],
    "may": [
      "span",
      "p"
    ],
    "install": [
      "span",
      "p"
    ],
    "malware": [
      "span",
      "p"
    ],
    "or": [
      "span",
      "p",
      "ul",
      "li",
      "a"
    ],
    "perform": [
      "span",
      "p",
      "span",
      "p"
    ],
    "other": [
      "span",
      "p"
    ],
    "harmful": [
      "span",
      "p"
    ],
    "activities": [
      "span",
      "p"
    ],
    "scenarios": [
      "h1"
    ],
    "are": [
      "span",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a"
    ],
    "very": [
      "span",
      "p"
    ],
    "common": [
      "span",
      "span",
      "p",
      "p"
    ],
    "also": [
      "span",
      "p",
      "h1"
    ],
    "dynamic": [
      "span",
      "span",
      "p",
      "p"
    ],
    "data": [
      "span",
      "p"
    ],
    "construct": [
      "span",
      "p"
    ],
    "portion": [
      "span",
      "span",
      "p",
      "p"
    ],
    "of": [
      "span",
      "span",
      "p",
      "p",
      "span",
      "span",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "when": [
      "span",
      "p",
      "ul",
      "li",
      "a"
    ],
    "occurs": [
      "span",
      "p"
    ],
    "validation": [
      "span",
      "span",
      "p",
      "p",
      "span",
      "p"
    ],
    "necessary": [
      "span",
      "p",
      "ul",
      "li",
      "a"
    ],
    "in": [
      "span",
      "p",
      "span",
      "p"
    ],
    "order": [
      "span",
      "p"
    ],
    "prevent": [
      "span",
      "p"
    ],
    "an": [
      "span",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p",
      "p",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p"
    ],
    "attacker": [
      "span",
      "span",
      "p",
      "p"
    ],
    "from": [
      "span",
      "p"
    ],
    "using": [
      "span",
      "span",
      "p",
      "p",
      "span",
      "span",
      "p",
      "p"
    ],
    "user": [
      "span",
      "span",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "external": [
      "span",
      "span",
      "p",
      "p"
    ],
    "site": [
      "span",
      "span",
      "p",
      "p"
    ],
    "following": [
      "span",
      "p"
    ],
    "shows": [
      "span",
      "p"
    ],
    "examples": [
      "span",
      "p"
    ],
    "first": [
      "span",
      "p"
    ],
    "example": [
      "span",
      "span",
      "p",
      "p",
      "h1",
      "span",
      "span",
      "span",
      "span",
      "p",
      "p",
      "p",
      "p",
      "h1"
    ],
    "uses": [
      "span",
      "p"
    ],
    "standard": [
      "span",
      "p"
    ],
    "sendredirect)": [
      "span",
      "p",
      "em",
      "ul",
      "li",
      "a",
      "title"
    ],
    "allows": [
      "span",
      "p"
    ],
    "manipulate": [
      "span",
      "p"
    ],
    "possibly": [
      "span",
      "p"
    ],
    "taking": [
      "span",
      "p"
    ],
    "second": [
      "span",
      "p"
    ],
    "resolves": [
      "span",
      "p"
    ],
    "issue": [
      "span",
      "p"
    ],
    "by": [
      "span",
      "p"
    ],
    "httputilitiessendredirect()": [
      "span",
      "p",
      "em"
    ],
    "performs": [
      "span",
      "p"
    ],
    "on": [
      "span",
      "p",
      "ul",
      "li",
      "a"
    ],
    "incoming": [
      "span",
      "p"
    ],
    "and": [
      "span",
      "p",
      "span",
      "ul",
      "li",
      "h1",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "h1",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "h1"
    ],
    "throws": [
      "span",
      "p"
    ],
    "accesscontrolexception": [
      "span",
      "p",
      "em",
      "span",
      "pre",
      "p"
    ],
    "if": [
      "span",
      "p",
      "ul",
      "li",
      "a"
    ],
    "not": [
      "span",
      "p",
      "ul",
      "li",
      "a"
    ],
    "pointing": [
      "span",
      "p"
    ],
    "expected": [
      "span",
      "p",
      "span",
      "p"
    ],
    "internal": [
      "span",
      "p"
    ],
    "resource": [
      "span",
      "p"
    ],
    "solution": [
      "h1"
    ],
    "insecure": [
      "span",
      "p"
    ],
    "shown": [
      "span",
      "span",
      "p",
      "p"
    ],
    "below": [
      "span",
      "span",
      "span",
      "p",
      "p",
      "p"
    ],
    "httpservletrequest": [
      "span",
      "span",
      "pre",
      "p",
      "pre",
      "p"
    ],
    "request": [
      "span",
      "span",
      "pre",
      "p",
      "pre",
      "p"
    ],
    "=": [
      "span",
      "span",
      "span",
      "span",
      "span",
      "span",
      "pre",
      "pre",
      "pre",
      "p",
      "p",
      "p",
      "pre",
      "pre",
      "pre",
      "p",
      "p",
      "p"
    ],
    "..;": [
      "span",
      "span",
      "span",
      "span",
      "pre",
      "pre",
      "p",
      "p",
      "pre",
      "pre",
      "p",
      "p"
    ],
    "httpservletresponse": [
      "span",
      "span",
      "pre",
      "p",
      "pre",
      "p"
    ],
    "response": [
      "span",
      "span",
      "pre",
      "p",
      "pre",
      "p"
    ],
    "string": [
      "span",
      "span",
      "pre",
      "p",
      "pre",
      "p"
    ],
    "requestgetparameter(\"loc\")": [
      "span",
      "span",
      "pre",
      "p",
      "pre",
      "p"
    ],
    "+": [
      "span",
      "span",
      "pre",
      "p",
      "pre",
      "p"
    ],
    "\"/other/url\"": [
      "span",
      "span",
      "pre",
      "p",
      "pre",
      "p"
    ],
    "responsesendredirect(location);": [
      "span",
      "pre",
      "p"
    ],
    "more": [
      "span",
      "p",
      "span",
      "span",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "secure": [
      "span",
      "p"
    ],
    "try": [
      "span",
      "pre",
      "p"
    ],
    "{": [
      "span",
      "span",
      "pre",
      "pre",
      "p",
      "p"
    ],
    "esapihttputilities().sendredirect(response,location);": [
      "span",
      "pre",
      "p"
    ],
    "}": [
      "span",
      "span",
      "pre",
      "pre",
      "p",
      "p"
    ],
    "catch": [
      "span",
      "pre",
      "p"
    ],
    "ace": [
      "span",
      "pre",
      "p"
    ],
    "//a": [
      "span",
      "pre",
      "p"
    ],
    "bad": [
      "span",
      "pre",
      "p"
    ],
    "was": [
      "span",
      "pre",
      "p"
    ],
    "attempted": [
      "span",
      "pre",
      "p"
    ],
    "..": [
      "span",
      "pre",
      "p"
    ],
    "handle": [
      "span",
      "pre",
      "p"
    ],
    "exception": [
      "span",
      "pre",
      "p"
    ],
    "here": [
      "span",
      "pre",
      "p"
    ],
    "note": [
      "span",
      "p"
    ],
    "additional": [
      "span",
      "p"
    ],
    "protections": [
      "span",
      "p"
    ],
    "should": [
      "span",
      "p"
    ],
    "be": [
      "span",
      "p"
    ],
    "added": [
      "span",
      "p"
    ],
    "such": [
      "span",
      "p"
    ],
    "as": [
      "span",
      "p"
    ],
    "whitelist": [
      "span",
      "p"
    ],
    "but": [
      "span",
      "p"
    ],
    "above": [
      "span",
      "p"
    ],
    "simplicity)": [
      "span",
      "p"
    ],
    "addition": [
      "span",
      "p"
    ],
    "function": [
      "span",
      "p"
    ],
    "you'll": [
      "span",
      "p"
    ],
    "need": [
      "span",
      "span",
      "p",
      "p"
    ],
    "update": [
      "span",
      "span",
      "p",
      "p"
    ],
    "esapiproperties": [
      "span",
      "p",
      "em"
    ],
    "file": [
      "span",
      "p"
    ],
    "your": [
      "span",
      "span",
      "p",
      "p"
    ],
    "inform": [
      "span",
      "p"
    ],
    "what": [
      "span",
      "p"
    ],
    "name": [
      "span",
      "p"
    ],
    "so": [
      "span",
      "p"
    ],
    "knows": [
      "span",
      "p"
    ],
    "path": [
      "span",
      "p"
    ],
    "snippet": [
      "span",
      "p"
    ],
    "you": [
      "span",
      "p"
    ],
    "validatorredirect=^\\\\/myapp.*$": [
      "span",
      "pre"
    ],
    "see": [
      "h1",
      "span",
      "span",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "information": [
      "span",
      "span",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "about": [
      "span",
      "span",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "forwards": [
      "span",
      "ul",
      "li",
      "h1",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "h1",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "h1"
    ],
    "please": [
      "span",
      "span",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "https//www.owasp.org/index.php/top_10_2010-a10for": [
      "span",
      "ul"
    ],
    "https//www.owasp.org/index.php/category:owasp_enterprise_security_api": [
      "span",
      "ul",
      "li",
      "a"
    ],
    "https//www.owasp.org/index.php/top_10_2010-a10": [
      "li",
      "a"
    ],
    "guidelines": [
      "h1"
    ],
    "don't": [
      "ul",
      "li",
      "a"
    ],
    "possible": [
      "ul",
      "li",
      "a"
    ],
    "calculate": [
      "ul",
      "li",
      "a"
    ],
    "destinations": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "without": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "input": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "mapping": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "values": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "redirecting": [
      "ul",
      "li",
      "a"
    ],
    "validate": [
      "ul",
      "li",
      "a"
    ],
    "checklists": [
      "h1"
    ],
    "used": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "unless": [
      "ul",
      "li",
      "a"
    ],
    "calculated": [
      "ul",
      "li",
      "a"
    ],
    "validated": [
      "ul",
      "li",
      "a"
    ],
    "code": [
      "h1"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "Summary",
      "Objectives",
      "Scenarios",
      "Solution Example",
      "See Also",
      "Redirects and Forwards Guidelines",
      "Redirects and Forwards Checklists",
      "Redirects and Forwards Code Example"
    ],
    "ul": [
      "Java web-based applications.",
      "For more information about unvalidated redirects and forwards, please see https://www.owasp.org/index.php/Top_10_2010-A10For more information about ESAPI, please see https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API",
      "Don't Use Redirects or Forwards if Possible\r\n      \r\n        Calculate Destinations of Redirects and Forwards Without User Input\r\n        \r\n          Use Mapping Values When Redirecting on User Input\r\n          \r\n            Validate Destinations of Redirects and Forwards",
      "Redirects and Forwards Are Not Used Unless Necessary\r\n      \r\n        Destinations of Redirects and Forwards Are Calculated Without User Input\r\n        \r\n          Mapping Values Are Used for Redirects and Forwards\r\n          \r\n            Destinations of Redirects and Forwards Are Validated",
      "Use ESAPI to Override the sendRedirect() Method"
    ],
    "li": [
      "Java web-based applications.",
      "For more information about unvalidated redirects and forwards, please see https://www.owasp.org/index.php/Top_10_2010-A10",
      "For more information about ESAPI, please see https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API",
      "Don't Use Redirects or Forwards if Possible",
      "Calculate Destinations of Redirects and Forwards Without User Input",
      "Use Mapping Values When Redirecting on User Input",
      "Validate Destinations of Redirects and Forwards",
      "Redirects and Forwards Are Not Used Unless Necessary",
      "Destinations of Redirects and Forwards Are Calculated Without User Input",
      "Mapping Values Are Used for Redirects and Forwards",
      "Destinations of Redirects and Forwards Are Validated",
      "Use ESAPI to Override the sendRedirect() Method"
    ],
    "span": [
      "Use the ESAPI library to override the HttpServletResponse.sendRedirect() method.",
      "The ESAPI library provides a replacement method for the HttpServletResponse.sendRedirect() method that validates the redirect location to ensure it is a relative url within the application. This prevents unvalidated redirects, which can lead users to dangerous sites that may install malware or perform other harmful activities.",
      "Applications that perform redirects are very common. It is also common to use dynamic data to construct a portion of the redirect. When this occurs, validation is necessary in order to prevent an attacker from using the dynamic portion of the redirect to lead a user to a dangerous external site. The following shows 2 examples. The first example uses the standard sendRedirect() method which allows an attacker to manipulate the redirect location possibly taking a user to a dangerous external site. The second example resolves this issue by using the HTTPUtilities.sendRedirect() method which performs a validation on the incoming location, and throws an AccessControlException if the location is not pointing to an expected internal resource.",
      "An example of an insecure redirect is shown below:\r\n    \r\n      HttpServletRequest request = ...;\r\n      HttpServletResponse response = ...;\r\n      String location = request.getParameter(\"loc\") + \"/other/url\";\r\n      response.sendRedirect(location);\r\n    \r\n    A more secure example using ESAPI is shown below:\r\n    \r\n      HttpServletRequest request = ...;\r\n      HttpServletResponse response = ...;\r\n      String location = request.getParameter(\"loc\") + \"/other/url\";\r\n      try {\r\n      \tESAPI.httpUtilities().sendRedirect(response,location);\r\n      } catch (AccessControlException ace) {\r\n      \t//a bad location was attempted ... handle exception here\r\n      }\r\n    \r\n    (Note that additional protections should be added, such as whitelist validation, but the example above is for simplicity.)\r\n    In addition to using this function, you'll need to update the ESAPI.properties file for your application to inform ESAPI what your application name is so it knows the expected relative path. An example of the snippet you need to update is below:\r\n    Validator.Redirect=^\\\\/myapp.*$",
      "For more information about unvalidated redirects and forwards, please see https://www.owasp.org/index.php/Top_10_2010-A10For more information about ESAPI, please see https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API"
    ],
    "p": [
      "Use the ESAPI library to override the HttpServletResponse.sendRedirect() method.",
      "The ESAPI library provides a replacement method for the HttpServletResponse.sendRedirect() method that validates the redirect location to ensure it is a relative url within the application. This prevents unvalidated redirects, which can lead users to dangerous sites that may install malware or perform other harmful activities.",
      "Applications that perform redirects are very common. It is also common to use dynamic data to construct a portion of the redirect. When this occurs, validation is necessary in order to prevent an attacker from using the dynamic portion of the redirect to lead a user to a dangerous external site. The following shows 2 examples. The first example uses the standard sendRedirect() method which allows an attacker to manipulate the redirect location possibly taking a user to a dangerous external site. The second example resolves this issue by using the HTTPUtilities.sendRedirect() method which performs a validation on the incoming location, and throws an AccessControlException if the location is not pointing to an expected internal resource.",
      "An example of an insecure redirect is shown below:",
      "HttpServletRequest request = ...;",
      "HttpServletResponse response = ...;",
      "String location = request.getParameter(\"loc\") + \"/other/url\";",
      "response.sendRedirect(location);",
      "A more secure example using ESAPI is shown below:",
      "HttpServletRequest request = ...;",
      "HttpServletResponse response = ...;",
      "String location = request.getParameter(\"loc\") + \"/other/url\";",
      "try {",
      "ESAPI.httpUtilities().sendRedirect(response,location);",
      "} catch (AccessControlException ace) {",
      "//a bad location was attempted ... handle exception here",
      "}",
      "(Note that additional protections should be added, such as whitelist validation, but the example above is for simplicity.)",
      "In addition to using this function, you'll need to update the ESAPI.properties file for your application to inform ESAPI what your application name is so it knows the expected relative path. An example of the snippet you need to update is below:"
    ],
    "em": [
      "HttpServletResponse.sendRedirect()",
      "HttpServletResponse.sendRedirect()",
      "sendRedirect()",
      "HTTPUtilities.sendRedirect()",
      "AccessControlException",
      "ESAPI.properties"
    ],
    "pre": [
      "HttpServletRequest request = ...;\r\n      HttpServletResponse response = ...;\r\n      String location = request.getParameter(\"loc\") + \"/other/url\";\r\n      response.sendRedirect(location);",
      "HttpServletRequest request = ...;\r\n      HttpServletResponse response = ...;\r\n      String location = request.getParameter(\"loc\") + \"/other/url\";\r\n      try {\r\n      \tESAPI.httpUtilities().sendRedirect(response,location);\r\n      } catch (AccessControlException ace) {\r\n      \t//a bad location was attempted ... handle exception here\r\n      }",
      "Validator.Redirect=^\\\\/myapp.*$"
    ],
    "a": [
      "https://www.owasp.org/index.php/Top_10_2010-A10",
      "https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API",
      "Don't Use Redirects or Forwards if Possible",
      "Calculate Destinations of Redirects and Forwards Without User Input",
      "Use Mapping Values When Redirecting on User Input",
      "Validate Destinations of Redirects and Forwards",
      "Redirects and Forwards Are Not Used Unless Necessary",
      "Destinations of Redirects and Forwards Are Calculated Without User Input",
      "Mapping Values Are Used for Redirects and Forwards",
      "Destinations of Redirects and Forwards Are Validated",
      "Use ESAPI to Override the sendRedirect() Method"
    ]
  },
  "links": [
    {
      "href": "https://www.owasp.org/index.php/Top_10_2010-A10",
      "text": "https://www.owasp.org/index.php/Top_10_2010-A10"
    },
    {
      "href": "https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API",
      "text": "https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API"
    },
    {
      "href": "/article/0ed7310a-a0fd-4074-9c0f-37f48cf2bf4f",
      "text": "Don't Use Redirects or Forwards if Possible"
    },
    {
      "href": "/article/be525e05-0785-4b0c-8266-1ab4a0be08ea",
      "text": "Calculate Destinations of Redirects and Forwards Without User Input"
    },
    {
      "href": "/article/8a8fe651-2168-4c88-b89a-0b6b442da2f8",
      "text": "Use Mapping Values When Redirecting on User Input"
    },
    {
      "href": "/article/e7a1c675-9cae-4c12-85f3-4eb4269c197d",
      "text": "Validate Destinations of Redirects and Forwards"
    },
    {
      "href": "/article/11e960d3-09c4-4b40-9e20-a17fbe3116e7",
      "text": "Redirects and Forwards Are Not Used Unless Necessary"
    },
    {
      "href": "/article/b77c82d9-0a87-4f01-9943-f3a9fc52b561",
      "text": "Destinations of Redirects and Forwards Are Calculated Without User Input"
    },
    {
      "href": "/article/7bef867d-4dcb-47ea-ac58-651b9552cc1c",
      "text": "Mapping Values Are Used for Redirects and Forwards"
    },
    {
      "href": "/article/346a9c98-e2ce-4551-85b4-ba8f4acdd9dc",
      "text": "Destinations of Redirects and Forwards Are Validated"
    },
    {
      "href": "/article/58e5c2d7-7917-4c79-b329-b676173f6764",
      "text": "Use ESAPI to Override the sendRedirect() Method"
    }
  ],
  "html": "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>Java web-based applications.</li>\r\n  </ul>\r\n  <h1>Summary</h1>\r\n  <span>\r\n    <p>Use the ESAPI library to override the <em>HttpServletResponse.sendRedirect() </em>method.</p>\r\n  </span>\r\n  <h1>Objectives</h1>\r\n  <span>\r\n    <p>The ESAPI library provides a replacement method for the <em>HttpServletResponse.sendRedirect()</em> method that validates the redirect location to ensure it is a relative url within the application. This prevents unvalidated redirects, which can lead users to dangerous sites that may install malware or perform other harmful activities.</p>\r\n  </span>\r\n  <h1>Scenarios</h1>\r\n  <span>\r\n    <p>Applications that perform redirects are very common. It is also common to use dynamic data to construct a portion of the redirect. When this occurs, validation is necessary in order to prevent an attacker from using the dynamic portion of the redirect to lead a user to a dangerous external site. The following shows 2 examples. The first example uses the standard <em>sendRedirect()</em> method which allows an attacker to manipulate the redirect location possibly taking a user to a dangerous external site. The second example resolves this issue by using the <em>HTTPUtilities.sendRedirect()</em> method which performs a validation on the incoming location, and throws an <em>AccessControlException</em> if the location is not pointing to an expected internal resource.</p>\r\n  </span>\r\n  <h1>Solution Example</h1>\r\n  <span>\r\n    <p>An example of an insecure redirect is shown below:</p>\r\n    <pre>\r\n      <p>HttpServletRequest request = ...;</p>\r\n      <p>HttpServletResponse response = ...;</p>\r\n      <p>String location = request.getParameter(\"loc\") &#43; \"/other/url\";</p>\r\n      <p>response.sendRedirect(location);</p>\r\n    </pre>\r\n    <p>A more secure example using ESAPI is shown below:</p>\r\n    <pre>\r\n      <p>HttpServletRequest request = ...;</p>\r\n      <p>HttpServletResponse response = ...;</p>\r\n      <p>String location = request.getParameter(\"loc\") &#43; \"/other/url\";</p>\r\n      <p>try &#123;</p>\r\n      <p>&#9;ESAPI.httpUtilities().sendRedirect(response,location);</p>\r\n      <p>&#125; catch (AccessControlException ace) &#123;</p>\r\n      <p>&#9;//a bad location was attempted ... handle exception here</p>\r\n      <p>&#125;</p>\r\n    </pre>\r\n    <p>(Note that additional protections should be added, such as whitelist validation, but the example above is for simplicity.)</p>\r\n    <p>In addition to using this function, you'll need to update the <em>ESAPI.properties</em> file for your application to inform ESAPI what your application name is so it knows the expected relative path. An example of the snippet you need to update is below:</p>\r\n    <pre>Validator.Redirect=&#94;\\\\/myapp.&#42;&#36;</pre>\r\n  </span>\r\n  <h1>See Also</h1>\r\n  <span>\r\n    <ul>\r\n      <li>For more information about unvalidated redirects and forwards, please see <a href=\"https://www.owasp.org/index.php/Top_10_2010-A10\">https://www.owasp.org/index.php/Top_10_2010-A10</a><li>For more information about ESAPI, please see <a href=\"https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API\">https://www.owasp.org/index.php/Category:OWASP_Enterprise_Security_API</a></li></li>\r\n    </ul>\r\n  </span>\r\n  <h1>Redirects and Forwards Guidelines</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/0ed7310a-a0fd-4074-9c0f-37f48cf2bf4f\">Don't Use Redirects or Forwards if Possible</a>\r\n      <li>\r\n        <a href=\"/article/be525e05-0785-4b0c-8266-1ab4a0be08ea\">Calculate Destinations of Redirects and Forwards Without User Input</a>\r\n        <li>\r\n          <a href=\"/article/8a8fe651-2168-4c88-b89a-0b6b442da2f8\">Use Mapping Values When Redirecting on User Input</a>\r\n          <li>\r\n            <a href=\"/article/e7a1c675-9cae-4c12-85f3-4eb4269c197d\">Validate Destinations of Redirects and Forwards</a>\r\n          </li>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ul>\r\n  <h1>Redirects and Forwards Checklists</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/11e960d3-09c4-4b40-9e20-a17fbe3116e7\">Redirects and Forwards Are Not Used Unless Necessary</a>\r\n      <li>\r\n        <a href=\"/article/b77c82d9-0a87-4f01-9943-f3a9fc52b561\">Destinations of Redirects and Forwards Are Calculated Without User Input</a>\r\n        <li>\r\n          <a href=\"/article/7bef867d-4dcb-47ea-ac58-651b9552cc1c\">Mapping Values Are Used for Redirects and Forwards</a>\r\n          <li>\r\n            <a href=\"/article/346a9c98-e2ce-4551-85b4-ba8f4acdd9dc\">Destinations of Redirects and Forwards Are Validated</a>\r\n          </li>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ul>\r\n  <h1>Redirects and Forwards Code Example</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/58e5c2d7-7917-4c79-b329-b676173f6764\">Use ESAPI to Override the sendRedirect() Method</a>\r\n    </li>\r\n  </ul>"
}