<br />
  <h1>What to Check For</h1>
  <p>A global exception handler is used to catch any unhandled exceptions. A global exception handler improves the application's robustness and minimizes the risk of information disclosure.</p>
  <h1>Why</h1>
  <p>Unhandled exceptions can be a serious stumbling block to an application's performance and security. Unhandled exceptions must be avoided as they can result in the application entering an unknown state and/or revealing sensitive internal application details. Using a global exception handler will prevent unhandled exceptions.</p>
  <h1>How to Check</h1>
  <p>Use the following steps to verify a global exception handler is used for unhandled exceptions:</p>
  <ol>
    <li>
      <p>
        <strong>Verify that the application defines a global error handler in Global.aspx</strong> to catch any exceptions that are not handled in code. The following code gives an example of how this might be done:</p>
      <pre>&lt;%@ Application Language="C#" %&gt;<br />&lt;%@ Import Namespace="System.Diagnostics" %&gt;<br /> &lt;script language="C#" runat="server"&gt;<br /> void Application_Error(object sender, EventArgs e) {<br />     // Add the appropriate logging code<br />        Response.Write("We are sorry, but we cannot complete your request. Please try again later!");<br />    Server.ClearError();<br />}<br /> &lt;/script&gt;</pre>
    </li>
    <li>
      <p>
        <strong>Verify that all exceptions are logged in the application event log.</strong> While testing the application, analyze the event log regularly, looking for unhandled exceptions.</p>
    </li>
  </ol>
  <h1>Problem Example</h1>
  <p>An ASP.NET application has code to connect to a SQL database. However, the application does not have a generic error handler specified. As a result, when the connection times out application details are revealed to the client in the exception: </p>
  <p>
    <strong>Description:</strong> An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.</p>
  <p>
    <strong>Exception Details:</strong> System.Data.SqlClient.SqlException: An error has occurred while establishing a connection to the server. When connecting to SQL Server, this failure may be caused by the fact that under the default settings SQL Server does not allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)</p>
  <p>
    <strong>Source Error:</strong>
  </p>
  <table>
    <tbody>
      <tr>
        <td>
          <pre>Line 216:<br />Line 217:            if (conn.State != ConnectionState.Open)<br />Line 218:                conn.Open();<br />Line 219:<br />Line 220:            cmd.Connection = conn;</pre>
        </td>
      </tr>
    </tbody>
  </table>
  <h1>Additional Resources</h1>
  <ul>
    <li>To learn more about creating custom errors in ASP.NET, visit <a href="http://support.microsoft.com/kb/306355">http://support.microsoft.com/kb/306355</a></li>
  </ul>
  <hr />
  <p>Adapted from Microsoft patterns &amp; practices guidance. </p>