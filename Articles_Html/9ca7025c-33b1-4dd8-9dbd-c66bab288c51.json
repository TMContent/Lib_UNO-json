{
  "id": "9ca7025c-33b1-4dd8-9dbd-c66bab288c51",
  "checksum": "a40b8d67392874c8c0c7e2646b87ac92e42b5ee2",
  "words": {
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "title"
    ],
    "web": [
      "ul",
      "li",
      "p"
    ],
    "application": [
      "ul",
      "li",
      "p"
    ],
    "what": [
      "h1"
    ],
    "do": [
      "h1",
      "p"
    ],
    "you": [
      "p",
      "p",
      "div",
      "div",
      "p"
    ],
    "must": [
      "p"
    ],
    "protect": [
      "p",
      "title"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "p",
      "p",
      "p",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre"
    ],
    "authentication": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "cookie with": [
      "p"
    ],
    "ssl": [
      "p",
      "p",
      "p",
      "title"
    ],
    "why": [
      "h1"
    ],
    "prevent": [
      "p"
    ],
    "session": [
      "p",
      "title"
    ],
    "hijacking": [
      "p"
    ],
    "and": [
      "p",
      "p",
      "p"
    ],
    "cookie": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre"
    ],
    "replay": [
      "p"
    ],
    "attacks": [
      "p"
    ],
    "secure": [
      "p",
      "p",
      "p",
      "p",
      "div",
      "div",
      "div",
      "div",
      "p",
      "div",
      "div",
      "pre"
    ],
    "by": [
      "p",
      "p"
    ],
    "making": [
      "p"
    ],
    "sure": [
      "p",
      "p"
    ],
    "that": [
      "p",
      "p"
    ],
    "it": [
      "p",
      "p"
    ],
    "is": [
      "p",
      "p",
      "p"
    ],
    "only": [
      "p",
      "p",
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "passed": [
      "p"
    ],
    "over": [
      "p",
      "p",
      "p"
    ],
    "connections": [
      "p",
      "p",
      "p"
    ],
    "using": [
      "p",
      "p",
      "p",
      "p",
      "div",
      "div",
      "div",
      "div",
      "p",
      "p"
    ],
    "https": [
      "p",
      "p",
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "protocol": [
      "p"
    ],
    "for": [
      "p",
      "p",
      "p"
    ],
    "additional": [
      "p"
    ],
    "risk": [
      "p",
      "p"
    ],
    "mitigation": [
      "p"
    ],
    "encrypt": [
      "p"
    ],
    "before": [
      "p"
    ],
    "sending": [
      "p"
    ],
    "client": [
      "p"
    ],
    "limit": [
      "p"
    ],
    "period": [
      "p"
    ],
    "which": [
      "p",
      "p"
    ],
    "valid": [
      "p"
    ],
    "when": [
      "h1"
    ],
    "when you": [
      "p"
    ],
    "use": [
      "p",
      "title"
    ],
    "forms": [
      "p",
      "div",
      "div",
      "pre"
    ],
    "make": [
      "p"
    ],
    "your": [
      "p"
    ],
    "encrypts": [
      "p"
    ],
    "cookies": [
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "protection=\"all\"": [
      "p",
      "b"
    ],
    "attribute": [
      "p"
    ],
    "on": [
      "p",
      "p"
    ],
    "forms>": [
      "p",
      "b",
      "p",
      "b"
    ],
    "element": [
      "p",
      "p"
    ],
    "this": [
      "p"
    ],
    "practice": [
      "p"
    ],
    "recommended": [
      "p"
    ],
    "in": [
      "p",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "p",
      "p",
      "div",
      "div",
      "pre"
    ],
    "addition": [
      "p"
    ],
    "mitigate": [
      "p"
    ],
    "of": [
      "p",
      "p"
    ],
    "an": [
      "p"
    ],
    "xss": [
      "p"
    ],
    "attack": [
      "p"
    ],
    "manages": [
      "p"
    ],
    "steal": [
      "p"
    ],
    "a": [
      "p"
    ],
    "user": [
      "p"
    ],
    "how": [
      "h1"
    ],
    "not": [
      "p"
    ],
    "pass": [
      "p"
    ],
    "http": [
      "p"
    ],
    "set": [
      "p",
      "p",
      "div",
      "div",
      "div",
      "div",
      "p",
      "div",
      "div",
      "pre"
    ],
    "property": [
      "p",
      "p",
      "div",
      "div",
      "p"
    ],
    "within": [
      "p"
    ],
    "instructs": [
      "p"
    ],
    "browsers": [
      "p",
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "send": [
      "p",
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "back": [
      "p"
    ],
    "server": [
      "p"
    ],
    "more": [
      "p"
    ],
    "information": [
      "p"
    ],
    "see": [
      "p"
    ],
    "chapter 10": [
      "p"
    ],
    "\"building": [
      "p"
    ],
    "aspnet": [
      "p"
    ],
    "pages": [
      "p",
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "controls\"": [
      "p"
    ],
    "if": [
      "p",
      "div",
      "div",
      "div",
      "div",
      "p",
      "div",
      "div",
      "pre"
    ],
    "are": [
      "p",
      "div",
      "div",
      "p"
    ],
    "net": [
      "p",
      "div",
      "div",
      "p"
    ],
    "framework": [
      "p",
      "div",
      "div",
      "p"
    ],
    "version": [
      "p",
      "div",
      "div",
      "p"
    ],
    "11,": [
      "p"
    ],
    "requiressl=\"true\"": [
      "p",
      "b",
      "div",
      "div",
      "pre"
    ],
    "as": [
      "p"
    ],
    "follows": [
      "p"
    ],
    "loginurl=\"secure\\loginaspx\"": [
      "div",
      "div",
      "pre"
    ],
    "/": [
      "div",
      "div",
      "pre"
    ],
    "10,": [
      "div",
      "div",
      "p"
    ],
    "manually": [
      "div",
      "div",
      "p"
    ],
    "application_endrequest": [
      "div",
      "div",
      "p",
      "b"
    ],
    "event": [
      "div",
      "div",
      "p"
    ],
    "handler": [
      "div",
      "div",
      "p"
    ],
    "globalasax": [
      "div",
      "div",
      "p"
    ],
    "following": [
      "div",
      "div",
      "p"
    ],
    "code": [
      "div",
      "div",
      "p"
    ],
    "protected": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "void": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "application_endrequestobject": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "sender": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "eventargs": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "e": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "{": [
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre"
    ],
    "string": [
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre"
    ],
    "authcookie": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "=": [
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre"
    ],
    "formsauthenticationformscookiename;": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "foreach": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "scookie": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "responsecookies)": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "scookie.equals(authcookie))": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "//": [
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre"
    ],
    "be": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "will": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "requested": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "with": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "responsecookies[scookie].secure": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "true": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "}": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "}}": [
      "div",
      "div",
      "div",
      "div",
      "pre"
    ],
    "adapted": [
      "p"
    ],
    "from": [
      "p"
    ],
    "microsoft": [
      "p"
    ],
    "patterns": [
      "p"
    ],
    "&": [
      "p"
    ],
    "practices": [
      "p"
    ],
    "guidance": [
      "p"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "What to Do",
      "Why",
      "When",
      "How"
    ],
    "ul": [
      "Web Application"
    ],
    "li": [
      "Web Application"
    ],
    "p": [
      "You must protect the authentication cookie with SSL.",
      "To prevent session hijacking and cookie replay attacks, secure the cookie by making sure that it is only passed over SSL connections using the HTTPS protocol. For additional risk mitigation, encrypt the cookie before sending it to the client and limit the period for which the cookie is valid.",
      "When you use Forms authentication, make sure your application encrypts the authentication cookies using the protection=\"All\" attribute on the <forms> element. This practice is recommended in addition to SSL to mitigate the risk of an XSS attack that manages to steal the authentication cookie of a user.",
      "Do not pass authentication cookies over HTTP connections. Set the secure cookie property within authentication cookies, which instructs browsers to send cookies back to the server only over HTTPS connections. For more information, see Chapter 10, \"Building Secure ASP.NET Web Pages and Controls.\"",
      "If you are using .NET Framework version 1.1, set the secure property by using requireSSL=\"true\" on the <forms> element as follows:",
      "If you are using .NET Framework version 1.0, set the secure property manually in the Application_EndRequest event handler in Global.asax using the following code:",
      "Adapted from Microsoft patterns & practices guidance."
    ],
    "b": [
      "protection=\"All\"",
      "<forms>",
      "requireSSL=\"true\"",
      "<forms>",
      "Application_EndRequest"
    ],
    "div": [
      "<forms loginUrl=\"Secure\\Login.aspx\"       requireSSL=\"true\" . . . />\r\n    \r\n    \r\n      If you are using .NET Framework version 1.0, set the secure property manually in the Application_EndRequest event handler in Global.asax using the following code:\r\n      \r\n        \r\n        \r\n        \r\n          protected void Application_EndRequest(Object sender, EventArgs e) {  string authCookie = FormsAuthentication.FormsCookieName;  foreach (string sCookie in Response.Cookies)   {    if (sCookie.Equals(authCookie))    {       // Set the cookie to be secure. Browsers will send the cookie      // only to pages requested with https      Response.Cookies[sCookie].Secure = true;    }  }}",
      "",
      "<forms loginUrl=\"Secure\\Login.aspx\"       requireSSL=\"true\" . . . />",
      "If you are using .NET Framework version 1.0, set the secure property manually in the Application_EndRequest event handler in Global.asax using the following code:\r\n      \r\n        \r\n        \r\n        \r\n          protected void Application_EndRequest(Object sender, EventArgs e) {  string authCookie = FormsAuthentication.FormsCookieName;  foreach (string sCookie in Response.Cookies)   {    if (sCookie.Equals(authCookie))    {       // Set the cookie to be secure. Browsers will send the cookie      // only to pages requested with https      Response.Cookies[sCookie].Secure = true;    }  }}",
      "protected void Application_EndRequest(Object sender, EventArgs e) {  string authCookie = FormsAuthentication.FormsCookieName;  foreach (string sCookie in Response.Cookies)   {    if (sCookie.Equals(authCookie))    {       // Set the cookie to be secure. Browsers will send the cookie      // only to pages requested with https      Response.Cookies[sCookie].Secure = true;    }  }}",
      "",
      "protected void Application_EndRequest(Object sender, EventArgs e) {  string authCookie = FormsAuthentication.FormsCookieName;  foreach (string sCookie in Response.Cookies)   {    if (sCookie.Equals(authCookie))    {       // Set the cookie to be secure. Browsers will send the cookie      // only to pages requested with https      Response.Cookies[sCookie].Secure = true;    }  }}"
    ],
    "pre": [
      "<forms loginUrl=\"Secure\\Login.aspx\"       requireSSL=\"true\" . . . />",
      "protected void Application_EndRequest(Object sender, EventArgs e) {  string authCookie = FormsAuthentication.FormsCookieName;  foreach (string sCookie in Response.Cookies)   {    if (sCookie.Equals(authCookie))    {       // Set the cookie to be secure. Browsers will send the cookie      // only to pages requested with https      Response.Cookies[sCookie].Secure = true;    }  }}"
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "hr": [
      ""
    ]
  },
  "links": [],
  "html": "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>Web Application&nbsp;</li>\r\n  </ul>\r\n  <h1>What to Do</h1>\r\n  <p>You must protect the authentication cookie&nbsp;with SSL. </p>\r\n  <h1>Why</h1>\r\n  <p>To prevent session hijacking and cookie replay attacks, secure the cookie by making sure that it is only passed over SSL connections using the HTTPS protocol. For additional risk mitigation, encrypt the cookie before sending it to the client and limit the period for which the cookie is valid. </p>\r\n  <h1>When</h1>\r\n  <p>When&nbsp;you use Forms authentication, make sure your application encrypts the authentication cookies using the <b>protection=\"All\"</b> attribute on the <b>&lt;forms&gt; </b>element. This practice is recommended in addition to SSL to mitigate the risk of an XSS attack that manages to steal the authentication cookie of a user.&nbsp; </p>\r\n  <h1>How</h1>\r\n  <p>Do not pass authentication cookies over HTTP connections. Set the secure cookie property within authentication cookies, which instructs browsers to send cookies back to the server only over HTTPS connections. For more information, see Chapter&nbsp;10, \"Building Secure ASP.NET Web Pages and Controls.\"</p>\r\n  <p>If you are using .NET Framework version 1.1, set the secure property by using <b>requireSSL=\"true\"</b> on the <b>&lt;forms&gt;</b> element as follows:</p>\r\n  <div>\r\n    <div>\r\n    </div>\r\n    <div>\r\n      <pre>&lt;forms loginUrl=\"Secure\\Login.aspx\"<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; requireSSL=\"true\" . . . /&gt;</pre>\r\n    </div>\r\n    <div>\r\n      <p>If you are using .NET Framework version 1.0, set the secure property manually in the <b>Application_EndRequest</b> event handler in Global.asax using the following code:</p>\r\n      <div>\r\n        <div>\r\n        </div>\r\n        <div>\r\n          <pre>protected void Application_EndRequest(Object sender, EventArgs e) <br />{<br />&nbsp; string authCookie = FormsAuthentication.FormsCookieName;<br /><br />&nbsp; foreach (string sCookie in Response.Cookies) <br />&nbsp; {<br />&nbsp;&nbsp;&nbsp; if (sCookie.Equals(authCookie))<br />&nbsp;&nbsp;&nbsp; { <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Set the cookie to be secure. Browsers will send the cookie<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // only to pages requested with https<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Response.Cookies[sCookie].Secure = true;<br />&nbsp;&nbsp;&nbsp; }<br />&nbsp; }<br />}</pre>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns & practices guidance.</p>"
}