<h1>Applies to</h1>
  <ul>
    <li>C&#43;&#43;<li>Windows</li></li>
  </ul>
  <h1>What to Check For</h1>
  <p>Verify that processes are created safely.</p>
  <h1>Why</h1>
  <p>Improperly creating processes may allow an attacker to execute arbitrary code.</p>
  <h1>How to Check</h1>
  <p>Use the following steps to check if processes are created safely:</p>
  <ol>
    <li>
      <p>
        <strong>Identify code the creates processes.</strong> Search code for the following functions that may be used to create processes: <em>CreateProcess(), CreateProcessAsUser(), CreateProcessWithLogon(), ShellExecute(), ShellExecuteEx(), exec(), spawn().</em></p>
      <li>
        <p>
          <strong>Verify that shell or CRT APIs are not used.</strong> Review code to make sure the following APIs are not used unless absolutely necessary:<em> ShellExecute(), ShellExecuteEx(), exec(), spawn()</em>.</p>
        <li>
          <p>
            <strong>Verify that CreateProcess() is used with fully-qualified names.</strong> Review code to make sure that either <em>lpApplicationName</em> or <em>lpCommandLine</em> is fully-qualified in calls to <em>CreateProcess(), CreateProcessAsUser(), or CreateProcessWithLogon()</em>.</p>
        </li>
      </li>
    </li>
  </ol>
  <h1>How to Fix</h1>
  <p>Perform the following actions to create processes securely:</p>
  <ol>
    <li>
      <p>
        <strong>Identify code the creates processes.</strong> Search code for the following functions that may be used to create processes: <em>CreateProcess(), CreateProcessAsUser(), CreateProcessWithLogon(), ShellExecute(), ShellExecuteEx(), exec(), spawn()</em>.</p>
      <li>
        <p>
          <strong>Replace shell and CRT APIs with base APIs.</strong> Shell APIs and CRT functions all wrap <em>CreateProcess()</em> at some point while adding additional threats. Use <em>CreateProcess()</em> as often as possible. Shell and CRT APIs are: <em>ShellExecute(), ShellExecuteEx(), exec(), spawn()</em>.</p>
        <li>
          <p>
            <strong>Use fully qualified paths with CreateProcess().</strong> Either <em>lpApplicationName</em> or <em>lpCommandLine</em> should be fully qualified. If neither of them are fully-qualified, an attacker may place an executable with the same name as the one being launched by <em>CreateProcess()</em> into the current folder and <em>CreateProcess()</em> will run it instead.</p>
        </li>
      </li>
    </li>
  </ol>
  <h1>Related Items</h1>
  <ul>
    <li>
      <a href="/article/2314618a-47ce-4ff0-9641-365fb3e262e4">Create Processes Securely with CreateProcess()<br /></a>
    </li>
  </ul>