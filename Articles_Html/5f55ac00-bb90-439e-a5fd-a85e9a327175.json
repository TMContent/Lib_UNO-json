{
  "id": "5f55ac00-bb90-439e-a5fd-a85e9a327175",
  "checksum": "187f8b173d5ff96e14f1a392f6783ff183751646",
  "words": {
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "pre",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "applications": [
      "ul",
      "li"
    ],
    "written": [
      "ul",
      "li"
    ],
    "using": [
      "ul",
      "li",
      "ol",
      "li",
      "p"
    ],
    "servlets": [
      "ul",
      "li"
    ],
    "or": [
      "ul",
      "li",
      "p",
      "ol",
      "li",
      "p",
      "pre"
    ],
    "jsp": [
      "ul",
      "li"
    ],
    "what": [
      "h1"
    ],
    "do": [
      "h1",
      "p"
    ],
    "use": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "stored": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "strong",
      "li",
      "p",
      "p",
      "p",
      "title"
    ],
    "procedures": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "when": [
      "p"
    ],
    "interacting": [
      "p"
    ],
    "with": [
      "p"
    ],
    "a": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "p",
      "p"
    ],
    "database": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "p",
      "p",
      "p"
    ],
    "if": [
      "p"
    ],
    "other": [
      "p"
    ],
    "parameterized": [
      "p"
    ],
    "apis": [
      "p"
    ],
    "are": [
      "p"
    ],
    "not": [
      "p",
      "p"
    ],
    "available": [
      "p"
    ],
    "this": [
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "increases": [
      "p"
    ],
    "performance": [
      "p"
    ],
    "and": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "reduces": [
      "p"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "strong",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "risk": [
      "p"
    ],
    "of": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "successful": [
      "p"
    ],
    "sql": [
      "p",
      "p",
      "p",
      "p"
    ],
    "injection": [
      "p",
      "p",
      "p",
      "p"
    ],
    "attack": [
      "p",
      "p"
    ],
    "why": [
      "h1"
    ],
    "attackers": [
      "p"
    ],
    "can": [
      "p",
      "p",
      "ol",
      "li",
      "p",
      "p",
      "p"
    ],
    "manipulate": [
      "p",
      "p",
      "p"
    ],
    "in": [
      "p",
      "p"
    ],
    "unforeseen": [
      "p"
    ],
    "ways": [
      "p"
    ],
    "allows": [
      "p"
    ],
    "an": [
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "attacker": [
      "p"
    ],
    "assume": [
      "p"
    ],
    "credentials": [
      "p"
    ],
    "account": [
      "p"
    ],
    "used": [
      "p"
    ],
    "connect": [
      "p"
    ],
    "which": [
      "p"
    ],
    "may": [
      "p"
    ],
    "lead": [
      "p",
      "p"
    ],
    "arbitrary": [
      "p"
    ],
    "reading": [
      "p"
    ],
    "writing": [
      "p"
    ],
    "updating": [
      "p"
    ],
    "deleting": [
      "p"
    ],
    "data": [
      "p",
      "p",
      "p"
    ],
    "improperly": [
      "p"
    ],
    "secured": [
      "p"
    ],
    "also": [
      "p"
    ],
    "remote": [
      "p"
    ],
    "code": [
      "p",
      "p",
      "p"
    ],
    "execution": [
      "p"
    ],
    "through": [
      "p"
    ],
    "certain": [
      "p"
    ],
    "that": [
      "p",
      "p"
    ],
    "allow": [
      "p",
      "ol",
      "li",
      "p",
      "p",
      "p"
    ],
    "for": [
      "p"
    ],
    "direct": [
      "p"
    ],
    "operating": [
      "p"
    ],
    "system": [
      "p"
    ],
    "command": [
      "p"
    ],
    "how": [
      "h1"
    ],
    "procedure": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "pre",
      "li",
      "p",
      "strong",
      "li",
      "p"
    ],
    "create": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "pre"
    ],
    "on": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "pre",
      "pre",
      "p"
    ],
    "since": [
      "ol",
      "li",
      "p"
    ],
    "reside": [
      "ol",
      "li",
      "p"
    ],
    "server": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "li",
      "p",
      "p"
    ],
    "you": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "need": [
      "ol",
      "li",
      "p",
      "p"
    ],
    "appropriate": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "your": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "application's": [
      "ol",
      "li",
      "p",
      "p",
      "p"
    ],
    "following": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "p",
      "p"
    ],
    "example": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "h1",
      "h1"
    ],
    "creates": [
      "ol",
      "li",
      "p"
    ],
    "oracle": [
      "ol",
      "li",
      "p"
    ],
    "replace": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "placeordercustid": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "int": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "pre",
      "pre",
      "pre"
    ],
    "itemid": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "pre",
      "pre"
    ],
    "qty": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "isbegin": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "insert": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "into": [
      "ol",
      "li",
      "p",
      "pre",
      "p",
      "pre",
      "p"
    ],
    "pendingpurchases": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "pre",
      "li",
      "li",
      "p",
      "em",
      "p",
      "pre",
      "p",
      "em",
      "pre",
      "p",
      "em"
    ],
    "customer,": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "item": [
      "ol",
      "li",
      "p",
      "pre",
      "pre"
    ],
    "quantity": [
      "ol",
      "li",
      "p",
      "pre",
      "pre"
    ],
    "values": [
      "ol",
      "li",
      "p",
      "pre",
      "pre"
    ],
    "custid,": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "qty;end": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "placeorder": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "pre",
      "li",
      "li",
      "p",
      "em",
      "p",
      "pre"
    ],
    "call": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "be": [
      "ol",
      "li",
      "p"
    ],
    "done using": [
      "ol",
      "li",
      "p"
    ],
    "java": [
      "ol",
      "li",
      "p"
    ],
    "codeconnection": [
      "ol",
      "li",
      "p"
    ],
    "cn": [
      "ol",
      "li",
      "p",
      "pre",
      "pre",
      "pre"
    ],
    "=": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "myappgetdbconnection();preparedstatement": [
      "ol",
      "li",
      "p",
      "pre",
      "pre",
      "pre"
    ],
    "st": [
      "ol",
      "li",
      "p",
      "pre",
      "pre",
      "pre"
    ],
    "cnpreparestatement(\"exec": [
      "ol",
      "li",
      "p",
      "pre",
      "pre"
    ],
    "placeorder?,": [
      "ol",
      "li",
      "p",
      "pre",
      "pre"
    ],
    "?": [
      "ol",
      "li",
      "p",
      "pre",
      "pre",
      "pre"
    ],
    "?;\");st.setint(1,": [
      "ol",
      "li",
      "p",
      "pre",
      "pre",
      "pre"
    ],
    "custid;st.setint(2,": [
      "ol",
      "li",
      "p",
      "pre",
      "pre",
      "pre"
    ],
    "itemid;st.setint(3,": [
      "ol",
      "li",
      "p",
      "pre",
      "pre",
      "pre"
    ],
    "qty;resultset": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "rs": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "stexecutequery();": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "assign": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "permissions": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "p"
    ],
    "once": [
      "ol",
      "li",
      "p"
    ],
    "have": [
      "ol",
      "li",
      "p"
    ],
    "created": [
      "ol",
      "li",
      "p"
    ],
    "above": [
      "ol",
      "li",
      "p"
    ],
    "application": [
      "ol",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "execute": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "pre",
      "p"
    ],
    "deny": [
      "ol",
      "li",
      "p"
    ],
    "it": [
      "ol",
      "li",
      "p",
      "p"
    ],
    "access": [
      "ol",
      "li",
      "p"
    ],
    "revoke": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "all": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "from": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "myappgrant": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "myapp": [
      "ol",
      "li",
      "p",
      "pre"
    ],
    "connection": [
      "pre",
      "pre",
      "pre"
    ],
    "problem": [
      "h1"
    ],
    "places": [
      "p",
      "p"
    ],
    "new": [
      "p",
      "p"
    ],
    "order": [
      "p",
      "p"
    ],
    "backend": [
      "p",
      "p"
    ],
    "because": [
      "p",
      "p"
    ],
    "does": [
      "p"
    ],
    "developers": [
      "p",
      "p"
    ],
    "grant": [
      "p"
    ],
    "extra": [
      "p"
    ],
    "priviliges": [
      "p"
    ],
    "directly": [
      "p",
      "p"
    ],
    "inside": [
      "p",
      "p"
    ],
    "table": [
      "p"
    ],
    "cnpreparestatement(\"insert": [
      "pre"
    ],
    "\"": [
      "pre"
    ],
    "+": [
      "pre"
    ],
    "\"customer,": [
      "pre"
    ],
    "?,": [
      "pre"
    ],
    "qty;": [
      "pre",
      "pre"
    ],
    "solution": [
      "h1"
    ],
    "uses": [
      "p"
    ],
    "without": [
      "p"
    ],
    "giving": [
      "p"
    ],
    "so": [
      "p"
    ],
    "therefore": [
      "p"
    ],
    "further": [
      "p"
    ],
    "restricting": [
      "p"
    ],
    "set": [
      "p"
    ],
    "operations": [
      "p"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "What to Do",
      "Why",
      "How",
      "Problem Example",
      "Solution Example"
    ],
    "ul": [
      "Applications written using Servlets or JSP."
    ],
    "li": [
      "Applications written using Servlets or JSP.",
      "Create the stored procedure on the database. Since stored procedures reside on the database server, you need to create the appropriate stored procedures on your application's database server. The following example creates a stored procedure on an Oracle database server: CREATE OR REPLACE PROCEDURE PlaceOrder(custID INT, itemID INT, qty INT) ISBEGIN   INSERT INTO PendingPurchases (customer, item, quantity)    VALUES (custID, itemID, qty);END PlaceOrder;",
      "Call the stored procedure. This can be done using the following Java code:Connection cn = MyApp.getDBConnection();PreparedStatement st = cn.prepareStatement(\"exec PlaceOrder(?, ?, ?);\");st.setInt(1, custID);st.setInt(2, itemID);st.setInt(3, qty);ResultSet rs = st.executeQuery();",
      "Assign the appropriate permissions. Once you have created the stored procedure, assign the appropriate permissions on the database server. Using the example above, allow your application to execute PlaceOrder and deny it access to PendingPurchases. Example: REVOKE ALL ON PendingPurchases FROM myapp;GRANT EXECUTE ON PlaceOrder TO myapp;"
    ],
    "p": [
      "Use stored procedures when interacting with a database if other parameterized APIs are not available. This increases performance and reduces the risk of a successful SQL injection attack.",
      "Attackers can use a SQL Injection Attack to manipulate the database in unforeseen ways. SQL injection allows an attacker to assume the credentials of the SQL account used to connect to the database, which may lead to arbitrary reading, writing, updating or deleting of data. In an improperly secured database, this can also lead to remote code execution through the use of certain stored procedures that allow for direct Operating System command injection.",
      "To use a stored procedure:",
      "Create the stored procedure on the database. Since stored procedures reside on the database server, you need to create the appropriate stored procedures on your application's database server. The following example creates a stored procedure on an Oracle database server: CREATE OR REPLACE PROCEDURE PlaceOrder(custID INT, itemID INT, qty INT) ISBEGIN   INSERT INTO PendingPurchases (customer, item, quantity)    VALUES (custID, itemID, qty);END PlaceOrder;",
      "Call the stored procedure. This can be done using the following Java code:Connection cn = MyApp.getDBConnection();PreparedStatement st = cn.prepareStatement(\"exec PlaceOrder(?, ?, ?);\");st.setInt(1, custID);st.setInt(2, itemID);st.setInt(3, qty);ResultSet rs = st.executeQuery();",
      "Assign the appropriate permissions. Once you have created the stored procedure, assign the appropriate permissions on the database server. Using the example above, allow your application to execute PlaceOrder and deny it access to PendingPurchases. Example:",
      "REVOKE ALL ON PendingPurchases FROM myapp;GRANT EXECUTE ON PlaceOrder TO myapp;",
      "The following code places a new order into the application's backend database. Because the application does not use stored procedures, the developers need to grant extra priviliges to the application to allow it to directly manipulate data inside the PendingPurchases table.",
      "The following code places a new order into the application's backend database. Because the application uses stored procedures, the developers can allow the application to manipulate the data inside PendingPurchases without giving permissions to directly do so, therefore, further restricting the set of operations that the application can execute on the database server."
    ],
    "ol": [
      "Create the stored procedure on the database. Since stored procedures reside on the database server, you need to create the appropriate stored procedures on your application's database server. The following example creates a stored procedure on an Oracle database server: CREATE OR REPLACE PROCEDURE PlaceOrder(custID INT, itemID INT, qty INT) ISBEGIN   INSERT INTO PendingPurchases (customer, item, quantity)    VALUES (custID, itemID, qty);END PlaceOrder;\r\n    \r\n      \r\n      Call the stored procedure. This can be done using the following Java code:Connection cn = MyApp.getDBConnection();PreparedStatement st = cn.prepareStatement(\"exec PlaceOrder(?, ?, ?);\");st.setInt(1, custID);st.setInt(2, itemID);st.setInt(3, qty);ResultSet rs = st.executeQuery();\r\n    \r\n      \r\n      Assign the appropriate permissions. Once you have created the stored procedure, assign the appropriate permissions on the database server. Using the example above, allow your application to execute PlaceOrder and deny it access to PendingPurchases. Example: REVOKE ALL ON PendingPurchases FROM myapp;GRANT EXECUTE ON PlaceOrder TO myapp;"
    ],
    "strong": [
      "Create the stored procedure on the database.",
      "Call the stored procedure.",
      "Assign the appropriate permissions."
    ],
    "pre": [
      "CREATE OR REPLACE PROCEDURE PlaceOrder(custID INT, itemID INT, qty INT) ISBEGIN   INSERT INTO PendingPurchases (customer, item, quantity)    VALUES (custID, itemID, qty);END PlaceOrder;",
      "Connection cn = MyApp.getDBConnection();PreparedStatement st = cn.prepareStatement(\"exec PlaceOrder(?, ?, ?);\");st.setInt(1, custID);st.setInt(2, itemID);st.setInt(3, qty);ResultSet rs = st.executeQuery();",
      "REVOKE ALL ON PendingPurchases FROM myapp;GRANT EXECUTE ON PlaceOrder TO myapp;",
      "Connection cn = MyApp.getDBConnection();PreparedStatement st = cn.prepareStatement(\"insert into PendingPurchases \"                      + \"(customer, item, quantity) values (?, ?, ?);\");st.setInt(1, custID);st.setInt(2, itemID);st.setInt(3, qty);",
      "Connection cn = MyApp.getDBConnection();PreparedStatement st = cn.prepareStatement(\"exec PlaceOrder(?, ?, ?);\");st.setInt(1, custID);st.setInt(2, itemID);st.setInt(3, qty);"
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "em": [
      "PlaceOrder",
      "PendingPurchases",
      "PendingPurchases",
      "PendingPurchases"
    ]
  },
  "links": [],
  "html": "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>Applications written using Servlets or JSP.</li>\r\n  </ul>\r\n  <h1>What to Do</h1>\r\n  <p>Use stored procedures when interacting with a database if other parameterized APIs are not available. This increases performance and reduces the risk of a successful SQL injection attack.</p>\r\n  <h1>Why</h1>\r\n  <p>Attackers can use a SQL Injection Attack to manipulate the database in unforeseen ways. SQL injection allows an attacker to assume the credentials of the SQL account used to connect to the database, which may lead to arbitrary reading, writing, updating or deleting of data. In an improperly secured database, this can also lead to remote code execution through the use of certain stored procedures that allow for direct Operating System command injection.</p>\r\n  <h1>How</h1>\r\n  <p>To use a stored procedure:</p>\r\n  <ol>\r\n    <li>\r\n      <p />\r\n      <strong>Create the stored procedure on the database. </strong>Since stored procedures reside on the database server, you need to create the appropriate stored procedures on your application's database server. The following example creates a stored procedure on an Oracle database server: <pre>CREATE OR REPLACE PROCEDURE<br /> PlaceOrder(custID INT, itemID INT, qty INT)<br /> ISBEGIN<br />   INSERT INTO PendingPurchases (customer, item, quantity)<br />    VALUES (custID, itemID, qty);END PlaceOrder;</pre></li>\r\n    <li>\r\n      <p />\r\n      <strong>Call the stored procedure. </strong>This can be done&nbsp;using the following Java code:<pre>Connection cn = MyApp.getDBConnection();<br />PreparedStatement st = cn.prepareStatement(\"exec PlaceOrder(?, ?, ?);\");<br />st.setInt(1, custID);<br />st.setInt(2, itemID);<br />st.setInt(3, qty);<br />ResultSet rs = st.executeQuery();</pre></li>\r\n    <li>\r\n      <p />\r\n      <strong>Assign the appropriate permissions. </strong>Once you have created the stored procedure, assign the appropriate permissions on the database server. Using the example above, allow your application to execute <em>PlaceOrder</em> and deny it access to <em>PendingPurchases</em>. Example: <p /><pre>REVOKE ALL ON PendingPurchases FROM myapp;<br />GRANT EXECUTE ON PlaceOrder TO myapp;</pre></li>\r\n  </ol>\r\n  <h1>Problem Example</h1>\r\n  <p>The following code places a new order into the application's backend database. Because the application does not use stored procedures, the developers need to grant extra priviliges to the application to allow it to directly manipulate data inside the <em>PendingPurchases</em> table.</p>\r\n  <pre>Connection cn = MyApp.getDBConnection();<br />PreparedStatement st = cn.prepareStatement(\"insert into PendingPurchases \"<br />                      + \"(customer, item, quantity) values (?, ?, ?);\");<br />st.setInt(1, custID);st.setInt(2, itemID);st.setInt(3, qty);</pre>\r\n  <h1>Solution Example</h1>\r\n  <p>The following code places a new order into the application's backend database. Because the application uses stored procedures, the developers can allow the application to manipulate the data inside <em>PendingPurchases</em> without giving permissions to directly do so, therefore, further restricting the set of operations that the application can execute on the database server.</p>\r\n  <pre>Connection cn = MyApp.getDBConnection();<br />PreparedStatement st = cn.prepareStatement(\"exec PlaceOrder(?, ?, ?);\");<br />st.setInt(1, custID);st.setInt(2, itemID);st.setInt(3, qty);</pre>\r\n  <br />"
}