{
  "id": "da2ef63c-2068-41a2-a096-564da21ead6a",
  "checksum": "545d99a257b053ceb0538b023d4b2aa13330715f",
  "words": {
    "applies": [
      "h2"
    ],
    "to": [
      "h2",
      "h2",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "title"
    ],
    "c++": [
      "ul",
      "li"
    ],
    "what": [
      "h2"
    ],
    "do": [
      "h2"
    ],
    "use": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong",
      "title"
    ],
    "reference": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "strong",
      "title"
    ],
    "maps": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "strong",
      "title"
    ],
    "access": [
      "p",
      "p",
      "ol",
      "li",
      "title"
    ],
    "objects": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "title"
    ],
    "assign": [
      "p"
    ],
    "user-specific": [
      "p"
    ],
    "or": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li"
    ],
    "session-specific": [
      "p"
    ],
    "identifiers": [
      "p",
      "p"
    ],
    "when": [
      "p",
      "p"
    ],
    "exposing": [
      "p",
      "p",
      "p",
      "ol",
      "li"
    ],
    "their": [
      "p"
    ],
    "names": [
      "p",
      "p",
      "p",
      "ol",
      "li"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li"
    ],
    "user": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li"
    ],
    "rather": [
      "p",
      "p",
      "ol",
      "li"
    ],
    "than": [
      "p",
      "p",
      "ol",
      "li"
    ],
    "operating": [
      "p",
      "p",
      "ol",
      "li"
    ],
    "system": [
      "p",
      "p",
      "p",
      "ol",
      "li"
    ],
    "assigned": [
      "p",
      "p"
    ],
    "of": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong"
    ],
    "these": [
      "p"
    ],
    "why": [
      "h2"
    ],
    "prevent": [
      "p"
    ],
    "path": [
      "p",
      "p"
    ],
    "manipulation": [
      "p",
      "p"
    ],
    "vulnerabilities": [
      "p"
    ],
    "if": [
      "p"
    ],
    "application": [
      "p",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "uses": [
      "p"
    ],
    "its": [
      "p"
    ],
    "own": [
      "p"
    ],
    "for": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li"
    ],
    "them": [
      "p"
    ],
    "instead": [
      "p",
      "ol",
      "li",
      "strong"
    ],
    "filesystem": [
      "p",
      "p"
    ],
    "paths": [
      "p",
      "p"
    ],
    "an": [
      "p"
    ],
    "attacker": [
      "p"
    ],
    "will": [
      "p"
    ],
    "not": [
      "p"
    ],
    "be": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li"
    ],
    "able": [
      "p"
    ],
    "manipulate": [
      "p"
    ],
    "while": [
      "p"
    ],
    "refers": [
      "p"
    ],
    "almost": [
      "p"
    ],
    "exclusively": [
      "p"
    ],
    "same": [
      "p"
    ],
    "technique": [
      "p"
    ],
    "using": [
      "p"
    ],
    "aliases": [
      "p"
    ],
    "also": [
      "p"
    ],
    "works": [
      "p"
    ],
    "other": [
      "p"
    ],
    "types": [
      "p"
    ],
    "resources": [
      "p"
    ],
    "such": [
      "p"
    ],
    "as": [
      "p"
    ],
    "sockets": [
      "p"
    ],
    "how": [
      "h2"
    ],
    "identify": [
      "ol",
      "li",
      "strong"
    ],
    "that": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li"
    ],
    "are": [
      "ol",
      "ol",
      "ol",
      "li",
      "strong",
      "li",
      "li"
    ],
    "being": [
      "ol",
      "ol",
      "li",
      "strong",
      "li"
    ],
    "referenced": [
      "ol",
      "ol",
      "li",
      "strong",
      "li"
    ],
    "find": [
      "ol",
      "li"
    ],
    "all": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "code": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li"
    ],
    "exposes": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "handled": [
      "ol",
      "li"
    ],
    "by": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li"
    ],
    "especially": [
      "ol",
      "li"
    ],
    "files": [
      "ol",
      "li"
    ],
    "make": [
      "ol",
      "li"
    ],
    "a": [
      "ol",
      "li"
    ],
    "spreadsheet": [
      "ol",
      "li"
    ],
    "track": [
      "ol",
      "li"
    ],
    "this": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li"
    ],
    "define": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong"
    ],
    "object": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "li",
      "strong"
    ],
    "arrays": [
      "ol",
      "li"
    ],
    "hashes": [
      "ol",
      "li"
    ],
    "index": [
      "ol",
      "li"
    ],
    "array": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "key": [
      "ol",
      "li"
    ],
    "hash": [
      "ol",
      "li"
    ],
    "matches": [
      "ol",
      "li"
    ],
    "required": [
      "ol",
      "li"
    ],
    "resource": [
      "ol",
      "li"
    ],
    "itself": [
      "ol",
      "li"
    ],
    "approach": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "ensures": [
      "ol",
      "li"
    ],
    "only": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "in": [
      "ol",
      "li"
    ],
    "may": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li"
    ],
    "accessed": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li"
    ],
    "work": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "should": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "include": [
      "ol",
      "li"
    ],
    "which": [
      "ol",
      "li"
    ],
    "is": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "authorized": [
      "ol",
      "li"
    ],
    "it": [
      "ol",
      "li"
    ],
    "possible": [
      "ol",
      "li"
    ],
    "per-user": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "per-session": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li"
    ],
    "mappings": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li"
    ],
    "each": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li"
    ],
    "current": [
      "ol",
      "li"
    ],
    "session": [
      "ol",
      "li"
    ],
    "references": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong"
    ],
    "offer": [
      "ol",
      "li"
    ],
    "additional": [
      "ol",
      "li"
    ],
    "security": [
      "ol",
      "li"
    ],
    "flexibility": [
      "ol",
      "li"
    ],
    "but": [
      "ol",
      "li"
    ],
    "require": [
      "ol",
      "li"
    ],
    "more": [
      "ol",
      "li"
    ],
    "generated": [
      "ol",
      "li"
    ],
    "dynamically": [
      "ol",
      "li"
    ],
    "and": [
      "ol",
      "li"
    ],
    "means": [
      "ol",
      "li"
    ],
    "has": [
      "ol",
      "li"
    ],
    "written": [
      "ol",
      "li"
    ],
    "defines": [
      "ol",
      "li"
    ],
    "direct": [
      "ol",
      "li",
      "strong"
    ],
    "update": [
      "ol",
      "li"
    ]
  },
  "tags": {
    "h2": [
      "Applies To",
      "What to Do",
      "Why",
      "How"
    ],
    "ul": [
      "C++"
    ],
    "li": [
      "C++",
      "Identify objects that are being referenced. Find all code that exposes the operating system names of objects handled by the application, especially files. Make a spreadsheet to track this code.",
      "Define object reference maps. Object reference maps are arrays or hashes of objects that are being referenced. The application exposes the index of the array or the key of the hash that matches the required resource, rather than exposing the object itself. This approach ensures that only objects in the array may be accessed. For this approach to work, reference maps should only include objects for which access is authorized. It is possible to use per-user or per-session object mappings. Per-user mappings define objects that may be accessed by each user. Per-session mappings define objects that may be accessed by each user for the current session. Per-session references may offer additional security or flexibility, but require more work. Mappings should be generated dynamically and that means that code has to be written that defines objects that may be accessed by each user.",
      "Use reference maps instead of direct object references. Update all the code that references objects to use the reference maps."
    ],
    "p": [
      "Use reference maps to access objects. Assign user-specific or session-specific identifiers to objects when exposing their names to the user, rather than exposing the operating system assigned names of these objects.",
      "Use reference maps to prevent path manipulation vulnerabilities. If the application uses its own identifiers for objects when exposing them to the user, instead of filesystem paths, an attacker will not be able to manipulate the paths of the objects. While path manipulation refers almost exclusively to filesystem objects, the same technique of using aliases rather than operating system assigned names also works for other types of system resources, such as sockets.",
      "To use reference maps to access objects:"
    ],
    "ol": [
      "Identify objects that are being referenced. Find all code that exposes the operating system names of objects handled by the application, especially files. Make a spreadsheet to track this code.\n Define object reference maps. Object reference maps are arrays or hashes of objects that are being referenced. The application exposes the index of the array or the key of the hash that matches the required resource, rather than exposing the object itself. This approach ensures that only objects in the array may be accessed. For this approach to work, reference maps should only include objects for which access is authorized. It is possible to use per-user or per-session object mappings. Per-user mappings define objects that may be accessed by each user. Per-session mappings define objects that may be accessed by each user for the current session. Per-session references may offer additional security or flexibility, but require more work. Mappings should be generated dynamically and that means that code has to be written that defines objects that may be accessed by each user.\n Use reference maps instead of direct object references. Update all the code that references objects to use the reference maps."
    ],
    "strong": [
      "Identify objects that are being referenced.",
      "Define object reference maps.",
      "Use reference maps instead of direct object references."
    ]
  },
  "links": [],
  "html": "<h2>Applies To</h2><ul><li> C++</li>\n</ul><h2>What to Do</h2><p>Use reference maps to access objects. Assign user-specific or session-specific identifiers to objects when exposing their names to the user, rather than exposing the operating system assigned names of these objects.\n</p><h2>Why</h2><p>Use reference maps to prevent path manipulation vulnerabilities. If the application uses its own identifiers for objects when exposing them to the user, instead of filesystem paths, an attacker will not be able to manipulate the paths of the objects. While path manipulation refers almost exclusively to filesystem objects, the same technique of using aliases rather than operating system assigned names also works for other types of system resources, such as sockets.\n</p><h2>How</h2><p>To use reference maps to access objects:\n</p><ol>\n<li> <strong>Identify objects that are being referenced.</strong> Find all code that exposes the operating system names of objects handled by the application, especially files. Make a spreadsheet to track this code.</li>\n<li> <strong>Define object reference maps.</strong> Object reference maps are arrays or hashes of objects that are being referenced. The application exposes the index of the array or the key of the hash that matches the required resource, rather than exposing the object itself. This approach ensures that only objects in the array may be accessed. For this approach to work, reference maps should only include objects for which access is authorized. It is possible to use per-user or per-session object mappings. Per-user mappings define objects that may be accessed by each user. Per-session mappings define objects that may be accessed by each user for the current session. Per-session references may offer additional security or flexibility, but require more work. Mappings should be generated dynamically and that means that code has to be written that defines objects that may be accessed by each user.</li>\n<li> <strong>Use reference maps instead of direct object references.</strong> Update all the code that references objects to use the reference maps.</li>\n</ol>"
}