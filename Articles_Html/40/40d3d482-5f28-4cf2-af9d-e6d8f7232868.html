<h1>Applies To</h1>
  <ul>
    <li>ASP.NET 4.0</li>
  </ul>
  <h1>What to Check For</h1>
  <p>Verify that authentication events are logged.</p>
  <h1>Why</h1>
  <p>Logging authentication events helps detect suspicious behavior, such as an attacker trying to guess passwords.</p>
  <h1>How To Check</h1>
  <p>Perform the following actions to verify that authentication events are logged:</p>
  <ol>
    <li>
      <p>
        <strong>Identify authentication events. </strong>Make a list of authentication events that may occur when using your application. Typical authentication events include: </p>
      <ul>
        <li>Successful or failed authentication </li>
        <li>Password changes </li>
        <li>Account lockouts </li>
        <li>User creation or removal </li>
        <li>Changes in user privilege level, such as assigning a user to the Administrators group</li>
      </ul>
    </li>
    <li>
      <p>
        <strong>Identify code that is used for authentication.</strong> Use the list of authentication events to find functions that are responsible for those events. Make a list of these functions.</p>
    </li>
    <li>
      <p>
        <strong>Verify that authentication events are logged.</strong> Use the list of functions that implement authentication to review each one. Make sure that each authentication function generates log entries for both successful and failed events.</p>
    </li>
  </ol>
  <h1>How To Fix</h1>
  <p>Perform the following actions to assure that your application logs authentication events:</p>
  <ol>
    <li>
      <p>
        <strong>Identify authentication events.</strong> Make a list of authentication events that may occur when using your application. Typical authentication events include: </p>
      <ul>
        <li>Successful or failed authentication </li>
        <li>Password changes </li>
        <li>Account lockouts </li>
        <li>User creation or removal </li>
        <li>Changes in user privilege level, such as assigning a user to the Administrators group</li>
      </ul>
    </li>
    <li>
      <p>
        <strong>Identify code that is used for authentication.</strong> Use the list of authentication events to find functions that are responsible for those events.</p>
    </li>
    <li>
      <p>
        <strong>Identify the logging subsystem.</strong> The logging subsystem should provide an API that allows generating log entries from application code. If this API or the logging subsystems do not exist, write them. Make a list of functions that may be used to generate log entries and collect documentation about how to use them.</p>
    </li>
    <li>
      <p>
        <strong>Add code that generates log entries.</strong> Use the list of functions that perform authentication and add code to each one to generate log entries. Generate log entries for both successful and failed events. Use the list of functions in the logging subsystem when adding code that generates log entries.</p>
    </li>
  </ol>
  <h1>Related Items</h1>
  <ul>
    <li>
      <a href="/article/24c6bb1f-4df4-4367-829a-34c9aa839d3b">Log Authentication Events</a>
    </li>
  </ul>