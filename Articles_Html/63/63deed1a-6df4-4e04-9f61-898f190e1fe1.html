<h2>Applies To</h2>
<ul>
<li>JAVA</li>
<li>Struts 1</li>
</ul>
<h2>Summary</h2>
<p>Perform CSRF prevention using Struts 1 within an application. CSRF prevention is a key security control for an application that protects the application and its users from CSRF attacks.</p>
<h2>Solution Example</h2>
<p>There is a standard model for CSRF prevention using Struts 1 that involves 3 basic steps</p>
<ol>
<li>
<p><strong>Call saveToken().</strong> In the action class/method that handles the setup for your form display (ex. EditBookAction), you need to call saveToken().</p>
<pre><code>public ActionForward execute(ActionMapping mapping,
ActionForm form, HttpServletRequest request, HttpServletResponse response)
throws Exception {
	saveToken(request);
	....
}
</code></pre>
</li>
<li>
<p><strong>Use html:form to create your form on your JSP (ex. editBook.jsp).</strong></p>
<pre><code>&lt;html:form action=&quot;...&quot;&gt;
...
&lt;/html:form&gt;
</code></pre>
</li>
<li>
<p><strong>Check isTokenValid() and call resetToken().</strong> In the action class/method that handles the saving of your form (ex. SaveBookAction), you need to call isTokenValid(). If the token is valid, then you need to call resetToken().</p>
<pre><code>public ActionForward execute(ActionMapping mapping,
ActionForm form, HttpServletRequest request, HttpServletResponse response)
throws Exception {
...
	if ( !isTokenValid(request) ) {
		return mapping.findForward(Constants.INVALID_TOKEN);
	} else {
		...
  //normal business logic
 ...
 resetToken(request);
	}
...
</code></pre>
</li>
</ol>
