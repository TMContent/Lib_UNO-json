<h1>Applies To</h1>
  <ul>
    <li>ASP.NET 4.0</li>
  </ul>
  <h1>What to Check For</h1>
  <p>Ensure your application monitors the use of privileged accounts and logs all activities performed under their credentials.</p>
  <h1>Why</h1>
  <p>Privileged accounts by their nature are allowed to do damaging activities. If compromised, they can cause the most damage. Close monitoring can catch unauthorized and/or malicious activities and help minimize&nbsp;any damage done.</p>
  <h1>How To Check</h1>
  <p>To check if your application monitors privileged accounts activities, follow these steps:</p>
  <ol>
    <li>
      <p>
        <strong>Identify the privileged users and roles. </strong>For the purposes of security monitoring, privileged accounts are those that can cause more damage than other users. Check for both privileged users and roles (Administrator or the Administrator's group, among others, or root and wheel on a Unix environment). This will vary by application and roles defined, however, some examples are:</p>
      <ul>
        <li>Administrators </li>
        <li>Power users </li>
        <li>Team leaders</li>
      </ul>
    </li>
    <li>
      <p>
        <strong>Identify potentially dangerous activities. </strong>Enumerate all activities enabled by the privileged accounts identified above. Some of the common activities include, but are not limited to:</p>
      <ul>
        <li>Add, delete, and modify user accounts </li>
        <li>Add, delete, and modify database tables </li>
        <li>Install or remove applications </li>
        <li>View or modify application configuration settings </li>
        <li>View log files </li>
        <li>View or modify source code</li>
      </ul>
    </li>
    <li>
      <p>
        <strong>Ensure all activities are logged. </strong>Identify areas of code that perform privileged activates as identified from step 2 above. Verify that all activities, including successful and failed operations, are logged.&nbsp;Ensure that privileged events are logged separately in files that are not accessible to lower privileged users.</p>
    </li>
    <li>
      <p>
        <strong>Audit the logs. </strong>Audit your application's logs regularly. Logs are the first and sometimes only place that security problems can be discovered. Use your logs to detect problems early and prevent them instead of for forensics. Verify that:</p>
      <ul>
        <li>The application's security policy includes scheduled log audits </li>
        <li>Logs are being audited regularly </li>
        <li>Information in log files is marked and categorized during audits </li>
        <li>Suspicious activity is investigated</li>
      </ul>
      <p>If there are no available logs to audit, use your application to generate enough logged sample data from the application's components that require privileged accounts. Then perform an audit to verify that the logging mechanisms have been set up correctly.</p>
    </li>
  </ol>
  <h1>How To Fix</h1>
  <p>Perform the following actions to implement monitoring the use of privileged user accounts:</p>
  <ol>
    <li>
      <p>
        <strong>Identify privileged user roles.</strong> Identify the types of privileged user accounts available in your application. Some example are: administrator, root, power user, manager, etc. Make a list of privileged user roles.</p>
    </li>
    <li>
      <p>
        <strong>Identify functionality unique to privileged users. </strong>For each type of privileged user account, make a list of functionality that this type of account can use that&nbsp; a regular user cannot. Some examples are: adding or removing user accounts, changing passwords for other users, changing application settings, shutting down the application, etc. Make a list of functionality that is unique to privileged users.</p>
    </li>
    <li>
      <p>
        <strong>Identify code that implements functions unique to privileged users.</strong> Use the list of actions available exclusively to privileged users to identify the functions that implement these actions. Make a list of these functions.</p>
    </li>
    <li>
      <p>
        <strong>Identify the logging subsystem.</strong> The logging subsystem should provide an API that allows generating log entries from application code. If this API or the logging subsystem don't exist, write them. Make a list of functions that may be used to generate log entries and collect documentation about how to use them.</p>
    </li>
    <li>
      <p>
        <strong>Implement monitoring of privileged accounts.</strong> Use the list of functions that perform actions unique to privileged accounts to add code that generates log entries to each of those functions. Use the list of functions in the logging subsystem when writing code that generates log entries.</p>
    </li>
  </ol>
  <h1>Related Items</h1>
  <em>You may find these additional articles useful</em>
  <ul>
    <li>
      <a href="/article/91b9955c-90c2-47f3-a910-1c314fc865e6">Monitor the Use of Privileged Accounts</a>
    </li>
  </ul>
  <hr />
  <p>Adapted from Microsoft patterns & practices guidance. </p>