<h2>Applies To</h2><ul><li> Java</li>
</ul><h2>What to Check For</h2><p>Make sure that user identity is verified before resetting a forgotten password.
</p><h2>Why</h2><p>The user's identity should be verified before resetting a forgotten password to ensure that an attacker is not pretending to be the user to gain access.
</p><h2>How to Check</h2><p>To make sure that user identity is verified before resetting a forgotten password:
</p><ol>
<li> <strong>Trigger password reset functionality.</strong> Usually there is a link to the password reset function on the authentication page, called something like "Did you forget your password?".</li>
<li> <strong>Make sure that user identity is verified before the password reset token is sent over a side-channel.</strong> Go through the password reset process. Pay attention to the manner in which user identity is verified before the password reset token is sent. Make sure the information, token, and side channel that are used to verify user identity are not easily available to attackers. For example, it is not acceptable to ask people to verify their identities using information that can be looked up on social networks.</li>
</ol><h2>How to Fix</h2><p>To verify the user's identity before sending a password reset token over a side-channel:
</p><ol>
<li> <strong>Choose one or more mechanisms to verify user identity.</strong> Some common methods include asking user-chosen questions that have user-provided answers, and sending a code via e-mail or SMS.</li>
<li> <strong>Associate identity verification information with user accounts.</strong> When creating a user account, collect the information necessary to verify user identity and store it together with the rest of the account information. Provide a mechanism for the user to update this information as necessary.</li>
<li> <strong>Identify code that resets a forgotten password.</strong> Find the code in the application that is responsible for changing user passwords when users forget them.</li>
<li> <strong>Add user identity verification to the password reset code.</strong> In the code that resets forgotten passwords, add code that implements the identity verification mechanism. Make sure that the code verifies user identity before it sends the password reset token. The password reset token should be sent over a side channel.</li>
</ol><h2>Additional Resources</h2><ul><li> For more information about password reset security, see <a href="https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet">https://www.owasp.org/index.php/Forgot_Password_Cheat_Sheet</a></li>
</ul>