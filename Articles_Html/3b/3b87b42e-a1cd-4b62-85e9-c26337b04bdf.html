<h2>Applies To</h2>
<ul>
<li>Scala with Play Framework 2.1.0+</li>
</ul>
<h2>What to Check For</h2>
<p>Ensure that sensitive data is not placed in unprotected parameters.</p>
<h2>Why</h2>
<p>Sensitive data stored in unprotected parameters is sent on the network in plaintext and can be easily read by an attacker who steals it using a network sniffer.</p>
<h2>How to Check</h2>
<p>Sensitive data may be transmitted between a user's browser and your application for the following purposes:</p>
<ul>
<li>
<p>Submitting input to your application: A user can provide input to your application via URL and form-based parameters.</p>
</li>
<li>
<p>Tracking user activity: Your application may use cookies or hidden fields to track user activity.</p>
</li>
</ul>
<p>Since HTTP-based parameters are handled in plaintext form, use the following steps to ensure your application's proper use of HTTP-based parameters when handling sensitive data:</p>
<ol>
<li>
<p><strong>Identify sensitive data.</strong> Sensitive data is any information that is kept secret and should be disclosed only to authorized parties. Common examples of sensitive data include, but are not limited to, customer names, government issued ID numbers, credit card and other financial information, passwords, and private keys. Some industries, such as health care and banking, have regulatory standards that define sensitive information. Use regulatory requirements as they apply to your application to identify sensitive data. Sensitive data can be defined as follows:</p>
<ul>
<li>Information that either contains personally identifiable information or can be used to derive personally identifiable information that should not be shared with others.</li>
<li>Information that a user provides that they would not want shared with other users of the application.</li>
<li>Information that comes from an external trusted source that is not designed to be shared with users.</li>
</ul>
</li>
<li>
<p><strong>Verify that your application uses HTTPS for all sensitive pages.</strong> Identify all sensitive pages and use a web browser to navigate through them. Use the facilities built-into the web browser to make sure that all sensitive pages are protected with TLS.</p>
</li>
<li>
<p><strong>Verify that your application uses POST requests.</strong> Ensure that your application accepts sensitive data only via HTTP POST requests. Verify that the following items are in place:</p>
<ul>
<li>HTML Forms: Verify that all templates(forms) that submit sensitive data explicitly specify that the user's browser should use POST requests.</li>
<li>Server-Side Code: Verify that your application controller accepts sensitive data only over a POST method.</li>
</ul>
</li>
<li>
<p><strong>Verify that no sensitive data is stored in HTTP parameters or cookies.</strong> Ensure that your application does not store sensitive data in HTTP parameters or cookies. Verify that all sensitive data is stored into sessions.</p>
</li>
</ol>
<h2>How to Fix</h2>
<p>Follow these steps when handling sensitive data via parameters:</p>
<ol>
<li>
<p><strong>Identify the parameters.</strong> Parameters can be used both as entry points and storage places. Locating your application's parameters helps identify potential sources of input. Because parameters are easily accessible by the client, they should be considered untrusted. Different types of parameters include:</p>
<ul>
<li>URL-based parameters</li>
<li>Form-based parameters</li>
<li>Hidden fields</li>
<li>Cookies</li>
</ul>
</li>
<li>
<p><strong>Identify the use.</strong> Parameters can be used for several purposes. If you are using parameters to send sensitive data, use the steps below to find a work-around:</p>
<ul>
<li>Submitting input: Submitting sensitive data using parameters should always be done through an encrypted channel and always using a POST request. Use SSL to ensure encryption. Avoid using hidden fields when gathering information from the user. Allowing the user to enter all information about their account ensures that they are aware of all data that is being sent. Any information regarding the user's client environment can be gathered via the HTTP headers.</li>
<li>User tracking: User tracking should always be done server-side using sessions. Avoid storing sensitive information in hidden fields and cookies. If it is necessary to store sensitive data using parameters, encrypt the data using a key that is known only by your application. If encrypted sensitive data is stored inside a cookie, avoid setting the cookie as persistent.</li>
</ul>
</li>
</ol>
