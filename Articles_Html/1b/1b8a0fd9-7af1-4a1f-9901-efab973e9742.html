<h2>Applies To</h2><ul><li> C++</li>
</ul><h2>What to Check For</h2><p>Verify that authentication credentials are sent over encrypted tunnels.
</p><h2>Why</h2><p>Using encrypted communication tunnels prevents the credentials from being sniffed or tampered with as they are transmitted over the network. TLS libraries are available for most mature development platforms and are ideal for protecting the authentication credentials in transit.
</p><h2>When</h2><p>Use this checklist item when your application sends authentication credentials over the network.
</p><h2>How to Check</h2><p>To verify that authentication credentials are sent over encrypted tunnels:
</p><ol>
<li> <strong>Identify authentication security requirements.</strong> Make sure that your application actually does send authentication credentials over the network. For example, if the application authenticates against a local credential store, then there is no need for network tunnels. If credentials are sent over the network, then they need to be protected in transit and, for most scenarios, TLS will be suitable. When using TLS, some thought will have to be given to what certificates to use. It is highly recommended to use valid certificates, however it is possible to encrypt network traffic with self-signed certificates. </li>
<li> <strong>Identify the network authentication mechanism.</strong> Find the code that sends authentication credentials over the network.</li>
<li> <strong>Verify that authentication credentials are encrypted in transit.</strong> Examine the code that sends authentication credentials over the network to make sure that TLS sockets are used instead of regular sockets for connections that are used to transmit credentials.</li>
</ol>
<h2>How to Fix</h2><p>To protect authentication credentials in transit:
</p><ol>
<li> <strong>Identify authentication security requirements.</strong> Make sure that your application actually does send authentication credentials over the network. For example, if the application authenticates against a local credential store, then there is no need for network tunnels. If credentials are sent over the network, then they need to be protected in transit and for most scenarios TLS will be suitable. When using TLS, some thought will have to be given to what certificates to use. It is highly recommended to use valid certificates, however it is possible to encrypt network traffic with self-signed certificates. </li>
<li> <strong>Identify available communication security APIs.</strong> Determine what libraries and APIs that implement TLS are available for your development platform. Because there are many different platforms and development environments that use C++, there are a lot of options. The platform-provided APIs should be the first choice but if these are not available, OpenSSL is a good alternative. </li>
<li> <strong>Identify the network authentication mechanism.</strong> Find the code that sends authentication credentials (usually hashes or keys) over the network.</li>
<li> <strong>Encrypt authentication credentials in transit.</strong> Use the chosen TLS APIs to encrypt the hashes or keys as they are transmitted over the network. Modify all the code that sends the credentials over the network to always use TLS for the task. When doing so, it is recommended to use valid certificates and check them with a certificate authority to help prevent man-in-the-middle attacks.</li>
</ol>