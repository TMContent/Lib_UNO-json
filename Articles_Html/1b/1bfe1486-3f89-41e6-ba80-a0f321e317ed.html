<h2>Applies To</h2>
<ul>
<li>Ruby</li>
</ul>
<h2>What to Do</h2>
<p>Set the <em>Secure</em> and <em>HttpOnly</em> flags on session cookies.</p>
<h2>Why</h2>
<p>Set the <em>Secure</em> flag on all sensitive cookies to protect the contents of the sensitive cookies from eavesdropping attacks. When the <em>Secure</em> flag on sensitive cookies is enabled, they are only transferred over connections that are secured by TLS. The <em>HttpOnly</em> flag prevents the contents of the marked cookie from being accessed by a client-side script. When the <em>HttpOnly</em> flag is set, this helps reduce the potential damage of Cross-Site Scripting attacks.</p>
<h2>When</h2>
<p>If your application uses cookies with sensitive information, then use this guideline to protect the session cookie.</p>
<p>##How##</p>
<p>To set the <em>Secure</em> and <em>HttpOnly</em> flags on all sensitive cookies:</p>
<ol>
<li>
<p><strong>Verify that TLS is available.</strong> The <em>Secure</em> flag forces cookies to be sent over TLS. TLS must be available for this to work. Please refer to the documentation for your web platform for information about enabling and configuring TLS on the web server.</p>
</li>
<li>
<p><strong>Identify sensitive cookies.</strong> Session cookies should always be considered sensitive. Enumerate all cookies used by the application. Make a list of cookies that may contain sensitive information.</p>
</li>
<li>
<p><strong>Identify code that creates sensitive cookies.</strong> For each sensitive cookie in the list, find the application code that creates the cookie.</p>
</li>
<li>
<p><strong>Set the <em>Secure</em> and <em>HttpOnly</em> flags for each sensitive cookie.</strong> For each piece of code that creates a sensitive cookie, add code that sets
the <em>Secure</em> and <em>HttpOnly</em> flags for the cookie. For example:</p>
<pre><code> cookies[:key] = {
   :value =&gt; 'some_value',
   :httponly =&gt; true,
   :secure =&gt; true
 }
</code></pre>
</li>
</ol>
