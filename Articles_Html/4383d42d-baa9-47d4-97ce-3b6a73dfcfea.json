{
  "id": "4383d42d-baa9-47d4-97ce-3b6a73dfcfea",
  "checksum": "06828263a00294c9d24fce628201905ca78f9008",
  "words": {
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "h1",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "c++windows": [
      "ul"
    ],
    "c++": [
      "li",
      "p"
    ],
    "windows": [
      "li",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "title"
    ],
    "what": [
      "h1"
    ],
    "do": [
      "h1",
      "p",
      "title"
    ],
    "not": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "title"
    ],
    "make": [
      "p"
    ],
    "decisions": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "strong"
    ],
    "based": [
      "p",
      "ol",
      "li",
      "p",
      "strong"
    ],
    "on": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "li",
      "p",
      "strong",
      "title"
    ],
    "file": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "title"
    ],
    "path": [
      "p",
      "p",
      "p",
      "title"
    ],
    "or": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p"
    ],
    "folder": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "title"
    ],
    "names": [
      "p",
      "p",
      "title"
    ],
    "why": [
      "h1"
    ],
    "it": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "is": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "p",
      "li",
      "p"
    ],
    "so": [
      "p"
    ],
    "difficult": [
      "p"
    ],
    "implement": [
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "canonicalization": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "title"
    ],
    "correctly": [
      "p"
    ],
    "with": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "that": [
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "impractical": [
      "p"
    ],
    "therefore": [
      "p"
    ],
    "all": [
      "p",
      "ul",
      "li",
      "a"
    ],
    "and": [
      "p",
      "p",
      "ol",
      "li",
      "p",
      "title"
    ],
    "name": [
      "p"
    ],
    "input": [
      "p",
      "ul",
      "li",
      "a"
    ],
    "should": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "be": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "considered": [
      "p"
    ],
    "untrusted": [
      "p"
    ],
    "used": [
      "p",
      "ol",
      "li",
      "p",
      "ul",
      "li",
      "a"
    ],
    "for": [
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "ul",
      "li",
      "li"
    ],
    "any": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "how": [
      "h1"
    ],
    "perform": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "the": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p"
    ],
    "following": [
      "p"
    ],
    "actions": [
      "p"
    ],
    "filesystem": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "security": [
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "policies": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "without": [
      "p"
    ],
    "relying": [
      "p"
    ],
    "don't": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "rely": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "title"
    ],
    "win32": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "api": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "filename/path": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "p"
    ],
    "in": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "title"
    ],
    "represented": [
      "ol",
      "li",
      "p"
    ],
    "by": [
      "ol",
      "li",
      "p"
    ],
    "getfullpathname": [
      "ol",
      "li",
      "p"
    ],
    "function": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "because": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "this": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "does": [
      "ol",
      "li",
      "p"
    ],
    "validation": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "its": [
      "ol",
      "li",
      "p"
    ],
    "output": [
      "ol",
      "li",
      "p"
    ],
    "relied": [
      "ol",
      "li",
      "p"
    ],
    "there": [
      "ol",
      "li",
      "p"
    ],
    "no": [
      "ol",
      "li",
      "p"
    ],
    "guarantee": [
      "ol",
      "li",
      "p"
    ],
    "produces": [
      "ol",
      "li",
      "p"
    ],
    "a": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p"
    ],
    "valid": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "canonical": [
      "ol",
      "li",
      "p"
    ],
    "even": [
      "ol",
      "li",
      "p"
    ],
    "if": [
      "ol",
      "li",
      "p"
    ],
    "you": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "use": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "additional": [
      "ol",
      "li",
      "p",
      "h1"
    ],
    "measures": [
      "ol",
      "li",
      "p"
    ],
    "filenames/paths": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "making": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "strong"
    ],
    "acls": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "when": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p"
    ],
    "have": [
      "ol",
      "li",
      "p"
    ],
    "enforce": [
      "ol",
      "li",
      "p"
    ],
    "built-in": [
      "ol",
      "li",
      "p"
    ],
    "acl": [
      "ol",
      "li",
      "p"
    ],
    "functionality": [
      "ol",
      "li",
      "p"
    ],
    "accesscheck": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "validate": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "access": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "permissions": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "your": [
      "ol",
      "li",
      "p"
    ],
    "application": [
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "has": [
      "ol",
      "li",
      "p"
    ],
    "work": [
      "ol",
      "li",
      "p"
    ],
    "verify": [
      "ol",
      "li",
      "p"
    ],
    "request": [
      "ol",
      "li",
      "p"
    ],
    "avoid": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "condition": [
      "ol",
      "li",
      "p"
    ],
    "an": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p"
    ],
    "attacker": [
      "ol",
      "li",
      "p"
    ],
    "may": [
      "ol",
      "li",
      "p"
    ],
    "able": [
      "ol",
      "li",
      "p"
    ],
    "trick": [
      "ol",
      "li",
      "p"
    ],
    "execute": [
      "ol",
      "li",
      "p"
    ],
    "unintended": [
      "ol",
      "li",
      "p"
    ],
    "code": [
      "ol",
      "li",
      "p"
    ],
    "branch": [
      "ol",
      "li",
      "p"
    ],
    "prevent": [
      "ol",
      "li",
      "p"
    ],
    "using": [
      "ol",
      "li",
      "p"
    ],
    "conditional": [
      "ol",
      "li",
      "p"
    ],
    "statements": [
      "ol",
      "li",
      "p"
    ],
    "except": [
      "ol",
      "li",
      "p"
    ],
    "error": [
      "ol",
      "li",
      "p"
    ],
    "handling": [
      "ol",
      "li",
      "p"
    ],
    "resources": [
      "h1",
      "ul",
      "li",
      "a"
    ],
    "information": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "about": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "getfullpathname),": [
      "ul",
      "li"
    ],
    "please": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "see": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "http//msdn.microsoft.com/en-us/library/aa364963(v=vs.85).aspxfor": [
      "ul"
    ],
    "accesscheck),": [
      "ul",
      "li"
    ],
    "http//msdn.microsoft.com/en-us/library/aa374815(vs.85).aspx": [
      "ul",
      "li",
      "a"
    ],
    "http//msdn.microsoft.com/en-us/library/aa364963(v=vs.85).aspx": [
      "li",
      "a"
    ],
    "related": [
      "h1"
    ],
    "items": [
      "h1"
    ],
    "canonicalize": [
      "ul",
      "li",
      "a"
    ],
    "identify": [
      "ul",
      "li",
      "a"
    ],
    "of": [
      "title"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "What to Do",
      "Why",
      "How",
      "Additional Resources",
      "Related Items"
    ],
    "ul": [
      "C++Windows",
      "For information about GetFullPathName(), please see http://msdn.microsoft.com/en-us/library/aa364963(v=VS.85).aspxFor information about AccessCheck(), please see http://msdn.microsoft.com/en-us/library/aa374815(VS.85).aspx",
      "Canonicalize All Input Used to Identify Resources"
    ],
    "li": [
      "C++",
      "Windows",
      "Don't rely on Win32 API canonicalization. Filename/path canonicalization in Win32 is represented by the GetFullPathName function. Because this function does not perform any validation on its output, it should not be relied on, because there is no guarantee that it produces a valid or a canonical filename/path. Even if you implement canonicalization, use additional security measures and don't rely on filenames/paths for making decisions.",
      "Use Windows ACLs. When you have to enforce filesystem security policies on Windows, use the built-in ACL functionality.",
      "Use AccessCheck to validate access permissions. When your application has to work with a file or folder, use AccessCheck to verify that the access request is valid.",
      "Avoid making decisions based on filenames/paths. When a filename/path is used in a condition, an attacker may be able to trick the application to execute an unintended code branch. To prevent this, avoid using filenames/paths in conditional statements, except for validation or error handling.",
      "For information about GetFullPathName(), please see http://msdn.microsoft.com/en-us/library/aa364963(v=VS.85).aspx",
      "For information about AccessCheck(), please see http://msdn.microsoft.com/en-us/library/aa374815(VS.85).aspx",
      "Canonicalize All Input Used to Identify Resources"
    ],
    "p": [
      "Do not make decisions based on file, path, or folder names.",
      "It is so difficult to implement canonicalization correctly on Windows with C++, that it is impractical. Therefore, all file, path, and folder name input should be considered untrusted and not be used for any decisions.",
      "Perform the following actions to implement filesystem security policies without relying on file, path, or folder names:",
      "Don't rely on Win32 API canonicalization. Filename/path canonicalization in Win32 is represented by the GetFullPathName function. Because this function does not perform any validation on its output, it should not be relied on, because there is no guarantee that it produces a valid or a canonical filename/path. Even if you implement canonicalization, use additional security measures and don't rely on filenames/paths for making decisions.",
      "Use Windows ACLs. When you have to enforce filesystem security policies on Windows, use the built-in ACL functionality.",
      "Use AccessCheck to validate access permissions. When your application has to work with a file or folder, use AccessCheck to verify that the access request is valid.",
      "Avoid making decisions based on filenames/paths. When a filename/path is used in a condition, an attacker may be able to trick the application to execute an unintended code branch. To prevent this, avoid using filenames/paths in conditional statements, except for validation or error handling."
    ],
    "ol": [
      "Don't rely on Win32 API canonicalization. Filename/path canonicalization in Win32 is represented by the GetFullPathName function. Because this function does not perform any validation on its output, it should not be relied on, because there is no guarantee that it produces a valid or a canonical filename/path. Even if you implement canonicalization, use additional security measures and don't rely on filenames/paths for making decisions.\r\n      \r\n        \r\n          Use Windows ACLs. When you have to enforce filesystem security policies on Windows, use the built-in ACL functionality.\r\n        \r\n          \r\n            Use AccessCheck to validate access permissions. When your application has to work with a file or folder, use AccessCheck to verify that the access request is valid.\r\n          \r\n            \r\n              Avoid making decisions based on filenames/paths. When a filename/path is used in a condition, an attacker may be able to trick the application to execute an unintended code branch. To prevent this, avoid using filenames/paths in conditional statements, except for validation or error handling."
    ],
    "strong": [
      "Don't rely on Win32 API canonicalization.",
      "Use Windows ACLs.",
      "Use AccessCheck to validate access permissions.",
      "Avoid making decisions based on filenames/paths."
    ],
    "a": [
      "http://msdn.microsoft.com/en-us/library/aa364963(v=VS.85).aspx",
      "http://msdn.microsoft.com/en-us/library/aa374815(VS.85).aspx",
      "Canonicalize All Input Used to Identify Resources"
    ]
  },
  "links": [
    {
      "href": "http://msdn.microsoft.com/en-us/library/aa364963(v=VS.85).aspx",
      "text": "http://msdn.microsoft.com/en-us/library/aa364963(v=VS.85).aspx"
    },
    {
      "href": "http://msdn.microsoft.com/en-us/library/aa374815(VS.85).aspx",
      "text": "http://msdn.microsoft.com/en-us/library/aa374815(VS.85).aspx"
    },
    {
      "href": "/article/004526a6-5b2f-4094-94fa-a80d818c0a41",
      "text": "Canonicalize All Input Used to Identify Resources"
    }
  ],
  "html": "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>C&#43;&#43;<li>Windows</li></li>\r\n  </ul>\r\n  <h1>What to Do</h1>\r\n  <p>Do not make decisions based on file, path, or folder names.</p>\r\n  <h1>Why</h1>\r\n  <p>It is so difficult to implement canonicalization correctly on Windows with C&#43;&#43;, that it is impractical. Therefore, all file, path, and folder name input should be considered untrusted and not be used for any decisions.</p>\r\n  <h1>How</h1>\r\n  <p>Perform the following actions to implement filesystem security policies without relying on file, path, or folder names:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Don't rely on Win32 API canonicalization.</strong> Filename/path canonicalization in Win32 is represented by the GetFullPathName function. Because this function does not perform any validation on its output, it should not be relied on, because there is no guarantee that it produces a valid or a canonical filename/path. Even if you implement canonicalization, use additional security measures and don't rely on filenames/paths for making decisions.</p>\r\n      <li>\r\n        <p>\r\n          <strong>Use Windows ACLs. </strong>When you have to enforce filesystem security policies on Windows, use the built-in ACL functionality.</p>\r\n        <li>\r\n          <p>\r\n            <strong>Use AccessCheck to validate access permissions.</strong> When your application has to work with a file or folder, use AccessCheck to verify that the access request is valid.</p>\r\n          <li>\r\n            <p>\r\n              <strong>Avoid making decisions based on filenames/paths.</strong> When a filename/path is used in a condition, an attacker may be able to trick the application to execute an unintended code branch. To prevent this, avoid using filenames/paths in conditional statements, except for validation or error handling.</p>\r\n          </li>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ol>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>For information about GetFullPathName(), please see <a href=\"http://msdn.microsoft.com/en-us/library/aa364963(v=VS.85).aspx\">http://msdn.microsoft.com/en-us/library/aa364963(v=VS.85).aspx</a><li>For information about AccessCheck(), please see <a href=\"http://msdn.microsoft.com/en-us/library/aa374815(VS.85).aspx\">http://msdn.microsoft.com/en-us/library/aa374815(VS.85).aspx</a></li></li>\r\n  </ul>\r\n  <h1>Related Items</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/004526a6-5b2f-4094-94fa-a80d818c0a41\">Canonicalize All Input Used to Identify Resources</a>\r\n    </li>\r\n  </ul>"
}