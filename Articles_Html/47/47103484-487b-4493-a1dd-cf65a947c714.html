<h1>Applies To</h1><p>All applications which provide authentication.
</p><h1>Description</h1><p>Attackers can reverse weak passwords by generating large tables of hashed values. The tables, called "rainbow tables," map the plaintext value to a hashed value so that, when the hacker discovers a table of usernames and hashed passwords, a simple lookup is all that is necessary to discover the plaintext password. Rainbow tables are very expensive to create, often taking weeks or months to generate and consuming very large amounts of hard drive space. For this reason rainbow tables are usually not generated for each attack, but generated once and reused multiple times.
</p><h1>Impact</h1><ul><li>Credential compromise.</li>
<li>Information disclosure.</li>
</ul><h1>Vulnerabilities</h1><ul><li>Weak hashing algorithm: Many hashing algorithms have been cracked, allowing for passwords to be recovered easily. Hashing algorithms that are not proven secure can be easily reversed, even if the attacker does not have the original source. Therefore one should never attempt to write one's own hashing algorithm.</li>
<li>Lack of salt: A random value can be added to the plaintext of the passwords to ensure that previously calculated rainbow tables cannot be used.</li>
</ul><h1>Countermeasures</h1><ul><li>Use strong hashing algorithms: Research the current best practice for hashing algorithms, currently SHA256 is best practice.</li>
<li>Encrypt the plaintext passwords with salt: Salt adds a random value to the password so previously calculated rainbow tables cannot be used. The salt must be stored to verify the challenge password.</li>
<li>Use only one-way hashing algorithms: Using one way hashing algorithms will ensure proper use of the hash. Hash the challenge password and compare the calculated hash with the stored hash. This will minimize the amount of time the plaintext password is stored in memory.</li>
<li>Create a password policy: Determine the level of password or passphrase strength required by your application and state it in policy. Ensure that the system enforces the policy automatically, to prevent users from accidentally or intentionally choosing weak passwords.</li>
<li>Require regular password changes: Regular password changes will reduce the amount of time that an account with a potentially weak password is exposed, and will give an attacker less time to attempt to crack the password.</li>
</ul><h1>Example</h1><p>A rainbow table could contain all the popular passwords from a dictionary, all the possible passwords from a subset of characters or all hashes for a certain password length. The rainbow table also has to be generated for each hashing algorithm (SHA, MD5, MD4, etc.) A sample of a rainbow table may look something like the following:
</p><table><tr><td><tt>Plaintext</tt> </td><td><tt>SHA1 Hash</tt>                          </td></tr><tr><td><tt>Test</tt> </td><td><tt>640AB2BAE07BEDC4C163F679A746F7AB7FB5D1FA</tt></td></tr><tr><td><tt>Demo</tt> </td><td><tt>E52C854D5631EEC7468BA4727B4C77EB745F2965</tt></td></tr><tr><td><tt>Password</tt> </td><td><tt>8BE3C943B1609FFFBFC51AAD666D0A04ADF83C9D</tt></td></tr><tr><td><tt>password</tt> </td><td><tt>5BAA61E4C9B93F3F0682250B6CF8331B7EE68FD8</tt></td></tr><tr><td><tt>Admin</tt> </td><td><tt>4E7AFEBCFBAE000B22C7C85E5560F89A2A0280B4</tt></td></tr></table><h1>Additional Resources</h1><ul><li>For more information on Hash Function, see: <a href="http://en.wikipedia.org/wiki/Hash_function">http://en.wikipedia.org/wiki/Hash_function</a></li>
<li>For more information on Cryptographic Salt, see: <a href="http://en.wikipedia.org/wiki/Salt_%28cryptography%29">http://en.wikipedia.org/wiki/Salt_%28cryptography%29</a></li>
</ul><h1>Related Items</h1><ul><li><a href="e3ffdced-ef7e-45c7-bbbb-a7e71052053c">Attack: Credentials Brute Force Attack</a></li>
<li><a href="d00e43b2-f820-4668-8174-07045c4874be">Attack: Credentials Dictionary Attack</a></li>
<li><a href="331bfa1d-94c7-485b-8d8f-b8bab3e679e4">Attack: Statistical Analysis Attack</a></li>
</ul>