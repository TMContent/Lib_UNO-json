{
  "id": "8a8fe651-2168-4c88-b89a-0b6b442da2f8",
  "checksum": "8200af2e6ec3ce677b005460c882a9ff51e7063b",
  "words": {
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "h1",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "java": [
      "ul",
      "li"
    ],
    "what": [
      "h1"
    ],
    "do": [
      "h1"
    ],
    "use": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "mapping": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "values": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "perform": [
      "p",
      "p"
    ],
    "redirects": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "ul",
      "li",
      "h1",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "h1",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "h1"
    ],
    "or": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "ul",
      "li",
      "a"
    ],
    "forwards": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "strong",
      "ul",
      "li",
      "h1",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "h1",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "h1"
    ],
    "based": [
      "p",
      "p"
    ],
    "on": [
      "p",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "user": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "input": [
      "p",
      "ol",
      "li",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "title"
    ],
    "why": [
      "h1"
    ],
    "using": [
      "p",
      "p"
    ],
    "when": [
      "p",
      "h1",
      "p",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "performing": [
      "p"
    ],
    "prevents": [
      "p"
    ],
    "malicious": [
      "p",
      "p"
    ],
    "users": [
      "p"
    ],
    "from": [
      "p"
    ],
    "creating": [
      "p"
    ],
    "hyperlinks": [
      "p",
      "p"
    ],
    "that": [
      "p",
      "p",
      "ol",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "the": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "point": [
      "p",
      "p",
      "p"
    ],
    "pages": [
      "p"
    ],
    "other": [
      "p"
    ],
    "than": [
      "p"
    ],
    "those": [
      "p"
    ],
    "intended": [
      "p"
    ],
    "by": [
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "p"
    ],
    "application": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "design": [
      "p",
      "p"
    ],
    "this": [
      "p",
      "p"
    ],
    "guideline": [
      "p"
    ],
    "writing": [
      "p"
    ],
    "a": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "web": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "avoid": [
      "p"
    ],
    "in": [
      "p",
      "p",
      "p",
      "p"
    ],
    "applications": [
      "p"
    ],
    "if": [
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "possible": [
      "p",
      "ul",
      "li",
      "a"
    ],
    "how": [
      "h1"
    ],
    "following": [
      "p",
      "p",
      "p",
      "p"
    ],
    "actions": [
      "p"
    ],
    "calculate": [
      "p",
      "ol",
      "li",
      "p",
      "ul",
      "li",
      "a"
    ],
    "destinations": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "li",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "of": [
      "p",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "and": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "li",
      "p",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "h1",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "h1",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "h1"
    ],
    "identify": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "review": [
      "ol",
      "li",
      "p"
    ],
    "code": [
      "ol",
      "li",
      "p",
      "h1"
    ],
    "find": [
      "ol",
      "li",
      "p"
    ],
    "all": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "li",
      "p"
    ],
    "enumerate": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "make": [
      "ol",
      "li",
      "p"
    ],
    "list": [
      "ol",
      "li",
      "p"
    ],
    "pointed": [
      "ol",
      "li",
      "p"
    ],
    "define": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "for": [
      "ol",
      "li",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "a"
    ],
    "used": [
      "ol",
      "li",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "value": [
      "ol",
      "li",
      "p",
      "p",
      "p"
    ],
    "is": [
      "ol",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "short": [
      "ol",
      "li",
      "p"
    ],
    "identifying": [
      "ol",
      "li",
      "p"
    ],
    "string": [
      "ol",
      "li",
      "p"
    ],
    "symbolically": [
      "ol",
      "li",
      "p"
    ],
    "represents": [
      "ol",
      "li",
      "p"
    ],
    "resource": [
      "ol",
      "li",
      "p"
    ],
    "rewrite": [
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "strong"
    ],
    "as": [
      "ol",
      "li",
      "p",
      "p"
    ],
    "final": [
      "ol",
      "li",
      "p"
    ],
    "problem": [
      "h1"
    ],
    "example": [
      "h1",
      "h1",
      "p",
      "h1"
    ],
    "consider": [
      "p"
    ],
    "an": [
      "p",
      "p",
      "p",
      "p"
    ],
    "on-line": [
      "p"
    ],
    "banking": [
      "p",
      "p"
    ],
    "has": [
      "p",
      "p"
    ],
    "insecure": [
      "p"
    ],
    "redirect": [
      "p",
      "p",
      "p",
      "p"
    ],
    "http//www.onlinebank.com/redirect.jsp?url=[destination]": [
      "p"
    ],
    "http//www.onlinebank.com/redirect.jsp?url=[destination": [
      "a"
    ],
    "phisher": [
      "p",
      "p"
    ],
    "may": [
      "p",
      "p",
      "p"
    ],
    "create": [
      "p"
    ],
    "hyperlink": [
      "p"
    ],
    "his": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "site": [
      "p",
      "p",
      "p",
      "p"
    ],
    "send": [
      "p"
    ],
    "it": [
      "p",
      "p"
    ],
    "spam": [
      "p"
    ],
    "messages": [
      "p"
    ],
    "millions": [
      "p"
    ],
    "people": [
      "p"
    ],
    "http//www.onlinebank.com/redirect.jsp?url=www.phisher.com": [
      "p",
      "a",
      "p",
      "a"
    ],
    "sees": [
      "p",
      "p"
    ],
    "link": [
      "p",
      "p"
    ],
    "appears": [
      "p"
    ],
    "bank": [
      "p"
    ],
    "at": [
      "p"
    ],
    "onlinebankcom": [
      "p"
    ],
    "e-mail": [
      "p"
    ],
    "message": [
      "p",
      "p"
    ],
    "he": [
      "p"
    ],
    "clicks": [
      "p"
    ],
    "looks": [
      "p"
    ],
    "exactly": [
      "p"
    ],
    "like": [
      "p"
    ],
    "bank's": [
      "p",
      "p"
    ],
    "but": [
      "p",
      "p"
    ],
    "actually": [
      "p"
    ],
    "phishing": [
      "p"
    ],
    "steal": [
      "p"
    ],
    "authentication": [
      "p"
    ],
    "credentials": [
      "p",
      "p"
    ],
    "enters": [
      "p"
    ],
    "account": [
      "p",
      "p"
    ],
    "number": [
      "p"
    ],
    "pin": [
      "p"
    ],
    "into": [
      "p"
    ],
    "page": [
      "p",
      "p"
    ],
    "receives": [
      "p"
    ],
    "error": [
      "p"
    ],
    "telling": [
      "p"
    ],
    "him": [
      "p"
    ],
    "try": [
      "p"
    ],
    "again": [
      "p",
      "p"
    ],
    "redirected": [
      "p"
    ],
    "real": [
      "p"
    ],
    "after": [
      "p"
    ],
    "entering": [
      "p"
    ],
    "successfully": [
      "p"
    ],
    "views": [
      "p"
    ],
    "however": [
      "p",
      "p"
    ],
    "now": [
      "p"
    ],
    "user's": [
      "p"
    ],
    "online": [
      "p"
    ],
    "information": [
      "p",
      "ul",
      "li"
    ],
    "solution": [
      "h1",
      "p"
    ],
    "simplest": [
      "p"
    ],
    "get": [
      "p"
    ],
    "rid": [
      "p"
    ],
    "altogether": [
      "p"
    ],
    "necessary": [
      "p",
      "ul",
      "li",
      "a"
    ],
    "then": [
      "p",
      "p",
      "p"
    ],
    "be": [
      "p",
      "p",
      "p"
    ],
    "mitigate": [
      "p"
    ],
    "vulnerability": [
      "p"
    ],
    "redirectjsp": [
      "p"
    ],
    "balancejsp,": [
      "p"
    ],
    "called": [
      "p"
    ],
    "\"page1\"": [
      "p"
    ],
    "created": [
      "p"
    ],
    "signify": [
      "p"
    ],
    "balancejsp.": [
      "p"
    ],
    "redirectjspshould": [
      "p"
    ],
    "rewritten": [
      "p"
    ],
    "accept": [
      "p"
    ],
    "instead": [
      "p"
    ],
    "urls": [
      "p"
    ],
    "url": [
      "p"
    ],
    "should": [
      "p"
    ],
    "balancejsp:": [
      "p"
    ],
    "http//www.onlinebank.com/redirect.jsp?map=page1": [
      "p",
      "a"
    ],
    "will": [
      "p",
      "p"
    ],
    "not": [
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "work": [
      "p"
    ],
    "because": [
      "p"
    ],
    "supplied": [
      "p"
    ],
    "match": [
      "p"
    ],
    "any": [
      "p"
    ],
    "defined": [
      "p"
    ],
    "http//www.onlinebank.com/redirect.jsp?map=www.phisher.com": [
      "p",
      "a"
    ],
    "additional": [
      "h1"
    ],
    "resources": [
      "h1"
    ],
    "more": [
      "ul",
      "li"
    ],
    "about": [
      "ul",
      "li"
    ],
    "unvalidated": [
      "ul",
      "li"
    ],
    "please": [
      "ul",
      "li"
    ],
    "see": [
      "ul",
      "li"
    ],
    "http//www.owasp.org/index.php/top_10_2010-a10-unvalidated_redirects_and_forwards": [
      "ul",
      "li",
      "a"
    ],
    "guidelines": [
      "h1"
    ],
    "don't": [
      "ul",
      "li",
      "a"
    ],
    "without": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "redirecting": [
      "ul",
      "li",
      "a",
      "title"
    ],
    "validate": [
      "ul",
      "li",
      "a"
    ],
    "checklists": [
      "h1"
    ],
    "are": [
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a"
    ],
    "unless": [
      "ul",
      "li",
      "a"
    ],
    "calculated": [
      "ul",
      "li",
      "a"
    ],
    "validated": [
      "ul",
      "li",
      "a"
    ],
    "esapi": [
      "ul",
      "li",
      "a"
    ],
    "override": [
      "ul",
      "li",
      "a"
    ],
    "sendredirect)": [
      "ul",
      "li",
      "a"
    ],
    "method": [
      "ul",
      "li",
      "a"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "What to Do",
      "Why",
      "When",
      "How",
      "Problem Example",
      "Solution Example",
      "Additional Resources",
      "Redirects and Forwards Guidelines",
      "Redirects and Forwards Checklists",
      "Redirects and Forwards Code Example"
    ],
    "ul": [
      "Java",
      "For more information about unvalidated redirects and forwards, please see http://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards",
      "Don't Use Redirects or Forwards if Possible\r\n      \r\n        Calculate Destinations of Redirects and Forwards Without User Input\r\n        \r\n          Use Mapping Values When Redirecting on User Input\r\n          \r\n            Validate Destinations of Redirects and Forwards",
      "Redirects and Forwards Are Not Used Unless Necessary\r\n      \r\n        Destinations of Redirects and Forwards Are Calculated Without User Input\r\n        \r\n          Mapping Values Are Used for Redirects and Forwards\r\n          \r\n            Destinations of Redirects and Forwards Are Validated",
      "Use ESAPI to Override the sendRedirect() Method"
    ],
    "li": [
      "Java",
      "Identify redirects and forwards. Review code to find all redirects and forwards.",
      "Enumerate destinations. Make a list of all destinations pointed to by redirects and forwards.",
      "Define mapping values. Define mapping values for all destinations used by redirects and forwards. A mapping value is a short identifying string that symbolically represents a resource.",
      "Rewrite redirects and forwards. Rewrite redirects and forwards to use mapping values as input to calculate the final destinations of redirects or forwards.",
      "For more information about unvalidated redirects and forwards, please see http://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards",
      "Don't Use Redirects or Forwards if Possible",
      "Calculate Destinations of Redirects and Forwards Without User Input",
      "Use Mapping Values When Redirecting on User Input",
      "Validate Destinations of Redirects and Forwards",
      "Redirects and Forwards Are Not Used Unless Necessary",
      "Destinations of Redirects and Forwards Are Calculated Without User Input",
      "Mapping Values Are Used for Redirects and Forwards",
      "Destinations of Redirects and Forwards Are Validated",
      "Use ESAPI to Override the sendRedirect() Method"
    ],
    "p": [
      "Use mapping values to perform redirects or forwards based on user input.",
      "Using mapping values when performing redirects or forwards prevents malicious users from creating hyperlinks that use the redirects or forwards to point to pages other than those intended by the application design.",
      "Use this guideline when writing a web application that use redirects or forwards. Avoid using redirects or forwards in web applications, if possible.",
      "Perform the following actions to calculate destinations of redirects and forwards based on mapping values:",
      "Identify redirects and forwards. Review code to find all redirects and forwards.",
      "Enumerate destinations. Make a list of all destinations pointed to by redirects and forwards.",
      "Define mapping values. Define mapping values for all destinations used by redirects and forwards. A mapping value is a short identifying string that symbolically represents a resource.",
      "Rewrite redirects and forwards. Rewrite redirects and forwards to use mapping values as input to calculate the final destinations of redirects or forwards.",
      "Consider an on-line banking application that has an insecure redirect:",
      "http://www.onlinebank.com/redirect.jsp?url=[destination]",
      "A phisher may create the following hyperlink to point to his site and send it in spam messages to millions of people:",
      "http://www.onlinebank.com/redirect.jsp?url=www.phisher.com",
      "When a user sees a link that appears to point to his bank at onlinebank.com in an e-mail message, he clicks that link and sees a web site that looks exactly like the bank's, but is actually a phishing web site used to steal authentication credentials. The user enters his account number and PIN into the web page, receives an error message telling him to try again, and is redirected to the bank's real site. After entering his credentials again, the user successfully views his account. However, the phisher now has the user's online banking information.",
      "The simplest solution is to get rid of the redirect altogether, but if it is necessary for application design, then mapping values may be used to mitigate this vulnerability. For example, if redirect.jsp is used by the application to redirect to balance.jsp, a mapping value called \"page1\" may be created to signify balance.jsp. The page redirect.jspshould then be rewritten to accept mapping values as input, instead of URLs. The following URL should then redirect to balance.jsp:",
      "http://www.onlinebank.com/redirect.jsp?map=page1",
      "However, the following malicious hyperlinks will not work, because supplied input will not match any mapping value defined in the application:",
      "http://www.onlinebank.com/redirect.jsp?url=www.phisher.com\r\n    \r\n    http://www.onlinebank.com/redirect.jsp?map=www.phisher.com"
    ],
    "ol": [
      "Identify redirects and forwards. Review code to find all redirects and forwards.\r\n      \r\n        \r\n          Enumerate destinations. Make a list of all destinations pointed to by redirects and forwards.\r\n        \r\n          \r\n            Define mapping values. Define mapping values for all destinations used by redirects and forwards. A mapping value is a short identifying string that symbolically represents a resource.\r\n          \r\n            \r\n              Rewrite redirects and forwards. Rewrite redirects and forwards to use mapping values as input to calculate the final destinations of redirects or forwards."
    ],
    "strong": [
      "Identify redirects and forwards.",
      "Enumerate destinations.",
      "Define mapping values.",
      "Rewrite redirects and forwards."
    ],
    "a": [
      "http://www.onlinebank.com/redirect.jsp?url=[destination",
      "http://www.onlinebank.com/redirect.jsp?url=www.phisher.com",
      "http://www.onlinebank.com/redirect.jsp?map=page1",
      "http://www.onlinebank.com/redirect.jsp?url=www.phisher.com",
      "http://www.onlinebank.com/redirect.jsp?map=www.phisher.com",
      "http://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards",
      "Don't Use Redirects or Forwards if Possible",
      "Calculate Destinations of Redirects and Forwards Without User Input",
      "Use Mapping Values When Redirecting on User Input",
      "Validate Destinations of Redirects and Forwards",
      "Redirects and Forwards Are Not Used Unless Necessary",
      "Destinations of Redirects and Forwards Are Calculated Without User Input",
      "Mapping Values Are Used for Redirects and Forwards",
      "Destinations of Redirects and Forwards Are Validated",
      "Use ESAPI to Override the sendRedirect() Method"
    ],
    "br": [
      ""
    ]
  },
  "links": [
    {
      "href": "http://www.onlinebank.com/redirect.jsp?url=[destination",
      "text": "http://www.onlinebank.com/redirect.jsp?url=[destination"
    },
    {
      "href": "http://www.onlinebank.com/redirect.jsp?url=www.phisher.com",
      "text": "http://www.onlinebank.com/redirect.jsp?url=www.phisher.com"
    },
    {
      "href": "http://www.onlinebank.com/redirect.jsp?map=page1",
      "text": "http://www.onlinebank.com/redirect.jsp?map=page1"
    },
    {
      "href": "http://www.onlinebank.com/redirect.jsp?url=www.phisher.com",
      "text": "http://www.onlinebank.com/redirect.jsp?url=www.phisher.com"
    },
    {
      "href": "http://www.onlinebank.com/redirect.jsp?map=www.phisher.com",
      "text": "http://www.onlinebank.com/redirect.jsp?map=www.phisher.com"
    },
    {
      "href": "http://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards",
      "text": "http://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards"
    },
    {
      "href": "/article/0ed7310a-a0fd-4074-9c0f-37f48cf2bf4f",
      "text": "Don't Use Redirects or Forwards if Possible"
    },
    {
      "href": "/article/be525e05-0785-4b0c-8266-1ab4a0be08ea",
      "text": "Calculate Destinations of Redirects and Forwards Without User Input"
    },
    {
      "href": "/article/8a8fe651-2168-4c88-b89a-0b6b442da2f8",
      "text": "Use Mapping Values When Redirecting on User Input"
    },
    {
      "href": "/article/e7a1c675-9cae-4c12-85f3-4eb4269c197d",
      "text": "Validate Destinations of Redirects and Forwards"
    },
    {
      "href": "/article/11e960d3-09c4-4b40-9e20-a17fbe3116e7",
      "text": "Redirects and Forwards Are Not Used Unless Necessary"
    },
    {
      "href": "/article/b77c82d9-0a87-4f01-9943-f3a9fc52b561",
      "text": "Destinations of Redirects and Forwards Are Calculated Without User Input"
    },
    {
      "href": "/article/7bef867d-4dcb-47ea-ac58-651b9552cc1c",
      "text": "Mapping Values Are Used for Redirects and Forwards"
    },
    {
      "href": "/article/346a9c98-e2ce-4551-85b4-ba8f4acdd9dc",
      "text": "Destinations of Redirects and Forwards Are Validated"
    },
    {
      "href": "/article/58e5c2d7-7917-4c79-b329-b676173f6764",
      "text": "Use ESAPI to Override the sendRedirect() Method"
    }
  ],
  "html": "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>Java</li>\r\n  </ul>\r\n  <h1>What to Do</h1>\r\n  <p>Use mapping values to perform redirects or forwards based on user input.</p>\r\n  <h1>Why</h1>\r\n  <p>Using mapping values when performing redirects or forwards prevents malicious users from creating hyperlinks that use the redirects or forwards to point to pages other than those intended by the application design.</p>\r\n  <h1>When</h1>\r\n  <p>Use this guideline when writing a web application that use redirects or forwards. Avoid using redirects or forwards in web applications, if possible.</p>\r\n  <h1>How</h1>\r\n  <p>Perform the following actions to calculate destinations of redirects and forwards based on mapping values:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Identify redirects and forwards.</strong> Review code to find all redirects and forwards.</p>\r\n      <li>\r\n        <p>\r\n          <strong>Enumerate destinations.</strong> Make a list of all destinations pointed to by redirects and forwards.</p>\r\n        <li>\r\n          <p>\r\n            <strong>Define mapping values.</strong> Define mapping values for all destinations used by redirects and forwards. A mapping value is a short identifying string that symbolically represents a resource.</p>\r\n          <li>\r\n            <p>\r\n              <strong>Rewrite redirects and forwards.</strong> Rewrite redirects and forwards to use mapping values as input to calculate the final destinations of redirects or forwards.</p>\r\n          </li>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ol>\r\n  <h1>Problem Example</h1>\r\n  <p>Consider an on-line banking application that has an insecure redirect:</p>\r\n  <p>\r\n    <a href=\"http://www.onlinebank.com/redirect.jsp?url=&#91;destination\">http://www.onlinebank.com/redirect.jsp?url=&#91;destination</a>&#93;</p>\r\n  <p>A phisher may create the following hyperlink to point to his site and send it in spam messages to millions of people:</p>\r\n  <p>\r\n    <a href=\"http://www.onlinebank.com/redirect.jsp?url=www.phisher.com\">http://www.onlinebank.com/redirect.jsp?url=www.phisher.com</a>\r\n  </p>\r\n  <p>When a user sees a link that appears to point to his bank at onlinebank.com in an e-mail message, he clicks that link and sees a web site that looks exactly like the bank's, but is actually a phishing web site used to steal authentication credentials. The user enters his account number and PIN into the web page, receives an error message telling him to try again, and is redirected to the bank's real site. After entering his credentials again, the user successfully views his account. However, the phisher now has the user's online banking information.</p>\r\n  <h1>Solution Example</h1>\r\n  <p>The simplest solution is to get rid of the redirect altogether, but if it is necessary for application design, then mapping values may be used to mitigate this vulnerability. For example, if redirect.jsp is used by the application to redirect to balance.jsp, a mapping value called \"page1\" may be created to signify balance.jsp. The page redirect.jspshould then be rewritten to accept mapping values as input, instead of URLs. The following URL should then redirect to balance.jsp:</p>\r\n  <p>\r\n    <a href=\"http://www.onlinebank.com/redirect.jsp?map=page1\">http://www.onlinebank.com/redirect.jsp?map=page1</a>\r\n  </p>\r\n  <p>However, the following malicious hyperlinks will not work, because supplied input will not match any mapping value defined in the application:</p>\r\n  <p>\r\n    <a href=\"http://www.onlinebank.com/redirect.jsp?url=www.phisher.com\">http://www.onlinebank.com/redirect.jsp?url=www.phisher.com</a>\r\n    <br />\r\n    <a href=\"http://www.onlinebank.com/redirect.jsp?map=www.phisher.com\">http://www.onlinebank.com/redirect.jsp?map=www.phisher.com</a>\r\n  </p>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>For more information about unvalidated redirects and forwards, please see <a href=\"http://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards\">http://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards</a></li>\r\n  </ul>\r\n  <h1>Redirects and Forwards Guidelines</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/0ed7310a-a0fd-4074-9c0f-37f48cf2bf4f\">Don't Use Redirects or Forwards if Possible</a>\r\n      <li>\r\n        <a href=\"/article/be525e05-0785-4b0c-8266-1ab4a0be08ea\">Calculate Destinations of Redirects and Forwards Without User Input</a>\r\n        <li>\r\n          <a href=\"/article/8a8fe651-2168-4c88-b89a-0b6b442da2f8\">Use Mapping Values When Redirecting on User Input</a>\r\n          <li>\r\n            <a href=\"/article/e7a1c675-9cae-4c12-85f3-4eb4269c197d\">Validate Destinations of Redirects and Forwards</a>\r\n          </li>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ul>\r\n  <h1>Redirects and Forwards Checklists</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/11e960d3-09c4-4b40-9e20-a17fbe3116e7\">Redirects and Forwards Are Not Used Unless Necessary</a>\r\n      <li>\r\n        <a href=\"/article/b77c82d9-0a87-4f01-9943-f3a9fc52b561\">Destinations of Redirects and Forwards Are Calculated Without User Input</a>\r\n        <li>\r\n          <a href=\"/article/7bef867d-4dcb-47ea-ac58-651b9552cc1c\">Mapping Values Are Used for Redirects and Forwards</a>\r\n          <li>\r\n            <a href=\"/article/346a9c98-e2ce-4551-85b4-ba8f4acdd9dc\">Destinations of Redirects and Forwards Are Validated</a>\r\n          </li>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ul>\r\n  <h1>Redirects and Forwards Code Example</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/58e5c2d7-7917-4c79-b329-b676173f6764\">Use ESAPI to Override the sendRedirect() Method</a>\r\n    </li>\r\n  </ul>"
}