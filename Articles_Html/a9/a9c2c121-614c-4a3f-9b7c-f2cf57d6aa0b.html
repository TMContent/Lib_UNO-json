<h2>Applies To</h2>
<ul>
<li>Java</li>
<li>Struts 2</li>
</ul>
<h2>Summary</h2>
<p>Perform CSRF prevention using Struts 2 within an application. CSRF prevention is a key security control for an application that protects the application and its users from CSRF attacks.</p>
<h2>Solution Example</h2>
<p>There is a standard model for CSRF prevention using Struts 2 that involves 3 basic steps</p>
<ol>
<li>
<p><strong>Update your interceptor stack to include the tokenSessionInterceptor, either including or excluding all methods (all are included here).</strong></p>
<pre><code>&lt;interceptor-stack name=&quot;myStack&quot;&gt;
	&lt;interceptor-ref name=&quot;defaultStack&quot; /&gt;
	&lt;interceptor-ref name=&quot;tokenSession&quot;&gt;
 &lt;param name=&quot;includeMethods&quot;&gt;*&lt;/param&gt;
	&lt;/interceptor-ref&gt;
&lt;/interceptor-stack&gt;
&lt;default-interceptor-ref name=&quot;myStack&quot; /&gt;
</code></pre>
</li>
<li>
<p><strong>Update your action configuration to include or exclude any methods that need or do not need CSRF protection.</strong></p>
<pre><code>&lt;action ...&gt;
	...
	&lt;interceptor-ref name=&quot;tokenSession&quot;&gt;
 &lt;param name=&quot;excludeMethods&quot;&gt;searchBooks,getBook&lt;/param&gt;
	&lt;/interceptor-ref&gt;
&lt;/action&gt;
</code></pre>
</li>
<li>
<p><strong>Use s:token in your JSP form that requests the action.</strong></p>
<pre><code>&lt;s:form action=&quot;...&quot;&gt;
	...
	&lt;s:token /&gt;
	...
&lt;/s:form&gt;
</code></pre>
</li>
</ol>
