{
  "id": "03a6163b-a68c-409f-b19e-11ca604119bc",
  "checksum": "121b3447364230e0fc88a596784c4385622bf750",
  "words": {
    "what": [
      "h1"
    ],
    "to": [
      "h1",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "do": [
      "h1",
      "p"
    ],
    "make": [
      "p"
    ],
    "it": [
      "p"
    ],
    "easier": [
      "p"
    ],
    "maintain": [
      "p"
    ],
    "and": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "review": [
      "p",
      "p",
      "p"
    ],
    "your": [
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p"
    ],
    "code": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "place": [
      "p"
    ],
    "all": [
      "p",
      "p"
    ],
    "unmanaged": [
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "api": [
      "p",
      "p",
      "title"
    ],
    "calls": [
      "p",
      "ul",
      "li",
      "p",
      "title"
    ],
    "in": [
      "p",
      "ul",
      "li",
      "p",
      "p",
      "title"
    ],
    "a": [
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "wrapper": [
      "p",
      "p",
      "title"
    ],
    "assembly": [
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "title"
    ],
    "why": [
      "h1"
    ],
    "his": [
      "p"
    ],
    "allows": [
      "p"
    ],
    "you": [
      "p",
      "p",
      "p",
      "p"
    ],
    "easily": [
      "ul",
      "li"
    ],
    "determine": [
      "ul",
      "li"
    ],
    "the": [
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "set": [
      "ul",
      "li"
    ],
    "of": [
      "ul",
      "li",
      "p"
    ],
    "apis": [
      "ul",
      "li",
      "p"
    ],
    "application": [
      "ul",
      "li"
    ],
    "is": [
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "dependant": [
      "ul",
      "li"
    ],
    "on": [
      "ul",
      "li"
    ],
    "isolate": [
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "title"
    ],
    "single": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "unmanagedcodepermission": [
      "ul",
      "li",
      "b"
    ],
    "how": [
      "h1"
    ],
    "assembly use": [
      "p"
    ],
    "naming": [
      "p"
    ],
    "conventions": [
      "p"
    ],
    "keep": [
      "p"
    ],
    "native": [
      "p",
      "p",
      "i"
    ],
    "risks": [
      "p"
    ],
    "mind": [
      "p"
    ],
    "when": [
      "p"
    ],
    "develop": [
      "p"
    ],
    "categorize": [
      "p"
    ],
    "use": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "prefix": [
      "p"
    ],
    "indicate": [
      "p"
    ],
    "types": [
      "p"
    ],
    "that": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "encapsulate": [
      "p"
    ],
    "word": [
      "p",
      "p",
      "p"
    ],
    "safe": [
      "p",
      "p",
      "i",
      "p"
    ],
    "identify": [
      "p",
      "p",
      "p"
    ],
    "poses": [
      "p"
    ],
    "no": [
      "p",
      "p"
    ],
    "possible": [
      "p"
    ],
    "security": [
      "p",
      "p",
      "p",
      "p"
    ],
    "threat": [
      "p"
    ],
    "harmless": [
      "p"
    ],
    "for": [
      "p",
      "p",
      "p",
      "p"
    ],
    "any": [
      "p",
      "p"
    ],
    "malicious": [
      "p"
    ],
    "or": [
      "p"
    ],
    "otherwise": [
      "p"
    ],
    "call": [
      "p"
    ],
    "can": [
      "p"
    ],
    "annotate": [
      "p"
    ],
    "classes": [
      "p"
    ],
    "with": [
      "p",
      "p",
      "p"
    ],
    "suppressunmanagedcodesecurity": [
      "p",
      "b",
      "p",
      "b"
    ],
    "attribute": [
      "p",
      "p"
    ],
    "which": [
      "p"
    ],
    "turns": [
      "p"
    ],
    "off": [
      "p"
    ],
    "code-access": [
      "p"
    ],
    "permission's": [
      "p"
    ],
    "demand": [
      "p",
      "p",
      "p"
    ],
    "full": [
      "p",
      "p",
      "p"
    ],
    "trust": [
      "p"
    ],
    "suppressunmanagedcodesecurity]class": [
      "pre",
      "pre"
    ],
    "safenativemethods": [
      "pre"
    ],
    "{": [
      "pre",
      "pre",
      "pre"
    ],
    "dllimport\"user32\")]": [
      "pre"
    ],
    "internal": [
      "pre",
      "pre",
      "pre"
    ],
    "static": [
      "pre",
      "pre",
      "pre"
    ],
    "extern": [
      "pre",
      "pre",
      "pre"
    ],
    "void": [
      "pre",
      "pre",
      "pre"
    ],
    "messageboxstring": [
      "pre"
    ],
    "text;}": [
      "pre"
    ],
    "potentially": [
      "p",
      "p"
    ],
    "unsafe": [
      "p",
      "p",
      "p",
      "i"
    ],
    "but": [
      "p"
    ],
    "protected": [
      "p"
    ],
    "stack-walking": [
      "p"
    ],
    "permission": [
      "p",
      "p"
    ],
    "these": [
      "p",
      "p"
    ],
    "are": [
      "p"
    ],
    "implicitly": [
      "p"
    ],
    "made": [
      "p"
    ],
    "by": [
      "p"
    ],
    "interop": [
      "p"
    ],
    "layer": [
      "p"
    ],
    "unless": [
      "p"
    ],
    "they": [
      "p"
    ],
    "have": [
      "p"
    ],
    "been": [
      "p"
    ],
    "suppressed": [
      "p",
      "p"
    ],
    "class": [
      "pre"
    ],
    "nativemethods": [
      "pre"
    ],
    "dllimport(\"user32\")]": [
      "pre",
      "pre"
    ],
    "formatdrivestring": [
      "pre"
    ],
    "driveletter;}": [
      "pre"
    ],
    "has": [
      "p"
    ],
    "declaratively": [
      "p"
    ],
    "caller": [
      "p"
    ],
    "methods": [
      "p"
    ],
    "must": [
      "p"
    ],
    "ensure": [
      "p"
    ],
    "usage": [
      "p"
    ],
    "because": [
      "p"
    ],
    "stack": [
      "p"
    ],
    "walk": [
      "p"
    ],
    "performed": [
      "p"
    ],
    "unsafenativemethods": [
      "pre"
    ],
    "createfilestring": [
      "pre"
    ],
    "filename;}": [
      "pre"
    ],
    "adapted": [
      "p"
    ],
    "from": [
      "p"
    ],
    "microsoft": [
      "p"
    ],
    "patterns": [
      "p"
    ],
    "&": [
      "p"
    ],
    "practices": [
      "p"
    ],
    "guidance": [
      "p"
    ]
  },
  "tags": {
    "h1": [
      "What to Do",
      "Why",
      "How",
      ""
    ],
    "p": [
      "To make it easier maintain and review your code, place all unmanaged API calls in a wrapper assembly",
      "his allows you to:",
      "Isolate all unmanaged API calls in a wrapper assembly. Use naming conventions to keep native code risks in mind when you develop and review code. Categorize your unmanaged code and use a prefix to indicate the types that you use to encapsulate the unmanaged APIs.",
      "Use the word Safe to identify code that poses no possible security threat and is harmless for any code, malicious or otherwise, to call. You can annotate safe classes with the SuppressUnmanagedCodeSecurity attribute, which turns off the code-access security permission's demand for full trust.",
      "Use the word Native to identify unmanaged code that is potentially unsafe but is protected with a full stack-walking demand for the unmanaged code permission. These are implicitly made by the interop layer unless they have been suppressed with the SuppressUnmanagedCodeSecurity attribute.",
      "Use the word Unsafe to identify unmanaged code that is potentially unsafe and that has the security demand for the unmanaged code permission declaratively suppressed. Any caller of these methods must do a full security review to ensure that the usage is safe because no stack walk is performed.",
      "Adapted from Microsoft patterns & practices guidance."
    ],
    "ul": [
      "Easily determine the set of unmanaged APIs your application is dependant on. Isolate your unmanaged calls in a single assembly. Isolate the UnmanagedCodePermission to a single assembly."
    ],
    "li": [
      "Easily determine the set of unmanaged APIs your application is dependant on.",
      "Isolate your unmanaged calls in a single assembly.",
      "Isolate the UnmanagedCodePermission to a single assembly."
    ],
    "b": [
      "UnmanagedCodePermission",
      "SuppressUnmanagedCodeSecurity",
      "SuppressUnmanagedCodeSecurity"
    ],
    "i": [
      "Safe",
      "Native",
      "Unsafe"
    ],
    "pre": [
      "[SuppressUnmanagedCodeSecurity]class SafeNativeMethods {    DllImport(\"user32\")]    internal static extern void MessageBox(string text);}",
      "class NativeMethods {    [DllImport(\"user32\")]    internal static extern void FormatDrive(string driveLetter);}",
      "[SuppressUnmanagedCodeSecurity]class UnsafeNativeMethods {    [DllImport(\"user32\")]    internal static extern void CreateFile(string fileName);}"
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "hr": [
      ""
    ]
  },
  "links": [],
  "html": "<h1>What to Do</h1>\r\n  <p>To make it easier maintain and review your code, place all unmanaged API calls in a wrapper assembly</p>\r\n  <h1>Why</h1>\r\n  <p>his allows you to: </p>\r\n  <ul>\r\n    <li>Easily determine the set of unmanaged APIs your application is dependant on. <li>Isolate your unmanaged calls in a single assembly. <li>Isolate the <b>UnmanagedCodePermission </b>to a single assembly.</li></li></li>\r\n  </ul>\r\n  <h1>How</h1>\r\n  <p>Isolate all unmanaged API calls in a wrapper assembly.&nbsp;Use naming conventions to keep native code risks in mind when you develop and review code. Categorize your unmanaged code and use a prefix to indicate the types that you use to encapsulate the unmanaged APIs. </p>\r\n  <p>Use the word <i>Safe </i>to identify code that poses no possible security threat and is harmless for any code, malicious or otherwise, to call. You can annotate safe classes with the <b>SuppressUnmanagedCodeSecurity</b> attribute, which turns off the code-access security permission's demand for full trust. </p>\r\n  <pre>&#91;SuppressUnmanagedCodeSecurity&#93;<br />class SafeNativeMethods &#123;<br />&nbsp;&nbsp;&nbsp; DllImport(\"user32\")&#93;<br />&nbsp;&nbsp;&nbsp; internal static extern void MessageBox(string text);<br />&#125;  </pre>\r\n  <p>Use the word <i>Native</i> to identify unmanaged code that is potentially unsafe but is protected with a full stack-walking demand for the unmanaged code permission. These are implicitly made by the interop layer unless they have been suppressed with the <b>SuppressUnmanagedCodeSecurity</b> attribute. </p>\r\n  <pre>class NativeMethods &#123;<br />&nbsp;&nbsp;&nbsp; &#91;DllImport(\"user32\")&#93;<br />&nbsp;&nbsp;&nbsp; internal static extern void FormatDrive(string driveLetter);<br />&#125;  </pre>\r\n  <p>Use the word <i>Unsafe</i> to identify unmanaged code that is potentially unsafe and that has the security demand for the unmanaged code permission declaratively suppressed. Any caller of these methods must do a full security review to ensure that the usage is safe because no stack walk is performed. </p>\r\n  <pre>&#91;SuppressUnmanagedCodeSecurity&#93;<br />class UnsafeNativeMethods &#123;<br />&nbsp;&nbsp;&nbsp; &#91;DllImport(\"user32\")&#93;<br />&nbsp;&nbsp;&nbsp; internal static extern void CreateFile(string fileName);<br />&#125;</pre>\r\n  <h1>&nbsp;</h1>\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns & practices guidance.</p>"
}