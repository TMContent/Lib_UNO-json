<h2>Applies To</h2><ul><li> C++</li>
</ul><h2>What to Check For</h2><p>Verify that functions that accept format string parameters are either not used at all or are used as little as possible.
</p><h2>Why</h2><p>C and C++ use string functions, like printf(), that allow users to pass a format for the input string. Attackers can manipulate the input parameters passed to these functions to make the function work differently. Attackers can use format string bugs to overwrite parts of the stack, corrupt memory, and crash the system. They can use this vulnerability to execute different kind of attacks such as elevation of privileges, authentication bypass, information disclosure, and denial of services.
</p><h2>How to Check</h2><p>To verify that functions with format string parameters are used as little as possible:
</p><ol>
<li> <strong>Find code that uses functions with format string parameters.</strong> Search your application for code that uses any of the following functions:<ol>
<li> printf</li>
<li> wprintf</li>
<li> sprintf</li>
<li> swprintf</li>
<li> fprintf</li>
<li> fwprintf</li>
<li> vprintf</li>
<li> scanf</li>
<li> fscanf</li>
<li> sscanf</li>
<li> fwscanf</li>
<li> wscanf</li>
<li> swscanf</li>
<li> snprintf</li></ol></li>
<li> <strong>Identify whether using functions with format string parameters is necessary.</strong> Examine each piece of code that uses a function with format string parameters. Determine if it is possible to either remove this code or rewrite it without using format string functions.</li>
</ol>
<h2>How to Fix</h2><p>To avoid using functions with format string parameters:
</p><ol>
<li> <strong>Find code that uses functions with format string parameters.</strong> Search your application for code that uses any of the following functions:<ol>
<li> printf</li>
<li> wprintf</li>
<li> sprintf</li>
<li> swprintf</li>
<li> fprintf</li>
<li> fwprintf</li>
<li> vprintf</li>
<li> scanf</li>
<li> fscanf</li>
<li> sscanf</li>
<li> fwscanf</li>
<li> wscanf</li>
<li> swscanf</li>
<li> snprintf</li></ol></li>
<li> <strong>Replace code that uses functions with format string parameters.</strong> Change each piece of code that uses any of the functions with format string parameters to use some other functions. The following functions may be used as safe alternatives on Windows systems:<ol>
<li> StringCbPrintf</li>
<li> StringCbPrintfEx</li>
<li> StringCchPrintf </li></ol></li>
</ol>
