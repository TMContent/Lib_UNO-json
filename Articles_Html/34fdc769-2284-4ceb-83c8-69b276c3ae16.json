{
  "id": "34fdc769-2284-4ceb-83c8-69b276c3ae16",
  "checksum": "9ae16aa450e9dead27df5a6bb7ba24ea9306183f",
  "words": {
    "applies": [
      "h2"
    ],
    "to": [
      "h2",
      "h2",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong"
    ],
    "aspnet": [
      "ul",
      "li"
    ],
    "what": [
      "h2"
    ],
    "do": [
      "h2"
    ],
    "store": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "title"
    ],
    "uploaded": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "title"
    ],
    "files": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "title"
    ],
    "in": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li"
    ],
    "a": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li"
    ],
    "location": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "ol",
      "li",
      "li"
    ],
    "that": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "li",
      "li",
      "li"
    ],
    "is": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li"
    ],
    "not": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "li"
    ],
    "web": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "strong",
      "title"
    ],
    "accessible": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "ol",
      "li",
      "li"
    ],
    "why": [
      "h2",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "storing": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "prevents": [
      "p"
    ],
    "shell": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "upload": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "vulnerabilities": [
      "p",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "even": [
      "p",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "if": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "an": [
      "p",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "attacker": [
      "p",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "manages": [
      "p"
    ],
    "malicious": [
      "p",
      "p"
    ],
    "script": [
      "p",
      "p"
    ],
    "they": [
      "p",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "won't": [
      "p",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "be": [
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li"
    ],
    "able": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "execute": [
      "p"
    ],
    "it": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "the": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li"
    ],
    "stored": [
      "p",
      "ol",
      "ol",
      "li",
      "ol",
      "li",
      "li"
    ],
    "from": [
      "p",
      "ol",
      "ol",
      "li",
      "ol",
      "li",
      "li"
    ],
    "how": [
      "h2"
    ],
    "find": [
      "ol",
      "li",
      "strong"
    ],
    "all": [
      "ol",
      "ol",
      "li",
      "li",
      "strong"
    ],
    "code": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong",
      "li",
      "ol",
      "li",
      "li",
      "li",
      "strong"
    ],
    "used": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "strong",
      "li"
    ],
    "search": [
      "ol",
      "li"
    ],
    "your": [
      "ol",
      "li"
    ],
    "application": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "for": [
      "ol",
      "li"
    ],
    "make": [
      "ol",
      "li"
    ],
    "spreadsheet": [
      "ol",
      "li"
    ],
    "enumerates": [
      "ol",
      "li"
    ],
    "this": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "determine": [
      "ol",
      "li",
      "strong"
    ],
    "where": [
      "ol",
      "li",
      "strong"
    ],
    "it's": [
      "ol",
      "li"
    ],
    "possible": [
      "ol",
      "li"
    ],
    "folder": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "outside": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong",
      "title"
    ],
    "of": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "title"
    ],
    "root": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "strong",
      "title"
    ],
    "or": [
      "ol",
      "li"
    ],
    "database": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li"
    ],
    "strong": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "and": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li"
    ],
    "easy": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "implement": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "measure": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "however": [
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "makes": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "installing": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "on": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "large": [
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "amount": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "servers": [
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "slightly": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "more": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "difficult": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "because": [
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "then": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "need": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "configured": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "allow": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "by": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "creating": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "granting": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "server": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "permissions": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "write": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "additional": [
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "configuration": [
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "work": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "many": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "commercial": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "applications": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "subsequently": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "suffer": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "another": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "mitigation": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "method": [
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "cannot": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "accessed": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "directly": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "via": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "http": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "requests": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "so": [
      "ol",
      "ol",
      "li",
      "ol",
      "li",
      "li"
    ],
    "access": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "already": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "using": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "there": [
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "no": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "end-user": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "required": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "harder": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "some": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "maintenance": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "overhead": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "backups": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "might": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "become": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "quite": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "change": [
      "ol",
      "ol",
      "li",
      "li",
      "strong"
    ],
    "each": [
      "ol",
      "li"
    ],
    "piece": [
      "ol",
      "li"
    ],
    "handle": [
      "ol",
      "li"
    ],
    "are": [
      "ol",
      "li"
    ],
    "chosen": [
      "ol",
      "li"
    ]
  },
  "tags": {
    "h2": [
      "Applies To",
      "What to Do",
      "Why",
      "How"
    ],
    "ul": [
      "ASP.NET"
    ],
    "li": [
      "ASP.NET",
      "Find all code used to upload files. Search your application for code that is used to upload files. Make a spreadsheet that enumerates all this code.",
      "Determine where to store uploaded files. It's possible to store uploaded files in a folder outside of the web root or in a database.\n Storing uploaded files outside the web root is a strong and easy to implement measure. However, it makes installing the application on a large amount of servers slightly more difficult, because the servers then need to be configured to allow storing files outside of the web root by creating a folder to store the uploaded files and granting the web server permissions to write to that folder. This additional configuration work is why many commercial applications store uploaded files in a web accessible location, and subsequently suffer from shell upload vulnerabilities. \n Another mitigation method is to store uploaded files in a database. Files stored in a database cannot be accessed directly via HTTP requests, so even if an attacker is able to upload a shell, they won't be able to access it. If the application is already using a database, there is no additional end-user configuration required. However, this method is harder to code, and there is some maintenance overhead because the database and backups might become quite large.",
      "Storing uploaded files outside the web root is a strong and easy to implement measure. However, it makes installing the application on a large amount of servers slightly more difficult, because the servers then need to be configured to allow storing files outside of the web root by creating a folder to store the uploaded files and granting the web server permissions to write to that folder. This additional configuration work is why many commercial applications store uploaded files in a web accessible location, and subsequently suffer from shell upload vulnerabilities.",
      "Another mitigation method is to store uploaded files in a database. Files stored in a database cannot be accessed directly via HTTP requests, so even if an attacker is able to upload a shell, they won't be able to access it. If the application is already using a database, there is no additional end-user configuration required. However, this method is harder to code, and there is some maintenance overhead because the database and backups might become quite large.",
      "Change code to store uploaded files outside web root. Change each piece of code that is used to handle uploaded files so that the uploaded files are stored in the chosen location that is not accessible from the web."
    ],
    "p": [
      "Store uploaded files in a location that is not web accessible.",
      "Storing uploaded files in a location that is not web accessible prevents shell upload vulnerabilities. Even if an attacker manages to upload a malicious script, they won't be able to execute it if the malicious script is stored in a location that is not accessible from the web.",
      "To store uploaded files in a location that is not web accessible:"
    ],
    "ol": [
      "Find all code used to upload files. Search your application for code that is used to upload files. Make a spreadsheet that enumerates all this code. \n Determine where to store uploaded files. It's possible to store uploaded files in a folder outside of the web root or in a database.\n Storing uploaded files outside the web root is a strong and easy to implement measure. However, it makes installing the application on a large amount of servers slightly more difficult, because the servers then need to be configured to allow storing files outside of the web root by creating a folder to store the uploaded files and granting the web server permissions to write to that folder. This additional configuration work is why many commercial applications store uploaded files in a web accessible location, and subsequently suffer from shell upload vulnerabilities. \n Another mitigation method is to store uploaded files in a database. Files stored in a database cannot be accessed directly via HTTP requests, so even if an attacker is able to upload a shell, they won't be able to access it. If the application is already using a database, there is no additional end-user configuration required. However, this method is harder to code, and there is some maintenance overhead because the database and backups might become quite large. \n Change code to store uploaded files outside web root. Change each piece of code that is used to handle uploaded files so that the uploaded files are stored in the chosen location that is not accessible from the web.",
      "Storing uploaded files outside the web root is a strong and easy to implement measure. However, it makes installing the application on a large amount of servers slightly more difficult, because the servers then need to be configured to allow storing files outside of the web root by creating a folder to store the uploaded files and granting the web server permissions to write to that folder. This additional configuration work is why many commercial applications store uploaded files in a web accessible location, and subsequently suffer from shell upload vulnerabilities. \n Another mitigation method is to store uploaded files in a database. Files stored in a database cannot be accessed directly via HTTP requests, so even if an attacker is able to upload a shell, they won't be able to access it. If the application is already using a database, there is no additional end-user configuration required. However, this method is harder to code, and there is some maintenance overhead because the database and backups might become quite large."
    ],
    "strong": [
      "Find all code used to upload files.",
      "Determine where to store uploaded files.",
      "Change code to store uploaded files outside web root."
    ]
  },
  "links": [],
  "html": "<h2>Applies To</h2><ul><li> ASP.NET</li>\n</ul><h2>What to Do</h2><p>Store uploaded files in a location that is not web accessible.\n</p><h2>Why</h2><p>Storing uploaded files in a location that is not web accessible prevents shell upload vulnerabilities. Even if an attacker manages to upload a malicious script, they won't be able to execute it if the malicious script is stored in a location that is not accessible from the web.\n</p><h2>How</h2><p>To store uploaded files in a location that is not web accessible:\n</p><ol>\n<li> <strong>Find all code used to upload files.</strong> Search your application for code that is used to upload files. Make a spreadsheet that enumerates all this code. </li>\n<li> <strong>Determine where to store uploaded files.</strong> It's possible to store uploaded files in a folder outside of the web root or in a database.<ol>\n<li> Storing uploaded files outside the web root is a strong and easy to implement measure. However, it makes installing the application on a large amount of servers slightly more difficult, because the servers then need to be configured to allow storing files outside of the web root by creating a folder to store the uploaded files and granting the web server permissions to write to that folder. This additional configuration work is why many commercial applications store uploaded files in a web accessible location, and subsequently suffer from shell upload vulnerabilities. </li>\n<li> Another mitigation method is to store uploaded files in a database. Files stored in a database cannot be accessed directly via HTTP requests, so even if an attacker is able to upload a shell, they won't be able to access it. If the application is already using a database, there is no additional end-user configuration required. However, this method is harder to code, and there is some maintenance overhead because the database and backups might become quite large. </li></ol></li>\n<li> <strong>Change code to store uploaded files outside web root.</strong> Change each piece of code that is used to handle uploaded files so that the uploaded files are stored in the chosen location that is not accessible from the web.</li>\n</ol>"
}