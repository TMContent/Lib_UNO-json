{
  "id": "4832e6c2-3669-4dde-8aa1-4cc33ba5224d",
  "checksum": "d2a3f9c598320e7a21c62765abeb6e7a143b7bb1",
  "words": {
    "what": [
      "h1"
    ],
    "to": [
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "h2",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "do": [
      "h1",
      "p",
      "p",
      "p"
    ],
    "avoid": [
      "p",
      "p",
      "title"
    ],
    "writing": [
      "p",
      "p"
    ],
    "code": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "that": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "accepts": [
      "p",
      "p",
      "p"
    ],
    "file": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "h2",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "p",
      "title",
      "title"
    ],
    "or": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "path": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "input": [
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "title"
    ],
    "from": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "caller": [
      "p"
    ],
    "instead": [
      "p"
    ],
    "use": [
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p"
    ],
    "fixed": [
      "p"
    ],
    "names": [
      "p",
      "p",
      "p",
      "ul",
      "li",
      "title"
    ],
    "and": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "locations": [
      "p"
    ],
    "when": [
      "p",
      "h1"
    ],
    "your": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "reads": [
      "p"
    ],
    "writes": [
      "p"
    ],
    "data": [
      "p",
      "p"
    ],
    "why": [
      "h1"
    ],
    "accepting": [
      "p"
    ],
    "paths": [
      "p",
      "p",
      "p",
      "h2",
      "ul",
      "li",
      "title"
    ],
    "users": [
      "p"
    ],
    "can": [
      "p",
      "p",
      "p",
      "p"
    ],
    "result": [
      "p",
      "p"
    ],
    "in": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "attackers": [
      "p",
      "p"
    ],
    "coercing": [
      "p"
    ],
    "application": [
      "p",
      "p",
      "p",
      "p",
      "h2"
    ],
    "into": [
      "p",
      "p"
    ],
    "accessing": [
      "p",
      "p"
    ],
    "arbitrary": [
      "p",
      "p"
    ],
    "files": [
      "p",
      "p"
    ],
    "resources": [
      "p",
      "p"
    ],
    "you": [
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p"
    ],
    "should": [
      "p"
    ],
    "never": [
      "p"
    ],
    "accept": [
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "a": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "name": [
      "p",
      "p",
      "p",
      "ul",
      "li"
    ],
    "user": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "under": [
      "p"
    ],
    "any": [
      "p",
      "p",
      "p"
    ],
    "circumstances": [
      "p"
    ],
    "how": [
      "h1"
    ],
    "if": [
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p"
    ],
    "need": [
      "p",
      "p"
    ],
    "store": [
      "p",
      "p"
    ],
    "it": [
      "p",
      "p",
      "p"
    ],
    "database": [
      "p"
    ],
    "other": [
      "p"
    ],
    "non-filesystem": [
      "p"
    ],
    "store&nbsp;": [
      "p"
    ],
    "keep": [
      "p"
    ],
    "provided": [
      "p"
    ],
    "as": [
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "reference": [
      "p"
    ],
    "but": [
      "p"
    ],
    "not": [
      "p",
      "p"
    ],
    "form": [
      "p"
    ],
    "of": [
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "p"
    ],
    "canonical": [
      "p"
    ],
    "has": [
      "p"
    ],
    "url": [
      "p"
    ],
    "validate": [
      "p"
    ],
    "is": [
      "p",
      "p"
    ],
    "correct": [
      "p"
    ],
    "format": [
      "p"
    ],
    "points": [
      "p"
    ],
    "valid": [
      "p"
    ],
    "location": [
      "p"
    ],
    "within": [
      "p"
    ],
    "context": [
      "p"
    ],
    "failure": [
      "p"
    ],
    "this": [
      "p",
      "p",
      "p",
      "p"
    ],
    "persuading": [
      "p"
    ],
    "validating": [
      "h2"
    ],
    "prevent": [
      "p",
      "h2",
      "p"
    ],
    "malicious": [
      "p"
    ],
    "manipulating": [
      "p"
    ],
    "code's": [
      "p"
    ],
    "operations": [
      "p"
    ],
    "user-supplied": [
      "p"
    ],
    "for": [
      "p",
      "p",
      "title"
    ],
    "example": [
      "p",
      "p"
    ],
    "must": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "full": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "by": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "using": [
      "ul",
      "ul",
      "li",
      "li",
      "h2"
    ],
    "systemio.path.getfilename.": [
      "ul",
      "li"
    ],
    "systemio.path.getfullpath.": [
      "ul",
      "li"
    ],
    "systemio.path.getfilename": [
      "b"
    ],
    "systemio.path.getfullpath": [
      "b"
    ],
    "mappath": [
      "h2",
      "p",
      "b"
    ],
    "cross": [
      "h2"
    ],
    "mapping": [
      "h2",
      "p",
      "pre",
      "p"
    ],
    "map": [
      "p"
    ],
    "supplied": [
      "p"
    ],
    "virtual": [
      "p",
      "p",
      "p"
    ],
    "physical": [
      "p",
      "p"
    ],
    "on": [
      "p"
    ],
    "server": [
      "p",
      "p",
      "p"
    ],
    "overload": [
      "p"
    ],
    "requestmappath": [
      "p",
      "b"
    ],
    "bool": [
      "p",
      "b"
    ],
    "parameter": [
      "p",
      "p"
    ],
    "so": [
      "p"
    ],
    "cross-application": [
      "p",
      "pre",
      "p"
    ],
    "following": [
      "p"
    ],
    "shows": [
      "p"
    ],
    "technique": [
      "p"
    ],
    "try&#123&nbsp;": [
      "pre"
    ],
    "string": [
      "pre"
    ],
    "mappedpath": [
      "pre"
    ],
    "=": [
      "pre"
    ],
    "requestmappath(": [
      "pre"
    ],
    "inputpathtext,": [
      "pre"
    ],
    "&nbsp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;": [
      "pre"
    ],
    "requestapplicationpath,": [
      "pre"
    ],
    "false;&#125;catch": [
      "pre"
    ],
    "httpexception)&#123;&nbsp;": [
      "pre"
    ],
    "//": [
      "pre"
    ],
    "attempted&#125": [
      "pre"
    ],
    "final": [
      "p"
    ],
    "false": [
      "p",
      "b"
    ],
    "prevents": [
      "p"
    ],
    "means": [
      "p"
    ],
    "cannot": [
      "p"
    ],
    "successfully": [
      "p"
    ],
    "supply": [
      "p"
    ],
    "contains": [
      "p"
    ],
    "\".\"": [
      "p",
      "b"
    ],
    "traverse": [
      "p"
    ],
    "outside": [
      "p"
    ],
    "application's": [
      "p"
    ],
    "directory": [
      "p"
    ],
    "hierarchy": [
      "p"
    ],
    "attempt": [
      "p"
    ],
    "results": [
      "p"
    ],
    "an": [
      "p",
      "p"
    ],
    "exception": [
      "p"
    ],
    "type": [
      "p"
    ],
    "httpexception": [
      "p",
      "b",
      "p",
      "b"
    ],
    "controls": [
      "p"
    ],
    "controlmappathsecure": [
      "p",
      "p",
      "p",
      "b",
      "b",
      "b"
    ],
    "method": [
      "p"
    ],
    "retrieve": [
      "p"
    ],
    "which": [
      "p"
    ],
    "mapped": [
      "p",
      "p"
    ],
    "uses": [
      "p"
    ],
    "access": [
      "p"
    ],
    "security": [
      "p"
    ],
    "throws": [
      "p"
    ],
    "control": [
      "p"
    ],
    "does": [
      "p"
    ],
    "have": [
      "p"
    ],
    "permissions": [
      "p"
    ],
    "read": [
      "p"
    ],
    "resulting": [
      "p"
    ],
    "more": [
      "p"
    ],
    "information": [
      "p"
    ],
    "see": [
      "p"
    ],
    "net": [
      "p"
    ],
    "framework": [
      "p"
    ],
    "sdk": [
      "p"
    ],
    "documentation": [
      "p"
    ],
    "adapted": [
      "p"
    ],
    "microsoft": [
      "p"
    ],
    "patterns": [
      "p"
    ],
    "&": [
      "p"
    ],
    "practices": [
      "p"
    ],
    "guidance": [
      "p"
    ],
    "sink]": [
      "title"
    ],
    "untrusted": [
      "title"
    ]
  },
  "tags": {
    "h1": [
      "What to Do",
      "Why",
      "When",
      "How"
    ],
    "p": [
      "Avoid writing code that accepts file or path input from the caller. Instead, use fixed file names and locations when your code reads and writes data.",
      "Accepting file names or paths from users can result in attackers coercing your application into accessing arbitrary files and resources.",
      "You should never accept a file name or path from a user under any circumstances.",
      "If you need to store a file from a user, store it in a database or other non-filesystem data store.&nbsp; Keep the name the user provided as a reference to the file, but do not use it as any form of canonical name.",
      "If your application has to accept input file names, file paths, or URL paths, you need to validate that the path is in the correct format and that it points to a valid location within the context of your application. Failure to do this can result in attackers persuading your application into accessing arbitrary files and resources.",
      "To prevent a malicious user manipulating your code's file operations, avoid writing code that accepts user-supplied file or path input. For example:",
      "If you use MapPath to map a supplied virtual path to a physical path on the server, use the overload of Request.MapPath that accepts a bool parameter so that you can prevent cross-application mapping. The following code example shows this technique.",
      "The final false parameter prevents cross-application mapping. This means that a user cannot successfully supply a path that contains \"..\" to traverse outside of your application's virtual directory hierarchy. Any attempt to do this results in an exception of type HttpException.",
      "If you use server controls, you can use the Control.MapPathSecure method to retrieve the physical path to which the virtual path is mapped. Control.MapPathSecure uses code access security and throws an HttpException if the server control does not have permissions to read the resulting mapped file. For more information, see Control.MapPathSecure in the .NET Framework SDK documentation.",
      "Adapted from Microsoft patterns & practices guidance."
    ],
    "h2": [
      "Validating File Paths",
      "Using MapPath to Prevent Cross Application Mapping"
    ],
    "ul": [
      "If you must accept file names as input, use the full name of the file by using System.IO.Path.GetFileName. If you must accept file paths as input, use the full file path by using System.IO.Path.GetFullPath."
    ],
    "li": [
      "If you must accept file names as input, use the full name of the file by using System.IO.Path.GetFileName.",
      "If you must accept file paths as input, use the full file path by using System.IO.Path.GetFullPath."
    ],
    "b": [
      "System.IO.Path.GetFileName",
      "System.IO.Path.GetFullPath",
      "MapPath",
      "Request.MapPath",
      "bool",
      "false",
      "\"..\"",
      "HttpException",
      "Control.MapPathSecure",
      "Control.MapPathSecure",
      "HttpException",
      "Control.MapPathSecure"
    ],
    "pre": [
      "try&#123;&nbsp; string mappedPath = Request.MapPath( inputPath.Text, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Request.ApplicationPath, false);&#125;catch (HttpException)&#123;&nbsp; // Cross-application mapping attempted&#125;"
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "hr": [
      ""
    ]
  },
  "links": [],
  "html": "<h1>What to Do</h1>\n  <p>Avoid writing code that accepts file or path input from the caller. Instead, use fixed file names and locations when your code reads and writes data.</p>\n  <h1>Why</h1>\n  <p>Accepting file names or paths from users can result in attackers coercing your application into accessing arbitrary files and resources. </p>\n  <h1>When</h1>\n  <p>You should never accept a file name or path from a user under any circumstances.</p>\n  <h1>How</h1>\n  <p>If you need to store a file from a user, store it in a database or other non-filesystem data store.&amp;nbsp; Keep the name the user provided as a reference to the file, but do not use it as any form of canonical name.</p>\n  <p>If your application has to accept input file names, file paths, or URL paths, you need to validate that the path is in the correct format and that it points to a valid location within the context of your application. Failure to do this can result in attackers persuading your application into accessing arbitrary files and resources. </p>\n  <h2>Validating File Paths</h2>\n  <p>To prevent a malicious user manipulating your code's file operations, avoid writing code that accepts user-supplied file or path input. For example: </p>\n  <ul>\n    <li>If you must accept file names as input, use the full name of the file by using <b>System.IO.Path.GetFileName</b>. <li>If you must accept file paths as input, use the full file path by using <b>System.IO.Path.GetFullPath</b>.</li></li>\n  </ul>\n  <h2>Using MapPath to Prevent Cross Application Mapping</h2>\n  <p>If you use <b>MapPath</b> to map a supplied virtual path to a physical path on the server, use the overload of <b>Request.MapPath</b> that accepts a <b>bool</b> parameter so that you can prevent cross-application mapping. The following code example shows this technique.</p>\n  <pre>try<br />&amp;#123;<br />&amp;nbsp; string mappedPath = Request.MapPath( inputPath.Text, <br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Request.ApplicationPath, false);<br />&amp;#125;<br />catch (HttpException)<br />&amp;#123;<br />&amp;nbsp; // Cross-application mapping attempted<br />&amp;#125;   </pre>\n  <p>The final <b>false</b> parameter prevents cross-application mapping. This means that a user cannot successfully supply a path that contains <b>\"..\"</b> to traverse outside of your application's virtual directory hierarchy. Any attempt to do this results in an exception of type <b>HttpException</b>.</p>\n  <p>If you use server controls, you can use the <b>Control.MapPathSecure</b> method to retrieve the physical path to which the virtual path is mapped. <b>Control.MapPathSecure</b> uses code access security and throws an <b>HttpException</b> if the server control does not have permissions to read the resulting mapped file. For more information, see <b>Control.MapPathSecure</b> in the .NET Framework SDK documentation.</p>\n  <hr />\n  <p>Adapted from Microsoft patterns &amp; practices guidance.</p>"
}