{
  "id": "2ad6c81b-2b98-4039-9ada-ca31b6433fb8",
  "checksum": "1209a1170f49d5558a27769b07c491895bc14a27",
  "words": {
    "0": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "1": [
      "ul",
      "li",
      "div",
      "ul",
      "li",
      "h1",
      "p",
      "p",
      "b",
      "li",
      "blockquote",
      "ol",
      "li"
    ],
    "2": [
      "ul",
      "li",
      "div",
      "ul",
      "li",
      "h1",
      "p",
      "p",
      "b",
      "blockquote"
    ],
    "3": [
      "ul",
      "li",
      "div",
      "ul",
      "li",
      "h1"
    ],
    "60": [
      "ul",
      "li"
    ],
    "2000": [
      "p",
      "p",
      "ol",
      "li",
      "blockquote",
      "p",
      "ol",
      "li"
    ],
    "2003": [
      "ul",
      "li",
      "p",
      "p",
      "ol",
      "li",
      "blockquote",
      "p",
      "p",
      "ol",
      "li",
      "h2",
      "ol",
      "li",
      "b"
    ],
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "div",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "blockquote",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "li",
      "p",
      "ul",
      "li",
      "h1",
      "p",
      "p",
      "p",
      "b",
      "p",
      "p",
      "h3",
      "ol",
      "li",
      "h3",
      "p",
      "p",
      "p",
      "p",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "blockquote",
      "blockquote",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "p",
      "p",
      "p",
      "blockquote",
      "h2",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "b",
      "li",
      "li",
      "li",
      "b",
      "p",
      "p",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "h2",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "blockquote",
      "li",
      "li",
      "li",
      "b",
      "li",
      "li",
      "li",
      "b",
      "p",
      "p",
      "li",
      "li",
      "p",
      "blockquote",
      "blockquote",
      "blockquote",
      "h2",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "div",
      "div",
      "pre",
      "pre",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "li",
      "li",
      "li",
      "p",
      "h2",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "h2",
      "h2",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "h3",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "h3",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "h3",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "b",
      "li",
      "li",
      "li",
      "li",
      "b",
      "h3",
      "p",
      "ul",
      "li",
      "blockquote",
      "p",
      "p",
      "h2",
      "ol",
      "li",
      "h2",
      "h2",
      "title"
    ],
    "internet": [
      "ul",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "information": [
      "ul",
      "li",
      "p",
      "p",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "services": [
      "ul",
      "li",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "p",
      "blockquote",
      "ol",
      "li",
      "ul",
      "li",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "li",
      "b",
      "li",
      "b",
      "li",
      "li",
      "b",
      "li",
      "b",
      "li",
      "b",
      "li",
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "li",
      "b",
      "li",
      "b",
      "li",
      "ul",
      "li"
    ],
    "or": [
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "ul",
      "li",
      "div",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "ul",
      "li",
      "h1",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "li",
      "b",
      "li",
      "li",
      "b",
      "li",
      "li",
      "li",
      "p",
      "li",
      "b",
      "li",
      "b",
      "blockquote",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "p",
      "li",
      "p",
      "b",
      "p",
      "b",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "li",
      "b",
      "blockquote",
      "blockquote"
    ],
    "latermicrosoft": [
      "ul"
    ],
    "windows": [
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "div",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "p",
      "ul",
      "li",
      "h1",
      "p",
      "p",
      "h2",
      "p",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "b",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "h2",
      "ol",
      "li",
      "b"
    ],
    "server": [
      "ul",
      "li",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "blockquote",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "p",
      "p",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "blockquote",
      "blockquote",
      "ol",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p",
      "h2",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "h2",
      "p",
      "h3",
      "h2",
      "p",
      "h3",
      "ol",
      "li",
      "p",
      "p",
      "p",
      "p",
      "h3",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "h3",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "p",
      "p",
      "ol",
      "li",
      "h2",
      "ol",
      "li",
      "b"
    ],
    "later operating": [
      "ul",
      "li"
    ],
    "system": [
      "ul",
      "li",
      "p",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "later": [
      "li",
      "p"
    ],
    "microsoft": [
      "li",
      "p",
      "p",
      "p",
      "ol",
      "li",
      "li",
      "p"
    ],
    "summary": [
      "h1",
      "ul",
      "li",
      "div",
      "h1"
    ],
    "this": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "blockquote",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "p",
      "blockquote",
      "blockquote",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "blockquote",
      "li",
      "b",
      "li",
      "b",
      "li",
      "p",
      "li",
      "li",
      "blockquote",
      "li",
      "b",
      "li",
      "b",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "li",
      "li",
      "li",
      "b",
      "li"
    ],
    "how": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "blockquote",
      "title"
    ],
    "shows": [
      "p",
      "p"
    ],
    "you": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "ul",
      "li",
      "b",
      "li",
      "b",
      "p",
      "p",
      "p",
      "blockquote",
      "blockquote",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "p",
      "p",
      "p",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "blockquote",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "p",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "li",
      "p",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "p",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "configure": [
      "p",
      "p",
      "ul",
      "li",
      "div",
      "ul",
      "li",
      "h2",
      "p",
      "h3",
      "h1",
      "p",
      "h2",
      "h2",
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "ol",
      "li",
      "blockquote",
      "p",
      "p",
      "h3",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "h3",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "h3",
      "h3",
      "ul",
      "li",
      "blockquote"
    ],
    "and": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "div",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "a",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "li",
      "ol",
      "li",
      "p",
      "blockquote",
      "ul",
      "li",
      "blockquote",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "li",
      "li",
      "h1",
      "p",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "h2",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "h3",
      "ol",
      "li",
      "p",
      "h3",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "b",
      "li",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "li",
      "title"
    ],
    "use": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "div",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "b",
      "li",
      "p",
      "ul",
      "li",
      "h1",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "b",
      "p",
      "p",
      "b",
      "b",
      "li",
      "li",
      "li",
      "li",
      "b",
      "p",
      "p",
      "b",
      "b",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "b",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "b",
      "b",
      "p",
      "ol",
      "li",
      "title"
    ],
    "protocol": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "div",
      "ul",
      "li",
      "p",
      "h2",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "b",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "blockquote",
      "p",
      "p",
      "h2",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "b",
      "p",
      "p",
      "b",
      "h2",
      "li",
      "li",
      "li",
      "b",
      "p",
      "p",
      "b",
      "h1",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "p",
      "li",
      "h2",
      "p",
      "b",
      "ul",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "p",
      "title"
    ],
    "transition": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "div",
      "ul",
      "li",
      "p",
      "h2",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "b",
      "p",
      "ul",
      "li",
      "p",
      "ul",
      "li",
      "blockquote",
      "p",
      "p",
      "h2",
      "ol",
      "li",
      "p",
      "h2",
      "li",
      "p",
      "h1",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "p",
      "li",
      "h2",
      "p",
      "b",
      "ul",
      "li",
      "ol",
      "li",
      "p",
      "title"
    ],
    "constrained": [
      "p",
      "p",
      "p",
      "i",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "div",
      "li",
      "div",
      "ul",
      "li",
      "h2",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "h1",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "li",
      "li",
      "p",
      "h2",
      "ol",
      "li",
      "h1",
      "p",
      "p",
      "b",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "h3",
      "ol",
      "ol",
      "li",
      "li",
      "h3",
      "ul",
      "li",
      "p",
      "ol",
      "li",
      "title"
    ],
    "delegation": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "i",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "div",
      "li",
      "div",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p",
      "h2",
      "p",
      "p",
      "p",
      "blockquote",
      "p",
      "p",
      "ul",
      "li",
      "h1",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "b",
      "b",
      "li",
      "li",
      "li",
      "li",
      "b",
      "b",
      "b",
      "li",
      "li",
      "b",
      "p",
      "li",
      "blockquote",
      "b",
      "li",
      "li",
      "li",
      "li",
      "b",
      "b",
      "b",
      "li",
      "li",
      "b",
      "p",
      "h2",
      "ol",
      "li",
      "h1",
      "p",
      "p",
      "b",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "h3",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "b",
      "b",
      "li",
      "li",
      "b",
      "h3",
      "ul",
      "li",
      "p",
      "ol",
      "li",
      "title"
    ],
    "allow": [
      "p",
      "ul",
      "li",
      "p",
      "blockquote",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p"
    ],
    "your": [
      "p",
      "p",
      "p",
      "ul",
      "li",
      "div",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "b",
      "li",
      "li",
      "li",
      "b",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "li",
      "p",
      "ol",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "li",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "p",
      "h3",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "h3",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "li",
      "blockquote",
      "blockquote"
    ],
    "aspnet": [
      "p",
      "p",
      "p",
      "p",
      "a",
      "p",
      "p",
      "b",
      "h2",
      "p",
      "p",
      "p",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "li",
      "blockquote",
      "li",
      "p",
      "p",
      "h3",
      "ol",
      "li",
      "p",
      "ol",
      "li",
      "title"
    ],
    "application": [
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "b",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "ul",
      "li",
      "blockquote",
      "p",
      "p",
      "p",
      "p",
      "p",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "h2",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "h3",
      "ol",
      "li",
      "h2",
      "p",
      "p",
      "h3",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "h3",
      "ul",
      "li",
      "blockquote"
    ],
    "access": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "b",
      "li",
      "div",
      "pre",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "blockquote",
      "p",
      "ol",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "ol",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p"
    ],
    "network": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "div",
      "pre",
      "ul",
      "li",
      "blockquote",
      "p",
      "p",
      "ol",
      "li",
      "ol",
      "li",
      "ul",
      "li"
    ],
    "resources": [
      "p",
      "p",
      "ul",
      "li",
      "div",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "div",
      "pre",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "blockquote",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "while": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li"
    ],
    "impersonating": [
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "the": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "div",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "li",
      "h1",
      "p",
      "p",
      "p",
      "b",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "h3",
      "ol",
      "li",
      "h2",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "p",
      "p",
      "blockquote",
      "blockquote",
      "blockquote",
      "h2",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "li",
      "li",
      "li",
      "li",
      "li",
      "b",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "li",
      "li",
      "li",
      "b",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "blockquote",
      "h2",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "b",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "div",
      "div",
      "pre",
      "pre",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "h3",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "h3",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "p",
      "h2",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "h2",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li"
    ],
    "original": [
      "p",
      "ul",
      "li",
      "div",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "ul",
      "li",
      "h1",
      "h2",
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "div",
      "pre",
      "pre",
      "ol",
      "li",
      "p",
      "p",
      "b",
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li"
    ],
    "caller": [
      "p",
      "ul",
      "li",
      "div",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "h1",
      "h2",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "pre",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "b",
      "ul",
      "ul",
      "li",
      "li",
      "ol",
      "li"
    ],
    "operating": [
      "p",
      "p",
      "blockquote",
      "ul",
      "li",
      "ol",
      "li",
      "blockquote",
      "ol",
      "li"
    ],
    "supports": [
      "p"
    ],
    "however": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "downstream": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p"
    ],
    "servers": [
      "p",
      "p",
      "p",
      "p",
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "p"
    ],
    "cannot": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "be": [
      "p",
      "ul",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "ol",
      "li",
      "li",
      "blockquote"
    ],
    "limited": [
      "p"
    ],
    "by": [
      "p",
      "p",
      "p",
      "ul",
      "li",
      "blockquote",
      "p",
      "ol",
      "li",
      "blockquote",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "li",
      "p",
      "p"
    ],
    "systems": [
      "p"
    ],
    "provides": [
      "p"
    ],
    "a": [
      "p",
      "p",
      "ul",
      "li",
      "div",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "h1",
      "p",
      "p",
      "p",
      "b",
      "h3",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "h3",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "h2",
      "p",
      "p",
      "div",
      "div",
      "pre",
      "pre",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "p",
      "p",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "h2",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "p",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "div",
      "div",
      "pre",
      "pre",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ol",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "li",
      "blockquote",
      "p",
      "ol",
      "li"
    ],
    "more": [
      "p",
      "p",
      "p"
    ],
    "secure": [
      "p",
      "p",
      "p",
      "a",
      "a"
    ],
    "form": [
      "p",
      "h3",
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "pre",
      "p",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "of": [
      "p",
      "p",
      "ul",
      "li",
      "div",
      "p",
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "h1",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "ol",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "li"
    ],
    "called": [
      "p",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote",
      "p"
    ],
    "with": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "p",
      "p",
      "ul",
      "li",
      "ol",
      "li",
      "p",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote",
      "li",
      "p",
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "ol",
      "li",
      "p",
      "p",
      "p",
      "b",
      "b"
    ],
    "can": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "blockquote",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "b",
      "li",
      "li",
      "b",
      "p",
      "blockquote",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "ol",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "li"
    ],
    "active": [
      "p",
      "p",
      "blockquote",
      "ul",
      "li",
      "ul",
      "li",
      "blockquote",
      "p",
      "ol",
      "li",
      "li",
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "h2",
      "p",
      "p",
      "ol",
      "li",
      "b",
      "ul",
      "li",
      "b",
      "ol",
      "li",
      "b",
      "ol",
      "ol",
      "li",
      "li",
      "b"
    ],
    "directory®": [
      "p"
    ],
    "directory": [
      "p",
      "p",
      "blockquote",
      "ul",
      "li",
      "b",
      "blockquote",
      "ul",
      "li",
      "blockquote",
      "p",
      "ol",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "li",
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "h2",
      "p",
      "p",
      "ol",
      "li",
      "b",
      "ul",
      "li",
      "b",
      "ol",
      "li",
      "b",
      "ol",
      "ol",
      "li",
      "li",
      "b"
    ],
    "service": [
      "p",
      "ul",
      "li",
      "div",
      "p",
      "p",
      "ul",
      "li",
      "h1",
      "p",
      "blockquote",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "blockquote",
      "li",
      "li",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "div",
      "pre",
      "h3",
      "ol",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote"
    ],
    "restrict": [
      "p",
      "ul",
      "li",
      "ol",
      "li",
      "li",
      "p"
    ],
    "that": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "p",
      "div",
      "pre",
      "blockquote",
      "p",
      "ol",
      "li",
      "p",
      "li",
      "blockquote",
      "blockquote",
      "h2",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote"
    ],
    "impersonated": [
      "p",
      "p",
      "p"
    ],
    "identity": [
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "b",
      "div",
      "div",
      "pre",
      "pre",
      "p",
      "h2",
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "div",
      "pre",
      "pre",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "in": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "p",
      "ul",
      "ul",
      "li",
      "blockquote",
      "li",
      "p",
      "p",
      "ol",
      "li",
      "ol",
      "li",
      "p",
      "p",
      "div",
      "pre",
      "blockquote",
      "blockquote",
      "blockquote",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "blockquote",
      "li",
      "li",
      "p",
      "p",
      "p",
      "ol",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "li",
      "p",
      "ol",
      "li",
      "ol",
      "li",
      "title"
    ],
    "requires": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "kerberos": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "div",
      "pre",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "b",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "b",
      "ol",
      "li",
      "div",
      "pre",
      "ul",
      "ul",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "b"
    ],
    "authentication": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "a",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "b",
      "blockquote",
      "li",
      "b",
      "p",
      "p",
      "h2",
      "p",
      "p",
      "p",
      "h3",
      "ol",
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "li",
      "div",
      "pre",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "b",
      "p",
      "p",
      "p",
      "p",
      "b",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "b",
      "p",
      "p",
      "p",
      "p",
      "b",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "pre",
      "li",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "b",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "div",
      "pre",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "div",
      "pre",
      "li",
      "ol",
      "li"
    ],
    "if": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "b",
      "li",
      "li",
      "b",
      "p",
      "div",
      "div",
      "pre",
      "pre",
      "blockquote",
      "p",
      "p",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "p",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "ol",
      "li"
    ],
    "authenticate": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "ol",
      "li",
      "ul",
      "li",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "its": [
      "p",
      "p",
      "ul",
      "li"
    ],
    "callers": [
      "p",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "switch": [
      "p",
      "ul",
      "li",
      "p",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "from": [
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "b",
      "div",
      "div",
      "pre",
      "pre",
      "blockquote",
      "ul",
      "li",
      "ol",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "p",
      "ol",
      "li",
      "p"
    ],
    "an": [
      "p",
      "p",
      "ul",
      "li",
      "div",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "blockquote",
      "ul",
      "li",
      "h1",
      "p",
      "p",
      "b",
      "b",
      "p",
      "div",
      "pre",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "ol",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "li",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "p",
      "li",
      "p",
      "p",
      "blockquote",
      "blockquote",
      "ol",
      "li",
      "b"
    ],
    "alternate": [
      "p",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "non-windows": [
      "p",
      "ul",
      "li",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "p"
    ],
    "mode": [
      "p",
      "p"
    ],
    "such": [
      "p",
      "p",
      "p"
    ],
    "as": [
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "p",
      "ol",
      "li",
      "ul",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "li",
      "blockquote",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "li",
      "p",
      "ol",
      "li",
      "blockquote",
      "p",
      "p",
      "ul",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "forms": [
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "b",
      "blockquote",
      "h2",
      "p",
      "p",
      "h3",
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li",
      "p",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li"
    ],
    "certificate": [
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "b"
    ],
    "then": [
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "li",
      "li",
      "ul",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "for": [
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "div",
      "li",
      "div",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "blockquote",
      "ul",
      "ul",
      "li",
      "li",
      "h1",
      "p",
      "h2",
      "h3",
      "h3",
      "h2",
      "p",
      "div",
      "pre",
      "blockquote",
      "blockquote",
      "h1",
      "p",
      "p",
      "blockquote",
      "blockquote",
      "h2",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "blockquote",
      "b",
      "li",
      "li",
      "li",
      "b",
      "b",
      "li",
      "b",
      "li",
      "h2",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "blockquote",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "li",
      "li",
      "b",
      "b",
      "li",
      "b",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "ol",
      "li",
      "h3",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "b",
      "li",
      "li",
      "li",
      "b",
      "h3",
      "p",
      "ul",
      "li",
      "blockquote",
      "blockquote",
      "ol",
      "li"
    ],
    "demonstration": [
      "p"
    ],
    "purposes": [
      "p"
    ],
    "uses": [
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "b",
      "blockquote",
      "li",
      "li",
      "b",
      "p",
      "p",
      "div",
      "pre",
      "h2",
      "ol",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "ul",
      "li",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "practice": [
      "p"
    ],
    "would": [
      "p"
    ],
    "logonuser": [
      "p",
      "b",
      "ul",
      "ul",
      "li",
      "li",
      "b",
      "b"
    ],
    "api": [
      "p",
      "ul",
      "li"
    ],
    "because": [
      "p",
      "p",
      "ul",
      "li",
      "blockquote",
      "blockquote",
      "ol",
      "li"
    ],
    "already": [
      "p"
    ],
    "obtained": [
      "p",
      "div",
      "pre"
    ],
    "username": [
      "p",
      "i",
      "i",
      "i"
    ],
    "password": [
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "b"
    ],
    "example": [
      "p",
      "p",
      "p",
      "ul",
      "li",
      "blockquote",
      "p",
      "ol",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p"
    ],
    "production": [
      "p"
    ],
    "scenario": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "is": [
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "p",
      "p",
      "div",
      "pre",
      "blockquote",
      "blockquote",
      "blockquote",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "p",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "b",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "ul",
      "li",
      "blockquote",
      "ol",
      "li"
    ],
    "where": [
      "p",
      "p",
      "ul",
      "li",
      "blockquote",
      "p",
      "b",
      "ol",
      "li"
    ],
    "certificates": [
      "p",
      "ul",
      "li"
    ],
    "users": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "li",
      "b",
      "li",
      "li",
      "b",
      "li",
      "b",
      "li",
      "b",
      "blockquote",
      "blockquote",
      "ul",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "b",
      "li",
      "b",
      "ul",
      "li",
      "b",
      "ol",
      "li",
      "b",
      "ol",
      "li"
    ],
    "want": [
      "p",
      "ol",
      "li",
      "blockquote"
    ],
    "map": [
      "p",
      "ul",
      "li"
    ],
    "them": [
      "p",
      "blockquote"
    ],
    "existing": [
      "p",
      "ol",
      "li",
      "ul",
      "li"
    ],
    "accounts": [
      "p",
      "p",
      "blockquote",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote",
      "ol",
      "li"
    ],
    "contents": [
      "h1"
    ],
    "objectives": [
      "ul",
      "li",
      "div",
      "h1"
    ],
    "overview": [
      "ul",
      "li",
      "div",
      "h1"
    ],
    "scenarios": [
      "ul",
      "li",
      "div",
      "h2",
      "p",
      "ol",
      "li"
    ],
    "steps": [
      "ul",
      "li",
      "div",
      "h1",
      "p",
      "p"
    ],
    "step": [
      "ul",
      "ul",
      "ul",
      "li",
      "div",
      "li",
      "div",
      "li",
      "div",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "h1",
      "h1",
      "p",
      "li",
      "blockquote",
      "h1",
      "p"
    ],
    "s4u": [
      "ul",
      "li",
      "div",
      "p",
      "ul",
      "li",
      "h1",
      "p",
      "b",
      "p",
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "logon": [
      "ul",
      "li",
      "div",
      "ul",
      "li",
      "h1",
      "p",
      "b",
      "div",
      "pre",
      "ol",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "ul",
      "li",
      "p",
      "b"
    ],
    "create": [
      "ul",
      "li",
      "div",
      "ul",
      "li",
      "h1",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "h3",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "blockquote",
      "li",
      "blockquote",
      "blockquote",
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "ol",
      "li"
    ],
    "token": [
      "ul",
      "li",
      "div",
      "ul",
      "ul",
      "li",
      "li",
      "ul",
      "li",
      "h1",
      "h2",
      "p",
      "p",
      "div",
      "pre",
      "h3",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "b",
      "li",
      "li",
      "li",
      "li",
      "b",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "machine": [
      "ul",
      "li",
      "div",
      "p",
      "ul",
      "li",
      "h1",
      "p",
      "h2",
      "p",
      "blockquote"
    ],
    "account": [
      "ul",
      "li",
      "div",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "h1",
      "p",
      "p",
      "p",
      "blockquote",
      "blockquote",
      "blockquote",
      "h2",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "h2",
      "p",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote"
    ],
    "implement": [
      "ul",
      "li",
      "div",
      "p",
      "ul",
      "li",
      "h1",
      "p",
      "h2"
    ],
    "test": [
      "ul",
      "li",
      "div",
      "ul",
      "li",
      "h1",
      "h2"
    ],
    "using": [
      "ul",
      "li",
      "div",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "b",
      "b",
      "div",
      "pre",
      "p",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "h1",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "li",
      "blockquote"
    ],
    "through": [
      "ul",
      "li",
      "div",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "h1",
      "p",
      "p",
      "b"
    ],
    "multiple": [
      "ul",
      "li",
      "div",
      "ul",
      "li",
      "h1",
      "p",
      "p",
      "b"
    ],
    "tiers": [
      "ul",
      "li",
      "div",
      "ul",
      "li",
      "h1",
      "p",
      "p",
      "b"
    ],
    "domain": [
      "ul",
      "li",
      "div",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "div",
      "pre",
      "blockquote",
      "p",
      "p",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "li",
      "h2",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "i",
      "i",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "div",
      "pre",
      "pre",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "ul",
      "li",
      "blockquote",
      "h1",
      "p",
      "p",
      "h2",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "h2",
      "ol",
      "ol",
      "b",
      "i",
      "li",
      "b",
      "li",
      "b"
    ],
    "functional": [
      "ul",
      "li",
      "div",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "h1",
      "p",
      "h2",
      "ol",
      "ol",
      "li",
      "li",
      "h2",
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "b"
    ],
    "levels": [
      "ul",
      "li",
      "div",
      "h1"
    ],
    "additional": [
      "ul",
      "li",
      "div",
      "p"
    ],
    "specific": [
      "ul",
      "li"
    ],
    "pass": [
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "ol",
      "li"
    ],
    "web": [
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "h3",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "h3",
      "ol",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "li",
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "ol",
      "li",
      "p",
      "h2",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "h2",
      "p",
      "p",
      "h3",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "div",
      "pre",
      "h3",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "p",
      "h3",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "blockquote"
    ],
    "database": [
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "b",
      "p",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "div",
      "pre",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "p",
      "h2",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "ul",
      "li"
    ],
    "when": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "ul",
      "li",
      "ul",
      "li"
    ],
    "impersonates": [
      "p",
      "ol",
      "li",
      "ul",
      "li"
    ],
    "it": [
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "blockquote",
      "ul",
      "li",
      "ol",
      "li",
      "ul",
      "li"
    ],
    "accesses": [
      "p",
      "p"
    ],
    "security": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "b",
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li"
    ],
    "context": [
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li"
    ],
    "authenticated": [
      "p",
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "b",
      "ul",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "user": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "p",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "blockquote",
      "ul",
      "li",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "li",
      "b",
      "li",
      "b",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "b",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "i",
      "i",
      "ul",
      "li",
      "ol",
      "li",
      "b"
    ],
    "only": [
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "li",
      "li",
      "b",
      "p",
      "p",
      "b",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote",
      "li",
      "b",
      "li",
      "li",
      "li",
      "b",
      "p",
      "p",
      "b",
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "li",
      "li",
      "b",
      "b"
    ],
    "local": [
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "blockquote",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "remote": [
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "p",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "must": [
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "p",
      "p",
      "blockquote",
      "ol",
      "ol",
      "li",
      "blockquote",
      "li",
      "p",
      "li",
      "p",
      "blockquote",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "ol",
      "li",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "ol",
      "li"
    ],
    "caller's": [
      "p",
      "p",
      "b",
      "h2",
      "ol",
      "li",
      "div",
      "pre",
      "p"
    ],
    "layers": [
      "p"
    ],
    "does": [
      "p",
      "blockquote",
      "ol",
      "li",
      "blockquote",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li"
    ],
    "not": [
      "p",
      "div",
      "pre",
      "blockquote",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "li",
      "blockquote",
      "li",
      "b",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "b",
      "ol",
      "ol",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "li",
      "blockquote"
    ],
    "non-kerberos": [
      "p",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "mechanism": [
      "p",
      "p",
      "ul",
      "li",
      "p",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "on": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "ol",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "li",
      "blockquote",
      "li",
      "li",
      "blockquote",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "p",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "ul",
      "li",
      "ol",
      "li"
    ],
    "many": [
      "p",
      "p",
      "blockquote"
    ],
    "situations—for": [
      "p"
    ],
    "site": [
      "p",
      "h3",
      "ol",
      "li",
      "h3",
      "p",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "over": [
      "p",
      "p"
    ],
    "internet—you": [
      "p"
    ],
    "firewalls": [
      "p"
    ],
    "prevent": [
      "p"
    ],
    "client": [
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "b",
      "li",
      "li",
      "ul",
      "li",
      "blockquote"
    ],
    "computer": [
      "p",
      "blockquote",
      "p",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "b",
      "li",
      "li",
      "li",
      "b",
      "b",
      "li",
      "b",
      "li",
      "li",
      "li",
      "li",
      "b",
      "p",
      "ol",
      "li",
      "i",
      "i",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li"
    ],
    "directly": [
      "p",
      "ul",
      "li",
      "p"
    ],
    "communicating": [
      "p"
    ],
    "controller": [
      "p",
      "p"
    ],
    "instead": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "ul",
      "li"
    ],
    "another": [
      "p"
    ],
    "approach": [
      "p",
      "ul",
      "li",
      "blockquote"
    ],
    "extranet": [
      "p"
    ],
    "has": [
      "p",
      "ol",
      "li",
      "ul",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "li"
    ],
    "feature": [
      "p"
    ],
    "permits": [
      "p"
    ],
    "applications": [
      "p",
      "p",
      "p",
      "a",
      "ul",
      "li"
    ],
    "but": [
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "ul",
      "li",
      "ol",
      "li"
    ],
    "still": [
      "p"
    ],
    "allows": [
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "ul",
      "li"
    ],
    "require": [
      "p"
    ],
    "auditing": [
      "p",
      "p"
    ],
    "track": [
      "p",
      "p"
    ],
    "backend": [
      "p"
    ],
    "note": [
      "p",
      "b",
      "b",
      "p",
      "b",
      "b",
      "b",
      "b",
      "b",
      "b",
      "b",
      "b",
      "b",
      "ol",
      "li",
      "p",
      "b",
      "ol",
      "li",
      "b",
      "b"
    ],
    "brings": [
      "p"
    ],
    "number": [
      "p",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "advantages": [
      "p",
      "p"
    ],
    "also": [
      "p",
      "ol",
      "li",
      "p"
    ],
    "some": [
      "p",
      "blockquote"
    ],
    "disadvantages": [
      "p",
      "p"
    ],
    "include": [
      "p",
      "p",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "ability": [
      "p",
      "p"
    ],
    "back-end": [
      "p"
    ],
    "fine-grained": [
      "p",
      "p"
    ],
    "controls": [
      "p",
      "p",
      "ol",
      "li",
      "blockquote"
    ],
    "databases": [
      "p"
    ],
    "per-user": [
      "p"
    ],
    "basis": [
      "p"
    ],
    "administration": [
      "p",
      "p"
    ],
    "required": [
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li"
    ],
    "administer": [
      "p"
    ],
    "reduced": [
      "p",
      "p"
    ],
    "scalability": [
      "p",
      "p"
    ],
    "trusted": [
      "p",
      "p",
      "ul",
      "li",
      "blockquote"
    ],
    "subsystem": [
      "p"
    ],
    "model": [
      "p",
      "p"
    ],
    "appropriate": [
      "p",
      "p",
      "p"
    ],
    "authenticates": [
      "p"
    ],
    "behalf": [
      "p",
      "ul",
      "li",
      "blockquote"
    ],
    "results": [
      "p"
    ],
    "improved": [
      "p"
    ],
    "selecting": [
      "p"
    ],
    "see": [
      "p",
      "p",
      "ul",
      "li",
      "ol",
      "li",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "building": [
      "p",
      "a"
    ],
    "authorization": [
      "p",
      "a"
    ],
    "communication": [
      "p",
      "a"
    ],
    "relies": [
      "p"
    ],
    "two": [
      "p",
      "ol",
      "li"
    ],
    "extensions": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "both": [
      "p"
    ],
    "are": [
      "p",
      "p",
      "p",
      "blockquote",
      "ul",
      "li",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "li",
      "li",
      "p",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote",
      "li",
      "li",
      "p",
      "p",
      "ol",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "li",
      "blockquote"
    ],
    "implemented": [
      "p"
    ],
    "these": [
      "p",
      "p"
    ],
    "service-for-user-to-self": [
      "ul",
      "li",
      "b"
    ],
    "s4u2self),": [
      "ul",
      "li"
    ],
    "which": [
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p",
      "ul",
      "li",
      "blockquote",
      "blockquote",
      "ol",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote",
      "li",
      "ul",
      "li"
    ],
    "obtain": [
      "ul",
      "li",
      "h2",
      "p",
      "div",
      "pre",
      "p",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote",
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li"
    ],
    "supplying": [
      "ul",
      "li"
    ],
    "principal": [
      "ul",
      "li",
      "blockquote",
      "ol",
      "li",
      "li",
      "blockquote"
    ],
    "name": [
      "ul",
      "li",
      "ul",
      "li",
      "p",
      "div",
      "div",
      "pre",
      "pre",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote",
      "li",
      "blockquote",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "b",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "li"
    ],
    "upn)": [
      "ul",
      "li"
    ],
    "without": [
      "ul",
      "li",
      "div",
      "pre",
      "ol",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "ul",
      "li",
      "p",
      "b"
    ],
    "service-for-user-to-proxy": [
      "ul",
      "li",
      "b"
    ],
    "s4u2proxy),": [
      "ul",
      "li"
    ],
    "administrator": [
      "ul",
      "li",
      "ol",
      "li"
    ],
    "control": [
      "ul",
      "li",
      "ol",
      "li",
      "b",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "exactly": [
      "ul",
      "li",
      "p"
    ],
    "accessed": [
      "ul",
      "li",
      "blockquote",
      "ol",
      "li",
      "li"
    ],
    "s4u2self": [
      "ul",
      "li",
      "p"
    ],
    "s4u2self)": [
      "b"
    ],
    "s4u2proxy)": [
      "b"
    ],
    "about": [
      "p",
      "ol",
      "li",
      "p",
      "blockquote"
    ],
    "related": [
      "p"
    ],
    "s4u)": [
      "p"
    ],
    "exploring": [
      "p"
    ],
    "unconstrained": [
      "p"
    ],
    "configured": [
      "p",
      "blockquote",
      "ol",
      "li",
      "p",
      "p"
    ],
    "any": [
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "p",
      "b",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote",
      "li",
      "li",
      "b",
      "p",
      "b",
      "ol",
      "ol",
      "li",
      "li",
      "b"
    ],
    "user's": [
      "p",
      "p",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "p",
      "li",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "pre",
      "ol",
      "li"
    ],
    "represents": [
      "p"
    ],
    "potential": [
      "p"
    ],
    "threat": [
      "p"
    ],
    "particularly": [
      "p"
    ],
    "compromised": [
      "p"
    ],
    "address": [
      "p",
      "blockquote"
    ],
    "issue": [
      "p"
    ],
    "later includes": [
      "p"
    ],
    "administrators": [
      "p"
    ],
    "specify": [
      "p",
      "ol",
      "li",
      "li"
    ],
    "note   the": [
      "blockquote",
      "ul",
      "li",
      "blockquote"
    ],
    "list": [
      "blockquote",
      "blockquote",
      "blockquote",
      "ul",
      "li",
      "blockquote",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "maintained": [
      "blockquote"
    ],
    "referred": [
      "blockquote"
    ],
    "a2d2": [
      "blockquote",
      "ul",
      "li",
      "blockquote",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "solve": [
      "p"
    ],
    "following": [
      "p",
      "p",
      "ol",
      "li",
      "ol",
      "li",
      "p",
      "p",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "li"
    ],
    "common": [
      "p",
      "ol",
      "li",
      "blockquote"
    ],
    "problems": [
      "p"
    ],
    "external": [
      "ul",
      "li"
    ],
    "clients": [
      "ul",
      "ul",
      "li",
      "li",
      "p"
    ],
    "transitioning": [
      "ul",
      "li"
    ],
    "kerberos-authenticated": [
      "ul",
      "li"
    ],
    "their": [
      "ul",
      "ul",
      "li",
      "li"
    ],
    "identities": [
      "ul",
      "li"
    ],
    "used": [
      "p",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "consider": [
      "p",
      "ul",
      "li",
      "b"
    ],
    "entered": [
      "ul",
      "li"
    ],
    "login": [
      "ul",
      "li",
      "h3",
      "ol",
      "li",
      "b",
      "p",
      "blockquote",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "b",
      "ol",
      "li"
    ],
    "page": [
      "ul",
      "li",
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "ol",
      "li"
    ],
    "call": [
      "ul",
      "li",
      "p",
      "b",
      "div",
      "pre",
      "p",
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "avoid": [
      "ul",
      "li",
      "ul",
      "li",
      "blockquote",
      "ol",
      "li",
      "ul",
      "li"
    ],
    "simplicityif": [
      "ul"
    ],
    "look": [
      "ul",
      "li"
    ],
    "up": [
      "ul",
      "li",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "based": [
      "ul",
      "li"
    ],
    "log": [
      "ul",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "simplicity": [
      "li",
      "blockquote"
    ],
    "lient": [
      "b"
    ],
    "follow": [
      "p",
      "p"
    ],
    "have": [
      "p",
      "blockquote",
      "ul",
      "li",
      "blockquote",
      "ol",
      "li",
      "blockquote",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote",
      "li",
      "blockquote",
      "blockquote"
    ],
    "connect": [
      "p"
    ],
    "outside": [
      "p"
    ],
    "non-trusted": [
      "p"
    ],
    "internet,": [
      "p"
    ],
    "integrated": [
      "p",
      "p",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "shown": [
      "p",
      "ol",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "p",
      "ol",
      "li"
    ],
    "figure": [
      "p",
      "p",
      "b",
      "p",
      "p",
      "b"
    ],
    "could": [
      "p",
      "blockquote",
      "ol",
      "li",
      "ul",
      "li"
    ],
    "edit": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "properties": [
      "ol",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "blockquote",
      "b",
      "li",
      "b",
      "li",
      "li",
      "blockquote",
      "b",
      "li",
      "b",
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "b",
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "b"
    ],
    "anonymous": [
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "b",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "directorysecurity": [
      "ol",
      "li"
    ],
    "tab": [
      "ol",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "li",
      "blockquote",
      "li",
      "ol",
      "li"
    ],
    "check": [
      "ol",
      "li",
      "ul",
      "li",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "checkbox": [
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "add": [
      "ol",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "b",
      "li",
      "li",
      "b",
      "b",
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "b"
    ],
    "webconfig": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "file": [
      "ol",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote",
      "ol",
      "li"
    ],
    "enable": [
      "ol",
      "li",
      "ul",
      "li",
      "blockquote",
      "p",
      "p",
      "p",
      "p"
    ],
    "deny": [
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "pre"
    ],
    "unauthenticated": [
      "ol",
      "li"
    ],
    "adding": [
      "ol",
      "li"
    ],
    "configuration": [
      "ol",
      "li",
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li",
      "h2",
      "h2",
      "ol",
      "li",
      "h2",
      "p"
    ],
    "system.web>": [
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "..": [
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "mode=\"forms\"/": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "authorization>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "users=\"?\"": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "/": [
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "/authorization>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "..</system.web>": [
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "div",
      "pre"
    ],
    "loginaspx.": [
      "ol",
      "li"
    ],
    "createuserwizard": [
      "ol",
      "li",
      "b",
      "ol",
      "li",
      "b"
    ],
    "%@": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "language=\"c#\"": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "%<!doctype": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "html": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "public": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "\"-//w3c//dtd": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "xhtml": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "11//en\"": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "\"http//www.w3.org/tr/xhtml11/dtd/xhtml11.dtd\"><html": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "<head": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "runat=\"server\"": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "title>protocol": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "transition/title></head><body>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "id=\"form1\"": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "div>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "asp:login": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "id=\"login1\"": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "/asp:login>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "/div>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "asp:createuserwizard": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "id=\"createuserwizard1\"": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "wizardsteps>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "asp:createuserwizardstep": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "/asp:createuserwizardstep>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "asp:completewizardstep": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "/asp:completewizardstep>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "/wizardsteps>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "/asp:createuserwizard>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "/form></body></html>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "http//www.w3.org/tr/xhtml11/dtd/xhtml11.dtd": [
      "a"
    ],
    "code": [
      "p",
      "p",
      "p",
      "div",
      "pre",
      "ul",
      "li",
      "blockquote",
      "p",
      "h2",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "ol",
      "li"
    ],
    "takes": [
      "p"
    ],
    "supplied": [
      "p",
      "ol",
      "li",
      "ul",
      "li"
    ],
    "constructs": [
      "p",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "upn": [
      "p",
      "p",
      "blockquote",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p"
    ],
    "format": [
      "p",
      "div",
      "div",
      "pre",
      "pre",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "div",
      "pre",
      "pre",
      "li",
      "ul",
      "li"
    ],
    "username@domainname": [
      "p",
      "div",
      "pre",
      "a",
      "blockquote",
      "ol",
      "li",
      "div",
      "pre",
      "a"
    ],
    "passes": [
      "p",
      "ol",
      "li",
      "ul",
      "li"
    ],
    "windowsidentity": [
      "p",
      "b",
      "ul",
      "li",
      "b",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "b",
      "li",
      "li",
      "li",
      "p",
      "b",
      "p",
      "p",
      "b",
      "b"
    ],
    "constructor": [
      "p",
      "p",
      "div",
      "pre",
      "ul",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "p"
    ],
    "extension": [
      "p",
      "div",
      "pre",
      "p",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "begin": [
      "p"
    ],
    "impersonation": [
      "p",
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre",
      "p",
      "ol",
      "li",
      "p",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "domainname": [
      "i",
      "i",
      "i"
    ],
    "systemsecurity.principal;...//": [
      "div",
      "pre"
    ],
    "authenticationstring": [
      "div",
      "pre"
    ],
    "=": [
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "div",
      "pre",
      "pre"
    ],
    "useridentity.name;": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "//": [
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "convert": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "domainname\\username": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "necessaryint": [
      "div",
      "pre"
    ],
    "slash": [
      "div",
      "div",
      "pre",
      "pre",
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "div",
      "pre",
      "pre"
    ],
    "identityindexof(\"\\\\\");if": [
      "div",
      "pre"
    ],
    "0{": [
      "div",
      "pre"
    ],
    "string": [
      "div",
      "div",
      "pre",
      "pre",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre"
    ],
    "identitysubstring(0,": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "slash;": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "identitysubstring(slash": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "+": [
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre"
    ],
    "1;": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "\"@\"": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "domain}": [
      "div",
      "pre"
    ],
    "windowsidentitystring)": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "new//": [
      "div",
      "pre"
    ],
    "get": [
      "div",
      "pre",
      "ul",
      "li",
      "blockquote",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "user//": [
      "div",
      "pre"
    ],
    "passwordwindowsidentity": [
      "div",
      "pre"
    ],
    "wi": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "new": [
      "div",
      "pre",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "windowsidentityidentity);windowsimpersonationcontext": [
      "div",
      "pre"
    ],
    "wic": [
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre"
    ],
    "nulltry{": [
      "div",
      "pre"
    ],
    "wiimpersonate();": [
      "div",
      "pre"
    ],
    "goes": [
      "div",
      "pre"
    ],
    "here}catch(){": [
      "div",
      "pre"
    ],
    "ensure": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li"
    ],
    "exception": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "propagated": [
      "div",
      "pre"
    ],
    "higher": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "stack}finally{": [
      "div",
      "pre"
    ],
    "make": [
      "div",
      "pre",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "sure": [
      "div",
      "pre",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "remove": [
      "div",
      "pre"
    ],
    "!=": [
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "null": [
      "div",
      "pre",
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "div",
      "pre",
      "pre"
    ],
    "wicundo();}": [
      "div",
      "pre"
    ],
    "note   in": [
      "blockquote"
    ],
    "cases": [
      "blockquote"
    ],
    "e-mail": [
      "blockquote"
    ],
    "may": [
      "blockquote"
    ],
    "at": [
      "blockquote"
    ],
    "all": [
      "blockquote",
      "ol",
      "li",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "b"
    ],
    "default": [
      "blockquote",
      "ul",
      "li",
      "ol",
      "li",
      "li",
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "ol",
      "li",
      "blockquote",
      "ul",
      "li",
      "p"
    ],
    "logged": [
      "blockquote"
    ],
    "display": [
      "blockquote",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "running": [
      "blockquote",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p"
    ],
    "command": [
      "blockquote",
      "blockquote",
      "blockquote",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "whoami": [
      "blockquote",
      "blockquote",
      "b",
      "b"
    ],
    "/upn": [
      "blockquote",
      "b"
    ],
    "prompt": [
      "blockquote",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "command-line": [
      "blockquote"
    ],
    "tool": [
      "blockquote",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "available": [
      "blockquote",
      "li",
      "ol",
      "li",
      "ol",
      "li",
      "b"
    ],
    "support/tools": [
      "blockquote"
    ],
    "xp": [
      "blockquote"
    ],
    "professional": [
      "blockquote"
    ],
    "cd": [
      "blockquote",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "types": [
      "h3",
      "p"
    ],
    "type": [
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "li",
      "ol",
      "li"
    ],
    "generated": [
      "p"
    ],
    "determines": [
      "p",
      "ol",
      "li",
      "ul",
      "li"
    ],
    "what": [
      "p",
      "ul",
      "li"
    ],
    "do": [
      "p",
      "blockquote",
      "ol",
      "li",
      "b",
      "li",
      "b",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "identify-level": [
      "ul",
      "li",
      "b",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "returned": [
      "ul",
      "li",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "groups": [
      "ul",
      "li",
      "blockquote"
    ],
    "contained": [
      "ul",
      "li"
    ],
    "impersonation-level": [
      "ul",
      "li",
      "b"
    ],
    "grant": [
      "ul",
      "li",
      "blockquote"
    ],
    "process": [
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "blockquote"
    ],
    "\"act": [
      "ul",
      "li"
    ],
    "part": [
      "ul",
      "ul",
      "li",
      "li",
      "blockquote"
    ],
    "system\"": [
      "ul",
      "li"
    ],
    "right": [
      "ul",
      "li",
      "ol",
      "li",
      "li"
    ],
    "note   this": [
      "ul",
      "li",
      "blockquote",
      "blockquote"
    ],
    "places": [
      "ul",
      "li",
      "blockquote"
    ],
    "within": [
      "ul",
      "li",
      "blockquote",
      "p",
      "p"
    ],
    "computing": [
      "ul",
      "li",
      "blockquote"
    ],
    "base": [
      "ul",
      "li",
      "blockquote"
    ],
    "tcb)": [
      "ul",
      "li",
      "blockquote"
    ],
    "makes": [
      "ul",
      "li",
      "blockquote"
    ],
    "very": [
      "ul",
      "li",
      "blockquote"
    ],
    "highly": [
      "ul",
      "li",
      "blockquote"
    ],
    "privileged": [
      "ul",
      "li",
      "blockquote"
    ],
    "possible": [
      "ul",
      "li",
      "blockquote"
    ],
    "should": [
      "ul",
      "li",
      "blockquote"
    ],
    "attacker": [
      "ul",
      "li",
      "blockquote",
      "blockquote"
    ],
    "who": [
      "ul",
      "li",
      "blockquote"
    ],
    "manages": [
      "ul",
      "li",
      "blockquote"
    ],
    "inject": [
      "ul",
      "li",
      "blockquote"
    ],
    "compromise": [
      "ul",
      "li",
      "blockquote"
    ],
    "will": [
      "ul",
      "li",
      "blockquote",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "unrestricted": [
      "ul",
      "li",
      "blockquote"
    ],
    "capabilities": [
      "ul",
      "li",
      "blockquote"
    ],
    "computernote   if": [
      "ul",
      "li"
    ],
    "tcb": [
      "ul",
      "li",
      "blockquote"
    ],
    "impersonate-level": [
      "ul",
      "li",
      "blockquote"
    ],
    "case": [
      "ul",
      "li",
      "blockquote"
    ],
    "s4u2proxy": [
      "ul",
      "li",
      "blockquote"
    ],
    "tickets": [
      "ul",
      "li",
      "blockquote"
    ],
    "accessing": [
      "ul",
      "li",
      "blockquote",
      "ul",
      "li"
    ],
    "defined": [
      "ul",
      "li",
      "blockquote",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "note   if": [
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "li",
      "blockquote",
      "li",
      "blockquote",
      "li",
      "blockquote",
      "blockquote"
    ],
    "runs": [
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "under": [
      "p",
      "p",
      "p",
      "ul",
      "li"
    ],
    "custom": [
      "p",
      "p",
      "blockquote",
      "ol",
      "li",
      "h2",
      "p",
      "ol",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "li",
      "blockquote"
    ],
    "run": [
      "blockquote",
      "blockquote",
      "ol",
      "li",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "blockquote"
    ],
    "sql": [
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "blockquote",
      "blockquote",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "ul",
      "li",
      "ol",
      "li",
      "p",
      "blockquote"
    ],
    "spn)": [
      "blockquote",
      "li",
      "blockquote"
    ],
    "setspn": [
      "blockquote",
      "b",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "p",
      "b",
      "p",
      "b"
    ],
    "-a": [
      "blockquote",
      "b",
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "b",
      "p",
      "b"
    ],
    "mssqlsvc/": [
      "blockquote",
      "b"
    ],
    "databaseservernamefullyqualifieddomainname": [
      "blockquote",
      "b"
    ],
    "domain\\customaccountname": [
      "blockquote",
      "b",
      "p",
      "b"
    ],
    "recommended": [
      "blockquote"
    ],
    "associated": [
      "blockquote",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "high": [
      "blockquote"
    ],
    "privileges": [
      "blockquote"
    ],
    "exploit,": [
      "blockquote"
    ],
    "spn": [
      "blockquote",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "li",
      "blockquote",
      "blockquote",
      "blockquote"
    ],
    "created": [
      "blockquote",
      "blockquote"
    ],
    "automatically": [
      "blockquote",
      "ol",
      "li",
      "blockquote"
    ],
    "procedure": [
      "p",
      "p"
    ],
    "assumes": [
      "p",
      "p",
      "p",
      "ol",
      "li",
      "ul",
      "li"
    ],
    "start": [
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "management": [
      "ol",
      "li",
      "li"
    ],
    "console": [
      "ol",
      "li",
      "li"
    ],
    "mmc)": [
      "ol",
      "li",
      "li"
    ],
    "computers": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "b",
      "li",
      "b",
      "li",
      "b",
      "li",
      "li",
      "b",
      "li",
      "b",
      "ol",
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "b",
      "li",
      "b",
      "ul",
      "li",
      "b",
      "ol",
      "li",
      "b",
      "ol",
      "ol",
      "li",
      "li",
      "b"
    ],
    "snap-in": [
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "li",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "left": [
      "ol",
      "li",
      "li",
      "ol",
      "li"
    ],
    "pane": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "mmc": [
      "ol",
      "li",
      "li",
      "ol",
      "li",
      "ul",
      "li",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "click": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li"
    ],
    "node": [
      "ol",
      "li",
      "li",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "double-click": [
      "ol",
      "li",
      "li"
    ],
    "dialog": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "li",
      "blockquote",
      "li",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "li"
    ],
    "box": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "blockquote",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "there": [
      "ol",
      "li",
      "blockquote"
    ],
    "single": [
      "ol",
      "li",
      "blockquote",
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "trust": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "blockquote",
      "b",
      "li",
      "li",
      "b",
      "b",
      "li",
      "b",
      "li",
      "li",
      "b",
      "b",
      "li",
      "b",
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "b"
    ],
    "general": [
      "ol",
      "li",
      "blockquote",
      "b"
    ],
    "mixed": [
      "ol",
      "li",
      "blockquote",
      "p",
      "ol",
      "li"
    ],
    "raise": [
      "ol",
      "li",
      "blockquote",
      "p",
      "ol",
      "li",
      "h2",
      "ol",
      "li",
      "b"
    ],
    "level": [
      "ol",
      "li",
      "blockquote",
      "p",
      "h2",
      "ol",
      "ol",
      "li",
      "li",
      "h2",
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "b"
    ],
    "described": [
      "ol",
      "li",
      "blockquote",
      "p"
    ],
    "section": [
      "ol",
      "li",
      "blockquote",
      "ol",
      "li"
    ],
    "\"domain": [
      "ol",
      "li",
      "blockquote"
    ],
    "levels\"": [
      "ol",
      "li",
      "blockquote"
    ],
    "documenton": [
      "ol"
    ],
    "window": [
      "ol",
      "li",
      "li",
      "ol",
      "li"
    ],
    "selected": [
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "select": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "li",
      "b",
      "li",
      "li",
      "blockquote",
      "li",
      "li",
      "li",
      "li",
      "p",
      "p",
      "li",
      "b",
      "li",
      "ol",
      "li",
      "ul",
      "li",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "b",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "b"
    ],
    "specified": [
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "b",
      "li",
      "b",
      "li",
      "b",
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "b"
    ],
    "precisely": [
      "ol",
      "li",
      "li"
    ],
    "bottom": [
      "ol",
      "li",
      "li",
      "ol",
      "li"
    ],
    "beneath": [
      "ol",
      "li",
      "li"
    ],
    "works": [
      "ol",
      "li",
      "p",
      "li",
      "p"
    ],
    "button": [
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li"
    ],
    "displays": [
      "ol",
      "li",
      "li",
      "li",
      "ol",
      "li",
      "ol",
      "li"
    ],
    "alternatively": [
      "ol",
      "li"
    ],
    "enter": [
      "ol",
      "li"
    ],
    "ok": [
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "b",
      "li",
      "b",
      "li",
      "b",
      "ol",
      "li",
      "b",
      "li",
      "b",
      "ol",
      "li",
      "b"
    ],
    "names": [
      "ol",
      "li"
    ],
    "mssqlsvc": [
      "ol",
      "li",
      "b",
      "li",
      "b",
      "p",
      "ul",
      "li",
      "b"
    ],
    "delegate": [
      "ol",
      "li",
      "blockquote"
    ],
    "share": [
      "ol",
      "li",
      "blockquote"
    ],
    "need": [
      "ol",
      "li",
      "blockquote",
      "p",
      "p"
    ],
    "cifs)": [
      "ol",
      "li",
      "blockquote"
    ],
    "document": [
      "li",
      "blockquote",
      "ol",
      "li"
    ],
    "support": [
      "ol",
      "li"
    ],
    "mutual": [
      "ol",
      "li"
    ],
    "accountinstall": [
      "ol",
      "li"
    ],
    "tools": [
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "b"
    ],
    "twice": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "c\\program": [
      "ol",
      "li",
      "ol",
      "li",
      "b"
    ],
    "files\\support": [
      "ol",
      "li",
      "ol",
      "li",
      "b"
    ],
    "here": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "http/webservernamedomain\\customaccountnamesetspn": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "http/webservernamefullyqualifieddomainnamedomain\\customaccountnamenote   you": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "http": [
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "blockquote",
      "ul",
      "li",
      "ol",
      "li",
      "b"
    ],
    "dns)": [
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "means": [
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "spns": [
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "different": [
      "ol",
      "ol",
      "li",
      "li",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "blockquote"
    ],
    "mapped": [
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "same": [
      "ol",
      "li",
      "ol",
      "li",
      "blockquote",
      "ol",
      "li",
      "p"
    ],
    "unless": [
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "they": [
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "ports": [
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "port": [
      "ol",
      "li",
      "ol",
      "li",
      "blockquote"
    ],
    "install": [
      "ol",
      "li"
    ],
    "http/webservernamedomain\\customaccountname": [
      "p",
      "b"
    ],
    "webservername": [
      "i"
    ],
    "customaccountname": [
      "i",
      "i"
    ],
    "http/webservernamefullyqualifieddomainname": [
      "p",
      "b"
    ],
    "webservernamefullyqualifieddomainname": [
      "i"
    ],
    "note   you": [
      "blockquote"
    ],
    "snap": [
      "li",
      "ol",
      "li"
    ],
    "indicates": [
      "li",
      "blockquote"
    ],
    "exist": [
      "li",
      "blockquote",
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "explained": [
      "li",
      "blockquote",
      "ol",
      "li"
    ],
    "above": [
      "li",
      "blockquote",
      "p"
    ],
    "dialogue": [
      "li"
    ],
    "now": [
      "li"
    ],
    "necessary": [
      "p",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "target": [
      "p"
    ],
    "dbserver": [
      "p"
    ],
    "northwind": [
      "p",
      "blockquote",
      "ol",
      "li"
    ],
    "note   to": [
      "blockquote"
    ],
    "each": [
      "blockquote"
    ],
    "application's": [
      "blockquote"
    ],
    "end": [
      "blockquote",
      "ol",
      "li",
      "ul",
      "li",
      "ol",
      "li"
    ],
    "set": [
      "blockquote",
      "p",
      "ol",
      "li"
    ],
    "belong": [
      "blockquote"
    ],
    "read": [
      "blockquote",
      "ol",
      "li"
    ],
    "define": [
      "ol",
      "li"
    ],
    "connection": [
      "ol",
      "li"
    ],
    "specifying": [
      "ol",
      "li"
    ],
    "xmlns=\"http//schemas.microsoft.com/.netconfiguration/v2.0\">": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "connectionstrings>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "name=\"nwindconnectionstring\"": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "connectionstring=\"data": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "source=dbserverinitial": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "catalog=northwindintegrated": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "security=true\"": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "providername=\"systemdata.sqlclient\"": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "/connectionstrings>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "..</configuration>": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "similar": [
      "ol",
      "li"
    ],
    "impersonate": [
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "pre",
      "ol",
      "li"
    ],
    "systemdata.sqlclient;using": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "systemsecurity.principal;...private": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "datatable": [
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "div",
      "pre",
      "pre"
    ],
    "calldatabase){": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "dt": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "datatable);": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "windowsimpersonationcontext": [
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "div",
      "pre",
      "pre"
    ],
    "try": [
      "ol",
      "ol",
      "li",
      "div",
      "pre",
      "li",
      "ul",
      "li",
      "p"
    ],
    "{": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "first": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "impersonateenduser);": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "fetch": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "data": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "sqlconnection": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "conn": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "sqlconnection))": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "connconnectionstring": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "configurationmanagerconnectionstrings": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "\"nwindconnectionstring\"].connectionstring;": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "connopen();": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "sqlcommand": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "cmd": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "sqlcommand\"select": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "productname": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "products\"": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "conn;": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "sqldataadapter": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "da": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "sqldataadaptercmd);": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "dafill(dt);": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "}": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "div",
      "div",
      "div",
      "div",
      "div",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "catch": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "let": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "propagate": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "stack": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "finally": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "stopped": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "wicundo();": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "return": [
      "ol",
      "ol",
      "li",
      "li",
      "div",
      "div",
      "pre",
      "pre"
    ],
    "dt}private": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "impersonateenduser){": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "int": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "identityindexof(\"\\\\\");": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "windowsidentityidentity);": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "wiimpersonate();}": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "points": [
      "ol",
      "li",
      "p"
    ],
    "preceding": [
      "ol",
      "li",
      "p"
    ],
    "impersonateenduser": [
      "ol",
      "li",
      "ul",
      "li",
      "b"
    ],
    "method": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "been": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "converts": [
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "p"
    ],
    "username@domainname),": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "returns": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "requiring": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "account's": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "group": [
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "membership": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "p",
      "li",
      "li",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "blockquote",
      "blockquote"
    ],
    "request": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "submitted": [
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "authentic": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "represent": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "back": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "provider": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "verify": [
      "ol",
      "li",
      "ul",
      "li",
      "h2"
    ],
    "purpose": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "exposing": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "passwords": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "way": [
      "ol",
      "li",
      "ul",
      "li"
    ],
    "after": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "ol",
      "li"
    ],
    "verifies": [
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "into": [
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "object": [
      "ol",
      "ol",
      "li",
      "li",
      "ul",
      "ul",
      "li",
      "li",
      "p",
      "p"
    ],
    "generates": [
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "systemsecurity.securityexception": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "b"
    ],
    "message": [
      "ol",
      "li",
      "ul",
      "li",
      "p"
    ],
    "failure": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "b"
    ],
    "unknown": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "b"
    ],
    "bad": [
      "ol",
      "li",
      "ul",
      "li",
      "p",
      "b"
    ],
    "http//schemas.microsoft.com/.netconfiguration/v2.0": [
      "a"
    ],
    "one": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "matches": [
      "ol",
      "li"
    ],
    "authorizes": [
      "ol",
      "li"
    ],
    "match": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li"
    ],
    "note   by": [
      "ol",
      "li",
      "blockquote"
    ],
    "express": [
      "ol",
      "li",
      "blockquote"
    ],
    "\\app_data": [
      "ol",
      "li",
      "blockquote"
    ],
    "folder": [
      "ol",
      "li",
      "blockquote"
    ],
    "act": [
      "ol",
      "li",
      "blockquote"
    ],
    "succeed": [
      "ol",
      "li"
    ],
    "attempt": [
      "ol",
      "li"
    ],
    "fail": [
      "ol",
      "li"
    ],
    "generate": [
      "ol",
      "li"
    ],
    "securityexception": [
      "ol",
      "li",
      "b"
    ],
    "again": [
      "ol",
      "li"
    ],
    "ensures": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "intranet": [
      "p"
    ],
    "client's": [
      "p"
    ],
    "communicate": [
      "p"
    ],
    "result": [
      "p",
      "ul",
      "li"
    ],
    "iis": [
      "p",
      "p",
      "ol",
      "li",
      "p",
      "ol",
      "li"
    ],
    "middle-tier": [
      "p"
    ],
    "business": [
      "p"
    ],
    "logic": [
      "p"
    ],
    "exposed": [
      "p"
    ],
    "key": [
      "p"
    ],
    "features": [
      "p"
    ],
    "mssqlsvc)": [
      "ul",
      "li"
    ],
    "application,": [
      "ul",
      "li",
      "ol",
      "li"
    ],
    "credentials": [
      "p",
      "b",
      "ol",
      "li",
      "b",
      "ol",
      "li"
    ],
    "property": [
      "p",
      "ol",
      "li"
    ],
    "proxy": [
      "p",
      "ol",
      "li"
    ],
    "presentation-tier": [
      "h3"
    ],
    "disabled": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "settings": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "mode=\"windows\"/": [
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "impersonate=\"true\"/": [
      "ol",
      "li",
      "div",
      "pre",
      "ol",
      "li",
      "div",
      "pre"
    ],
    "passing": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "credentialsdataaccesswswebservice": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "ws": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "dataaccesswswebservice();ws.credentials": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "credentialcachedefaultcredentials;": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "wsgetdata();": [
      "ol",
      "li",
      "div",
      "pre"
    ],
    "..</system.web>use": [
      "ol"
    ],
    "relevant": [
      "ol",
      "ol",
      "li",
      "li"
    ],
    "permissions": [
      "ol",
      "li"
    ],
    "either": [
      "ol",
      "li"
    ],
    "application.": [
      "ol",
      "li"
    ],
    "computer/user": [
      "ol",
      "ol",
      "li",
      "b",
      "li",
      "b"
    ],
    "enables": [
      "ol",
      "li"
    ],
    "restricts": [
      "ol",
      "li"
    ],
    "authenticating": [
      "ol",
      "li"
    ],
    "technique": [
      "ol",
      "li"
    ],
    "other": [
      "ol",
      "li"
    ],
    "than": [
      "ol",
      "li"
    ],
    "programmatically": [
      "ol",
      "li"
    ],
    "\"step": [
      "ol",
      "li",
      "blockquote"
    ],
    "caller\"": [
      "ol",
      "li"
    ],
    "okyou": [
      "ol"
    ],
    "except": [
      "p"
    ],
    "applications..": [
      "ul",
      "li"
    ],
    "permitted": [
      "ul",
      "li"
    ],
    "details": [
      "blockquote"
    ],
    "creating": [
      "blockquote"
    ],
    "account\"": [
      "blockquote"
    ],
    "change": [
      "blockquote"
    ],
    "reversible": [
      "blockquote"
    ],
    "right-click": [
      "ol",
      "li"
    ],
    "root": [
      "ol",
      "li",
      "ol",
      "li"
    ],
    "including": [
      "ol",
      "li"
    ],
    "before": [
      "ol",
      "li"
    ],
    "titled": [
      "ol",
      "li"
    ],
    "machinename.": [
      "ol",
      "li",
      "b"
    ],
    "domain.": [
      "ol",
      "li"
    ],
    "action": [
      "ol",
      "li",
      "b"
    ],
    "menu": [
      "ol",
      "li"
    ],
    "tasks": [
      "ol",
      "li",
      "b"
    ],
    "dropdown": [
      "ol",
      "li"
    ],
    "machinename": [
      "i"
    ],
    "adapted": [
      "p"
    ],
    "patterns": [
      "p"
    ],
    "&": [
      "p"
    ],
    "practices": [
      "p"
    ],
    "guidance": [
      "p"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "Summary",
      "Contents",
      "Objectives",
      "Overview",
      "Summary of Steps",
      "Step 1. Use an S4U Logon to Create a Windows Token for the Original Caller",
      "Step 2. Configure Your Service or Machine Account for Constrained Delegation",
      "Step 3. Implement and Test Protocol Transition",
      "Using Constrained Delegation Through Multiple Tiers",
      "Domain Functional Levels"
    ],
    "ul": [
      "Internet Information Services 6.0 or laterMicrosoft Windows Server 2003 or later operating system",
      "Objectives\n      \n        Overview\n        \n          Scenarios\n          \n            Summary of Steps\n            \n              Step 1. Use an S4U Logon to Create a Windows Token for the Original Caller\n              \n                Step 2. Configure Your Service or Machine account for Constrained Delegation\n                \n                  Step 3. Implement and Test Protocol Transition\n                  \n                    Using Constrained Delegation Through Multiple Tiers\n                    \n                      Domain Functional Levels\n                      \n                        Additional Resources",
      "Use protocol transition to switch from non-Windows authentication to Kerberos authentication. Use constrained delegation to restrict access to specific services. Pass the original caller identity from the Web server to the database server. Pass the original caller identity from the Web server to the application server to the database server.",
      "Service-for-User-to-Self (S4U2Self), which allows you to obtain a Windows token for the client by supplying a user principal name (UPN) without a password. Service-for-User-to-Proxy (S4U2Proxy), which allows an administrator to control exactly which downstream services can be accessed with the S4U2Self token.",
      "Using a non-Windows authentication mechanism for external clients and then transitioning to Kerberos authentication to access network resources. Impersonating Kerberos-authenticated clients and then using their Windows security context to pass their identities through multiple tiers to access network resources.",
      "If your client uses\n      forms authentication, you can use LogonUser. If the user name and password entered through the forms login page map directly to a Windows domain account, your application can call the LogonUser API and avoid protocol transition. Note   The example in this How To uses forms authentication for simplicity.If your client uses certificate authentication, you can consider protocol transition. If your client uses certificates to authenticate with your Web server the application can look up the user in Active Directory based on the certificate, and use protocol transition to allow the user to log on.",
      "Step 1. Use an S4U Logon to create a Windows token for the original caller. Step 2. Configure your service or machine account for constrained delegation. Step 3. Implement and test protocol transition.",
      "Identify-level token. This is returned by default. With this token type, you can check to see what groups are contained in the token, but you cannot use it to access local or remote resources while impersonating. Impersonation-level token. This type of token allows you to access local resources while impersonating. To obtain this type of token from the WindowsIdentity constructor, you must grant your process account the \"Act as part of the operating system\" user right. Note   This places your process within the trusted computing base (TCB) of the Web server, which makes your Web server process very highly privileged. Where possible, you should avoid this approach because an attacker who manages to inject code and compromise your Web application will have unrestricted capabilities on the local computer.Note   If your process account is part of the TCB, you get an impersonate-level token. To access network resources, you must enable protocol transition in Active Directory. In this case, you can obtain S4U2Proxy tickets on behalf of your client by accessing remote services defined in the A2D2 list.",
      "The ImpersonateEndUser method uses the user name of the user that has been authenticated using forms authentication. It converts the user name to UPN format (userName@domainName), and passes the UPN to the WindowsIdentity constructor. This constructor returns a Windows token for a domain account without requiring the account's password. By default, an identify-level token is returned. You can only use this to check the user's group membership. You cannot access local or remote resources. However, if you configure protocol transition in Active Directory, you can use the token to access specified services on selected servers as defined by the A2D2 list. Your application must authenticate the request by using the user name and password submitted on your forms login page. When your application determines that the user is authentic, you must select an existing Windows account to represent the user on the back end. This example assumes that the user submitted a Windows user name and domain name on the forms login page and supplied a password that the ASP.NET membership provider could verify. This is not the password for the Windows account. The purpose of protocol transition is to avoid exposing Windows passwords in this way. In this example, after the membership system in ASP.NET verifies the user's password, the Web application converts the user's name into the UPN form and constructs a WindowsIdentity object. If you try to create a WindowsIdentity object for a user that does not exist, the WindowsIdentity constructor generates a System.Security.SecurityException with the message Logon failure: unknown user name or bad password.",
      "The application uses Kerberos authentication to authenticate users. As a result protocol transition is not required. Constrained delegation is required to allow the Web application, while impersonating, to access the HTTP service on the application server. Constrained delegation is required to allow the application server, while impersonating, to access the SQL Server (MSSQLSvc) service on the database server. The Web service on the application server uses Kerberos authentication to authenticate its caller (the Web application), and then impersonates the authenticated caller while accessing the database.",
      "In the Active Directory Users and Computers MMC snap-in, select the application server computer account (if you are using the default Network Service account to run Web service applications).. If your Web service applications run under a custom domain account, select that user account instead. When you configure the services for which constrained delegation is permitted, select the database server computer and the MSSQLSvc service on that computer."
    ],
    "li": [
      "Internet Information Services 6.0 or later",
      "Microsoft Windows Server 2003 or later operating system",
      "Objectives",
      "Overview",
      "Scenarios",
      "Summary of Steps",
      "Step 1. Use an S4U Logon to Create a Windows Token for the Original Caller",
      "Step 2. Configure Your Service or Machine account for Constrained Delegation",
      "Step 3. Implement and Test Protocol Transition",
      "Using Constrained Delegation Through Multiple Tiers",
      "Domain Functional Levels",
      "Additional Resources",
      "Use protocol transition to switch from non-Windows authentication to Kerberos authentication.",
      "Use constrained delegation to restrict access to specific services.",
      "Pass the original caller identity from the Web server to the database server.",
      "Pass the original caller identity from the Web server to the application server to the database server.",
      "Service-for-User-to-Self (S4U2Self), which allows you to obtain a Windows token for the client by supplying a user principal name (UPN) without a password.",
      "Service-for-User-to-Proxy (S4U2Proxy), which allows an administrator to control exactly which downstream services can be accessed with the S4U2Self token.",
      "Using a non-Windows authentication mechanism for external clients and then transitioning to Kerberos authentication to access network resources.",
      "Impersonating Kerberos-authenticated clients and then using their Windows security context to pass their identities through multiple tiers to access network resources.",
      "If your client uses\n      forms authentication, you can use LogonUser. If the user name and password entered through the forms login page map directly to a Windows domain account, your application can call the LogonUser API and avoid protocol transition. Note   The example in this How To uses forms authentication for simplicity.",
      "If your client uses certificate authentication, you can consider protocol transition. If your client uses certificates to authenticate with your Web server the application can look up the user in Active Directory based on the certificate, and use protocol transition to allow the user to log on.",
      "Step 1. Use an S4U Logon to create a Windows token for the original caller.",
      "Step 2. Configure your service or machine account for constrained delegation.",
      "Step 3. Implement and test protocol transition.",
      "Create a Web application.",
      "In Internet Information Services Administrator, edit the properties of the Web site. Edit the Anonymous access and authentication control on the Directorysecurity tab, and check the Anonymous access checkbox.",
      "Create a Web application. Add a Web.config file, enable forms authentication, and deny access to unauthenticated users by adding the following configuration. <system.web>    ...    <authentication mode=\"Forms\"/>    <authorization>        <deny users=\"?\" />     </authorization>   ...</system.web>",
      "Add a Web form called Login.aspx.",
      "Add a Login control and a CreateUserWizard control, as shown in the following example. <%@ Page Language=\"C#\" %><!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.1//EN\" \"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\"><html  ><head runat=\"server\">    <title>Protocol Transition</title></head><body>    <form id=\"form1\" runat=\"server\">    <div>        <asp:Login ID=\"Login1\" runat=\"server\">        </asp:Login>        </div>        <asp:CreateUserWizard ID=\"CreateUserWizard1\" runat=\"server\">            <WizardSteps>                <asp:CreateUserWizardStep runat=\"server\">                </asp:CreateUserWizardStep>                <asp:CompleteWizardStep runat=\"server\">                </asp:CompleteWizardStep>            </WizardSteps>        </asp:CreateUserWizard>    </form></body></html>",
      "Identify-level token. This is returned by default. With this token type, you can check to see what groups are contained in the token, but you cannot use it to access local or remote resources while impersonating.",
      "Impersonation-level token. This type of token allows you to access local resources while impersonating. To obtain this type of token from the WindowsIdentity constructor, you must grant your process account the \"Act as part of the operating system\" user right. Note   This places your process within the trusted computing base (TCB) of the Web server, which makes your Web server process very highly privileged. Where possible, you should avoid this approach because an attacker who manages to inject code and compromise your Web application will have unrestricted capabilities on the local computer.Note   If your process account is part of the TCB, you get an impersonate-level token. To access network resources, you must enable protocol transition in Active Directory. In this case, you can obtain S4U2Proxy tickets on behalf of your client by accessing remote services defined in the A2D2 list.",
      "Start the Microsoft Management Console (MMC) Active Directory Users and Computers snap-in.",
      "In the left pane of the MMC snap-in, click the Computers node.",
      "In the right pane, double-click your Web server computer to display the Properties dialog box. Note   If the Properties dialog box does not have a Delegation tab and there is a single checkbox called Trust Computer for Delegation on the General tab, your domain is operating as a Windows 2000 mixed domain. You must raise the domain functional level to Windows Server 2003 as described in the section \"Domain Functional Levels,\" in this document.",
      "On the Delegation tab of the Properties window for the Web server computer, Do not trust the computer for delegation is selected by default. To use constrained delegation, select Trust this computer for delegation to specified services only. You specify precisely which service or services can be accessed in the bottom pane.",
      "Beneath Trust this computer for delegation to specified services only, select Use any authentication protocol. If you select Use Kerberos only, constrained delegation works only with Kerberos authentication. If you are using protocol transition to switch from forms authentication (or an alternate non-Kerberos authentication mechanism) to Kerberos, then you must select Use any authentication protocol.",
      "Click the Add button. This displays the Add Services dialog box.",
      "Click the Users or computers button.",
      "In the Select Users or Computers dialog, type the name of your database server computer if you are running SQL Server as System or Network Service. Alternatively, if you are running SQL Server by using a custom domain account, enter that account name instead. Then click OK.",
      "You will see all the service principal names configured for the selected user or computer account. To restrict access to SQL Server, select the MSSQLSvc service, and then click OK. Note   If you want to delegate to a file on a file share, you need to select the Common Internet File System (CIFS) service.",
      "Create an SPN for your custom domain account. Kerberos requires an SPN to support mutual authentication. To create an SPN for the domain account:Install the Windows Server Tools from the Windows Server CD. From a command prompt, run the Setspn tool twice from the C:\\Program Files\\Support Tools directory as shown here. setspn -A HTTP/webservernamedomain\\customAccountNamesetspn -A HTTP/webservername.fullyqualifieddomainnamedomain\\customAccountNameNote   You can only have a single SPN associated with any HTTP service (DNS) name, which means you cannot create SPNs for different service accounts mapped to the same HTTP server unless they are on different ports. The SPN can include a port number.",
      "Install the Windows Server Tools from the Windows Server CD.",
      "From a command prompt, run the Setspn tool twice from the C:\\Program Files\\Support Tools directory as shown here. setspn -A HTTP/webservernamedomain\\customAccountNamesetspn -A HTTP/webservername.fullyqualifieddomainnamedomain\\customAccountNameNote   You can only have a single SPN associated with any HTTP service (DNS) name, which means you cannot create SPNs for different service accounts mapped to the same HTTP server unless they are on different ports. The SPN can include a port number.",
      "Start the Microsoft Management Console (MMC) Active Directory Users and Computers snap-in.",
      "In the left pane of the MMC snap in, click the Users node.",
      "In the right pane, double-click the user account you are using to run the ASP.NET application. This displays the user account properties. Note   If the Properties dialog box for your account does not have a Delegation tab, this indicates that a service principal name (SPN) does not exist for the user. Create an SPN as explained in step 1, above.",
      "On the Delegation tab of the Properties window for your Web server computer, Do not trust the computer for delegation is selected by default. To use constrained delegation, select Trust this user for delegation to specified services only. You specify precisely which service or services can be accessed in the bottom pane.",
      "Beneath Trust this user for delegation to specified services only, select Use any authentication protocol. If you select Use Kerberos only, constrained delegation works only with Kerberos authentication. If you are using protocol transition to switch from forms authentication (or an alternate non-Kerberos authentication mechanism) to Kerberos, then you must select Use any authentication protocol.",
      "Click the Add button. This displays the Add Services dialogue.",
      "Click the Users or computers button.",
      "In the Select Users or Computers dialog, type the name of your database server, and then click OK.",
      "You will now see all the available services on your database server. To restrict access to SQL Server, select the MSSQLSvc service, and then click OK.",
      "Define a connection string to the database server in your Web.config file, specifying Windows authentication to the database, as shown in the following example. <configuration xmlns=\"http://schemas.microsoft.com/.NetConfiguration/v2.0\">  <connectionStrings>    <add name=\"nwindConnectionString\" connectionString=\"Data Source=DBServer;Initial Catalog=northwind;Integrated Security=True\"          providerName=\"System.Data.SqlClient\" />  </connectionStrings>  ...</configuration>",
      "Use code similar to the following to impersonate the caller and access the database. Using System.Data.SqlClient;Using System.Security.Principal;...private DataTable CallDatabase(){  DataTable dt = new DataTable();  WindowsImpersonationContext wic = null;  try  {    // First, impersonate the original caller    wic = ImpersonateEndUser();    // Fetch data from the database using the original caller's     // security context    using (SqlConnection conn = new SqlConnection())    {      conn.ConnectionString = ConfigurationManager.ConnectionStrings                               [\"nwindConnectionString\"].ConnectionString;      conn.Open();      SqlCommand cmd = new SqlCommand(\"Select ProductName from Products\",                                       conn);       SqlDataAdapter da = new SqlDataAdapter(cmd);      da.Fill(dt);    }  }  catch  {    // Do not let the exception propagate higher up the call stack  }  finally  {    // Ensure that impersonation is stopped    if( wic != null)      wic.Undo();  }  return dt;}private WindowsImpersonationContext ImpersonateEndUser(){  // Obtain the user name (from forms authentication)  string identity = User.Identity.Name;  // Convert from domainName\\userName format to userName@domainName format  // if necessary  int slash = identity.IndexOf(\"\\\\\");  if (slash > 0)  {      string domain = identity.Substring(0, slash);      string user = identity.Substring(slash + 1);      identity = user + \"@\" + domain;  }  // The WindowsIdentity(string) constructor uses the new  // Kerberos S4U extension to get a logon for the user  // without a password.  WindowsIdentity wi = new WindowsIdentity(identity);  return wi.Impersonate();}",
      "Note the following points about the preceding code: The ImpersonateEndUser method uses the user name of the user that has been authenticated using forms authentication. It converts the user name to UPN format (userName@domainName), and passes the UPN to the WindowsIdentity constructor. This constructor returns a Windows token for a domain account without requiring the account's password. By default, an identify-level token is returned. You can only use this to check the user's group membership. You cannot access local or remote resources. However, if you configure protocol transition in Active Directory, you can use the token to access specified services on selected servers as defined by the A2D2 list. Your application must authenticate the request by using the user name and password submitted on your forms login page. When your application determines that the user is authentic, you must select an existing Windows account to represent the user on the back end. This example assumes that the user submitted a Windows user name and domain name on the forms login page and supplied a password that the ASP.NET membership provider could verify. This is not the password for the Windows account. The purpose of protocol transition is to avoid exposing Windows passwords in this way. In this example, after the membership system in ASP.NET verifies the user's password, the Web application converts the user's name into the UPN form and constructs a WindowsIdentity object. If you try to create a WindowsIdentity object for a user that does not exist, the WindowsIdentity constructor generates a System.Security.SecurityException with the message Logon failure: unknown user name or bad password.",
      "The ImpersonateEndUser method uses the user name of the user that has been authenticated using forms authentication. It converts the user name to UPN format (userName@domainName), and passes the UPN to the WindowsIdentity constructor. This constructor returns a Windows token for a domain account without requiring the account's password. By default, an identify-level token is returned. You can only use this to check the user's group membership. You cannot access local or remote resources. However, if you configure protocol transition in Active Directory, you can use the token to access specified services on selected servers as defined by the A2D2 list.",
      "Your application must authenticate the request by using the user name and password submitted on your forms login page. When your application determines that the user is authentic, you must select an existing Windows account to represent the user on the back end. This example assumes that the user submitted a Windows user name and domain name on the forms login page and supplied a password that the ASP.NET membership provider could verify. This is not the password for the Windows account. The purpose of protocol transition is to avoid exposing Windows passwords in this way. In this example, after the membership system in ASP.NET verifies the user's password, the Web application converts the user's name into the UPN form and constructs a WindowsIdentity object. If you try to create a WindowsIdentity object for a user that does not exist, the WindowsIdentity constructor generates a System.Security.SecurityException with the message Logon failure: unknown user name or bad password.",
      "Start your application.",
      "Use the CreateUserWizard control on the login page to create two user accounts: one that has a user name that matches a domain account and also has a SQL Server login that authorizes read access to the Northwind database, and one that has a user name that does not match a domain account. Note   By default, the ASP.NET login controls automatically create and configure a SQL Express membership database in the \\app_data folder to act as your membership database.",
      "Use the Login control to log in with the user account that does not match a domain account. The login will succeed, but the attempt to impersonate the user will fail and will generate a SecurityException because the user name does not match a domain name.",
      "Start the application again. Log in using the user name that does match a domain account name. On the Web server, the ASP.NET application impersonates the original caller and runs using the identity of the caller. The constrained delegation configuration ensures that the same identity is used to access the database.",
      "The application uses Kerberos authentication to authenticate users. As a result protocol transition is not required.",
      "Constrained delegation is required to allow the Web application, while impersonating, to access the HTTP service on the application server.",
      "Constrained delegation is required to allow the application server, while impersonating, to access the SQL Server (MSSQLSvc) service on the database server.",
      "The Web service on the application server uses Kerberos authentication to authenticate its caller (the Web application), and then impersonates the authenticated caller while accessing the database.",
      "Use IIS to configure your Web site for Integrated Windows authentication. Make sure anonymous access is disabled.",
      "Use the following settings to configure your ASP.NET application to use Windows authentication and impersonation. <system.web>    ...    <authentication mode=\"Windows\"/>    <identity impersonate=\"true\"/>    ...</system.web>",
      "Set the Credentials property on the Web service proxy to pass the authenticated user's security context to the Web service, as shown in the following code. // Call the web service passing the original user's credentialsDataAccessWS.WebService ws = new DataAccessWS.WebService();ws.Credentials = CredentialCache.DefaultCredentials;  ws.GetData();",
      "Use IIS to configure your Web site for Integrated Windows authentication. Make sure anonymous access is disabled.",
      "Use the following settings to configure your Web service to use Windows authentication and impersonation. <system.web>    ...    <authentication mode=\"Windows\"/>    <identity impersonate=\"true\"/>    ...</system.web>",
      "Use Windows authentication to access the database. The impersonation configuration ensures that the authenticated user's credentials are used to access the database. You must ensure that the relevant end user account has a SQL Server login and relevant database permissions.",
      "Use the Active Directory Users and Computers MMC snap in to display the Properties dialog box for either the Web server computer (if you are using the Network Service account to run your ASP.NET Web application), or your custom user account (if you are using a custom account to run your application).",
      "On the Delegation tab of the Properties window, select Trust this computer/user for delegation to specified services only. This enables constrained delegation for the services you will select in the bottom pane.",
      "After Trust this computer/user for delegation to specified services only, select Use Kerberos only. This restricts the use of constrained delegation to scenarios where the callers are authenticated using Kerberos authentication only. Note that if you are authenticating callers to the Web server using any technique other than Kerberos you must select Use any protocol, and obtain a Windows token for the caller programmatically as explained in the section, \"Step 1. Use Protocol Transition to Create a Windows Token for the Original Caller,\" in this document.",
      "Click the Add button. This displays the Add Services dialog box.",
      "Click the Users or computers button",
      "In the Select Users or Computers dialog box, type the name of your application server, and then click OK.",
      "You will see all the available services on your application server. Select the HTTP service, and then click OK.",
      "In the Active Directory Users and Computers MMC snap-in, select the application server computer account (if you are using the default Network Service account to run Web service applications).. If your Web service applications run under a custom domain account, select that user account instead.",
      "When you configure the services for which constrained delegation is permitted, select the database server computer and the MSSQLSvc service on that computer.",
      "In the left pane of the Active Directory Users and Computers MMC snap-in, right-click the root node for the domain, and then click Properties.",
      "The Properties dialog box displays information including the domain functional level. If the domain is operating as a Windows 2000 mixed domain, you must raise the domain functional level to Windows Server 2003 before you can use constrained delegation.",
      "In the Active Directory Users and Computers MMC snap-in, click the root node titled Active Directory User and Computers [machinename. domain].",
      "On the Action menu, click All Tasks, and then click Raise Domain Functional Level.",
      "Select Windows Server 2003 from the Select an available domain functional level dropdown box. Click OK."
    ],
    "p": [
      "This How To shows you how to configure and use protocol transition and constrained delegation to allow your ASP.NET application to access network resources while impersonating the original caller. The Microsoft Windows 2000 operating system supports delegation; however, access to downstream servers or services cannot be limited by delegation. The Microsoft Windows Server 2003 and later operating systems provides a more secure form of delegation called constrained delegation. With constrained delegation, you can configure the Microsoft Active Directory® directory service to restrict the services and servers that your ASP.NET application can access with the impersonated identity.",
      "Constrained delegation in Windows Server requires Kerberos authentication. If your application cannot use Kerberos authentication to authenticate its callers, you can use protocol transition to switch from an alternate, non-Windows authentication mode (such as forms or certificate authentication) to Kerberos authentication. You can then use Kerberos with constrained delegation to access downstream network resources.",
      "For demonstration purposes, this How To uses protocol transition with forms authentication. In practice, you would use the LogonUser API because you already obtained the username and password. An example of a production scenario for protocol transition is where you use certificates to authenticate users and want to map them to existing Windows accounts.",
      "When an ASP.NET application impersonates the original caller, it accesses resources by using the security context of the authenticated user. However, the application can only access local resources. To access network resources while impersonating a remote user, your application must use delegation. If your application uses Kerberos authentication to authenticate its users, you can use delegation to pass the caller's identity through the layers of your application, and use it to access network resources. If your application does not use Kerberos authentication, you can use protocol transition to switch from a non-Kerberos authentication mechanism to Kerberos, and then use delegation to pass the identity on.",
      "In many situations—for example, if your users access a Web site over the Internet—you cannot use Kerberos authentication because firewalls prevent the client computer from directly communicating with the domain controller. Instead, your application must authenticate the client by using another approach, such as forms authentication, or in an extranet scenario, client certificate authentication.",
      "Windows Server has a protocol transition feature that permits applications to use a non-Windows authentication mechanism to authenticate users, but still use Kerberos authentication and delegation to access downstream network resources. This allows your application to access downstream servers that require Windows authentication and it allows you to use Windows auditing to track user access to backend resources.",
      "Note that impersonating a Windows identity to access downstream resources brings a number of advantages, but also some disadvantages. The advantages include the ability to use Windows auditing to track user access to back-end resources, and the ability to implement fine-grained access controls to resources (such as databases) on a per-user basis. The disadvantages include the additional administration required to administer fine-grained access controls and reduced scalability. For many applications, the trusted subsystem model is appropriate; for example, where the Web server authenticates the caller, but then uses a service identity to access downstream resources on behalf of the original caller. This results in reduced administration and improved scalability. For more information on selecting the appropriate authentication model for your application, see Building Secure ASP.NET Applications: Authentication, Authorization, and Secure Communication.",
      "The use of protocol transition to access downstream resources relies on two extensions to the Kerberos protocol. Both extensions are implemented in Windows Server. These extensions are:",
      "For more information about protocol transition and the related service for user (S4U) extensions to the Kerberos protocol, see Exploring S4U Kerberos Extensions in Windows Server.",
      "Kerberos delegation on Windows Server 2000 is unconstrained and servers that are configured as trusted for delegation in Active Directory can access any network resources or any machine on the network while using the impersonated user's security context. This represents a potential security threat, particularly if the Web server is compromised.",
      "To address this issue, Windows Server 2003 and later includes constrained delegation. This allows administrators to specify exactly which services on a downstream server or a domain account can access when using an impersonated user's security context.",
      "This How To shows how to use protocol transition and constrained delegation in Windows Server to solve the following common problems:",
      "Protocol transition is appropriate when a non-Windows authentication mechanism is used by your Web application to authenticate clients. Consider the following scenarios:",
      "Follow these steps to use protocol transition and constrained delegation in ASP.NET on Windows Server:",
      "If your users have Windows domain accounts, but must connect to your Web server from outside the domain or a non-trusted domain (for example, over the Internet), then you cannot use integrated Windows authentication. Instead, you can use a non-Windows authentication mechanism, and then transition to Kerberos as shown in Figure 1.",
      "",
      "Figure 1. Using an S4U logon to call a database from an ASP.NET application using the caller's identity",
      "Create an ASP.NET application and configure it to use forms authentication. Note that instead of forms authentication, you could use any non-Windows authentication mechanism to authenticate the users of your application.",
      "Add the following code to your application. This code takes the user name supplied in the login form, constructs a UPN in the format userName@domainName, and passes the UPN to the WindowsIdentity constructor. This constructor uses the Kerberos S4U extension to obtain a Windows token for the user. The code then uses the token to begin impersonation.",
      "The type of token generated with the S4U2Self extension determines what you can do with the token while impersonating. You can obtain the following token types:",
      "In this step, you configure Active Directory to allow your Web application to use constrained delegation to access a remote database server.",
      "If your ASP.NET application runs using the Network Service machine account, then you must enable protocol transition and constrained delegation for your Web server computer. However, if your ASP.NET application runs under a custom domain account, you must enable protocol transition and constrained delegation for the custom domain account.",
      "This procedure assumes that you are running your Web application under the Network Service machine account.",
      "If you select Use Kerberos only, constrained delegation works only with Kerberos authentication. If you are using protocol transition to switch from forms authentication (or an alternate non-Kerberos authentication mechanism) to Kerberos, then you must select Use any authentication protocol.",
      "This procedure assumes that you are running your Web application under a custom domain account.",
      "setspn -A HTTP/webservernamedomain\\customAccountName",
      "setspn -A HTTP/webservername.fullyqualifieddomainname",
      "domain\\customAccountName",
      "If you select Use Kerberos only, constrained delegation works only with Kerberos authentication. If you are using protocol transition to switch from forms authentication (or an alternate non-Kerberos authentication mechanism) to Kerberos, then you must select Use any authentication protocol.",
      "In this step, you implement the code necessary to call the database using the identity of the caller. This example assumes the target database is a SQL Server called DBServer, the database server requires Windows authentication and the required database is the Northwind database.",
      "Note the following points about the preceding code:",
      "By default, an identify-level token is returned. You can only use this to check the user's group membership. You cannot access local or remote resources. However, if you configure protocol transition in Active Directory, you can use the token to access specified services on selected servers as defined by the A2D2 list.",
      "In this example, after the membership system in ASP.NET verifies the user's password, the Web application converts the user's name into the UPN form and constructs a WindowsIdentity object.",
      "If you try to create a WindowsIdentity object for a user that does not exist, the WindowsIdentity constructor generates a System.Security.SecurityException with the message Logon failure: unknown user name or bad password.",
      "You can use constrained delegation to pass the original caller's identity through multiple application tiers, for example from a Web server to an application server to a database server.",
      "In the following intranet scenario, the client's computer is on the same domain as the servers and can communicate directly with the domain controller. As a result, the ASP.NET application is configured for Windows authentication and the Web site is configured in IIS for integrated Windows authentication.",
      "The Web server accesses middle-tier business logic exposed by a Web service on an application server. This scenario is shown in Figure 2.",
      "",
      "Figure 2. Use constrained delegation with or without protocol transition through multiple tiers where the original caller is authenticated with Windows authentication.",
      "The key features of this scenario are:",
      "To configure the Web server, you need to enable Windows authentication within IIS, configure your ASP.NET application for impersonation, and set the Credentials property of the Web service proxy.",
      "To configure the application server, you need to enable Windows authentication within IIS, configure your ASP.NET application for impersonation, and use Windows authentication to access the database.",
      "You must configure Active Directory to allow the Web server application to use constrained delegation to access the Web service on the application server. You must also configure Active Directory to allow the Web service on the application server to access the SQL Server database.",
      "Follow the configuration steps described above for the Web server, except restrict access to the MSSQLSvc service on the database server.",
      "By default, a Windows Server 2003 domain runs in Windows 2000 mixed mode. You must raise the domain functional level to Windows Server 2003 to use constrained delegation and protocol transition.",
      "Adapted from Microsoft patterns & practices guidance."
    ],
    "i": [
      "constrained delegation",
      "userName",
      "domainName",
      "userName",
      "DomainName",
      "webservername",
      "domain",
      "customAccountName",
      "webservername.fullyqualifieddomainname",
      "domain",
      "customAccountName",
      "userName",
      "domainName",
      "computer",
      "user",
      "computer",
      "user",
      "machinename",
      "domain"
    ],
    "b": [
      "LogonUser",
      "Service-for-User-to-Self (S4U2Self)",
      "Service-for-User-to-Proxy (S4U2Proxy)",
      "Note",
      "",
      "If your client uses",
      "forms authentication, you can use LogonUser.",
      "LogonUser",
      "Note",
      "If your",
      "lient uses certificate authentication, you can consider protocol transition.",
      "Figure 1. Using an S4U logon to call a database from an ASP.NET application using the caller's identity",
      "Anonymous access and authentication control",
      "Directory",
      "security",
      "Anonymous access",
      "Login",
      "CreateUserWizard",
      "WindowsIdentity",
      "Note",
      "whoami /upn",
      "Whoami",
      "Identify-level token.",
      "Impersonation-level token.",
      "WindowsIdentity",
      "Note",
      "",
      "Note",
      "",
      "Note",
      "setspn -A MSSQLSvc/ databaseservername.fullyqualifieddomainname",
      "domain\\customAccountName",
      "Computers",
      "Properties",
      "Note",
      "Properties",
      "Delegation",
      "Trust Computer for Delegation",
      "General",
      "",
      "Delegation",
      "Properties",
      "Do not trust the computer for delegation",
      "Trust this computer for delegation to specified services only",
      "Trust this computer for delegation to specified services only",
      "Use any authentication protocol",
      "Use Kerberos only",
      "Use any authentication protocol",
      "Add",
      "Add Services",
      "Users or computers",
      "Select Users or Computers",
      "OK",
      "MSSQLSvc",
      "OK",
      "Note",
      "",
      "",
      "Setspn",
      "C:\\Program Files\\Support Tools",
      "setspn -A HTTP/webservernamedomain\\customAccountName",
      "setspn -A HTTP/webservername.fullyqualifieddomainname",
      "domain\\customAccountName",
      "Note",
      "Users",
      "Note",
      "Properties",
      "Delegation",
      "",
      "Delegation",
      "Properties",
      "Do not trust the computer for delegation",
      "Trust this user for delegation to specified services only",
      "Trust this user for delegation to specified services only",
      "Use any authentication protocol",
      "Use Kerberos only",
      "Use any authentication protocol",
      "Add",
      "Add Services",
      "Users or computers",
      "Select Users or Computers",
      "OK",
      "MSSQLSvc",
      "OK",
      "Note",
      "",
      "ImpersonateEndUser",
      "WindowsIdentity",
      "WindowsIdentity",
      "WindowsIdentity",
      "WindowsIdentity",
      "System.Security.SecurityException",
      "Logon failure: unknown user name or bad password",
      "CreateUserWizard",
      "Note",
      "Login",
      "SecurityException",
      "Figure 2. Use constrained delegation with or without protocol transition through multiple tiers where the original caller is authenticated with Windows authentication.",
      "Credentials",
      "Credentials",
      "Active Directory Users and Computers",
      "Properties",
      "Delegation",
      "Properties",
      "Trust this computer/user for delegation to specified services only",
      "Trust this computer/user for delegation to specified services only",
      "Use Kerberos only",
      "Use any protocol",
      "Add",
      "Add Services",
      "Users or computers",
      "Select Users or Computers",
      "OK.",
      "HTTP",
      "OK",
      "Active Directory Users and Computers",
      "MSSQLSvc",
      "Note",
      "",
      "Note",
      "",
      "Active Directory Users and Computers",
      "Properties",
      "Properties",
      "Active Directory User and Computers [machinename. domain]",
      "Action",
      "All Tasks",
      "Raise Domain Functional Level",
      "Windows Server 2003",
      "Select an available domain functional level",
      "OK"
    ],
    "div": [
      "Objectives",
      "Overview",
      "Scenarios",
      "Summary of Steps",
      "Step 1. Use an S4U Logon to Create a Windows Token for the Original Caller",
      "Step 2. Configure Your Service or Machine account for Constrained Delegation",
      "Step 3. Implement and Test Protocol Transition",
      "Using Constrained Delegation Through Multiple Tiers",
      "Domain Functional Levels",
      "Additional Resources",
      "<system.web>    ...    <authentication mode=\"Forms\"/>    <authorization>        <deny users=\"?\" />     </authorization>   ...</system.web>",
      "<%@ Page Language=\"C#\" %><!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.1//EN\" \"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\"><html  ><head runat=\"server\">    <title>Protocol Transition</title></head><body>    <form id=\"form1\" runat=\"server\">    <div>        <asp:Login ID=\"Login1\" runat=\"server\">        </asp:Login>        </div>        <asp:CreateUserWizard ID=\"CreateUserWizard1\" runat=\"server\">            <WizardSteps>                <asp:CreateUserWizardStep runat=\"server\">                </asp:CreateUserWizardStep>                <asp:CompleteWizardStep runat=\"server\">                </asp:CompleteWizardStep>            </WizardSteps>        </asp:CreateUserWizard>    </form></body></html>",
      "using System.Security.Principal;...// Obtain the user name (obtained from forms authentication)string identity = User.Identity.Name;\n    // Convert the user name from domainName\\userName format to // userName@domainName format if necessaryint slash = identity.IndexOf(\"\\\\\");if (slash > 0){  string domain = identity.Substring(0, slash);  string user = identity.Substring(slash + 1);  identity = user + \"@\" + domain;}\n    // The WindowsIdentity(string) constructor uses the new// Kerberos S4U extension to get a logon for the user// without a password.WindowsIdentity wi = new WindowsIdentity(identity);WindowsImpersonationContext wic = null;try{  wic = wi.Impersonate();  // Code to access network resources goes here.}catch(){  // Ensure that an exception is not propagated higher in the call stack.}finally{  // Make sure to remove the impersonation token  if( wic != null)    wic.Undo();}",
      "<configuration xmlns=\"http://schemas.microsoft.com/.NetConfiguration/v2.0\">  <connectionStrings>    <add name=\"nwindConnectionString\" connectionString=\"Data Source=DBServer;Initial Catalog=northwind;Integrated Security=True\"          providerName=\"System.Data.SqlClient\" />  </connectionStrings>  ...</configuration>",
      "Using System.Data.SqlClient;Using System.Security.Principal;...private DataTable CallDatabase(){  DataTable dt = new DataTable();  WindowsImpersonationContext wic = null;  try  {    // First, impersonate the original caller    wic = ImpersonateEndUser();    // Fetch data from the database using the original caller's     // security context    using (SqlConnection conn = new SqlConnection())    {      conn.ConnectionString = ConfigurationManager.ConnectionStrings                               [\"nwindConnectionString\"].ConnectionString;      conn.Open();      SqlCommand cmd = new SqlCommand(\"Select ProductName from Products\",                                       conn);       SqlDataAdapter da = new SqlDataAdapter(cmd);      da.Fill(dt);    }  }  catch  {    // Do not let the exception propagate higher up the call stack  }  finally  {    // Ensure that impersonation is stopped    if( wic != null)      wic.Undo();  }  return dt;}private WindowsImpersonationContext ImpersonateEndUser(){  // Obtain the user name (from forms authentication)  string identity = User.Identity.Name;  // Convert from domainName\\userName format to userName@domainName format  // if necessary  int slash = identity.IndexOf(\"\\\\\");  if (slash > 0)  {      string domain = identity.Substring(0, slash);      string user = identity.Substring(slash + 1);      identity = user + \"@\" + domain;  }  // The WindowsIdentity(string) constructor uses the new  // Kerberos S4U extension to get a logon for the user  // without a password.  WindowsIdentity wi = new WindowsIdentity(identity);  return wi.Impersonate();}",
      "<system.web>    ...    <authentication mode=\"Windows\"/>    <identity impersonate=\"true\"/>    ...</system.web>",
      "// Call the web service passing the original user's credentialsDataAccessWS.WebService ws = new DataAccessWS.WebService();ws.Credentials = CredentialCache.DefaultCredentials;  ws.GetData();",
      "<system.web>    ...    <authentication mode=\"Windows\"/>    <identity impersonate=\"true\"/>    ...</system.web>"
    ],
    "h2": [
      "Protocol Transition",
      "Constrained Delegation",
      "Scenarios",
      "Configure ASP.NET for Forms Authentication",
      "Obtain a Windows Token for the Original Caller",
      "To configure protocol transition for the machine account",
      "To configure protocol transition for a custom domain account",
      "To implement code that uses the caller's identity",
      "To test protocol transition and constrained delegation",
      "Web to Application Server to Database",
      "Web Server Configuration",
      "Application Server Configuration",
      "Active Directory Configuration",
      "To verify the domain functional level",
      "To raise the domain functional level to Windows Server 2003"
    ],
    "a": [
      "Building Secure ASP.NET Applications: Authentication, Authorization, and Secure Communication",
      "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd",
      "userName@domainName",
      "http://schemas.microsoft.com/.NetConfiguration/v2.0",
      "userName@domainName"
    ],
    "blockquote": [
      "Note   The list of services that can be accessed by delegation is maintained in an Active Directory list referred to as the A2D2 list.",
      "Note   The example in this How To uses forms authentication for simplicity.",
      "Note   In many cases, the UPN is the user's e-mail address, but it does not have to be. For some accounts, it may not be configured at all. The default format for a UPN is userName@DomainName. If you are logged on to a domain, you can display your user name in UPN format by running the command whoami /upn from a command prompt. Whoami is a command-line tool available on Windows Server and in the in the Support/Tools directory on the Windows XP Professional operating system CD.",
      "Note   This places your process within the trusted computing base (TCB) of the Web server, which makes your Web server process very highly privileged. Where possible, you should avoid this approach because an attacker who manages to inject code and compromise your Web application will have unrestricted capabilities on the local computer.",
      "Note   If your process account is part of the TCB, you get an impersonate-level token. To access network resources, you must enable protocol transition in Active Directory. In this case, you can obtain S4U2Proxy tickets on behalf of your client by accessing remote services defined in the A2D2 list.",
      "Note   If you use a custom domain account to run SQL Server, you must create a service principal name (SPN) for this account. You can do this by using the following command:",
      "setspn -A MSSQLSvc/ databaseservername.fullyqualifieddomainname",
      "domain\\customAccountName",
      "If you run SQL Server by using the System account (which is not recommended because of the associated high privileges that an attacker could exploit), an SPN is created automatically for you.",
      "Note   If the Properties dialog box does not have a Delegation tab and there is a single checkbox called Trust Computer for Delegation on the General tab, your domain is operating as a Windows 2000 mixed domain. You must raise the domain functional level to Windows Server 2003 as described in the section \"Domain Functional Levels,\" in this document.",
      "Note   If you want to delegate to a file on a file share, you need to select the Common Internet File System (CIFS) service.",
      "Note   You can only have a single SPN associated with any HTTP service (DNS) name, which means you cannot create SPNs for different service accounts mapped to the same HTTP server unless they are on different ports. The SPN can include a port number.",
      "Note   If the Properties dialog box for your account does not have a Delegation tab, this indicates that a service principal name (SPN) does not exist for the user. Create an SPN as explained in step 1, above.",
      "Note   To allow access to SQL Server, you must create a SQL Server login for each of your application's end users or for a set of groups that the users belong to, and grant them read access to the Northwind database.",
      "Note   By default, the ASP.NET login controls automatically create and configure a SQL Express membership database in the \\app_data folder to act as your membership database.",
      "Note   If you are using a custom domain account to run your Web application, Web service or SQL Server, be sure that you have created an SPN for the account. For details about creating an SPN, see \"Step 2. Configure Your Service or Machine Account.\"",
      "Note   This change is not reversible."
    ],
    "img": [
      "",
      ""
    ],
    "h3": [
      "To configure a Web site for forms authentication",
      "To create a login form for the Web site",
      "Token Types",
      "To configure your Web server and ASP.NET presentation-tier application",
      "To configure your application server and Web service",
      "To configure constrained delegation for the Web server",
      "To configure constrained delegation for the application server"
    ],
    "ol": [
      "Create a Web application. In Internet Information Services Administrator, edit the properties of the Web site. Edit the Anonymous access and authentication control on the Directorysecurity tab, and check the Anonymous access checkbox. Create a Web application. Add a Web.config file, enable forms authentication, and deny access to unauthenticated users by adding the following configuration. <system.web>    ...    <authentication mode=\"Forms\"/>    <authorization>        <deny users=\"?\" />     </authorization>   ...</system.web>",
      "Add a Web form called Login.aspx. Add a Login control and a CreateUserWizard control, as shown in the following example. <%@ Page Language=\"C#\" %><!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.1//EN\" \"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\"><html  ><head runat=\"server\">    <title>Protocol Transition</title></head><body>    <form id=\"form1\" runat=\"server\">    <div>        <asp:Login ID=\"Login1\" runat=\"server\">        </asp:Login>        </div>        <asp:CreateUserWizard ID=\"CreateUserWizard1\" runat=\"server\">            <WizardSteps>                <asp:CreateUserWizardStep runat=\"server\">                </asp:CreateUserWizardStep>                <asp:CompleteWizardStep runat=\"server\">                </asp:CompleteWizardStep>            </WizardSteps>        </asp:CreateUserWizard>    </form></body></html>",
      "Start the Microsoft Management Console (MMC) Active Directory Users and Computers snap-in. In the left pane of the MMC snap-in, click the Computers node. In the right pane, double-click your Web server computer to display the Properties dialog box. Note   If the Properties dialog box does not have a Delegation tab and there is a single checkbox called Trust Computer for Delegation on the General tab, your domain is operating as a Windows 2000 mixed domain. You must raise the domain functional level to Windows Server 2003 as described in the section \"Domain Functional Levels,\" in this document.On the Delegation tab of the Properties window for the Web server computer, Do not trust the computer for delegation is selected by default. To use constrained delegation, select Trust this computer for delegation to specified services only. You specify precisely which service or services can be accessed in the bottom pane. Beneath Trust this computer for delegation to specified services only, select Use any authentication protocol. If you select Use Kerberos only, constrained delegation works only with Kerberos authentication. If you are using protocol transition to switch from forms authentication (or an alternate non-Kerberos authentication mechanism) to Kerberos, then you must select Use any authentication protocol. Click the Add button. This displays the Add Services dialog box. Click the Users or computers button. In the Select Users or Computers dialog, type the name of your database server computer if you are running SQL Server as System or Network Service. Alternatively, if you are running SQL Server by using a custom domain account, enter that account name instead. Then click OK. You will see all the service principal names configured for the selected user or computer account. To restrict access to SQL Server, select the MSSQLSvc service, and then click OK. Note   If you want to delegate to a file on a file share, you need to select the Common Internet File System (CIFS) service.",
      "Create an SPN for your custom domain account. Kerberos requires an SPN to support mutual authentication. To create an SPN for the domain account:Install the Windows Server Tools from the Windows Server CD. From a command prompt, run the Setspn tool twice from the C:\\Program Files\\Support Tools directory as shown here. setspn -A HTTP/webservernamedomain\\customAccountNamesetspn -A HTTP/webservername.fullyqualifieddomainnamedomain\\customAccountNameNote   You can only have a single SPN associated with any HTTP service (DNS) name, which means you cannot create SPNs for different service accounts mapped to the same HTTP server unless they are on different ports. The SPN can include a port number.",
      "Install the Windows Server Tools from the Windows Server CD. From a command prompt, run the Setspn tool twice from the C:\\Program Files\\Support Tools directory as shown here. setspn -A HTTP/webservernamedomain\\customAccountNamesetspn -A HTTP/webservername.fullyqualifieddomainnamedomain\\customAccountNameNote   You can only have a single SPN associated with any HTTP service (DNS) name, which means you cannot create SPNs for different service accounts mapped to the same HTTP server unless they are on different ports. The SPN can include a port number.",
      "Define a connection string to the database server in your Web.config file, specifying Windows authentication to the database, as shown in the following example. <configuration xmlns=\"http://schemas.microsoft.com/.NetConfiguration/v2.0\">  <connectionStrings>    <add name=\"nwindConnectionString\" connectionString=\"Data Source=DBServer;Initial Catalog=northwind;Integrated Security=True\"          providerName=\"System.Data.SqlClient\" />  </connectionStrings>  ...</configuration>  Use code similar to the following to impersonate the caller and access the database. Using System.Data.SqlClient;Using System.Security.Principal;...private DataTable CallDatabase(){  DataTable dt = new DataTable();  WindowsImpersonationContext wic = null;  try  {    // First, impersonate the original caller    wic = ImpersonateEndUser();    // Fetch data from the database using the original caller's     // security context    using (SqlConnection conn = new SqlConnection())    {      conn.ConnectionString = ConfigurationManager.ConnectionStrings                               [\"nwindConnectionString\"].ConnectionString;      conn.Open();      SqlCommand cmd = new SqlCommand(\"Select ProductName from Products\",                                       conn);       SqlDataAdapter da = new SqlDataAdapter(cmd);      da.Fill(dt);    }  }  catch  {    // Do not let the exception propagate higher up the call stack  }  finally  {    // Ensure that impersonation is stopped    if( wic != null)      wic.Undo();  }  return dt;}private WindowsImpersonationContext ImpersonateEndUser(){  // Obtain the user name (from forms authentication)  string identity = User.Identity.Name;  // Convert from domainName\\userName format to userName@domainName format  // if necessary  int slash = identity.IndexOf(\"\\\\\");  if (slash > 0)  {      string domain = identity.Substring(0, slash);      string user = identity.Substring(slash + 1);      identity = user + \"@\" + domain;  }  // The WindowsIdentity(string) constructor uses the new  // Kerberos S4U extension to get a logon for the user  // without a password.  WindowsIdentity wi = new WindowsIdentity(identity);  return wi.Impersonate();}  Note the following points about the preceding code: The ImpersonateEndUser method uses the user name of the user that has been authenticated using forms authentication. It converts the user name to UPN format (userName@domainName), and passes the UPN to the WindowsIdentity constructor. This constructor returns a Windows token for a domain account without requiring the account's password. By default, an identify-level token is returned. You can only use this to check the user's group membership. You cannot access local or remote resources. However, if you configure protocol transition in Active Directory, you can use the token to access specified services on selected servers as defined by the A2D2 list. Your application must authenticate the request by using the user name and password submitted on your forms login page. When your application determines that the user is authentic, you must select an existing Windows account to represent the user on the back end. This example assumes that the user submitted a Windows user name and domain name on the forms login page and supplied a password that the ASP.NET membership provider could verify. This is not the password for the Windows account. The purpose of protocol transition is to avoid exposing Windows passwords in this way. In this example, after the membership system in ASP.NET verifies the user's password, the Web application converts the user's name into the UPN form and constructs a WindowsIdentity object. If you try to create a WindowsIdentity object for a user that does not exist, the WindowsIdentity constructor generates a System.Security.SecurityException with the message Logon failure: unknown user name or bad password.",
      "Start your application. Use the CreateUserWizard control on the login page to create two user accounts: one that has a user name that matches a domain account and also has a SQL Server login that authorizes read access to the Northwind database, and one that has a user name that does not match a domain account. Note   By default, the ASP.NET login controls automatically create and configure a SQL Express membership database in the \\app_data folder to act as your membership database. Use the Login control to log in with the user account that does not match a domain account. The login will succeed, but the attempt to impersonate the user will fail and will generate a SecurityException because the user name does not match a domain name. Start the application again. Log in using the user name that does match a domain account name. On the Web server, the ASP.NET application impersonates the original caller and runs using the identity of the caller. The constrained delegation configuration ensures that the same identity is used to access the database.",
      "Use IIS to configure your Web site for Integrated Windows authentication. Make sure anonymous access is disabled. Use the following settings to configure your ASP.NET application to use Windows authentication and impersonation. <system.web>    ...    <authentication mode=\"Windows\"/>    <identity impersonate=\"true\"/>    ...</system.web>  Set the Credentials property on the Web service proxy to pass the authenticated user's security context to the Web service, as shown in the following code. // Call the web service passing the original user's credentialsDataAccessWS.WebService ws = new DataAccessWS.WebService();ws.Credentials = CredentialCache.DefaultCredentials;  ws.GetData();",
      "Use IIS to configure your Web site for Integrated Windows authentication. Make sure anonymous access is disabled. Use the following settings to configure your Web service to use Windows authentication and impersonation. <system.web>    ...    <authentication mode=\"Windows\"/>    <identity impersonate=\"true\"/>    ...</system.web>Use Windows authentication to access the database. The impersonation configuration ensures that the authenticated user's credentials are used to access the database. You must ensure that the relevant end user account has a SQL Server login and relevant database permissions.",
      "Use the Active Directory Users and Computers MMC snap in to display the Properties dialog box for either the Web server computer (if you are using the Network Service account to run your ASP.NET Web application), or your custom user account (if you are using a custom account to run your application). On the Delegation tab of the Properties window, select Trust this computer/user for delegation to specified services only. This enables constrained delegation for the services you will select in the bottom pane. After Trust this computer/user for delegation to specified services only, select Use Kerberos only. This restricts the use of constrained delegation to scenarios where the callers are authenticated using Kerberos authentication only. Note that if you are authenticating callers to the Web server using any technique other than Kerberos you must select Use any protocol, and obtain a Windows token for the caller programmatically as explained in the section, \"Step 1. Use Protocol Transition to Create a Windows Token for the Original Caller,\" in this document. Click the Add button. This displays the Add Services dialog box. Click the Users or computers button In the Select Users or Computers dialog box, type the name of your application server, and then click OK.You will see all the available services on your application server. Select the HTTP service, and then click OK.",
      "In the left pane of the Active Directory Users and Computers MMC snap-in, right-click the root node for the domain, and then click Properties. The Properties dialog box displays information including the domain functional level. If the domain is operating as a Windows 2000 mixed domain, you must raise the domain functional level to Windows Server 2003 before you can use constrained delegation.",
      "In the Active Directory Users and Computers MMC snap-in, click the root node titled Active Directory User and Computers [machinename. domain]. On the Action menu, click All Tasks, and then click Raise Domain Functional Level. Select Windows Server 2003 from the Select an available domain functional level dropdown box. Click OK."
    ],
    "pre": [
      "<system.web>    ...    <authentication mode=\"Forms\"/>    <authorization>        <deny users=\"?\" />     </authorization>   ...</system.web>",
      "<%@ Page Language=\"C#\" %><!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.1//EN\" \"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\"><html  ><head runat=\"server\">    <title>Protocol Transition</title></head><body>    <form id=\"form1\" runat=\"server\">    <div>        <asp:Login ID=\"Login1\" runat=\"server\">        </asp:Login>        </div>        <asp:CreateUserWizard ID=\"CreateUserWizard1\" runat=\"server\">            <WizardSteps>                <asp:CreateUserWizardStep runat=\"server\">                </asp:CreateUserWizardStep>                <asp:CompleteWizardStep runat=\"server\">                </asp:CompleteWizardStep>            </WizardSteps>        </asp:CreateUserWizard>    </form></body></html>",
      "using System.Security.Principal;...// Obtain the user name (obtained from forms authentication)string identity = User.Identity.Name;",
      "// Convert the user name from domainName\\userName format to // userName@domainName format if necessaryint slash = identity.IndexOf(\"\\\\\");if (slash > 0){  string domain = identity.Substring(0, slash);  string user = identity.Substring(slash + 1);  identity = user + \"@\" + domain;}",
      "// The WindowsIdentity(string) constructor uses the new// Kerberos S4U extension to get a logon for the user// without a password.WindowsIdentity wi = new WindowsIdentity(identity);WindowsImpersonationContext wic = null;try{  wic = wi.Impersonate();  // Code to access network resources goes here.}catch(){  // Ensure that an exception is not propagated higher in the call stack.}finally{  // Make sure to remove the impersonation token  if( wic != null)    wic.Undo();}",
      "<configuration xmlns=\"http://schemas.microsoft.com/.NetConfiguration/v2.0\">  <connectionStrings>    <add name=\"nwindConnectionString\" connectionString=\"Data Source=DBServer;Initial Catalog=northwind;Integrated Security=True\"          providerName=\"System.Data.SqlClient\" />  </connectionStrings>  ...</configuration>",
      "Using System.Data.SqlClient;Using System.Security.Principal;...private DataTable CallDatabase(){  DataTable dt = new DataTable();  WindowsImpersonationContext wic = null;  try  {    // First, impersonate the original caller    wic = ImpersonateEndUser();    // Fetch data from the database using the original caller's     // security context    using (SqlConnection conn = new SqlConnection())    {      conn.ConnectionString = ConfigurationManager.ConnectionStrings                               [\"nwindConnectionString\"].ConnectionString;      conn.Open();      SqlCommand cmd = new SqlCommand(\"Select ProductName from Products\",                                       conn);       SqlDataAdapter da = new SqlDataAdapter(cmd);      da.Fill(dt);    }  }  catch  {    // Do not let the exception propagate higher up the call stack  }  finally  {    // Ensure that impersonation is stopped    if( wic != null)      wic.Undo();  }  return dt;}private WindowsImpersonationContext ImpersonateEndUser(){  // Obtain the user name (from forms authentication)  string identity = User.Identity.Name;  // Convert from domainName\\userName format to userName@domainName format  // if necessary  int slash = identity.IndexOf(\"\\\\\");  if (slash > 0)  {      string domain = identity.Substring(0, slash);      string user = identity.Substring(slash + 1);      identity = user + \"@\" + domain;  }  // The WindowsIdentity(string) constructor uses the new  // Kerberos S4U extension to get a logon for the user  // without a password.  WindowsIdentity wi = new WindowsIdentity(identity);  return wi.Impersonate();}",
      "<system.web>    ...    <authentication mode=\"Windows\"/>    <identity impersonate=\"true\"/>    ...</system.web>",
      "// Call the web service passing the original user's credentialsDataAccessWS.WebService ws = new DataAccessWS.WebService();ws.Credentials = CredentialCache.DefaultCredentials;  ws.GetData();",
      "<system.web>    ...    <authentication mode=\"Windows\"/>    <identity impersonate=\"true\"/>    ...</system.web>"
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "hr": [
      ""
    ]
  },
  "links": [
    {
      "href": "http://msdn2.microsoft.com/en-us/library/aa302383.aspx",
      "text": "Building Secure ASP.NET Applications: Authentication, Authorization, and Secure Communication"
    },
    {
      "href": "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd",
      "text": "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"
    },
    {
      "href": "mailto:userName@domainName",
      "text": "userName@domainName"
    },
    {
      "href": "http://schemas.microsoft.com/.NetConfiguration/v2.0",
      "text": "http://schemas.microsoft.com/.NetConfiguration/v2.0"
    },
    {
      "href": "mailto:userName@domainName",
      "text": "userName@domainName"
    }
  ],
  "html": "<h1>Applies to</h1>\n  <ul>\n    <li>Internet Information Services 6.0 or later<li>Microsoft Windows Server 2003 or later&nbsp;operating system </li></li>\n  </ul>\n  <h1>Summary</h1>\n  <p>This How To shows you how to configure and use protocol transition and constrained delegation to allow your ASP.NET application to access network resources while impersonating the original caller. The Microsoft Windows 2000 operating system supports delegation; however, access to downstream servers or services cannot be limited by delegation. The Microsoft Windows Server 2003 and later operating systems provides a more secure form of delegation called <i>constrained delegation</i>. With constrained delegation, you can configure the Microsoft Active Directory&#174; directory service to restrict the services and servers that your ASP.NET application can access with the impersonated identity.</p>\n  <p>Constrained delegation in Windows Server requires Kerberos authentication. If your application cannot use Kerberos authentication to authenticate its callers, you can use protocol transition to switch from an alternate, non-Windows authentication mode (such as forms or certificate authentication) to Kerberos authentication. You can then use Kerberos with constrained delegation to access downstream network resources.</p>\n  <p>For demonstration purposes, this How To uses protocol transition with forms authentication. In practice, you would use the <b>LogonUser</b> API because you already obtained the username and password. An example of a production scenario for protocol transition is where you use certificates to authenticate users and want to map them to existing Windows accounts.</p>\n  <h1>Contents</h1>\n  <ul>\n    <li>\n      <div>Objectives</div>\n      <li>\n        <div>Overview</div>\n        <li>\n          <div>Scenarios</div>\n          <li>\n            <div>Summary of Steps</div>\n            <li>\n              <div>Step 1. Use an S4U Logon to Create a Windows Token for the Original Caller</div>\n              <li>\n                <div>Step 2. Configure Your Service or Machine account for Constrained Delegation</div>\n                <li>\n                  <div>Step 3. Implement and Test Protocol Transition</div>\n                  <li>\n                    <div>Using Constrained Delegation Through Multiple Tiers</div>\n                    <li>\n                      <div>Domain Functional Levels</div>\n                      <li>\n                        <div>Additional Resources</div>\n                      </li>\n                    </li>\n                  </li>\n                </li>\n              </li>\n            </li>\n          </li>\n        </li>\n      </li>\n    </li>\n  </ul>\n  <h1>Objectives</h1>\n  <ul>\n    <li>Use protocol transition to switch from non-Windows authentication to Kerberos authentication. <li>Use constrained delegation to restrict access to specific services. <li>Pass the original caller identity from the Web server to the database server. <li>Pass the original caller identity from the Web server to the application server to the database server. </li></li></li></li>\n  </ul>\n  <h1>Overview</h1>\n  <p>When an ASP.NET application impersonates the original caller, it accesses resources by using the security context of the authenticated user. However, the application can only access local resources. To access network resources while impersonating a remote user, your application must use delegation. If your application uses Kerberos authentication to authenticate its users, you can use delegation to pass the caller's identity through the layers of your application, and use it to access network resources. If your application does not use Kerberos authentication, you can use protocol transition to switch from a non-Kerberos authentication mechanism to Kerberos, and then use delegation to pass the identity on.</p>\n  <h2>Protocol Transition</h2>\n  <p>In many situations&#8212;for example, if your users access a Web site over the Internet&#8212;you cannot use Kerberos authentication because firewalls prevent the client computer from directly communicating with the domain controller. Instead, your application must authenticate the client by using another approach, such as forms authentication, or in an extranet scenario, client certificate authentication.</p>\n  <p>Windows Server has a protocol transition feature that permits applications to use a non-Windows authentication mechanism to authenticate users, but still use Kerberos authentication and delegation to access downstream network resources. This allows your application to access downstream servers that require Windows authentication and it allows you to use Windows auditing to track user access to backend resources.</p>\n  <p>Note that impersonating a Windows identity to access downstream resources brings a number of advantages, but also some disadvantages. The advantages include the ability to use Windows auditing to track user access to back-end resources, and the ability to implement fine-grained access controls to resources (such as databases) on a per-user basis. The disadvantages include the additional administration required to administer fine-grained access controls and reduced scalability. For many applications, the trusted subsystem model is appropriate; for example, where the Web server authenticates the caller, but then uses a service identity to access downstream resources on behalf of the original caller. This results in reduced administration and improved scalability. For more information on selecting the appropriate authentication model for your application, see <a href=\"http://msdn2.microsoft.com/en-us/library/aa302383.aspx\">Building Secure ASP.NET Applications: Authentication, Authorization, and Secure Communication</a>.</p>\n  <p>The use of protocol transition to access downstream resources relies on two extensions to the Kerberos protocol. Both extensions are implemented in Windows Server. These extensions are: </p>\n  <ul>\n    <li>\n      <b>Service-for-User-to-Self (S4U2Self)</b>, which allows you to obtain a Windows token for the client by supplying a user principal name (UPN) without a password. <li><b>Service-for-User-to-Proxy (S4U2Proxy)</b>, which allows an administrator to control exactly which downstream services can be accessed with the S4U2Self token. </li></li>\n  </ul>\n  <p>For more information about protocol transition and the related service for user (S4U) extensions to the Kerberos protocol, see Exploring S4U Kerberos Extensions in Windows Server.</p>\n  <h2>Constrained Delegation</h2>\n  <p>Kerberos delegation on Windows Server 2000 is unconstrained and servers that are configured as trusted for delegation in Active Directory can access any network resources or any machine on the network while using the impersonated user's security context. This represents a potential security threat, particularly if the Web server is compromised.</p>\n  <p>To address this issue, Windows Server 2003 and later&nbsp;includes constrained delegation. This allows administrators to specify exactly which services on a downstream server or a domain account can access when using an impersonated user's security context.</p>\n  <blockquote>\n    <b>Note</b>&nbsp;&nbsp;&nbsp;The list of services that can be accessed by delegation is maintained in an Active Directory list referred to as the A2D2 list.<b></b></blockquote>\n  <p>This How To shows how to use protocol transition and constrained delegation in Windows Server to solve the following common problems: </p>\n  <ul>\n    <li>Using a non-Windows authentication mechanism for external clients and then transitioning to Kerberos authentication to access network resources. <li>Impersonating Kerberos-authenticated clients and then using their Windows security context to pass their identities through multiple tiers to access network resources. </li></li>\n  </ul>\n  <h2>Scenarios</h2>\n  <p>Protocol transition is appropriate when a non-Windows authentication mechanism is used by your Web application to authenticate clients. Consider the following scenarios: </p>\n  <ul>\n    <li>\n      <b>If your client uses</b>\n      <b>forms authentication, you can use LogonUser.</b> If the user name and password entered through the forms login page map directly to a Windows domain account, your application can call the <b>LogonUser</b> API and avoid protocol transition. <blockquote><b>Note</b>&nbsp;&nbsp;&nbsp;The example in this How To uses forms authentication for simplicity.</blockquote><li><b>If your</b> c<b>lient uses certificate authentication, you can consider protocol transition.</b> If your client uses certificates to authenticate with your Web server the application can look up the user in Active Directory based on the certificate, and use protocol transition to allow the user to log on. </li></li>\n  </ul>\n  <h1>Summary of Steps</h1>\n  <p>Follow these steps to use protocol transition and constrained delegation in ASP.NET on Windows Server: </p>\n  <ul>\n    <li>Step 1. Use an S4U Logon to create a Windows token for the original caller. <li>Step 2. Configure your service or machine account for constrained delegation. <li>Step 3. Implement and test protocol transition. </li></li></li>\n  </ul>\n  <h1>Step 1. Use an S4U Logon to Create a Windows Token for the Original Caller</h1>\n  <p>If your users have Windows domain accounts, but must connect to your Web server from outside the domain or a non-trusted domain (for example, over the Internet), then you cannot use integrated Windows authentication. Instead, you can use a non-Windows authentication mechanism, and then transition to Kerberos as shown in Figure 1.</p>\n  <p>\n    <img alt=\"\" src=\"http://msdn2.microsoft.com/en-us/library/ms998355.f01paght00002401(en-us,MSDN.10).gif\" border=\"0\" />\n  </p>\n  <p>\n    <b>Figure 1. Using an S4U logon to call a database from an ASP.NET application using the caller's identity</b>\n  </p>\n  <h2>Configure ASP.NET for Forms Authentication</h2>\n  <p>Create an ASP.NET application and configure it to use forms authentication. Note that instead of forms authentication, you could use any non-Windows authentication mechanism to authenticate the users of your application.</p>\n  <h3>To configure a Web site for forms authentication </h3>\n  <ol>\n    <li>Create a Web application. <li>In Internet Information Services Administrator, edit the properties of the Web site. Edit the <b>Anonymous access and authentication control</b> on the <b>Directory</b><b>security</b> tab, and check the <b>Anonymous access</b> checkbox. <li>Create a Web application. Add a Web.config file, enable forms authentication, and deny access to unauthenticated users by adding the following configuration. <div><pre>&lt;system.web&gt;<br />&nbsp;&nbsp;&nbsp; ...<br />&nbsp;&nbsp;&nbsp; &lt;authentication mode=\"Forms\"/&gt;<br />&nbsp;&nbsp;&nbsp; &lt;authorization&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;deny users=\"?\" /&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp; &lt;/authorization&gt;<br />&nbsp;&nbsp; ...<br />&lt;/system.web&gt;  </pre></div></li></li></li>\n  </ol>\n  <h3>To create a login form for the Web site </h3>\n  <ol>\n    <li>Add a Web form called Login.aspx. <li>Add a <b>Login</b> control and a <b>CreateUserWizard</b> control, as shown in the following example. <div><pre>&lt;&#37;&#64; Page Language=\"C#\" &#37;&gt;<br />&lt;&#33;DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.1//EN\" \"<a href=\"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd\">http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd</a>\"&gt;<br />&lt;html&nbsp; &gt;<br />&lt;head runat=\"server\"&gt;<br />&nbsp;&nbsp;&nbsp; &lt;title&gt;Protocol Transition&lt;/title&gt;<br />&lt;/head&gt;<br />&lt;body&gt;<br />&nbsp;&nbsp;&nbsp; &lt;form id=\"form1\" runat=\"server\"&gt;<br />&nbsp;&nbsp;&nbsp; &lt;div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;asp:Login ID=\"Login1\" runat=\"server\"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/asp:Login&gt;<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; &lt;/div&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;asp:CreateUserWizard ID=\"CreateUserWizard1\" runat=\"server\"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;WizardSteps&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;asp:CreateUserWizardStep runat=\"server\"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/asp:CreateUserWizardStep&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;asp:CompleteWizardStep runat=\"server\"&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/asp:CompleteWizardStep&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/WizardSteps&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/asp:CreateUserWizard&gt;<br />&nbsp;&nbsp;&nbsp; &lt;/form&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;  </pre></div></li></li>\n  </ol>\n  <h2>Obtain a Windows Token for the Original Caller</h2>\n  <p>Add the following code to your application. This code takes the user name supplied in the login form, constructs a UPN in the format <i>userName</i>&#64;<i>domainName</i>, and passes the UPN to the <b>WindowsIdentity</b> constructor. This constructor uses the Kerberos S4U extension to obtain a Windows token for the user. The code then uses the token to begin impersonation.</p>\n  <div>\n    <pre>using System.Security.Principal;<br />...<br />// Obtain the user name (obtained from forms authentication)<br />string identity = User.Identity.Name;</pre>\n    <pre>// Convert the user name from domainName\\userName format to <br />// <a href=\"mailto:userName&#64;domainName\">userName&#64;domainName</a> format if necessary<br />int slash = identity.IndexOf(\"\\\\\");<br />if (slash &gt; 0)<br />&#123;<br />&nbsp; string domain = identity.Substring(0, slash);<br />&nbsp; string user = identity.Substring(slash &#43; 1);<br />&nbsp; identity = user &#43; \"&#64;\" &#43; domain;<br />&#125;</pre>\n    <pre>// The WindowsIdentity(string) constructor uses the new<br />// Kerberos S4U extension to get a logon for the user<br />// without a password.<br />WindowsIdentity wi = new WindowsIdentity(identity);<br />WindowsImpersonationContext wic = null;<br />try<br />&#123;<br />&nbsp; wic = wi.Impersonate();<br />&nbsp; // Code to access network resources goes here.<br />&#125;<br />catch()<br />&#123;<br />&nbsp; // Ensure that an exception is not propagated higher in the call stack.<br />&#125;<br />finally<br />&#123;<br />&nbsp; // Make sure to remove the impersonation token<br />&nbsp; if( wic &#33;= null)<br />&nbsp;&nbsp;&nbsp; wic.Undo();<br />&#125;  </pre>\n  </div>\n  <blockquote>\n    <b>Note</b>&nbsp;&nbsp;&nbsp;In many cases, the UPN is the user's e-mail address, but it does not have to be. For some accounts, it may not be configured at all. The default format for a UPN is <i>userName</i>&#64;<i>DomainName</i>. If you are logged on to a domain, you can display your user name in UPN format by running the command <b>whoami /upn</b> from a command prompt. <b>Whoami</b> is a command-line tool available on Windows Server and in the in the Support/Tools directory on the Windows XP Professional operating system CD.</blockquote>\n  <h3>Token Types</h3>\n  <p>The type of token generated with the S4U2Self extension determines what you can do with the token while impersonating. You can obtain the following token types: </p>\n  <ul>\n    <li>\n      <b>Identify-level token.</b> This is returned by default. With this token type, you can check to see what groups are contained in the token, but you cannot use it to access local or remote resources while impersonating. <li><b>Impersonation-level token.</b> This type of token allows you to access local resources while impersonating. To obtain this type of token from the <b>WindowsIdentity</b> constructor, you must grant your process account the \"Act as part of the operating system\" user right. <blockquote><b>Note</b>&nbsp;&nbsp;&nbsp;This places your process within the trusted computing base (TCB) of the Web server, which makes your Web server process very highly privileged. Where possible, you should avoid this approach because an attacker who manages to inject code and compromise your Web application will have unrestricted capabilities on the local computer.<b></b></blockquote><blockquote><b>Note</b>&nbsp;&nbsp;&nbsp;If your process account is part of the TCB, you get an impersonate-level token. To access network resources, you must enable protocol transition in Active Directory. In this case, you can obtain S4U2Proxy tickets on behalf of your client by accessing remote services defined in the A2D2 list.<b></b></blockquote></li></li>\n  </ul>\n  <h1>Step 2. Configure Your Service or Machine Account for Constrained Delegation</h1>\n  <p>In this step, you configure Active Directory to allow your Web application to use constrained delegation to access a remote database server.</p>\n  <p>If your ASP.NET application runs using the Network Service machine account, then you must enable protocol transition and constrained delegation for your Web server computer. However, if your ASP.NET application runs under a custom domain account, you must enable protocol transition and constrained delegation for the custom domain account.</p>\n  <blockquote>\n    <b>Note</b>&nbsp;&nbsp;&nbsp;If you use a custom domain account to run SQL Server, you must create a service principal name (SPN) for this account. You can do this by using the following command:</blockquote>\n  <blockquote>\n    <b>setspn -A MSSQLSvc/ databaseservername.fullyqualifieddomainname</b>\n  </blockquote>\n  <blockquote>\n    <b>domain\\customAccountName </b>\n  </blockquote>\n  <blockquote>If you run SQL Server by using the System account (which is not recommended because of the associated high privileges that an attacker could exploit), an SPN is created automatically for you. </blockquote>\n  <h2>To configure protocol transition for the machine account</h2>\n  <p>This procedure assumes that you are running your Web application under the Network Service machine account. </p>\n  <ol>\n    <li>Start the Microsoft Management Console (MMC) Active Directory Users and Computers snap-in. <li>In the left pane of the MMC snap-in, click the <b>Computers</b> node. <li>In the right pane, double-click your Web server computer to display the <b>Properties</b> dialog box. <blockquote><b>Note</b>&nbsp;&nbsp;&nbsp;If the <b>Properties</b> dialog box does not have a <b>Delegation</b> tab and there is a single checkbox called <b>Trust Computer for Delegation</b> on the <b>General</b> tab, your domain is operating as a Windows 2000 mixed domain. You must raise the domain functional level to Windows Server 2003 as described in the section \"Domain Functional Levels,\" in this document.<b></b></blockquote><li>On the <b>Delegation</b> tab of the <b>Properties</b> window for the Web server computer, <b>Do not trust the computer for delegation</b> is selected by default. To use constrained delegation, select <b>Trust this computer for delegation to specified services only</b>. You specify precisely which service or services can be accessed in the bottom pane. <li>Beneath <b>Trust this computer for delegation to specified services only</b>, select <b>Use any authentication protocol</b>. <p>If you select <b>Use Kerberos only</b>, constrained delegation works only with Kerberos authentication. If you are using protocol transition to switch from forms authentication (or an alternate non-Kerberos authentication mechanism) to Kerberos, then you must select <b>Use any authentication protocol</b>. </p><li>Click the <b>Add</b> button. This displays the <b>Add Services</b> dialog box. <li>Click the <b>Users or computers</b> button. <li>In the <b>Select Users or Computers</b> dialog, type the name of your database server computer if you are running SQL Server as System or Network Service. Alternatively, if you are running SQL Server by using a custom domain account, enter that account name instead. Then click <b>OK</b>. <li>You will see all the service principal names configured for the selected user or computer account. To restrict access to SQL Server, select the <b>MSSQLSvc</b> service, and then click <b>OK</b>. <blockquote><b>Note</b>&nbsp;&nbsp;&nbsp;If you want to delegate to a file on a file share, you need to select the Common Internet File System (CIFS) service.<b></b></blockquote></li></li></li></li></li></li></li></li></li>\n  </ol>\n  <h2>To configure protocol transition for a custom domain account</h2>\n  <p>This procedure assumes that you are running your Web application under a custom domain account. </p>\n  <ol>\n    <li>Create an SPN for your custom domain account. Kerberos requires an SPN to support mutual authentication. To create an SPN for the domain account:<b></b><ol><li>Install the Windows Server Tools from the Windows Server CD. <li>From a command prompt, run the <b>Setspn</b> tool twice from the <b>C:\\Program Files\\Support Tools</b> directory as shown here. <p><b>setspn -A HTTP/<i>webservername</i><i>domain</i>\\<i>customAccountName</i></b></p><p><b>setspn -A HTTP/<i>webservername.fullyqualifieddomainname</i></b></p><p><b><i>domain</i>\\<i>customAccountName</i></b></p><blockquote><b>Note</b>&nbsp;&nbsp;&nbsp;You can only have a single SPN associated with any HTTP service (DNS) name, which means you cannot create SPNs for different service accounts mapped to the same HTTP server unless they are on different ports. The SPN can include a port number. </blockquote></li></li></ol><li>Start the Microsoft Management Console (MMC) Active Directory Users and Computers snap-in. <li>In the left pane of the MMC snap in, click the <b>Users</b> node. <li>In the right pane, double-click the user account you are using to run the ASP.NET application. This displays the user account properties. <blockquote><b>Note</b>&nbsp;&nbsp;&nbsp;If the <b>Properties</b> dialog box for your account does not have a <b>Delegation</b> tab, this indicates that a service principal name (SPN) does not exist for the user. Create an SPN as explained in step 1, above.<b></b></blockquote><li>On the <b>Delegation</b> tab of the <b>Properties</b> window for your Web server computer, <b>Do not trust the computer for delegation</b> is selected by default. To use constrained delegation, select <b>Trust this user for delegation to specified services only</b>. You specify precisely which service or services can be accessed in the bottom pane. <li>Beneath <b>Trust this user for delegation to specified services only</b>, select <b>Use any authentication protocol</b>. <p>If you select <b>Use Kerberos only</b>, constrained delegation works only with Kerberos authentication. If you are using protocol transition to switch from forms authentication (or an alternate non-Kerberos authentication mechanism) to Kerberos, then you must select <b>Use any authentication protocol</b>. </p><li>Click the <b>Add</b> button. This displays the <b>Add Services</b> dialogue. <li>Click the <b>Users or computers</b> button. <li>In the <b>Select Users or Computers</b> dialog, type the name of your database server, and then click <b>OK</b>. <li>You will now see all the available services on your database server. To restrict access to SQL Server, select the <b>MSSQLSvc</b> service, and then click <b>OK</b>. </li></li></li></li></li></li></li></li></li></li>\n  </ol>\n  <h1>Step 3. Implement and Test Protocol Transition</h1>\n  <p>In this step, you implement the code necessary to call the database using the identity of the caller. This example assumes the target database is a SQL Server called DBServer, the database server requires Windows authentication and the required database is the Northwind database.</p>\n  <blockquote>\n    <b>Note</b>&nbsp;&nbsp;&nbsp;To allow access to SQL Server, you must create a SQL Server login for each of your application's end users or for a set of groups that the users belong to, and grant them read access to the Northwind database.<b></b></blockquote>\n  <h2>To implement code that uses the caller's identity </h2>\n  <ol>\n    <li>Define a connection string to the database server in your Web.config file, specifying Windows authentication to the database, as shown in the following example. <div><pre>&lt;configuration xmlns=\"<a href=\"http://schemas.microsoft.com/.NetConfiguration/v2.0\">http://schemas.microsoft.com/.NetConfiguration/v2.0</a>\"&gt;<br />&nbsp; &lt;connectionStrings&gt;<br />&nbsp;&nbsp;&nbsp; &lt;add name=\"nwindConnectionString\" connectionString=<br />\"Data Source=DBServer;Initial Catalog=northwind;Integrated Security=True\" <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; providerName=\"System.Data.SqlClient\" /&gt;<br />&nbsp; &lt;/connectionStrings&gt;<br />&nbsp; ...<br />&lt;/configuration&gt;  </pre></div><li>Use code similar to the following to impersonate the caller and access the database. <div><pre>Using System.Data.SqlClient;<br />Using System.Security.Principal;<br />...<br />private DataTable CallDatabase()<br />&#123;<br />&nbsp; DataTable dt = new DataTable();<br />&nbsp; WindowsImpersonationContext wic = null;<br />&nbsp; try<br />&nbsp; &#123;<br />&nbsp;&nbsp;&nbsp; // First, impersonate the original caller<br />&nbsp;&nbsp;&nbsp; wic = ImpersonateEndUser();<br />&nbsp;&nbsp;&nbsp; // Fetch data from the database using the original caller's <br />&nbsp;&nbsp;&nbsp; // security context<br />&nbsp;&nbsp;&nbsp; using (SqlConnection conn = new SqlConnection())<br />&nbsp;&nbsp;&nbsp; &#123;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn.ConnectionString = ConfigurationManager.ConnectionStrings<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#91;\"nwindConnectionString\"&#93;.ConnectionString;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn.Open();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SqlCommand cmd = new SqlCommand(\"Select ProductName from Products\",<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conn); <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SqlDataAdapter da = new SqlDataAdapter(cmd);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; da.Fill(dt);<br />&nbsp;&nbsp;&nbsp; &#125;<br />&nbsp; &#125;<br />&nbsp; catch<br />&nbsp; &#123;<br />&nbsp;&nbsp;&nbsp; // Do not let the exception propagate higher up the call stack<br />&nbsp; &#125;<br />&nbsp; finally<br />&nbsp; &#123;<br />&nbsp;&nbsp;&nbsp; // Ensure that impersonation is stopped<br />&nbsp;&nbsp;&nbsp; if( wic &#33;= null)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; wic.Undo();<br />&nbsp; &#125;<br />&nbsp; return dt;<br />&#125;<br />private WindowsImpersonationContext ImpersonateEndUser()<br />&#123;<br />&nbsp; // Obtain the user name (from forms authentication)<br />&nbsp; string identity = User.Identity.Name;<br />&nbsp; // Convert from domainName\\userName format to <a href=\"mailto:userName&#64;domainName\">userName&#64;domainName</a> format<br />&nbsp; // if necessary<br />&nbsp; int slash = identity.IndexOf(\"\\\\\");<br />&nbsp; if (slash &gt; 0)<br />&nbsp; &#123;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string domain = identity.Substring(0, slash);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; string user = identity.Substring(slash &#43; 1);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; identity = user &#43; \"&#64;\" &#43; domain;<br />&nbsp; &#125;<br />&nbsp; // The WindowsIdentity(string) constructor uses the new<br />&nbsp; // Kerberos S4U extension to get a logon for the user<br />&nbsp; // without a password.<br />&nbsp; WindowsIdentity wi = new WindowsIdentity(identity);<br />&nbsp; return wi.Impersonate();<br />&#125;  </pre></div><li><p>Note the following points about the preceding code: </p><ul><li>The <b>ImpersonateEndUser</b> method uses the user name of the user that has been authenticated using forms authentication. It converts the user name to UPN format (<i>userName</i>&#64;<i>domainName</i>), and passes the UPN to the <b>WindowsIdentity</b> constructor. This constructor returns a Windows token for a domain account without requiring the account's password. <p>By default, an identify-level token is returned. You can only use this to check the user's group membership. You cannot access local or remote resources. However, if you configure protocol transition in Active Directory, you can use the token to access specified services on selected servers as defined by the A2D2 list. </p><li>Your application must authenticate the request by using the user name and password submitted on your forms login page. When your application determines that the user is authentic, you must select an existing Windows account to represent the user on the back end. This example assumes that the user submitted a Windows user name and domain name on the forms login page and supplied a password that the ASP.NET membership provider could verify. This is not the password for the Windows account. The purpose of protocol transition is to avoid exposing Windows passwords in this way. <p>In this example, after the membership system in ASP.NET verifies the user's password, the Web application converts the user's name into the UPN form and constructs a <b>WindowsIdentity</b> object. </p><p>If you try to create a <b>WindowsIdentity</b> object for a user that does not exist, the <b>WindowsIdentity</b> constructor generates a <b>System.Security.SecurityException</b> with the message <b>Logon failure: unknown user name or bad password</b>. </p></li></li></ul></li></li></li>\n  </ol>\n  <h2>To test protocol transition and constrained delegation </h2>\n  <ol>\n    <li>Start your application. <li>Use the <b>CreateUserWizard</b> control on the login page to create two user accounts: one that has a user name that matches a domain account and also has a SQL Server login that authorizes read access to the Northwind database, and one that has a user name that does not match a domain account. <blockquote><b>Note</b>&nbsp;&nbsp;&nbsp;By default, the ASP.NET login controls automatically create and configure a SQL Express membership database in the \\app_data folder to act as your membership database. </blockquote><li>Use the <b>Login</b> control to log in with the user account that does not match a domain account. The login will succeed, but the attempt to impersonate the user will fail and will generate a <b>SecurityException</b> because the user name does not match a domain name. <li>Start the application again. Log in using the user name that does match a domain account name. On the Web server, the ASP.NET application impersonates the original caller and runs using the identity of the caller. The constrained delegation configuration ensures that the same identity is used to access the database. </li></li></li></li>\n  </ol>\n  <h1>Using Constrained Delegation Through Multiple Tiers</h1>\n  <p>You can use constrained delegation to pass the original caller's identity through multiple application tiers, for example from a Web server to an application server to a database server.</p>\n  <h2>Web to Application Server to Database</h2>\n  <p>In the following intranet scenario, the client's computer is on the same domain as the servers and can communicate directly with the domain controller. As a result, the ASP.NET application is configured for Windows authentication and the Web site is configured in IIS for integrated Windows authentication. </p>\n  <p>The Web server accesses middle-tier business logic exposed by a Web service on an application server. This scenario is shown in Figure 2.</p>\n  <p>\n    <img alt=\"\" src=\"http://msdn2.microsoft.com/en-us/library/ms998355.f01paght00002402(en-us,MSDN.10).gif\" border=\"0\" />\n  </p>\n  <p>\n    <b>Figure 2. Use constrained delegation with or without protocol transition through multiple tiers where the original caller is authenticated with Windows authentication.</b>\n  </p>\n  <p>The key features of this scenario are: </p>\n  <ul>\n    <li>The application uses Kerberos authentication to authenticate users. As a result protocol transition is not required. <li>Constrained delegation is required to allow the Web application, while impersonating, to access the HTTP service on the application server. <li>Constrained delegation is required to allow the application server, while impersonating, to access the SQL Server (MSSQLSvc) service on the database server. <li>The Web service on the application server uses Kerberos authentication to authenticate its caller (the Web application), and then impersonates the authenticated caller while accessing the database. </li></li></li></li>\n  </ul>\n  <h2>Web Server Configuration</h2>\n  <p>To configure the Web server, you need to enable Windows authentication within IIS, configure your ASP.NET application for impersonation, and set the <b>Credentials</b> property of the Web service proxy.</p>\n  <h3>To configure your Web server and ASP.NET presentation-tier application </h3>\n  <ol>\n    <li>Use IIS to configure your Web site for Integrated Windows authentication. Make sure anonymous access is disabled. <li>Use the following settings to configure your ASP.NET application to use Windows authentication and impersonation. <div><pre>&lt;system.web&gt;<br />&nbsp;&nbsp;&nbsp; ...<br />&nbsp;&nbsp;&nbsp; &lt;authentication mode=\"Windows\"/&gt;<br />&nbsp;&nbsp;&nbsp; &lt;identity impersonate=\"true\"/&gt;<br />&nbsp;&nbsp;&nbsp; ...<br />&lt;/system.web&gt;  </pre></div><li>Set the <b>Credentials</b> property on the Web service proxy to pass the authenticated user's security context to the Web service, as shown in the following code. <div><pre>// Call the web service passing the original user's credentials<br />DataAccessWS.WebService ws = new DataAccessWS.WebService();<br />ws.Credentials = CredentialCache.DefaultCredentials;<br />&nbsp; <br />ws.GetData();</pre></div></li></li></li>\n  </ol>\n  <h2>Application Server Configuration</h2>\n  <p>To configure the application server, you need to enable Windows authentication within IIS, configure your ASP.NET application for impersonation, and use Windows authentication to access the database.</p>\n  <h3>To configure your application server and Web service </h3>\n  <ol>\n    <li>Use IIS to configure your Web site for Integrated Windows authentication. Make sure anonymous access is disabled. <li>Use the following settings to configure your Web service to use Windows authentication and impersonation. <div><pre>&lt;system.web&gt;<br />&nbsp;&nbsp;&nbsp; ...<br />&nbsp;&nbsp;&nbsp; &lt;authentication mode=\"Windows\"/&gt;<br />&nbsp;&nbsp;&nbsp; &lt;identity impersonate=\"true\"/&gt;<br />&nbsp;&nbsp;&nbsp; ...<br />&lt;/system.web&gt;<br /></pre></div><li>Use Windows authentication to access the database. The impersonation configuration ensures that the authenticated user's credentials are used to access the database. You must ensure that the relevant end user account has a SQL Server login and relevant database permissions. </li></li></li>\n  </ol>\n  <h2>Active Directory Configuration</h2>\n  <p>You must configure Active Directory to allow the Web server application to use constrained delegation to access the Web service on the application server. You must also configure Active Directory to allow the Web service on the application server to access the SQL Server database.</p>\n  <h3>To configure constrained delegation for the Web server </h3>\n  <ol>\n    <li>Use the <b>Active Directory Users and Computers</b> MMC snap in to display the <b>Properties</b> dialog box for either the Web server computer (if you are using the Network Service account to run your ASP.NET Web application), or your custom user account (if you are using a custom account to run your application). <li>On the <b>Delegation</b> tab of the <b>Properties</b> window, select <b>Trust this <i>computer</i>/<i>user</i> for delegation to specified services only</b>. This enables constrained delegation for the services you will select in the bottom pane. <li>After <b>Trust this <i>computer</i>/<i>user</i> for delegation to specified services only</b>, select <b>Use Kerberos only</b>. This restricts the use of constrained delegation to scenarios where the callers are authenticated using Kerberos authentication only. Note that if you are authenticating callers to the Web server using any technique other than Kerberos you must select <b>Use any protocol</b>, and obtain a Windows token for the caller programmatically as explained in the section, \"Step 1. Use Protocol Transition to Create a Windows Token for the Original Caller,\" in this document. <li>Click the <b>Add</b> button. This displays the <b>Add Services</b> dialog box. <li>Click the <b>Users or computers</b> button <li>In the <b>Select Users or Computers</b> dialog box, type the name of your application server, and then click <b>OK.</b><li>You will see all the available services on your application server. Select the <b>HTTP</b> service, and then click <b>OK</b>. </li></li></li></li></li></li></li>\n  </ol>\n  <h3>To configure constrained delegation for the application server</h3>\n  <p>Follow the configuration steps described above for the Web server, except restrict access to the MSSQLSvc service on the database server. </p>\n  <ul>\n    <li>In the <b>Active Directory Users and Computers</b> MMC snap-in, select the application server computer account (if you are using the default Network Service account to run Web service applications).. If your Web service applications run under a custom domain account, select that user account instead. <li>When you configure the services for which constrained delegation is permitted, select the database server computer and the <b>MSSQLSvc</b> service on that computer. </li></li>\n  </ul>\n  <blockquote>\n    <b>Note</b>&nbsp;&nbsp;&nbsp;If you are using a custom domain account to run your Web application, Web service or SQL Server, be sure that you have created an SPN for the account. For details about creating an SPN, see \"Step 2. Configure Your Service or Machine Account.\"<b></b></blockquote>\n  <h1>Domain Functional Levels</h1>\n  <p>By default, a Windows Server 2003 domain runs in Windows 2000 mixed mode. You must raise the domain functional level to Windows Server 2003 to use constrained delegation and protocol transition. </p>\n  <blockquote>\n    <b>Note</b>&nbsp;&nbsp;&nbsp;This change is not reversible.<b></b></blockquote>\n  <h2>To verify the domain functional level </h2>\n  <ol>\n    <li>In the left pane of the <b>Active Directory Users and Computers</b> MMC snap-in, right-click the root node for the domain, and then click <b>Properties</b>. <li>The <b>Properties</b> dialog box displays information including the domain functional level. If the domain is operating as a Windows 2000 mixed domain, you must raise the domain functional level to Windows Server 2003 before you can use constrained delegation. </li></li>\n  </ol>\n  <h2>To raise the domain functional level to Windows Server 2003 </h2>\n  <ol>\n    <li>In the Active Directory Users and Computers MMC snap-in, click the root node titled <b>Active Directory User and Computers &#91;<i>machinename</i>.<i> domain</i>&#93;</b>. <li>On the <b>Action</b> menu, click <b>All Tasks</b>, and then click <b>Raise Domain Functional Level</b>. <li>Select <b>Windows Server 2003</b> from the <b>Select an available domain functional level</b> dropdown box. Click <b>OK</b>. </li></li></li>\n  </ol>\n  <hr />\n  <p>Adapted from Microsoft patterns & practices guidance.</p>"
}