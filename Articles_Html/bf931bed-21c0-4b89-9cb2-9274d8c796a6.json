{
  "id": "bf931bed-21c0-4b89-9cb2-9274d8c796a6",
  "checksum": "14f7387c67f60dcd9b8fe403027355c1b769f316",
  "words": {
    "1": [
      "ul",
      "li",
      "a"
    ],
    "2": [
      "ul",
      "li",
      "a"
    ],
    "3": [
      "p",
      "p"
    ],
    "applies": [
      "h1"
    ],
    "to": [
      "h1",
      "p",
      "p",
      "ol",
      "li",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "javaspringmvc": [
      "ul"
    ],
    "java": [
      "li",
      "h1",
      "h1",
      "h1",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "h1",
      "ul",
      "li",
      "a"
    ],
    "springmvc": [
      "li",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a",
      "title"
    ],
    "summary": [
      "h1"
    ],
    "perform": [
      "p",
      "p",
      "ol",
      "li",
      "p"
    ],
    "csrf": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "p",
      "strong",
      "li",
      "p",
      "strong",
      "p",
      "p",
      "p"
    ],
    "prevention": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "title"
    ],
    "using": [
      "p",
      "p",
      "p",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "title"
    ],
    "within": [
      "p"
    ],
    "an": [
      "p",
      "p",
      "p"
    ],
    "application": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "objectives": [
      "h1"
    ],
    "is": [
      "p",
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "a": [
      "p",
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "p",
      "strong",
      "pre",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "key": [
      "p"
    ],
    "security": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "control": [
      "p",
      "p"
    ],
    "for": [
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "a"
    ],
    "that": [
      "p",
      "p",
      "ol",
      "li",
      "p",
      "p"
    ],
    "protects": [
      "p"
    ],
    "the": [
      "p",
      "p",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a"
    ],
    "and": [
      "p",
      "ol",
      "li",
      "p",
      "strong",
      "p",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "its": [
      "p"
    ],
    "users": [
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "from": [
      "p"
    ],
    "attacks": [
      "p",
      "p"
    ],
    "this": [
      "p",
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre",
      "p",
      "p"
    ],
    "article": [
      "p"
    ],
    "will": [
      "p"
    ],
    "describe": [
      "p"
    ],
    "how": [
      "p",
      "ul",
      "li",
      "a"
    ],
    "use": [
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "built-in": [
      "p"
    ],
    "mechanisms": [
      "p"
    ],
    "provided": [
      "p"
    ],
    "by": [
      "p",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "solution": [
      "h1"
    ],
    "example": [
      "h1"
    ],
    "there": [
      "p",
      "p"
    ],
    "standard": [
      "p"
    ],
    "model": [
      "p"
    ],
    "involves": [
      "p"
    ],
    "basic": [
      "p"
    ],
    "steps": [
      "p",
      "p",
      "p"
    ],
    "build": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "base": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "controller": [
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "p",
      "strong"
    ],
    "with": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "generation": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "validation": [
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "p"
    ],
    "methods": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "public": [
      "ol",
      "li",
      "pre"
    ],
    "class": [
      "ol",
      "li",
      "pre"
    ],
    "rootcontroller": [
      "ol",
      "li",
      "pre"
    ],
    "{..": [
      "ol",
      "li",
      "pre"
    ],
    "protected": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "void": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "initcontrollercontext": [
      "ol",
      "li",
      "pre"
    ],
    "ctx": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "pre",
      "pre",
      "pre",
      "pre",
      "li",
      "pre"
    ],
    "{Â ..": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "initializecsfrtokenctx);": [
      "ol",
      "li",
      "pre"
    ],
    "}": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "li",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "private": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "initializecsfrtokencontrollercontext": [
      "ol",
      "li",
      "pre"
    ],
    "{": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre",
      "li",
      "pre"
    ],
    "string": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "csrftoken": [
      "ol",
      "li",
      "pre"
    ],
    "=": [
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "pre",
      "pre",
      "pre",
      "li",
      "pre"
    ],
    "ctxgetsessionattribute(controllercontext.csrf_token,": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "\"\";": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "ifutils.isempty(csrftoken))": [
      "ol",
      "li",
      "pre"
    ],
    "ctxsetsessionattribute(ctx,": [
      "ol",
      "li",
      "pre"
    ],
    "controllercontextcsrf_token,": [
      "ol",
      "li",
      "pre"
    ],
    "generatecsrftokenctx));": [
      "ol",
      "li",
      "pre"
    ],
    "generatecsrftokencontrollercontext": [
      "ol",
      "li",
      "pre"
    ],
    "generate": [
      "ol",
      "li",
      "pre"
    ],
    "random": [
      "ol",
      "li",
      "pre"
    ],
    "boolean": [
      "ol",
      "li",
      "pre"
    ],
    "isvalidcsrftokencontrollercontext": [
      "ol",
      "li",
      "pre"
    ],
    "csrfparamtoken": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "ctxgetparameter(controllercontext.csrf_token);": [
      "ol",
      "li",
      "pre"
    ],
    "csrfsessiontoken": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "if!utils.isempty(csrfparamtoken)": [
      "ol",
      "li",
      "pre"
    ],
    "&&": [
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre"
    ],
    "!utilsisempty(csrfsessiontoken)": [
      "ol",
      "li",
      "pre"
    ],
    "csrfparamtokenequals(csrfsessiontoken))": [
      "ol",
      "li",
      "pre"
    ],
    "return": [
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "pre",
      "pre",
      "li",
      "pre"
    ],
    "true": [
      "ol",
      "li",
      "pre"
    ],
    "else": [
      "ol",
      "li",
      "pre"
    ],
    "//log": [
      "ol",
      "li",
      "pre"
    ],
    "as": [
      "ol",
      "li",
      "pre",
      "p",
      "p"
    ],
    "can": [
      "ol",
      "li",
      "pre",
      "p",
      "p"
    ],
    "be": [
      "ol",
      "li",
      "pre"
    ],
    "threat": [
      "ol",
      "li",
      "pre"
    ],
    "logwarn(\"invalid": [
      "ol",
      "li",
      "pre"
    ],
    "token": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "pre",
      "pre",
      "pre",
      "li",
      "p",
      "strong",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "p"
    ],
    "supplied": [
      "ol",
      "li",
      "pre"
    ],
    "\"": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "+": [
      "ol",
      "ol",
      "ol",
      "ol",
      "ol",
      "li",
      "li",
      "li",
      "li",
      "li",
      "pre",
      "pre",
      "pre",
      "pre",
      "pre"
    ],
    "session": [
      "ol",
      "li",
      "pre",
      "p",
      "h1",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "h1",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "h1",
      "h1",
      "ul",
      "li",
      "a"
    ],
    "ip": [
      "ol",
      "li",
      "pre"
    ],
    "ctxrequest.getremoteaddr());": [
      "ol",
      "li",
      "pre"
    ],
    "false": [
      "ol",
      "li",
      "pre"
    ],
    "include": [
      "ol",
      "li",
      "p",
      "strong",
      "ul",
      "li",
      "a"
    ],
    "in": [
      "ol",
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "li",
      "p",
      "p",
      "strong",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "form": [
      "ol",
      "ol",
      "li",
      "p",
      "strong",
      "li",
      "p"
    ],
    "submitted": [
      "ol",
      "li",
      "p",
      "strong",
      "p"
    ],
    "via": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "jsp": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "input": [
      "ol",
      "li",
      "pre"
    ],
    "type=\"hidden\"": [
      "ol",
      "li",
      "pre"
    ],
    "name=\"ctoken\"": [
      "ol",
      "li",
      "pre"
    ],
    "id=\"ctoken\"": [
      "ol",
      "li",
      "pre"
    ],
    "value=\"${sessionscopectoken}\"/>": [
      "ol",
      "li",
      "pre"
    ],
    "handling": [
      "ol",
      "li",
      "p",
      "strong"
    ],
    "request": [
      "ol",
      "li",
      "p",
      "strong",
      "p",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "title"
    ],
    "validate": [
      "ol",
      "li",
      "p",
      "strong",
      "p"
    ],
    "action": [
      "ol",
      "li",
      "p"
    ],
    "class/method": [
      "ol",
      "li",
      "p"
    ],
    "handles": [
      "ol",
      "li",
      "p"
    ],
    "saving": [
      "ol",
      "li",
      "p"
    ],
    "of": [
      "ol",
      "li",
      "p",
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "your": [
      "ol",
      "li",
      "p"
    ],
    "ex.": [
      "ol",
      "li",
      "p"
    ],
    "savebookcontroller,": [
      "ol",
      "li",
      "p"
    ],
    "you": [
      "ol",
      "li",
      "p",
      "p"
    ],
    "need": [
      "ol",
      "li",
      "p"
    ],
    "..controllercontext": [
      "ol",
      "li",
      "pre"
    ],
    "new": [
      "ol",
      "li",
      "pre"
    ],
    "controllercontextrequest,": [
      "ol",
      "li",
      "pre"
    ],
    "response;init(ctx);if": [
      "ol",
      "li",
      "pre"
    ],
    "!isvalidcsrftoken(ctx))": [
      "ol",
      "li",
      "pre"
    ],
    "resultadderror(new": [
      "ol",
      "li",
      "pre"
    ],
    "objecterror\"employee\",": [
      "ol",
      "li",
      "pre"
    ],
    "getmessage\"error.invalidcsrftoken\")));": [
      "ol",
      "li",
      "pre"
    ],
    "getmodelandviewctx,": [
      "ol",
      "li",
      "pre"
    ],
    "\"employee/list\";}...": [
      "ol",
      "li",
      "pre"
    ],
    "savebookcontroller": [
      "em"
    ],
    "these": [
      "p"
    ],
    "simple": [
      "p",
      "p"
    ],
    "effectively": [
      "p"
    ],
    "have": [
      "p",
      "p"
    ],
    "specific": [
      "p"
    ],
    "per": [
      "p"
    ],
    "user": [
      "p",
      "p"
    ],
    "used": [
      "p",
      "p",
      "ul",
      "li",
      "a"
    ],
    "was": [
      "p"
    ],
    "intentionally": [
      "p"
    ],
    "note": [
      "p",
      "strong"
    ],
    "been": [
      "p"
    ],
    "effective": [
      "p"
    ],
    "against": [
      "p"
    ],
    "various": [
      "p"
    ],
    "techniques": [
      "p"
    ],
    "including": [
      "p"
    ],
    "token-based": [
      "p"
    ],
    "approach": [
      "p"
    ],
    "when": [
      "p",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "has": [
      "p"
    ],
    "xss": [
      "p",
      "p"
    ],
    "vulnerabilities": [
      "p"
    ],
    "removing": [
      "p"
    ],
    "therefore": [
      "p"
    ],
    "viewed": [
      "p"
    ],
    "prerequisite": [
      "p"
    ],
    "activity": [
      "p"
    ],
    "complete": [
      "p"
    ],
    "mechanism": [
      "p"
    ],
    "conclusion": [
      "p"
    ],
    "function": [
      "p"
    ],
    "strong": [
      "p"
    ],
    "if": [
      "p"
    ],
    "properly": [
      "p"
    ],
    "applied": [
      "p"
    ],
    "thoroughly": [
      "p"
    ],
    "throughout": [
      "p"
    ],
    "framework": [
      "p",
      "ul",
      "li",
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "provides": [
      "p"
    ],
    "series": [
      "p"
    ],
    "accomplishing": [
      "p"
    ],
    "task": [
      "p"
    ],
    "more": [
      "h1",
      "ul",
      "li"
    ],
    "information": [
      "h1",
      "ul",
      "li"
    ],
    "about": [
      "ul",
      "li"
    ],
    "web": [
      "ul",
      "li"
    ],
    "mvc": [
      "ul",
      "li"
    ],
    "please": [
      "ul",
      "li"
    ],
    "see": [
      "ul",
      "li"
    ],
    "http//static.springsource.org/spring/docs/2.0.x/reference/mvc.html": [
      "ul",
      "li",
      "a"
    ],
    "management": [
      "h1",
      "ul",
      "li",
      "a",
      "h1",
      "ul",
      "li",
      "a",
      "h1",
      "h1"
    ],
    "guidelines": [
      "h1"
    ],
    "offered": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "protect": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "ids": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "cookies": [
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a"
    ],
    "set": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "domain": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "path": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "values": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "secure": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "httponly": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "flags": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "on": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "all": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "sensitive": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "change": [
      "ul",
      "li",
      "a"
    ],
    "during": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "authentication": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "invalidate": [
      "ul",
      "li",
      "a"
    ],
    "sessions": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "log": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "out": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "make": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "inactive": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "time-out": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "unique": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a"
    ],
    "tokens": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a"
    ],
    "http": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a"
    ],
    "requests": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a"
    ],
    "do": [
      "ul",
      "li",
      "a"
    ],
    "not": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "decisions": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "based": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "client-accessible": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "parameters": [
      "ul",
      "li",
      "a",
      "ul",
      "li",
      "a"
    ],
    "checklists": [
      "h1"
    ],
    "are": [
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a"
    ],
    "strict": [
      "ul",
      "li",
      "a"
    ],
    "changed": [
      "ul",
      "li",
      "a"
    ],
    "invalidated": [
      "ul",
      "li",
      "a"
    ],
    "included": [
      "ul",
      "li",
      "a"
    ],
    "made": [
      "ul",
      "li",
      "a"
    ],
    "code": [
      "h1"
    ],
    "examples": [
      "h1"
    ],
    "add": [
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a"
    ],
    "esapi": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "server": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "faces": [
      "ul",
      "li",
      "a"
    ],
    "jsf)": [
      "ul",
      "li",
      "a"
    ],
    "plain": [
      "ul",
      "li",
      "a"
    ],
    "pages": [
      "ul",
      "li",
      "a"
    ],
    "jsp)": [
      "ul",
      "li",
      "a"
    ],
    "cross-site": [
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "title"
    ],
    "forgery": [
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "title"
    ],
    "csrf)": [
      "ul",
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a",
      "li",
      "a",
      "title"
    ],
    "struts": [
      "ul",
      "ul",
      "li",
      "a",
      "li",
      "a"
    ],
    "httputilities": [
      "ul",
      "li",
      "a"
    ],
    "testing": [
      "h1"
    ],
    "test": [
      "ul",
      "li",
      "a"
    ],
    "prediction": [
      "ul",
      "li",
      "a"
    ],
    "bugs": [
      "ul",
      "li",
      "a"
    ]
  },
  "tags": {
    "h1": [
      "Applies to",
      "Summary",
      "Objectives",
      "Solution Example",
      "More Information",
      "Java Session Management Guidelines",
      "Java Session Management Checklists",
      "Java Session Management Code Examples",
      "Java Session Management Testing"
    ],
    "ul": [
      "JAVASpringMVC",
      "For more information about the Web MVC framework, please see http://static.springsource.org/spring/docs/2.0.x/reference/mvc.html",
      "Use Session Management Offered by the Framework\r\n      \r\n        Protect Session IDs\r\n        \r\n          Protect Session Cookies\r\n          \r\n            Set the Domain and Path Values of Session Cookies\r\n            \r\n              Set the Secure and HTTPOnly Flags on All Sensitive Cookies\r\n              \r\n                Change Session IDs During Authentication\r\n                \r\n                  Invalidate Sessions when Users Log Out\r\n                  \r\n                    Make Inactive Sessions Time-out\r\n                    \r\n                      Include Unique Tokens in HTTP Requests\r\n                      \r\n                        Do Not Make Security Decisions Based on Client-Accessible Parameters",
      "Session Management Offered by the Framework Is Used\r\n      \r\n        Session IDs Are Protected\r\n        \r\n          Session Cookies are Protected\r\n          \r\n            The Domain and Path Values of Session Cookies Are Strict\r\n            \r\n              The Secure and HTTPOnly Flags Are Set on All Sensitive Cookies\r\n              \r\n                Session IDs Are Changed During Authentication\r\n                \r\n                  Sessions Are Invalidated When Users Log Out\r\n                  \r\n                    Inactive Sessions Time-out\r\n                    \r\n                      Unique Tokens Are Included in HTTP Requests\r\n                      \r\n                        Security Decisions are Not Made Based on Client-Accessible Parameters",
      "Add Unique Tokens to HTTP Requests Using ESAPI\r\n    \r\n    \r\n      Add Unique Tokens to HTTP Requests Using Java Server Faces (JSF)\r\n    \r\n    \r\n      Add Unique Tokens to HTTP Requests Using Plain Java Server Pages (JSP)\r\n    \r\n    \r\n      Cross-Site Request Forgery (CSRF) Prevention Using SpringMVC\r\n    \r\n    \r\n      Cross-Site Request Forgery (CSRF) Prevention Using Struts 1\r\n    \r\n    \r\n      Cross-Site Request Forgery (CSRF) Prevention Using Struts 2\r\n    \r\n    \r\n      Use ESAPI HTTPUtilities",
      "How to Test for Session Prediction Bugs in Java"
    ],
    "li": [
      "JAVA",
      "SpringMVC",
      "Build a base controller with CSRF generation and validation methods.\r\n      \r\n      public class RootController {...Â Â Â  protected void init(ControllerContext ctx) {Â ...Â Â Â Â Â Â Â  initializeCsfrToken(ctx);Â Â Â  }\r\n      Â Â Â  private void initializeCsfrToken(ControllerContext ctx) {Â Â Â Â Â Â  String csrfToken = ctx.getSessionAttribute(ControllerContext.CSRF_TOKEN, \"\");Â Â Â Â Â Â  if(Utils.isEmpty(csrfToken)) {Â Â Â Â Â Â Â Â Â Â  ctx.setSessionAttribute(ctx, ControllerContext.CSRF_TOKEN, generateCsrfToken(ctx));Â Â Â Â Â Â  }Â Â Â  }Â Â Â  Â Â Â  private String generateCsrfToken(ControllerContext ctx) {Â ... generate random stringÂ Â Â  }Â Â Â  Â Â Â  protected boolean isValidCsrfToken(ControllerContext ctx) {Â Â Â Â Â Â Â  String csrfParamToken = ctx.getParameter(ControllerContext.CSRF_TOKEN);Â Â Â Â Â Â Â  String csrfSessionToken = ctx.getSessionAttribute(ControllerContext.CSRF_TOKEN, \"\");Â Â Â Â Â Â Â  if(!Utils.isEmpty(csrfParamToken) && !Utils.isEmpty(csrfSessionToken) && csrfParamToken.equals(csrfSessionToken)) {Â Â Â Â Â Â Â Â Â Â Â  return true;Â Â Â Â Â Â Â  } else {Â Â Â Â Â Â Â Â Â Â Â  //Log this as this can be a security threatÂ Â Â Â Â Â Â Â Â Â Â  Log.warn(\"Invalid security Token. Supplied token: \" + csrfParamToken + \". Session token: \" + csrfSessionToken + \". IP: \" + ctx.request.getRemoteAddr());Â Â Â Â Â Â Â Â Â Â Â  return false;Â Â Â Â Â Â Â  }Â Â Â  }",
      "Include CSRF token in form submitted via JSP.\r\n        \r\n        <input type=\"hidden\" name=\"ctoken\" id=\"ctoken\" value=\"${sessionScope.ctoken}\"/>",
      "In Controller handling request, validate CSRF token. In the action class/method that handles the saving of your form (ex. SaveBookController), you need to perform the token validation. \r\n          ...ControllerContext ctx = new ControllerContext(request, response);init(ctx);if (!isValidCsrfToken(ctx)) {Â Â Â  result.addError(new ObjectError(\"employee\", getMessage(\"error.invalidCsrfToken\")));Â Â Â  return getModelAndView(ctx, \"employee/list\");}...",
      "For more information about the Web MVC framework, please see http://static.springsource.org/spring/docs/2.0.x/reference/mvc.html",
      "Use Session Management Offered by the Framework",
      "Protect Session IDs",
      "Protect Session Cookies",
      "Set the Domain and Path Values of Session Cookies",
      "Set the Secure and HTTPOnly Flags on All Sensitive Cookies",
      "Change Session IDs During Authentication",
      "Invalidate Sessions when Users Log Out",
      "Make Inactive Sessions Time-out",
      "Include Unique Tokens in HTTP Requests",
      "Do Not Make Security Decisions Based on Client-Accessible Parameters",
      "Session Management Offered by the Framework Is Used",
      "Session IDs Are Protected",
      "Session Cookies are Protected",
      "The Domain and Path Values of Session Cookies Are Strict",
      "The Secure and HTTPOnly Flags Are Set on All Sensitive Cookies",
      "Session IDs Are Changed During Authentication",
      "Sessions Are Invalidated When Users Log Out",
      "Inactive Sessions Time-out",
      "Unique Tokens Are Included in HTTP Requests",
      "Security Decisions are Not Made Based on Client-Accessible Parameters",
      "Add Unique Tokens to HTTP Requests Using ESAPI",
      "Add Unique Tokens to HTTP Requests Using Java Server Faces (JSF)",
      "Add Unique Tokens to HTTP Requests Using Plain Java Server Pages (JSP)",
      "Cross-Site Request Forgery (CSRF) Prevention Using SpringMVC",
      "Cross-Site Request Forgery (CSRF) Prevention Using Struts 1",
      "Cross-Site Request Forgery (CSRF) Prevention Using Struts 2",
      "Use ESAPI HTTPUtilities",
      "How to Test for Session Prediction Bugs in Java"
    ],
    "p": [
      "Perform CSRF prevention using SpringMVC within an application.",
      "CSRF prevention is a key security control for an application that protects the application and its users from CSRF attacks. This article will describe how to use the built-in mechanisms provided by SpringMVC to perform CSRF prevention.",
      "There is a standard model for CSRF prevention using SpringMVC that involves 3 basic steps",
      "Build a base controller with CSRF generation and validation methods.",
      "Include CSRF token in form submitted via JSP.",
      "In Controller handling request, validate CSRF token. In the action class/method that handles the saving of your form (ex. SaveBookController), you need to perform the token validation.",
      "Using these 3 simple steps you can effectively have a session specific per user token used to validate that a request was submitted by a user intentionally.",
      "Note: There have been effective attacks against various CSRF prevention techniques including this token-based approach when an application has XSS vulnerabilities. Removing XSS is therefore viewed as a prerequisite activity for a complete CSRF prevention mechanism.",
      "In conclusion, CSRF prevention can function as a strong security control if used properly and applied thoroughly throughout the application. The SpringMVC framework provides a simple series of steps for accomplishing this task."
    ],
    "ol": [
      "Build a base controller with CSRF generation and validation methods.\r\n      \r\n      public class RootController {...Â Â Â  protected void init(ControllerContext ctx) {Â ...Â Â Â Â Â Â Â  initializeCsfrToken(ctx);Â Â Â  }\r\n      Â Â Â  private void initializeCsfrToken(ControllerContext ctx) {Â Â Â Â Â Â  String csrfToken = ctx.getSessionAttribute(ControllerContext.CSRF_TOKEN, \"\");Â Â Â Â Â Â  if(Utils.isEmpty(csrfToken)) {Â Â Â Â Â Â Â Â Â Â  ctx.setSessionAttribute(ctx, ControllerContext.CSRF_TOKEN, generateCsrfToken(ctx));Â Â Â Â Â Â  }Â Â Â  }Â Â Â  Â Â Â  private String generateCsrfToken(ControllerContext ctx) {Â ... generate random stringÂ Â Â  }Â Â Â  Â Â Â  protected boolean isValidCsrfToken(ControllerContext ctx) {Â Â Â Â Â Â Â  String csrfParamToken = ctx.getParameter(ControllerContext.CSRF_TOKEN);Â Â Â Â Â Â Â  String csrfSessionToken = ctx.getSessionAttribute(ControllerContext.CSRF_TOKEN, \"\");Â Â Â Â Â Â Â  if(!Utils.isEmpty(csrfParamToken) && !Utils.isEmpty(csrfSessionToken) && csrfParamToken.equals(csrfSessionToken)) {Â Â Â Â Â Â Â Â Â Â Â  return true;Â Â Â Â Â Â Â  } else {Â Â Â Â Â Â Â Â Â Â Â  //Log this as this can be a security threatÂ Â Â Â Â Â Â Â Â Â Â  Log.warn(\"Invalid security Token. Supplied token: \" + csrfParamToken + \". Session token: \" + csrfSessionToken + \". IP: \" + ctx.request.getRemoteAddr());Â Â Â Â Â Â Â Â Â Â Â  return false;Â Â Â Â Â Â Â  }Â Â Â  }\r\n      \r\n        \r\n          Include CSRF token in form submitted via JSP.\r\n        \r\n        <input type=\"hidden\" name=\"ctoken\" id=\"ctoken\" value=\"${sessionScope.ctoken}\"/>\r\n        \r\n          \r\n            In Controller handling request, validate CSRF token. In the action class/method that handles the saving of your form (ex. SaveBookController), you need to perform the token validation. \r\n          ...ControllerContext ctx = new ControllerContext(request, response);init(ctx);if (!isValidCsrfToken(ctx)) {Â Â Â  result.addError(new ObjectError(\"employee\", getMessage(\"error.invalidCsrfToken\")));Â Â Â  return getModelAndView(ctx, \"employee/list\");}..."
    ],
    "strong": [
      "Build a base controller with CSRF generation and validation methods.",
      "Include CSRF token in form submitted via JSP.",
      "In Controller handling request, validate CSRF token.",
      "Note"
    ],
    "pre": [
      "public class RootController {...Â Â Â  protected void init(ControllerContext ctx) {Â ...Â Â Â Â Â Â Â  initializeCsfrToken(ctx);Â Â Â  }",
      "private void initializeCsfrToken(ControllerContext ctx) {Â Â Â Â Â Â  String csrfToken = ctx.getSessionAttribute(ControllerContext.CSRF_TOKEN, \"\");Â Â Â Â Â Â  if(Utils.isEmpty(csrfToken)) {Â Â Â Â Â Â Â Â Â Â  ctx.setSessionAttribute(ctx, ControllerContext.CSRF_TOKEN, generateCsrfToken(ctx));Â Â Â Â Â Â  }Â Â Â  }Â Â Â  Â Â Â  private String generateCsrfToken(ControllerContext ctx) {Â ... generate random stringÂ Â Â  }Â Â Â  Â Â Â  protected boolean isValidCsrfToken(ControllerContext ctx) {Â Â Â Â Â Â Â  String csrfParamToken = ctx.getParameter(ControllerContext.CSRF_TOKEN);Â Â Â Â Â Â Â  String csrfSessionToken = ctx.getSessionAttribute(ControllerContext.CSRF_TOKEN, \"\");Â Â Â Â Â Â Â  if(!Utils.isEmpty(csrfParamToken) && !Utils.isEmpty(csrfSessionToken) && csrfParamToken.equals(csrfSessionToken)) {Â Â Â Â Â Â Â Â Â Â Â  return true;Â Â Â Â Â Â Â  } else {Â Â Â Â Â Â Â Â Â Â Â  //Log this as this can be a security threatÂ Â Â Â Â Â Â Â Â Â Â  Log.warn(\"Invalid security Token. Supplied token: \" + csrfParamToken + \". Session token: \" + csrfSessionToken + \". IP: \" + ctx.request.getRemoteAddr());Â Â Â Â Â Â Â Â Â Â Â  return false;Â Â Â Â Â Â Â  }Â Â Â  }",
      "<input type=\"hidden\" name=\"ctoken\" id=\"ctoken\" value=\"${sessionScope.ctoken}\"/>",
      "...ControllerContext ctx = new ControllerContext(request, response);init(ctx);if (!isValidCsrfToken(ctx)) {Â Â Â  result.addError(new ObjectError(\"employee\", getMessage(\"error.invalidCsrfToken\")));Â Â Â  return getModelAndView(ctx, \"employee/list\");}..."
    ],
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "em": [
      "SaveBookController"
    ],
    "a": [
      "http://static.springsource.org/spring/docs/2.0.x/reference/mvc.html",
      "Use Session Management Offered by the Framework",
      "Protect Session IDs",
      "Protect Session Cookies",
      "Set the Domain and Path Values of Session Cookies",
      "Set the Secure and HTTPOnly Flags on All Sensitive Cookies",
      "Change Session IDs During Authentication",
      "Invalidate Sessions when Users Log Out",
      "Make Inactive Sessions Time-out",
      "Include Unique Tokens in HTTP Requests",
      "Do Not Make Security Decisions Based on Client-Accessible Parameters",
      "Session Management Offered by the Framework Is Used",
      "Session IDs Are Protected",
      "Session Cookies are Protected",
      "The Domain and Path Values of Session Cookies Are Strict",
      "The Secure and HTTPOnly Flags Are Set on All Sensitive Cookies",
      "Session IDs Are Changed During Authentication",
      "Sessions Are Invalidated When Users Log Out",
      "Inactive Sessions Time-out",
      "Unique Tokens Are Included in HTTP Requests",
      "Security Decisions are Not Made Based on Client-Accessible Parameters",
      "Add Unique Tokens to HTTP Requests Using ESAPI",
      "Add Unique Tokens to HTTP Requests Using Java Server Faces (JSF)",
      "Add Unique Tokens to HTTP Requests Using Plain Java Server Pages (JSP)",
      "Cross-Site Request Forgery (CSRF) Prevention Using SpringMVC",
      "Cross-Site Request Forgery (CSRF) Prevention Using Struts 1",
      "Cross-Site Request Forgery (CSRF) Prevention Using Struts 2",
      "Use ESAPI HTTPUtilities",
      "How to Test for Session Prediction Bugs in Java"
    ]
  },
  "links": [
    {
      "href": "http://static.springsource.org/spring/docs/2.0.x/reference/mvc.html",
      "text": "http://static.springsource.org/spring/docs/2.0.x/reference/mvc.html"
    },
    {
      "href": "/article/42276b64-f51d-4b89-8c33-0ffd9b098890",
      "text": "Use Session Management Offered by the Framework"
    },
    {
      "href": "/article/2aa12bed-347a-43c6-a419-48ffd5bc3f5a",
      "text": "Protect Session IDs"
    },
    {
      "href": "/article/6012e717-6ba6-4380-8ca8-2f0b7c69d717",
      "text": "Protect Session Cookies"
    },
    {
      "href": "/article/7a517ad5-8640-4bc7-9e84-ccc313a71901",
      "text": "Set the Domain and Path Values of Session Cookies"
    },
    {
      "href": "/article/9b7e6e63-c37c-403b-a2f5-60b1e1abbb0b",
      "text": "Set the Secure and HTTPOnly Flags on All Sensitive Cookies"
    },
    {
      "href": "/article/6c470029-5c62-4394-99a9-8990bc48b0a8",
      "text": "Change Session IDs During Authentication"
    },
    {
      "href": "/article/a223c2d8-ab42-47fb-81a2-86ad677a5632",
      "text": "Invalidate Sessions when Users Log Out"
    },
    {
      "href": "/article/acfe1a16-3f00-4383-ada4-bebafc98a836",
      "text": "Make Inactive Sessions Time-out"
    },
    {
      "href": "/article/61b8ebc8-3ba5-4e75-aea8-94d6d3b3177e",
      "text": "Include Unique Tokens in HTTP Requests"
    },
    {
      "href": "/article/9df0b518-f832-4a7c-9857-0517638c47db",
      "text": "Do Not Make Security Decisions Based on Client-Accessible Parameters"
    },
    {
      "href": "/article/3f2660b3-a935-4b4e-85ff-27ae28683f5b",
      "text": "Session Management Offered by the Framework Is Used"
    },
    {
      "href": "/article/1de62774-3392-4da7-9bae-065fb15b4a2b",
      "text": "Session IDs Are Protected"
    },
    {
      "href": "/article/59132a30-2bae-45e9-9d85-8de26441be29",
      "text": "Session Cookies are Protected"
    },
    {
      "href": "/article/500d61f2-c9fa-4b1e-91f5-0a589c0fe00b",
      "text": "The Domain and Path Values of Session Cookies Are Strict"
    },
    {
      "href": "/article/d8922a46-a943-4ae0-b8af-b88eb01d6997",
      "text": "The Secure and HTTPOnly Flags Are Set on All Sensitive Cookies"
    },
    {
      "href": "/article/58df5418-8c03-4121-83e0-bc68247c5d7b",
      "text": "Session IDs Are Changed During Authentication"
    },
    {
      "href": "/article/0e40c446-c740-42a9-a4d2-72c9d05e55ac",
      "text": "Sessions Are Invalidated When Users Log Out"
    },
    {
      "href": "/article/c486eeb2-f64f-480b-9823-48bd7d21047d",
      "text": "Inactive Sessions Time-out"
    },
    {
      "href": "/article/0463ae25-dc35-45e7-8b24-9b1f8ddb6af0",
      "text": "Unique Tokens Are Included in HTTP Requests"
    },
    {
      "href": "/article/4436e342-64d9-4b1b-ae9b-3e00696053fb",
      "text": "Security Decisions are Not Made Based on Client-Accessible Parameters"
    },
    {
      "href": "/article/7d647e95-e47f-42e3-bb84-fd0dd727245c",
      "text": "Add Unique Tokens to HTTP Requests Using ESAPI"
    },
    {
      "href": "/article/25e3943b-a651-42c5-9e19-76077de05e90",
      "text": "Add Unique Tokens to HTTP Requests Using Java Server Faces (JSF)"
    },
    {
      "href": "/article/986c7161-0a76-430a-8d0e-80d4615ab5db",
      "text": "Add Unique Tokens to HTTP Requests Using Plain Java Server Pages (JSP)"
    },
    {
      "href": "/article/bf931bed-21c0-4b89-9cb2-9274d8c796a6",
      "text": "Cross-Site Request Forgery (CSRF) Prevention Using SpringMVC"
    },
    {
      "href": "/article/63deed1a-6df4-4e04-9f61-898f190e1fe1",
      "text": "Cross-Site Request Forgery (CSRF) Prevention Using Struts 1"
    },
    {
      "href": "/article/a9c2c121-614c-4a3f-9b7c-f2cf57d6aa0b",
      "text": "Cross-Site Request Forgery (CSRF) Prevention Using Struts 2"
    },
    {
      "href": "/article/4d7ee521-8680-481e-a40b-3afb04c2616d",
      "text": "Use ESAPI HTTPUtilities"
    },
    {
      "href": "/article/40771780-be59-4d4c-b283-5ec3cc286357",
      "text": "How to Test for Session Prediction Bugs in Java"
    }
  ],
  "html": "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>JAVA<li>SpringMVC</li></li>\r\n  </ul>\r\n  <h1>Summary</h1>\r\n  <p>Perform CSRF prevention using SpringMVC within an application.</p>\r\n  <h1>Objectives</h1>\r\n  <p>CSRF prevention is a key security control for an application that protects the application and its users from CSRF attacks. This article will describe how to use the built-in mechanisms provided by SpringMVC to perform CSRF prevention.</p>\r\n  <h1>Solution Example</h1>\r\n  <p>There is a standard model for CSRF prevention using SpringMVC that involves 3 basic steps</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Build a base controller with CSRF generation and validation methods.</strong>\r\n      </p>\r\n      <pre>public class RootController &#123;<br />...<br />&nbsp;&nbsp;&nbsp; protected void init(ControllerContext ctx) &#123;<br />&nbsp;...<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; initializeCsfrToken(ctx);<br />&nbsp;&nbsp;&nbsp; &#125;</pre>\r\n      <pre>&nbsp;&nbsp;&nbsp; private void initializeCsfrToken(ControllerContext ctx) &#123;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String csrfToken = ctx.getSessionAttribute(ControllerContext.CSRF_TOKEN, \"\");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(Utils.isEmpty(csrfToken)) &#123;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ctx.setSessionAttribute(ctx, ControllerContext.CSRF_TOKEN, generateCsrfToken(ctx));<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#125;<br />&nbsp;&nbsp;&nbsp; &#125;<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; private String generateCsrfToken(ControllerContext ctx) &#123;<br />&nbsp;... generate random string<br />&nbsp;&nbsp;&nbsp; &#125;<br />&nbsp;&nbsp;&nbsp; <br />&nbsp;&nbsp;&nbsp; protected boolean isValidCsrfToken(ControllerContext ctx) &#123;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String csrfParamToken = ctx.getParameter(ControllerContext.CSRF_TOKEN);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String csrfSessionToken = ctx.getSessionAttribute(ControllerContext.CSRF_TOKEN, \"\");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if(&#33;Utils.isEmpty(csrfParamToken) && &#33;Utils.isEmpty(csrfSessionToken) && csrfParamToken.equals(csrfSessionToken)) &#123;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return true;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#125; else &#123;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //Log this as this can be a security threat<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Log.warn(\"Invalid security Token. Supplied token: \" &#43; csrfParamToken &#43; \". Session token: \" &#43; csrfSessionToken &#43; \". IP: \" &#43; ctx.request.getRemoteAddr());<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; return false;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &#125;<br />&nbsp;&nbsp;&nbsp; &#125;</pre>\r\n      <li>\r\n        <p>\r\n          <strong>Include CSRF token in form submitted via JSP.</strong>\r\n        </p>\r\n        <pre>&lt;input type=\"hidden\" name=\"ctoken\" id=\"ctoken\" value=\"&#36;&#123;sessionScope.ctoken&#125;\"/&gt;</pre>\r\n        <li>\r\n          <p>\r\n            <strong>In Controller handling request, validate CSRF token. </strong>In the action class/method that handles the saving of your form (ex. <em>SaveBookController</em>), you need to perform the token validation. </p>\r\n          <pre>...<br />ControllerContext ctx = new ControllerContext(request, response);<br />init(ctx);<br />if (&#33;isValidCsrfToken(ctx)) &#123;<br />&nbsp;&nbsp;&nbsp; result.addError(new ObjectError(\"employee\", getMessage(\"error.invalidCsrfToken\")));<br />&nbsp;&nbsp;&nbsp; return getModelAndView(ctx, \"employee/list\");<br />&#125;<br />...</pre>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ol>\r\n  <p>Using these 3 simple steps you can effectively have a session specific per user token used to validate that a request was submitted by a user intentionally.</p>\r\n  <p>\r\n    <strong>Note</strong>: There have been effective attacks against various CSRF prevention techniques including this token-based approach when an application has XSS vulnerabilities. Removing XSS is therefore viewed as a prerequisite activity for a complete CSRF prevention mechanism.</p>\r\n  <p>In conclusion, CSRF prevention can function as a strong security control if used properly and applied thoroughly throughout the application. The SpringMVC framework provides a simple series of steps for accomplishing this task. </p>\r\n  <h1>More Information</h1>\r\n  <ul>\r\n    <li>For more information about the Web MVC framework, please see <a href=\"http://static.springsource.org/spring/docs/2.0.x/reference/mvc.html\">http://static.springsource.org/spring/docs/2.0.x/reference/mvc.html</a></li>\r\n  </ul>\r\n  <h1>Java Session Management Guidelines</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/42276b64-f51d-4b89-8c33-0ffd9b098890\">Use Session Management Offered by the Framework</a>\r\n      <li>\r\n        <a href=\"/article/2aa12bed-347a-43c6-a419-48ffd5bc3f5a\">Protect Session IDs</a>\r\n        <li>\r\n          <a href=\"/article/6012e717-6ba6-4380-8ca8-2f0b7c69d717\">Protect Session Cookies</a>\r\n          <li>\r\n            <a href=\"/article/7a517ad5-8640-4bc7-9e84-ccc313a71901\">Set the Domain and Path Values of Session Cookies</a>\r\n            <li>\r\n              <a href=\"/article/9b7e6e63-c37c-403b-a2f5-60b1e1abbb0b\">Set the Secure and HTTPOnly Flags on All Sensitive Cookies</a>\r\n              <li>\r\n                <a href=\"/article/6c470029-5c62-4394-99a9-8990bc48b0a8\">Change Session IDs During Authentication</a>\r\n                <li>\r\n                  <a href=\"/article/a223c2d8-ab42-47fb-81a2-86ad677a5632\">Invalidate Sessions when Users Log Out</a>\r\n                  <li>\r\n                    <a href=\"/article/acfe1a16-3f00-4383-ada4-bebafc98a836\">Make Inactive Sessions Time-out</a>\r\n                    <li>\r\n                      <a href=\"/article/61b8ebc8-3ba5-4e75-aea8-94d6d3b3177e\">Include Unique Tokens in HTTP Requests</a>\r\n                      <li>\r\n                        <a href=\"/article/9df0b518-f832-4a7c-9857-0517638c47db\">Do Not Make Security Decisions Based on Client-Accessible Parameters</a>\r\n                      </li>\r\n                    </li>\r\n                  </li>\r\n                </li>\r\n              </li>\r\n            </li>\r\n          </li>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ul>\r\n  <h1>Java Session Management Checklists</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/3f2660b3-a935-4b4e-85ff-27ae28683f5b\">Session Management Offered by the Framework Is Used</a>\r\n      <li>\r\n        <a href=\"/article/1de62774-3392-4da7-9bae-065fb15b4a2b\">Session IDs Are Protected</a>\r\n        <li>\r\n          <a href=\"/article/59132a30-2bae-45e9-9d85-8de26441be29\">Session Cookies are Protected</a>\r\n          <li>\r\n            <a href=\"/article/500d61f2-c9fa-4b1e-91f5-0a589c0fe00b\">The Domain and Path Values of Session Cookies Are Strict</a>\r\n            <li>\r\n              <a href=\"/article/d8922a46-a943-4ae0-b8af-b88eb01d6997\">The Secure and HTTPOnly Flags Are Set on All Sensitive Cookies</a>\r\n              <li>\r\n                <a href=\"/article/58df5418-8c03-4121-83e0-bc68247c5d7b\">Session IDs Are Changed During Authentication</a>\r\n                <li>\r\n                  <a href=\"/article/0e40c446-c740-42a9-a4d2-72c9d05e55ac\">Sessions Are Invalidated When Users Log Out</a>\r\n                  <li>\r\n                    <a href=\"/article/c486eeb2-f64f-480b-9823-48bd7d21047d\">Inactive Sessions Time-out</a>\r\n                    <li>\r\n                      <a href=\"/article/0463ae25-dc35-45e7-8b24-9b1f8ddb6af0\">Unique Tokens Are Included in HTTP Requests</a>\r\n                      <li>\r\n                        <a href=\"/article/4436e342-64d9-4b1b-ae9b-3e00696053fb\">Security Decisions are Not Made Based on Client-Accessible Parameters</a>\r\n                      </li>\r\n                    </li>\r\n                  </li>\r\n                </li>\r\n              </li>\r\n            </li>\r\n          </li>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ul>\r\n  <h1>Java Session Management Code Examples</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/7d647e95-e47f-42e3-bb84-fd0dd727245c\">Add Unique Tokens to HTTP Requests Using ESAPI</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/25e3943b-a651-42c5-9e19-76077de05e90\">Add Unique Tokens to HTTP Requests Using Java Server Faces (JSF)</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/986c7161-0a76-430a-8d0e-80d4615ab5db\">Add Unique Tokens to HTTP Requests Using Plain Java Server Pages (JSP)</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/bf931bed-21c0-4b89-9cb2-9274d8c796a6\">Cross-Site Request Forgery (CSRF) Prevention Using SpringMVC</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/63deed1a-6df4-4e04-9f61-898f190e1fe1\">Cross-Site Request Forgery (CSRF) Prevention Using Struts 1</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/a9c2c121-614c-4a3f-9b7c-f2cf57d6aa0b\">Cross-Site Request Forgery (CSRF) Prevention Using Struts 2</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/4d7ee521-8680-481e-a40b-3afb04c2616d\">Use ESAPI HTTPUtilities</a>\r\n    </li>\r\n  </ul>\r\n  <h1>Java Session Management Testing</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/40771780-be59-4d4c-b283-5ec3cc286357\">How to Test for Session Prediction Bugs in Java</a>\r\n    </li>\r\n  </ul>"
}