<h1>What to Do</h1>
  <p>Automatically lock inactive user accounts. Log when accounts have been locked.</p>
  <h1>Why</h1>
  <p>Inactive user accounts increase the attack surface of the application and can be used by an attacker as a means of entry.</p>
  <h1>When</h1>
  <p>Design your application so that inactive user accounts can be detected and locked. After deployment, set the system to lock inactive accounts after an appropriate amount of time.</p>
  <h1>How</h1>
  <p>Use the following steps when locking inactive user accounts:</p>
  <ol>
    <li>
      <p>
        <strong>Set a lockout policy. </strong>Create the application's lockout policy. Determine the necessary duration of inactivity before an account can be locked/disabled. This policy can vary depending on whether the account is of a normal user or an administrator. For example, disable normal accounts after 45 days of inactivity and administrative accounts after 30 days of inactivity.</p>
    </li>
    <li>
      <p>
        <strong>Keep track of user inactivity.</strong> Establish a mechanism to keep track of the last successful authentication. Successful authentication can be tracked via logs or a timestamp, which resides in the user database. Example: </p>
      <pre>sql&gt; select username, last_login_date from users</pre>
    </li>
    <li>
      <p>
        <strong>Set a lockout mechanism.</strong> Establish a mechanism to verify the current period of inactivity and automatically set the disabled bit for inactive accounts. Using the application or database server's scheduler, activate such functionality to run during the hours with least user activity. Keep in mind that inactive accounts should be disabled, but not removed until it is confirmed that they should be completely removed. If your application uses a backend database as its user store, consider using a scheduled database transaction to lock inactive user accounts. For example, the following database transaction would lock all user accounts that have been inactive for more than 30 days. Such transaction should be scheduled to run once a day:</p>
      <pre>sql&gt; update users set locked = 1 where (current_date - 30) &gt; last_login_date</pre>
    </li>
  </ol>
  <h1>Problem Example</h1>
  <p>The following segment illustrates the user database of a multi-user application. In its current state, the application logs the last time the user has logged in, but does not enforce a lockout policy for its inactive users; therefore an attacker can gain unauthorized access to the application by compromising an inactive account.</p>
  <h1>Solution Example</h1>
  <p>The following segment illustrates the user database of a multi-user application. Because the application enforces a lockout policy, all of its inactive users have been locked and denied access to the application. Therefore an attacker cannot compromise the application through its inactive users.</p>
  <pre>sql&gt; select username, locked, last_login_date from users</pre>
  <hr />
  <p>Adapted from Microsoft patterns & practices guidance. </p>