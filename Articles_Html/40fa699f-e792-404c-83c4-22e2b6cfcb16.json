{
  "id": "40fa699f-e792-404c-83c4-22e2b6cfcb16",
  "checksum": "6a6d6be488e79077e38ae7f9412489a1c9e91887",
  "words": {
    "description": [
      "h1"
    ],
    "if": [
      "p",
      "p",
      "blockquote",
      "blockquote",
      "p"
    ],
    "your": [
      "p",
      "blockquote",
      "p"
    ],
    "code": [
      "p",
      "p"
    ],
    "needs": [
      "p"
    ],
    "to": [
      "p",
      "p",
      "blockquote",
      "blockquote",
      "blockquote",
      "p",
      "p",
      "p",
      "p",
      "title",
      "title",
      "title"
    ],
    "use": [
      "p",
      "p",
      "p"
    ],
    "application": [
      "p",
      "blockquote"
    ],
    "specific": [
      "p"
    ],
    "event": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "ul",
      "li",
      "title"
    ],
    "sources": [
      "p",
      "p",
      "p",
      "ul",
      "li"
    ],
    "you": [
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "p"
    ],
    "should": [
      "p",
      "blockquote"
    ],
    "create": [
      "p",
      "p",
      "p"
    ],
    "them": [
      "p"
    ],
    "at": [
      "p",
      "p",
      "ul",
      "ul",
      "li",
      "li"
    ],
    "installation": [
      "p",
      "p",
      "ul",
      "li"
    ],
    "time": [
      "p",
      "p",
      "ul",
      "li"
    ],
    "when": [
      "p"
    ],
    "administrator": [
      "p",
      "p"
    ],
    "privileges": [
      "p"
    ],
    "are": [
      "p",
      "p",
      "p",
      "p"
    ],
    "available": [
      "p"
    ],
    "do": [
      "p"
    ],
    "so": [
      "p"
    ],
    "by": [
      "p",
      "p",
      "p",
      "p"
    ],
    "creating": [
      "p",
      "ul",
      "li"
    ],
    "an": [
      "p"
    ],
    "installer": [
      "p"
    ],
    "class": [
      "p"
    ],
    "that": [
      "p",
      "p"
    ],
    "derives": [
      "p"
    ],
    "from": [
      "p",
      "p"
    ],
    "systemconfiguration.install.installer": [
      "p",
      "b"
    ],
    "and": [
      "p",
      "p",
      "blockquote",
      "p",
      "p"
    ],
    "using": [
      "p",
      "pre"
    ],
    "the": [
      "p",
      "p",
      "p",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "title"
    ],
    "installutilexe": [
      "p"
    ],
    "utility": [
      "p"
    ],
    "unable": [
      "p"
    ],
    "in": [
      "p",
      "p",
      "p"
    ],
    "deployment": [
      "p"
    ],
    "can": [
      "p",
      "blockquote",
      "p",
      "p"
    ],
    "manually": [
      "p"
    ],
    "new": [
      "p"
    ],
    "source": [
      "p"
    ],
    "entry": [
      "p"
    ],
    "beneath": [
      "p"
    ],
    "following": [
      "p",
      "p",
      "p"
    ],
    "registry": [
      "p",
      "blockquote"
    ],
    "key": [
      "p",
      "blockquote",
      "blockquote"
    ],
    "hkey_local_machine\\system\\currentcontrolset\\services\\eventlog\\logname>": [
      "p",
      "b"
    ],
    "note   you": [
      "blockquote"
    ],
    "not": [
      "blockquote",
      "p"
    ],
    "grant": [
      "blockquote"
    ],
    "write": [
      "blockquote",
      "blockquote",
      "title"
    ],
    "permission": [
      "blockquote"
    ],
    "aspnet": [
      "blockquote"
    ],
    "process": [
      "blockquote"
    ],
    "account": [
      "blockquote",
      "blockquote",
      "blockquote"
    ],
    "or": [
      "blockquote",
      "p",
      "p"
    ],
    "any": [
      "blockquote",
      "blockquote",
      "blockquote",
      "p"
    ],
    "impersonated": [
      "blockquote"
    ],
    "uses": [
      "blockquote"
    ],
    "impersonation": [
      "blockquote"
    ],
    "on": [
      "blockquote",
      "blockquote"
    ],
    "hkey_local_machine\\system\\currentcontrolset\\services\\eventlog\\": [
      "blockquote",
      "b"
    ],
    "allow": [
      "blockquote"
    ],
    "access": [
      "blockquote",
      "blockquote",
      "p",
      "p",
      "p"
    ],
    "this": [
      "blockquote"
    ],
    "is": [
      "blockquote"
    ],
    "compromised": [
      "blockquote"
    ],
    "attacker": [
      "blockquote"
    ],
    "modify": [
      "blockquote"
    ],
    "log-related": [
      "blockquote"
    ],
    "setting": [
      "blockquote"
    ],
    "including": [
      "blockquote"
    ],
    "control": [
      "blockquote"
    ],
    "log": [
      "blockquote",
      "blockquote",
      "p",
      "p",
      "title"
    ],
    "for": [
      "blockquote",
      "ul",
      "li"
    ],
    "system": [
      "blockquote"
    ],
    "note": [
      "b"
    ],
    "assembly": [
      "p"
    ],
    "must": [
      "p"
    ],
    "be": [
      "p"
    ],
    "granted": [
      "p"
    ],
    "eventlogpermission": [
      "p",
      "b"
    ],
    "code-access": [
      "p"
    ],
    "security": [
      "p"
    ],
    "policy": [
      "p"
    ],
    "partial": [
      "p"
    ],
    "trust": [
      "p"
    ],
    "environments": [
      "p"
    ],
    "want": [
      "p"
    ],
    "constrain": [
      "p"
    ],
    "actions": [
      "p"
    ],
    "of": [
      "p"
    ],
    "event-log": [
      "p"
    ],
    "wrapper": [
      "p"
    ],
    "code—perhaps": [
      "p"
    ],
    "because": [
      "p"
    ],
    "was": [
      "p"
    ],
    "written": [
      "p"
    ],
    "another": [
      "p"
    ],
    "developer": [
      "p"
    ],
    "development": [
      "p"
    ],
    "organization—you": [
      "p"
    ],
    "declarative": [
      "p"
    ],
    "attributes": [
      "p"
    ],
    "with": [
      "p"
    ],
    "securityactionpermitonly": [
      "p",
      "b"
    ],
    "enumeration": [
      "p",
      "p",
      "p"
    ],
    "as": [
      "p"
    ],
    "shown": [
      "p"
    ],
    "example": [
      "p"
    ],
    "attribute": [
      "p"
    ],
    "ensures": [
      "p"
    ],
    "writetolog": [
      "p",
      "b",
      "pre"
    ],
    "method": [
      "p"
    ],
    "methods": [
      "p"
    ],
    "it": [
      "p"
    ],
    "calls": [
      "p"
    ],
    "only": [
      "p"
    ],
    "local": [
      "p"
    ],
    "computer's": [
      "p"
    ],
    "cannot": [
      "p"
    ],
    "delete": [
      "p"
    ],
    "logs": [
      "p",
      "p"
    ],
    "these": [
      "p"
    ],
    "operations": [
      "p"
    ],
    "permitted": [
      "p"
    ],
    "eventlogpermissionaccessinstrument": [
      "p",
      "b"
    ],
    "systemdiagnostics;": [
      "pre"
    ],
    "..": [
      "pre"
    ],
    "eventlogpermission(securityaction.permitonly,machinename=\".\",\t\tpermissionaccess=eventlogpermissionaccess.instrument)]public": [
      "pre"
    ],
    "static": [
      "pre"
    ],
    "void": [
      "pre"
    ],
    "string": [
      "pre"
    ],
    "message": [
      "pre"
    ],
    "enforce": [
      "p"
    ],
    "read-only": [
      "p"
    ],
    "existing": [
      "p"
    ],
    "eventlogpermissionaccessbrowse": [
      "p",
      "b"
    ],
    "additional": [
      "h1"
    ],
    "resources": [
      "h1"
    ],
    "more": [
      "ul",
      "li"
    ],
    "information": [
      "ul",
      "li"
    ],
    "about": [
      "ul",
      "li"
    ],
    "see": [
      "ul",
      "li"
    ],
    "\"installer": [
      "ul",
      "li"
    ],
    "tool": [
      "ul",
      "li"
    ],
    "installutil.exe)\"": [
      "ul",
      "li"
    ],
    "http//msdn.microsoft.com/library/en-us/cptools/html/cpconinstallerutilityinstallutilexe.asp": [
      "ul",
      "li",
      "a"
    ],
    "adapted": [
      "p"
    ],
    "microsoft": [
      "p"
    ],
    "patterns": [
      "p"
    ],
    "&": [
      "p"
    ],
    "practices": [
      "p"
    ],
    "guidance": [
      "p"
    ],
    "how": [
      "title"
    ],
    "set": [
      "title"
    ],
    "up": [
      "title"
    ],
    "permissions": [
      "title"
    ]
  },
  "tags": {
    "h1": [
      "Description",
      "Additional Resources"
    ],
    "p": [
      "If your code needs to use application specific event sources, you should create them at installation time when administrator privileges are available. You do so by creating an installer class that derives from System.Configuration.Install.Installer and using the InstallUtil.exe utility. If you are unable to create event sources at installation time, and you are in deployment, the administrator can manually create new event source entry beneath the following registry key HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\<LogName>",
      "To access the event log, your assembly must be granted EventLogPermission by code-access security policy. In partial trust environments, if you want to constrain the actions of event-log wrapper code—perhaps because the code was written by another developer or development organization—you can use declarative attributes with the SecurityAction.PermitOnly enumeration as shown in the following example.",
      "The following attribute ensures that the WriteToLog method and any methods it calls can only access the local computer's event log and cannot delete event logs or event sources. These operations are not permitted by the EventLogPermissionAccess.Instrument enumeration.",
      "To enforce read-only access to existing logs, use the EventLogPermissionAccess.Browse enumeration.",
      "Adapted from Microsoft patterns & practices guidance."
    ],
    "b": [
      "System.Configuration.Install.Installer",
      "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\<LogName>",
      "Note",
      "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\",
      "EventLogPermission",
      "SecurityAction.PermitOnly",
      "WriteToLog",
      "EventLogPermissionAccess.Instrument",
      "EventLogPermissionAccess.Browse"
    ],
    "blockquote": [
      "Note   You should not grant write permission to the ASP.NET process account (or any impersonated account if your application uses impersonation) on the HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\ registry key. If you allow write access to this key and the account is compromised, the attacker can modify any log-related setting, including access control to the log, for any log on the system."
    ],
    "pre": [
      "using System.Diagnostics;  ... [EventLogPermission(SecurityAction.PermitOnly,MachineName=\".\",\t\tPermissionAccess=EventLogPermissionAccess.Instrument)]public static void WriteToLog( string message )"
    ],
    "br": [
      "",
      "",
      ""
    ],
    "ul": [
      "For more information about creating event sources at installation time, see \"Installer Tool (Installutil.exe)\" at http://msdn.microsoft.com/library/en-us/cptools/html/cpconInstallerUtilityInstallutilexe.asp"
    ],
    "li": [
      "For more information about creating event sources at installation time, see \"Installer Tool (Installutil.exe)\" at http://msdn.microsoft.com/library/en-us/cptools/html/cpconInstallerUtilityInstallutilexe.asp"
    ],
    "a": [
      "http://msdn.microsoft.com/library/en-us/cptools/html/cpconInstallerUtilityInstallutilexe.asp"
    ],
    "hr": [
      ""
    ]
  },
  "links": [
    {
      "href": "http://msdn.microsoft.com/library/en-us/cptools/html/cpconInstallerUtilityInstallutilexe.asp",
      "text": "http://msdn.microsoft.com/library/en-us/cptools/html/cpconInstallerUtilityInstallutilexe.asp"
    }
  ],
  "html": "<h1>Description</h1>\r\n  <p>If your code needs to use application specific event sources, you should create them at installation time when administrator privileges are available. You do so by creating an installer class that derives from <b>System.Configuration.Install.Installer</b> and using the InstallUtil.exe utility. If you are unable to create event sources at installation time, and you are in deployment, the administrator can manually create new event source entry beneath the following registry key <b>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\&lt;LogName&gt;</b></p>\r\n  <blockquote>\r\n    <b>Note</b>&nbsp;&nbsp;&nbsp;You should not grant write permission to the ASP.NET process account (or any impersonated account if your application uses impersonation) on the <b>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\ </b>registry key. If you allow write access to this key and the account is compromised, the attacker can modify any log-related setting, including access control to the log, for any log on the system. </blockquote>\r\n  <p>To access the event log, your assembly must be granted <b>EventLogPermission</b> by code-access security policy. In partial trust environments, if you want to constrain the actions of event-log wrapper code&#8212;perhaps because the code was written by another developer or development organization&#8212;you can use declarative attributes with the <b>SecurityAction.PermitOnly</b> enumeration as shown in the following example. </p>\r\n  <p>The following attribute ensures that the <b>WriteToLog</b> method and any methods it calls can only access the local computer's event log and cannot delete event logs or event sources. These operations are not permitted by the <b>EventLogPermissionAccess.Instrument</b> enumeration. </p>\r\n  <pre>using System.Diagnostics;  ... <br />&#91;EventLogPermission(SecurityAction.PermitOnly,MachineName=\".\",<br />&#9;&#9;PermissionAccess=EventLogPermissionAccess.Instrument)&#93;<br />public static void WriteToLog( string message )  </pre>\r\n  <p>To enforce read-only access to existing logs, use the <b>EventLogPermissionAccess.Browse</b> enumeration. </p>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>For more information about creating event sources at installation time, see \"Installer Tool (Installutil.exe)\" at <a href=\"http://msdn.microsoft.com/library/en-us/cptools/html/cpconInstallerUtilityInstallutilexe.asp\">http://msdn.microsoft.com/library/en-us/cptools/html/cpconInstallerUtilityInstallutilexe.asp</a></li>\r\n  </ul>\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns & practices guidance.</p>"
}