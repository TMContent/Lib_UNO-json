<h1>Applies To</h1><p>Any web application.
</p><h1>Description</h1><p>Since HTTP is stateless, web applications use an authentication session ID to track the state between multiple requests from the same user. The session ID is usually a long, randomly-generated alpha-numeric string. This session ID is created and assigned to a user when they are first authenticated. This session ID is stored on the server and usually kept "alive" for as long as the user is using the web-application, and erased when the user log's out or the session times out after a predefined inactivity period. The session ID is associated with a specific user via a variety of means, most commonly by setting a cookie. Some applications will attempt to use hidden form variables or simply append the session ID to all page URLs, but this can make session hijacking attacks much easier.
</p><p>
By either obtaining or generating a valid session ID, an attacker can interact with the web application as though they were the user associated with that session. This is known as a session hijacking attack. Unlike other forms of hijacking, this does not prevent the original user from interacting with the application, so it can be hard to detect.
</p><p>
Failure to erase old session IDs or set a timeout period leaves the application vulnerable to an HTTP replay attack. It is also possible for a session hijacking attack to be performed without replaying an HTTP request if the session IDs are easily guessable.
</p><p>
There are three different ways to get a hold of the session ID for performing this attack:
</p><ol>
<li> <strong>Predict:</strong> If session IDs are generated by the server in a non-random fashion, then an attacker may be able to predict session ID values and take over a session.</li>
<li> <strong>Steal:</strong> Session IDs can be stolen by various methods some of which are:<ol>
<li>Network credential sniffing attack</li>
<li>Cross site scripting attack</li></ol></li>
<li> <strong>Brute force:</strong> The attacker can try a large number of IDs, generated randomly or generated with knowledge of probable IDs if IDs can be partially predicted.</li>
</ol><h1>Impact</h1><ul><li>Elevation of privilege.</li>
<li>Loss of sensitive information.</li>
</ul><h1>Vulnerabilities</h1><ul><li>Poor or predictable session identifiers.</li>
<li>Long session timeouts.</li>
<li>Insecure communication channel.</li>
</ul><h1>Countermeasures</h1><ul><li>Use strong random numbers for session identifiers: Strong random numbers (like GUIDs) will be difficult or impossible for an attacker to guess. It's important to ensure that the number of currently valid session IDs is small enough that the chances of an attacker randomly guessing a session ID are sufficiently small. For example, a 32-bit session ID might be acceptable in a situation where only a few hundred sessions can be valid at any time. But, if several million sessions can be concurrently valid, guessing a random session ID becomes relatively easy, suggesting that 64-bit or longer session IDs should be used. On the other hand, if the architecture of the system is such than an attacker can try session IDs very rapidly, say hundreds or thousands per second per machine, then the search space per session ID must be much larger, on the scale of one valid ID per a few billion possible IDs, at the least.</li>
<li>Tie the session ID to the IP address: This will prevent some forms of attacks, but may require mobile users to repeatedly re-authenticate. If this tradeoff is acceptable, it means that an attacker must be able to appear to come from the same IP address as the victim, which greatly limits their flexibility in network positioning, and may reduce the effective utility of things like cross-site scripting to steal session information.</li>
<li>Use smaller session timeout windows: This helps to ensure that the session ID will only be valid for a short amount of time before it must be re-authenticated. If the attacker is not using stolen session IDs immediately and the user abandons their session, a short session ID time out will help protect their session. This is especially important in contexts like public terminals.</li>
<li>Do not place session IDs in URLs: If session IDs are embedded in URLs, it may be much easier for an attacker to intercept them in certain situations. The browser will automatically pass session IDs along in the referer URL for pages when loading content on that page or following links away from it, potentially providing all the information the attacker needs.</li>
<li>Establish a secure communication channel: One of the most effective ways to protect HTTP session IDs is to use TLS or IPSec with encryption to establish a secure communication channel. As IPSec is relatively unsuitable for Internet users due to the required administrative overhead, TLS is the most logical choice for most applications. However, in addition to the usual issues of handling certificates, etc., great care must be taken when using TLS on sites with secure and insecure portions. If a session ID is valid and able to retrieve sensitive information through a secure portion of the site, it must never be sent in plaintext when talking to an insecure portion of the site, unless the session ID is marked as insecure and re-authentication is forced when re-entering a secure portion of the site.</li>
</ul><h1>Additional Resources</h1><ul><li>For more information on session hijacking mechanics and attack prevention see: <a href="http://technet.microsoft.com/en-us/magazine/2005.01.sessionhijacking.aspx">http://technet.microsoft.com/en-us/magazine/2005.01.sessionhijacking.aspx</a></li>
<li>For more information on GUIDs, see: <a href="http://en.wikipedia.org/wiki/GUID">http://en.wikipedia.org/wiki/GUID</a></li>
</ul><h1>Related Items</h1><ul><li><a href="edea26f5-72e9-40fb-a2d3-00224a9a84cd">Attack: HTTP Replay Attack</a></li>
<li><a href="e001f908-8905-40bd-8457-3ca2047537ea">Attack: Session Prediction Attack</a></li>
<li><a href="ad7b18e3-a8a0-4e87-b1a8-908e11449481">Attack: Network Credential Sniffing Attack</a></li>
<li><a href="36ce61ac-adcc-45a9-9910-95d477142c8b">Attack: Cross Site Scripting Attack</a></li>
</ul>