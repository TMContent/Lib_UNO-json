{
  "id": "b64450e3-f4d7-4da2-9d15-2d4f55d606d4",
  "checksum": "2403f5dc232d7eda5811d7e25a35aecc5bb87818",
  "words": {
    "what": [
      "h1"
    ],
    "to": [
      "h1",
      "p",
      "p",
      "p",
      "h1",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "blockquote"
    ],
    "check": [
      "h1",
      "p"
    ],
    "for": [
      "h1",
      "p",
      "p"
    ],
    "ensure": [
      "p"
    ],
    "that": [
      "p",
      "p",
      "p"
    ],
    "your": [
      "p",
      "p",
      "p",
      "p",
      "blockquote"
    ],
    "application": [
      "p",
      "p"
    ],
    "avoids": [
      "p"
    ],
    "using logonuser": [
      "p"
    ],
    "api": [
      "p",
      "p"
    ],
    "create": [
      "p",
      "p",
      "p"
    ],
    "impersonation": [
      "p",
      "p"
    ],
    "tokens": [
      "p",
      "p"
    ],
    "because": [
      "p",
      "p"
    ],
    "this": [
      "p",
      "p",
      "p",
      "p",
      "p"
    ],
    "forces": [
      "p",
      "p"
    ],
    "store": [
      "p",
      "p"
    ],
    "user": [
      "p",
      "p",
      "p",
      "p",
      "blockquote"
    ],
    "names": [
      "p",
      "p"
    ],
    "and": [
      "p",
      "p",
      "p",
      "p",
      "blockquote"
    ],
    "passwords": [
      "p",
      "p"
    ],
    "on": [
      "p",
      "p"
    ],
    "web": [
      "p",
      "p"
    ],
    "server": [
      "p",
      "p",
      "p",
      "p"
    ],
    "logonuser": [
      "strong",
      "p",
      "b",
      "title"
    ],
    "how": [
      "h1",
      "p"
    ],
    "fix": [
      "h1"
    ],
    "avoid": [
      "p"
    ],
    "writing": [
      "p"
    ],
    "code": [
      "p",
      "p"
    ],
    "calls": [
      "p"
    ],
    "the": [
      "p",
      "p",
      "p",
      "blockquote",
      "blockquote"
    ],
    "you": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "blockquote"
    ],
    "instead": [
      "p"
    ],
    "use": [
      "p",
      "p",
      "p",
      "title"
    ],
    "a": [
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "p",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote"
    ],
    "unique": [
      "p",
      "blockquote"
    ],
    "pool": [
      "p"
    ],
    "with": [
      "p"
    ],
    "specific": [
      "p",
      "p"
    ],
    "process": [
      "p"
    ],
    "identity": [
      "p",
      "p"
    ],
    "if": [
      "p",
      "p",
      "blockquote"
    ],
    "need": [
      "p",
      "p",
      "p"
    ],
    "access": [
      "p",
      "p",
      "p"
    ],
    "downstream": [
      "p",
      "p"
    ],
    "resources": [
      "p",
      "p"
    ],
    "multiple": [
      "p"
    ],
    "identities": [
      "p"
    ],
    "range": [
      "p"
    ],
    "of": [
      "p",
      "title"
    ],
    "services": [
      "p"
    ],
    "windows": [
      "p",
      "p",
      "p"
    ],
    "protocol": [
      "p"
    ],
    "transition": [
      "p"
    ],
    "windowsidentity": [
      "p",
      "b",
      "div",
      "pre"
    ],
    "constructor": [
      "p",
      "p"
    ],
    "allows": [
      "p"
    ],
    "token": [
      "p",
      "p",
      "p",
      "p"
    ],
    "is": [
      "p",
      "blockquote",
      "blockquote",
      "blockquote",
      "title"
    ],
    "given": [
      "p",
      "p"
    ],
    "only": [
      "p"
    ],
    "an": [
      "p"
    ],
    "account's": [
      "p",
      "blockquote"
    ],
    "principal": [
      "p"
    ],
    "name": [
      "p",
      "blockquote"
    ],
    "upn).": [
      "p"
    ],
    "network": [
      "p"
    ],
    "resource": [
      "p"
    ],
    "delegate-level": [
      "p"
    ],
    "get": [
      "p"
    ],
    "type": [
      "p"
    ],
    "needs": [
      "p"
    ],
    "be": [
      "p",
      "blockquote",
      "blockquote"
    ],
    "configured": [
      "p"
    ],
    "as": [
      "p"
    ],
    "trusted": [
      "p"
    ],
    "delegation": [
      "p"
    ],
    "in": [
      "p"
    ],
    "active": [
      "p"
    ],
    "directory": [
      "p"
    ],
    "following": [
      "p"
    ],
    "shows": [
      "p"
    ],
    "obtain": [
      "p"
    ],
    "using": [
      "div",
      "pre"
    ],
    "systemusing": [
      "div",
      "pre"
    ],
    "systemsecurity.principal;public": [
      "div",
      "pre"
    ],
    "void": [
      "div",
      "pre"
    ],
    "constructtokenstring": [
      "div",
      "pre"
    ],
    "upn": [
      "div",
      "pre",
      "blockquote",
      "blockquote",
      "blockquote",
      "blockquote"
    ],
    "out": [
      "div",
      "pre"
    ],
    "windowsprincipal": [
      "div",
      "pre"
    ],
    "p{": [
      "div",
      "pre"
    ],
    "id": [
      "div",
      "pre"
    ],
    "=": [
      "div",
      "div",
      "pre",
      "pre"
    ],
    "new": [
      "div",
      "div",
      "pre",
      "pre"
    ],
    "windowsidentityupn);": [
      "div",
      "pre"
    ],
    "p": [
      "div",
      "pre"
    ],
    "windowsprincipalid);}": [
      "div",
      "pre"
    ],
    "note   an": [
      "blockquote"
    ],
    "guaranteed": [
      "blockquote"
    ],
    "within": [
      "blockquote"
    ],
    "forest": [
      "blockquote"
    ],
    "frequently": [
      "blockquote"
    ],
    "user's": [
      "blockquote"
    ],
    "e-mail": [
      "blockquote"
    ],
    "address": [
      "blockquote"
    ],
    "but": [
      "blockquote"
    ],
    "it": [
      "blockquote",
      "blockquote"
    ],
    "does": [
      "blockquote"
    ],
    "not": [
      "blockquote"
    ],
    "have": [
      "blockquote"
    ],
    "always": [
      "blockquote"
    ],
    "has": [
      "blockquote"
    ],
    "by": [
      "blockquote",
      "blockquote"
    ],
    "default": [
      "blockquote"
    ],
    "userlogonname@fullyqualifieddomainname": [
      "blockquote"
    ],
    "are": [
      "blockquote"
    ],
    "logged": [
      "blockquote"
    ],
    "into": [
      "blockquote"
    ],
    "domain": [
      "blockquote"
    ],
    "can": [
      "blockquote"
    ],
    "find": [
      "blockquote"
    ],
    "running": [
      "blockquote"
    ],
    "whoami": [
      "blockquote",
      "b"
    ],
    "/upn": [
      "blockquote",
      "b"
    ],
    "from": [
      "blockquote",
      "p"
    ],
    "command": [
      "blockquote"
    ],
    "window": [
      "blockquote"
    ],
    "note": [
      "b"
    ],
    "userlogonname": [
      "i"
    ],
    "fullyqualifieddomainname": [
      "i"
    ],
    "adapted": [
      "p"
    ],
    "microsoft": [
      "p"
    ],
    "patterns": [
      "p"
    ],
    "&": [
      "p"
    ],
    "practices": [
      "p"
    ],
    "guidance": [
      "p"
    ],
    "avoided": [
      "title"
    ],
    "where": [
      "title"
    ],
    "possible": [
      "title"
    ]
  },
  "tags": {
    "br": [
      "",
      "",
      "",
      "",
      "",
      "",
      ""
    ],
    "h1": [
      "What to Check For",
      "How to Fix"
    ],
    "p": [
      "Check to ensure that your application avoids using LogonUser API to create impersonation tokens because this forces to store user names and passwords on your Web server.",
      "",
      "Avoid writing code that calls the LogonUser API to create impersonation tokens because this forces you to store user names and passwords on your Web server.",
      "Instead, use a unique application pool with a specific process identity if you need a specific identity to access downstream resources. If you need multiple identities to access a range of downstream resources and services, use Windows Server protocol transition and the WindowsIdentity constructor; this allows you to create a Windows token that is given only an account's user principal name (UPN). To access a network resource, you need to delegate-level token. To get this token type, your server needs to be configured as trusted for delegation in Active Directory.",
      "The following code shows how to use this constructor to obtain a Windows token for a given user.",
      "Adapted from Microsoft patterns & practices guidance."
    ],
    "strong": [
      "LogonUser"
    ],
    "b": [
      "LogonUser",
      "WindowsIdentity",
      "Note",
      "whoami /upn"
    ],
    "div": [
      "using System;using System.Security.Principal;public void ConstructToken(string upn, out WindowsPrincipal p){  WindowsIdentity id = new WindowsIdentity(upn);  p = new WindowsPrincipal(id);}"
    ],
    "pre": [
      "using System;using System.Security.Principal;public void ConstructToken(string upn, out WindowsPrincipal p){  WindowsIdentity id = new WindowsIdentity(upn);  p = new WindowsPrincipal(id);}"
    ],
    "blockquote": [
      "Note   An account's UPN is guaranteed to be unique within a forest. Frequently, the UPN is the user's e-mail address, but it does not have to be. A user always has a UPN and by default, it is userlogonname@fullyqualifieddomainname. If you are logged into a domain, you can find your UPN name by running whoami /upn from a command window."
    ],
    "i": [
      "userlogonname",
      "fullyqualifieddomainname"
    ],
    "hr": [
      ""
    ]
  },
  "links": [],
  "html": "<br />\r\n  <br />\r\n  <h1>What to Check For</h1>\r\n  <p>Check to ensure that your application avoids using&nbsp;<strong>LogonUser</strong> API to create impersonation tokens because this forces to store user names and passwords on your Web server.</p>\r\n  <p />\r\n  <h1>How to Fix</h1>\r\n  <p>Avoid writing code that calls the <b>LogonUser</b> API to create impersonation tokens because this forces you to store user names and passwords on your Web server. </p>\r\n  <p>Instead, use a unique application pool with a specific process identity if you need a specific identity to access downstream resources. If you need multiple identities to access a range of downstream resources and services, use Windows Server protocol transition and the <b>WindowsIdentity</b> constructor; this allows you to create a Windows token that is given only an account's user principal name (UPN). To access a network resource, you need to delegate-level token. To get this token type, your server needs to be configured as trusted for delegation in Active Directory.</p>\r\n  <p>The following code shows how to use this constructor to obtain a Windows token for a given user.</p>\r\n  <div>\r\n    <pre>using System;<br />using System.Security.Principal;<br />public void ConstructToken(string upn, out WindowsPrincipal p)&#123;<br />  WindowsIdentity id = new WindowsIdentity(upn);<br />  p = new WindowsPrincipal(id);<br />&#125;  </pre>\r\n  </div>\r\n  <blockquote>\r\n    <b>Note</b>&nbsp;&nbsp;&nbsp;An account's UPN is guaranteed to be unique within a forest. Frequently, the UPN is the user's e-mail address, but it does not have to be. A user always has a UPN and by default, it is <i>userlogonname</i>&#64;<i>fullyqualifieddomainname</i>. If you are logged into a domain, you can find your UPN name by running <b>whoami /upn</b> from a command window.</blockquote>\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns & practices guidance. </p>"
}