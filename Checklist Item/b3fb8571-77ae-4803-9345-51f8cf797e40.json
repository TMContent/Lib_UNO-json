{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "-2110548115",
      "Content_Hash": "1340760901"
    },
    "Metadata": [
      {
        "Id": [
          "b3fb8571-77ae-4803-9345-51f8cf797e40"
        ],
        "Id_History": [
          "b3fb8571-77ae-4803-9345-51f8cf797e40,cc21cb4b-2726-469c-bcbe-fea698414619,"
        ],
        "Library_Id": [
          "26bd1a04-beed-4a66-917d-b6ab0a7d634c"
        ],
        "Title": [
          "Indirect Object References Are Used"
        ],
        "Category": [
          "Authorization"
        ],
        "Phase": [
          "Design"
        ],
        "Technology": [
          ".NET"
        ],
        "Type": [
          "Checklist Item"
        ],
        "DirectLink": [
          "Indirect Object References Are Used"
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>Applies To</h1>\r\n  <ul>\r\n    <li>ASP.NET 4.0</li>\r\n  </ul>\r\n  <h1>What to Check For</h1>\r\n  <p>Verify that indirect object references are used.</p>\r\n  <h1>Why</h1>\r\n  <p>Using indirect object references makes it harder for an attacker to bypass security controls.</p>\r\n  <h1>How To Check</h1>\r\n  <p>To verify that indirect object references are used:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Identify pages that use system objects.</strong> Make a list of pages that use files and databases.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Examine object references.</strong> Review each page to make sure it uses a lookup table to address objects, instead of addressing them directly. A lookup table is a term for assigning identifiers to system objects and using these identifiers in pages that are exposed to the user. The purpose of lookup tables is to make sure that an attacker cannot perform unauthorized access by modifying object references - since all that is exposed are aliases, the attacker has no opportunity to tamper with other system objects.</p>\r\n    </li>\r\n  </ol>\r\n  <h1>How To Fix</h1>\r\n  <p>To use indirect object references:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Identify pages that use system objects.</strong> Make a list of pages that use files and databases.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Identify application assets.</strong> Make a list of files and database keys that are used by each page.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Define lookup tables.</strong> Assign an identifier to each resource being accessed by each page. Write a function or a set of functions that translates these identifiers into object references.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Use lookup tables.</strong> Use the object identifiers assigned in step 3 as parameters when referencing system objects. Call the function that translates that identifier into a direct object reference to access data.</p>\r\n    </li>\r\n  </ol>\r\n  <h1>Related Items</h1>\r\n  <em>You may find these additional articles useful</em>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/d4ce4080-2feb-434c-bbfe-b00549e099a7\">Use Indirect Object References</a>\r\n    </li>\r\n  </ul>\r\n  <h1>\r\n  </h1>"
        ]
      }
    ]
  }
}