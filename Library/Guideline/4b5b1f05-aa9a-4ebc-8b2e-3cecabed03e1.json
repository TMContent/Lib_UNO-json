{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "-846941138",
      "Content_Hash": "504479243"
    },
    "Metadata": [
      {
        "Id": [
          "4b5b1f05-aa9a-4ebc-8b2e-3cecabed03e1"
        ],
        "Id_History": [
          "4b5b1f05-aa9a-4ebc-8b2e-3cecabed03e1,8cbc7216-29e4-4655-ac14-b09dd18190c3,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "Java Enforce Strong Passwords"
        ],
        "Category": [
          "Authentication"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          "Java"
        ],
        "Type": [
          "Code Example"
        ],
        "DirectLink": [
          "Enforce Strong Passwords"
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          "2"
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "markdown"
        },
        "Data": [
          "## Applies To ##\r\n\r\n* Servlets or JSP\r\n\r\n\r\n## Summary ##\r\n\r\nEnforce the use of strong passwords. Enforcing strong passwords minimizes the risk of an attacker guessing a user's password.\r\n\r\n\r\n\r\nWhat constitutes a strong password varies from organization to organization; however, there are minimum requirements for length and input character sets. Minimum requirements for a strong password are:\r\n\r\nThe password must be at least 10 characters long.\r\nIt must contain letters, numbers, and special characters.\r\nThe following steps are required for enforcing strong passwords:\r\n\r\nDefine password requirements. Pick the schema that all passwords must follow. Check them for length and certain patterns. All passwords should be long (e.g. 10+ characters in length) and include a large input set (e.g. alpha-numeric and special character values).\r\n\r\nEnforce password requirements. The password requirements should be enforced while creating and modifying accounts.\r\nEnforce password lifetime. Determine a lifetime of a password. Force the users to update their passwords on a given interval. Verify that the new password is different from the old password by comparing the produced hashes.\r\n\r\nAdditionally users might be asked to not use previously used passwords. \r\n\r\n\r\n## Solution Example ##\r\n\r\nThe following code adds a new user to the application. Before it stores the user's credentials into the repository, it verifies that the password meets the application's password requirements.\r\n\r\n~~~~\r\npublic void addUser(String user, char[] pass)\r\n{      \r\n      // Check if user exists in the user database\r\n      // The application verifies that the given\r\n      // password meets the password requirements\r\n      if (!goodPassword(pass))\r\n      {\r\n            String errMsg = \"User's password does not meet\"\r\n                           + \" the password requirements\";\r\n            throw new AddUserException(errMsg);\r\n      }\r\n\r\n      // Add user to the application's user database\r\n      ...\r\n}\r\n\r\n\r\npublic boolean goodPassword(char[] pass)\r\n{\r\n      boolean alpha = false;\r\n      boolean num = false;\r\n      boolean sp = false;\r\n\r\n      if (pass.length \r\n      {\r\n            return false;\r\n      }\r\n\r\n      for (int i = 0; i \r\n      {\r\n            if (!alpha && Character.isLetter(pass[i]))\r\n            {\r\n                  alpha = true;\r\n            }\r\n\r\n            if (!num && Character.isDigit(pass[i]))\r\n            {\r\n                  num = true;\r\n            }\r\n\r\n            if (!sp && (pass[i] == '!' ||\r\n                  pass[i] == '@' || pass[i] == '#' ||\r\n                  pass[i] == '$' || pass[i] == '%' ||\r\n                  pass[i] == '^'))\r\n            {\r\n                  sp = true;\r\n            }\r\n      }\r\n\r\n      return (alpha & num) & sp;\r\n}\r\n~~~~\r\n\r\n\r\nThe following example illustrates checking if the user has used the new password in her six previous password changes:\r\n\r\n~~~~\r\nselect passDigest from\r\n   (select passDigest from passHistory\r\n    where userID = 'jill' and rownum \r\n    order by passID desc)\r\n    where passDigest = {{pass digest}};\r\n~~~~\t\r\n\r\nIf the query returns a result, then the user has used the password as one of her last passwords. Because the table contains important user information, it should be treated with the same security measures as the user repository."
        ]
      }
    ]
  }
}