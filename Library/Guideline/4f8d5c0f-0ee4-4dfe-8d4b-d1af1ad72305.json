{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "1177134181",
      "Content_Hash": "-950591688"
    },
    "Metadata": [
      {
        "Id": [
          "4f8d5c0f-0ee4-4dfe-8d4b-d1af1ad72305"
        ],
        "Id_History": [
          "4f8d5c0f-0ee4-4dfe-8d4b-d1af1ad72305,5dc44f4e-8ed3-4e8f-a3cc-f3790e3b2827,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "Protect Log Files"
        ],
        "Category": [
          "Auditing and Logging"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          "Java"
        ],
        "Type": [
          "Guideline"
        ],
        "DirectLink": [
          "Protect Log Files"
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          "2"
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "html"
        },
        "Data": [
          "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>Applications written using Servlets or JSP.</li>\r\n  </ul>\r\n  <h1>What to Do</h1>\r\n  <p>Restrict access to the log files&amp;nbsp;protect your application from attackers, as well as to protect your users' confidential information.</p>\r\n  <h1>Why</h1>\r\n  <p>Log files often contain internal application details that could enable an attacker to more effectively target your application.</p>\r\n  <h1>When</h1>\r\n  <p>If your application generates log files, limit their access.</p>\r\n  <h1>How</h1>\r\n  <p>Use the following steps to protect the application's log files: </p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Avoid disclosing location of logs. </strong>The location of the log files should be known only by your application and its administrators. Avoid disclosing the location of the logs to users.</p>\r\n      <li>\r\n        <p>\r\n          <strong>Set appropriate file permissions. </strong>Set the filesystem permissions so that only your application and its administrators/developers have access to its logs.</p>\r\n        <li>\r\n          <p>\r\n            <strong>Keep logging framework away from users. </strong>Do not allow your application's users to interact directly with the logging framework. The logging framework should log information regarding the performance of the application but should avoid storing user-supplied data inside the logs. Some user-supplied information can aid an attacker into poisoning your application's logs. </p>\r\n          <li>\r\n            <p>\r\n              <strong>Always use the append flag when writing to log files. </strong>Make sure that your application always appends new events to the log files. Appending to the logs reduces the risk of overwriting the existing logged events. Example:</p>\r\n            <pre>FileOutputStream logFile =<br /> new FileOutputStream(Environment.getLogPath() &amp;#43; logFilename, true);</pre>\r\n            <li>\r\n              <p>\r\n                <strong>Consider using log rotation. </strong>Log rotation prevents your application from working with large log files. It allows you to manage and audit your application's logged events without interfering in your application's workings. Use the following steps when utilizing log rotation:</p>\r\n              <ul>\r\n                <li>\r\n                  <strong>Define a rotation period</strong>: Schedule your log rotation on a regular basis. For example, rotate your logs every Monday. <li><strong>Create a new log file</strong>: Create a new log file when your application needs to rotate its log files. It is recommended to associate the new log file to the period of its creation. For example, the log file corresponding to the week of October 16, 2007 would be named 20071016.log. <li><strong>Back up the existing log files</strong>: Back up the existing log files when your application needs to rotate its log files. Consult your internal auditing policy to determine the period for which logs should be backed up. If your application backs up its logs, store them into an environment that is as secure as the storage environment for the current logs.</li></li></li>\r\n              </ul>\r\n              <li>\r\n                <p>\r\n                  <strong>Consider using an external logging application. </strong>Using an external logging application ensures that your application's logs will be kept up-to-date even if your application abruptly terminates.</p>\r\n                <li>\r\n                  <strong>Consider encoding output that is sent to log files</strong>. This can be useful in preventing log forging. Possible encoding mechanisms could include: <p /><ul><li>Stripping out certain characters &amp;#91;\\r\\n&amp;#93; that are known to create new lines, which can allow an attacker to forge log entries. <li>Encode all log output using HTML encoding, then view it in a browser to see the output.</li></li></ul></li>\r\n              </li>\r\n            </li>\r\n          </li>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ol>\r\n  <p>\r\n    <strong>Note:</strong> PCI DSS requirements state that logs should be kept for at least&amp;nbsp;one year.</p>"
        ]
      }
    ]
  }
}