{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "659816188",
      "Content_Hash": "-294453815"
    },
    "Metadata": [
      {
        "Id": [
          "bdff2308-96e1-4787-9162-a115d1366f76"
        ],
        "Id_History": [
          "bdff2308-96e1-4787-9162-a115d1366f76,48923e8a-a6db-4b6b-96b6-9f72a0ab1f0f,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "[SINK] Block Protected Files from Being Retrieved"
        ],
        "Category": [
          "Hardening"
        ],
        "Phase": [
          "Deployment"
        ],
        "Technology": [
          ".NET 3.5"
        ],
        "Type": [
          "Guideline"
        ],
        "DirectLink": [
          "Block Protected Files from Being Retrieved"
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          "2"
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>What to Do</h1>\r\n  <p>Block access to important application and configuration files.</p>\r\n  <h1>Why</h1>\r\n  <p>Certain files, such as source code and important application and configuration files, should be accessed only by the application and not via direct HTTP access.</p>\r\n  <h1>When</h1>\r\n  <p>All web applications. </p>\r\n  <h1>How</h1>\r\n  <p>Use the following steps to block access to protected files:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Set appropriate permissions.</strong> Apply the appropriate filesystem permissions such that the configuration files can be only accessed by your application and its administrators.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Use HttpForbiddenHandler.</strong> Use HttpForbiddenHandler to restrict HTTP access to configuration files. Follow these steps when configuring HttpForbiddenHandler to work with your application's custom extensions:</p>\r\n      <ul>\r\n        <li>\r\n          <p>\r\n            <strong>ISAPI filter</strong>: Map the ASP.NET ISAPI filter to your application's custom extension.</p>\r\n          <ol>\r\n            <li>Open the IIS management utility. </li>\r\n            <li>Locate your application's virtual directory. </li>\r\n            <li>Right click on your application and select <strong>Properties</strong>. </li>\r\n            <li>Navigate to the <strong>Directory</strong> tab. </li>\r\n            <li>Select <strong>Configuration</strong>. </li>\r\n            <li>Locate the <strong>.aspx</strong> extension. </li>\r\n            <li>Select <strong>Edit</strong>. </li>\r\n            <li>Copy the Executable path. </li>\r\n            <li>Select <strong>Cancel</strong>. </li>\r\n            <li>Select <strong>Add</strong>. </li>\r\n            <li>Paste the Executable path. </li>\r\n            <li>Specify your application's custom extension. </li>\r\n            <li>Select <strong>OK</strong> until you reach the IIS management utility.</li>\r\n          </ol>\r\n        </li>\r\n        <li>\r\n          <p>\r\n            <strong>web.config</strong>: Add the following element in your application's web.config:</p>\r\n          <pre>&lt;httpHandlers&gt;<br />  &lt;add path=\"*.myappextension\" verb=\"*\" type=\"System.Web.HttpForbiddenHandler\" validate=\"true\"/&gt;<br />&lt;/httpHandlers&gt;</pre>\r\n        </li>\r\n      </ul>\r\n    </li>\r\n  </ol>\r\n  <h1>Problem Example</h1>\r\n  <p>MyLib is a paid subscription service for valuable software development content. MyLib stores all articles in PDF format. Because ASP.NET is not configured to block access to PDF files, MyLib's users can access the articles directly; therefore bypassing the purchase system and obtaining the articles for free.</p>\r\n  <h1>Solution Example</h1>\r\n  <p>MyLib is a paid subscription service for valuable software development content. MyLib stores all articles in PDF format. The developers have properly set the ASP.NET ISAPI filter and HttpForbiddenHandler component, blocking all direct access to MyLib's articles. Therefore all users must go through MyLib's payment system to obtain the requested articles.</p>\r\n  <pre>&lt;httpHandlers&gt;<br />  &lt;add path=\"*.pdf\" verb=\"*\" type=\"System.Web.HttpForbiddenHandler\" validate=\"true\"/&gt;<br />&lt;/httpHandlers&gt;</pre>\r\n  <br />\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns &amp; practices guidance.</p>"
        ]
      }
    ]
  }
}