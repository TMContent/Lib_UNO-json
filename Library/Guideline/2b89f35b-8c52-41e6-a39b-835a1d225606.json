{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "187229996",
      "Content_Hash": "2041086692"
    },
    "Metadata": [
      {
        "Id": [
          "2b89f35b-8c52-41e6-a39b-835a1d225606"
        ],
        "Id_History": [
          "2b89f35b-8c52-41e6-a39b-835a1d225606,bc0f7a12-5590-42ac-8cca-a47cc339ce0b,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "[SINK] Use Strong Encryption for Connection Strings"
        ],
        "Category": [
          "Database Security"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          ".NET 3.5"
        ],
        "Type": [
          "Guideline"
        ],
        "DirectLink": [
          "Use Strong Encryption for Connection Strings"
        ],
        "Tag": [
          "ASP.NET,ASP.NET 3.5,ASP"
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          "2"
        ],
        "Status": [
          ""
        ],
        "Source": [
          "ASP.NET 3.5"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>What to Do</h1>\n  <p>Choose appropriately strong encryption when&amp;nbsp;protecting connection strings. Use available pre-existing&amp;nbsp;mechanisms for encrypting and decrypting data in production systems. Never attempt to write your own encryption routines for any&amp;nbsp;purpose&amp;nbsp;beyond academic excercise. </p>\n  <h1>Why</h1>\n  <p>Web Applications need the strongest level of encryption practically available. There are several existing encryption libraries that are available which have been audited by security professionals.&amp;nbsp;Besides saving time by re-using code,&amp;nbsp;robust encryption libraries handle many of the unforeseen pitfalls associated with transforming an encryption algorithm into a \"safe\" implementation. Commercial implementations of established algorithms have been vetted through extensive certification, such as the Federal Information Processing Standards issued by the National Institute of Standards and Technology (NIST). Using a weak &amp;nbsp;or&amp;nbsp;non-rigorously&amp;nbsp;tested encryption library is essentially the same as not using encryption at all, since there is a high likelihood that hackers will be able to decrypt connection strings&amp;nbsp;using brute force, or by&amp;nbsp;taking advantage of&amp;nbsp;flaws in the algorithm's implementation. </p>\n  <h1>When</h1>\n  <p>Unfortunately, continual improvements in hardware and software algorithms&amp;nbsp;that are available to the general public means that no encryption solution is a permanent choice. Encryption strength needs to be evaluated in all phases of the Software Development Lifecyle and wherever connection strings are utilized. There is a&amp;nbsp;balance between&amp;nbsp; knowing the&amp;nbsp;value of data, and the difficulty of comprising said data. &amp;nbsp;Using the strongest practical encryption available is chosen by knowing the value of the data you are trying to&amp;nbsp;protect and then elevate the difficulty of compromising it beyond that value.<br /></p>\n  <h1>How</h1>\n  <p>In ASP.NET&amp;nbsp; applications, there are two libraries that provide encryption facilities for connection strings, namely DPAPI and RSA. Both implementations are robust and safe, having passed certification by professional cryptologists. Both DPAPI and RSA are considered strong encryption by present standards. Follow these steps to encrypt your connection strings:</p>\n  <p>\n    <strong>1. Choose the appropriate configuration provider.</strong> Under most circumstances DPAPI will suffice, although the RSA protected configuration is the logical choice in web farms where multiple servers are employed. </p>\n  <p>\n    <strong>2.</strong>\n    <strong>Identify the configuration sections to be encrypted.</strong> Encrypting and decrypting data incurs performance overhead. To keep this overhead to a minimum, encrypt only the sections of the configuration file that store sensitive data.&amp;nbsp; Encrypt the &lt;connectionStrings&gt; element of the Web.config file to protect the database connection string. </p>\n  <p>\n    <strong>3. Choose the machine or user store.</strong> The DataProtectionConfigurationProvider supports machine-level and user-level stores for key storage. The choice of store depends largely on whether or not&amp;nbsp;the application shares a server with other applications and whether or not sensitive data must be kept private for each application.</p>\n  <p>\n    <strong>Machine Store</strong>\n  </p>\n  <p>By default, the DataProtectionConfigurationProvider is configured to use DPAPI with the machine store. Use machine-level key storage in the following situations:</p>\n  <ul>\n    <li>The application runs on its own dedicated server with no other applications. </li>\n    <li>Multiple applications run on the same server&amp;nbsp;and&amp;nbsp;those applications need to be able to share sensitive information.</li>\n  </ul>\n  <p>To encrypt the connectionStrings section&amp;nbsp;with the Machine Store, run the following command from a .NET command prompt:</p>\n  <pre>aspnet_regiis -pe \"connectionStrings\" -app \"/MachineDPAPI\" -prov \"DataProtectionConfigurationProvider\" </pre>\n  <p>\n    <strong>User Store</strong>\n  </p>\n  <p>Use user-level key storage if the application runs in a shared hosting environment and the&amp;nbsp;application's sensitive data should&amp;nbsp;not be accessible to other applications on the server. In this situation, each application should run under a separate identity, and the resources for the application—such as files and databases—should be restricted to that identity.</p>\n  <p>To encrypt the connectionStrings section&amp;nbsp;with the&amp;nbsp;User Store, run the following command from a .NET command prompt:</p>\n  <pre>   aspnet_regiis -pe \"connectionStrings\" -app \"/UserDPAPI\" -prov \"MyUserDataProtectionConfigurationProvider\"</pre>\n  <p>\n    <strong>4.</strong>\n    <strong>Encrypt&amp;nbsp;the configuration file data.</strong>&amp;nbsp;To encrypt the connectionStrings section in Web.config using DPAPI with the Machine Store, run the following command from a .NET command prompt:</p>\n  <pre>   aspnet_regiis -pe \"connectionStrings\" -app \"/MachineDPAPI\" -prov \"DataProtectionConfigurationProvider\" </pre>\n  <p>The above command with the -app switch assumes that there is an IIS virtual directory called MachineDPAPI. If the Visual Studio .NET Web server is being utilized instead of IIS, use the -pef switch, which&amp;nbsp;specifies the physical directory location of&amp;nbsp;the configuration file.</p>\n  <pre>   aspnet_regiis.exe -pef \"connectionStrings\" C:\\Projects\\MachineDPAPI -prov \"DataProtectionConfigurationProvider\"&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; <br /></pre>\n  <hr />\n  <p>Adapted from Microsoft patterns &amp; practices guidance. </p>"
        ]
      }
    ]
  }
}