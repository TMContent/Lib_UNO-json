{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "-1965460207",
      "Content_Hash": "716586204"
    },
    "Metadata": [
      {
        "Id": [
          "4383d42d-baa9-47d4-97ce-3b6a73dfcfea"
        ],
        "Id_History": [
          "4383d42d-baa9-47d4-97ce-3b6a73dfcfea,ab5c1c81-1120-4dea-be61-b75840e47d54,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "Do Not Rely on Canonicalization of File, Path, And Folder Names in Windows"
        ],
        "Category": [
          "Canonicalization"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          "C++"
        ],
        "Type": [
          "Guideline"
        ],
        "DirectLink": [
          "Do Not Rely on Canonicalization of File, Path, And Folder Names in Windows"
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>C&#43;&#43;<li>Windows</li></li>\r\n  </ul>\r\n  <h1>What to Do</h1>\r\n  <p>Do not make decisions based on file, path, or folder names.</p>\r\n  <h1>Why</h1>\r\n  <p>It is so difficult to implement canonicalization correctly on Windows with C&#43;&#43;, that it is impractical. Therefore, all file, path, and folder name input should be considered untrusted and not be used for any decisions.</p>\r\n  <h1>How</h1>\r\n  <p>Perform the following actions to implement filesystem security policies without relying on file, path, or folder names:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Don't rely on Win32 API canonicalization.</strong> Filename/path canonicalization in Win32 is represented by the GetFullPathName function. Because this function does not perform any validation on its output, it should not be relied on, because there is no guarantee that it produces a valid or a canonical filename/path. Even if you implement canonicalization, use additional security measures and don't rely on filenames/paths for making decisions.</p>\r\n      <li>\r\n        <p>\r\n          <strong>Use Windows ACLs. </strong>When you have to enforce filesystem security policies on Windows, use the built-in ACL functionality.</p>\r\n        <li>\r\n          <p>\r\n            <strong>Use AccessCheck to validate access permissions.</strong> When your application has to work with a file or folder, use AccessCheck to verify that the access request is valid.</p>\r\n          <li>\r\n            <p>\r\n              <strong>Avoid making decisions based on filenames/paths.</strong> When a filename/path is used in a condition, an attacker may be able to trick the application to execute an unintended code branch. To prevent this, avoid using filenames/paths in conditional statements, except for validation or error handling.</p>\r\n          </li>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ol>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>For information about GetFullPathName(), please see <a href=\"http://msdn.microsoft.com/en-us/library/aa364963(v=VS.85).aspx\">http://msdn.microsoft.com/en-us/library/aa364963(v=VS.85).aspx</a><li>For information about AccessCheck(), please see <a href=\"http://msdn.microsoft.com/en-us/library/aa374815(VS.85).aspx\">http://msdn.microsoft.com/en-us/library/aa374815(VS.85).aspx</a></li></li>\r\n  </ul>\r\n  <h1>Related Items</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/004526a6-5b2f-4094-94fa-a80d818c0a41\">Canonicalize All Input Used to Identify Resources</a>\r\n    </li>\r\n  </ul>"
        ]
      }
    ]
  }
}