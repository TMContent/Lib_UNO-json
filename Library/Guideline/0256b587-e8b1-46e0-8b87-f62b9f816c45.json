{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "-1097528698",
      "Content_Hash": "1143006057"
    },
    "Metadata": [
      {
        "Id": [
          "0256b587-e8b1-46e0-8b87-f62b9f816c45"
        ],
        "Id_History": [
          "0256b587-e8b1-46e0-8b87-f62b9f816c45,b3846b9c-002d-4a57-ae62-83c150953fbc,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "[SINK] Protect Log Files"
        ],
        "Category": [
          "Auditing and Logging"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          ".NET 3.5"
        ],
        "Type": [
          "Guideline"
        ],
        "DirectLink": [
          "Protect Log Files"
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          "2"
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<br />\r\n  <h1>What to Do</h1>\r\n  <p>Restrict access to protect the application's logged events.</p>\r\n  <h1>Why</h1>\r\n  <p>Logged events often contain internal application details that could help an attacker target your application.</p>\r\n  <h1>When</h1>\r\n  <p>If your application logs any type of events.</p>\r\n  <h1>How</h1>\r\n  <p>Use the following steps to protect your application's logged events: </p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Avoid disclosing location of logs</strong>: The location of the logs should only be known by your application and its administrators. Avoid disclosing the location of the logs to users.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Set appropriate ACL</strong>: Set the logs' ACL so that only your application and its administrators/developers have access to them.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Keep logging framework away from users</strong>: Do not allow your application's users to interact directly with the logging framework. The logging framework should log information regarding the performance of the application, but should avoid storing user supplied data. Storing user-supplied information can aid an attacker into poisoning your application's logs.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Always use the append flag when writing to log files</strong>: If your application stores logged events into files on disk, make sure that your application always appends new events to the log files. Appending to the log files reduces the risk of overwriting the existing logged events.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Consider using log rotation</strong>: Log rotation prevents your application from having to deal with large log repositories. It allows you to manage and audit your application's logged events without interfering with your application's workings. Use the following steps when utilizing log rotation:</p>\r\n      <ul>\r\n        <li>\r\n          <strong>Define a rotation period</strong>: Schedule your log rotation on a regular basis. For example, rotate your logs every Monday. </li>\r\n        <li>\r\n          <strong>Create a new log file</strong>: If your application stores logged events into files on disk, create a new log file when your application needs to rotate its logs. It is recommended to associate the new log file to the period of its creation. For example, a log file corresponding to the week of October 16, 2007 would be named 20071016.log. </li>\r\n        <li>\r\n          <strong>Back up the existing logs</strong>: Back up the existing logs when your application needs to rotate its log repository. Consult your internal auditing policy to determine how long log backups should be kept. If your application backs up its logs, store them into an environment that is as secure as the storage environment for the current logs.</li>\r\n      </ul>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Consider using an external logging application.</strong> Using an external logging application ensures that your application's logs will be kept up to date even if your application abruptly terminates.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Secure ASP.NET health monitoring.</strong> If your application uses ASP.NET health monitoring, consider taking the following measures:</p>\r\n      <ul>\r\n        <li>\r\n          <strong>Throttle your application's logs</strong>\r\n        </li>\r\n        <li>\r\n          <strong>Secure health monitoring</strong>\r\n        </li>\r\n        <li>\r\n          <strong>Secure connection strings</strong>\r\n        </li>\r\n      </ul>\r\n    </li>\r\n  </ol>\r\n  <h1>Problem Example</h1>\r\n  <p>An e-commerce site does hundreds of transactions an hour, and logs data at the web and database levels, along with a separate security log that monitors all user and security-related events. Unfortunately, the security logs are stored in a location that is hidden in the application's directory tree. An attacker finds the location of the logs and retrieves all user and security-related events.</p>\r\n  <h1>Solution Example</h1>\r\n  <p>An e-commerce site does hundreds of transactions an hour, and logs data at the web and database levels, along with a separate security log that monitors all user and security-related events. Because the logs are rotated and stored in a secure location that is monitored and managed 24x7 by the operations team, it is impossible for an attacker to gain access to the logged events without the help of an insider.</p>\r\n  <br />\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns &amp; practices guidance. </p>"
        ]
      }
    ]
  }
}