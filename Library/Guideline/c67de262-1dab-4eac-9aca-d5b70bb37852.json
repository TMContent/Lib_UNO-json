{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "2013097690",
      "Content_Hash": "1317695345"
    },
    "Metadata": [
      {
        "Id": [
          "c67de262-1dab-4eac-9aca-d5b70bb37852"
        ],
        "Id_History": [
          "c67de262-1dab-4eac-9aca-d5b70bb37852,b665b173-e70f-47a5-afd6-8c9253ad2259,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "[SINK] Enforce Strong Password Policies"
        ],
        "Category": [
          "Authentication"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          ".NET 3.5"
        ],
        "Type": [
          "Guideline"
        ],
        "DirectLink": [
          "Enforce Strong Password Policies"
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          "2"
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>What to Do</h1>\r\n  <p>Use&amp;nbsp;Active Directory policy&amp;nbsp;to ensure that your passwords are complex enough to prevent users guessing other users' passwords and to prevent successful dictionary attacks against your user credential store.</p>\r\n  <h1>Why</h1>\r\n  <p>Insufficiently complex passwords may be guessed by attackers, allowing them to compromise user accounts.&amp;nbsp; Strong passwords help to prevent dictionary attacks in the event your password store is compromised.&amp;nbsp; Most users will not choose sufficiently strong passwords without help from the application.</p>\r\n  <h1>When</h1>\r\n  <p>All systems which utilize passwords should enforce strong passwords.&amp;nbsp; The strength of the password and its frequency of change will depend on the security needs of the application, but all applications should enforce basic strong password rules.</p>\r\n  <h1>How</h1>\r\n  <p>Enforcing strong passwords is very simple, and it's one of the easiest ways to improve the security of your site.&amp;nbsp; Follow these steps to do so:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Understand Password Strength Requirements.</strong> By default, the ASP.NET membership providers enforce strong passwords.&amp;nbsp; <b>ActiveDirectoryMembershipProvider</b> ensures that passwords are at least seven characters in length with at least one non-alphanumeric character.&amp;nbsp; This is a reasonable baseline for applications with light security requirements, and there are very few cases where passwords should be permitted to be weaker than this.</p>\r\n      <p>When considering password strength, it's important to ensure that you're matching your strength requirements to the security needs of the application.&amp;nbsp; Requiring very strong passwords for sites with trivial security needs will frustrate your users.&amp;nbsp; On the other hand, don't restrict your users from chosing stronger passwords if they want&amp;#8212;maximum password lengths should be at least 20 characters, and all printable characters should be legal in the password.</p>\r\n      <li>\r\n        <p>\r\n          <strong>Enforce Password Strength Requirements.</strong> There are&amp;nbsp;three attributes which you can use to configure the precise password complexity rules enforced by your the <strong>ActiveDirectoryMembershipProvider</strong>, along with&amp;nbsp;three extra attributes that control account lockouts for failed authentication attempts:</p>\r\n        <ul>\r\n          <li>\r\n            <b>passwordStrengthRegularExpression</b>.&amp;nbsp; The default is blank.&amp;nbsp;&amp;nbsp; All passwords must satisfy this expression. <li><b>minRequiredPasswordLength</b>.&amp;nbsp; The default is 7.&amp;nbsp; All passwords must contain at least this many characters. <li><b>minRequiredNonalphanumericCharacters</b>.&amp;nbsp; The default is 1.&amp;nbsp; All passwords must contain this many non-letter, non-number characters. <li><b>maxInvalidPasswordAttempts</b>.&amp;nbsp; The default is 5.&amp;nbsp; An account is temporarily locked out if more than this many password attempts fail in the tracking window. <li><b>passwordAttemptWindow</b>.&amp;nbsp; The default is 10 (minutes).&amp;nbsp; Failed password attempts are tracked for the length of this window. <li><b>passwordAnswerAttemptLockoutDuration</b>.&amp;nbsp; The default is 30 (minutes).&amp;nbsp; Accounts with too many failed password attempts are locked out for this long.</li></li></li></li></li></li>\r\n        </ul>\r\n        <p>Furthermore, the <b>ActiveDirectoryMembershipProvider</b> also verifies passwords against the default domain password policy, and users must choose passwords which satisfy both sets of requirements.&amp;nbsp; Here's an example of an <b>ActiveDirectoryMembershipProvider</b> configured to require stronger passwords:</p>\r\n        <pre>&lt;membership defaultProvider=\"MyADMembershipProvider\"&gt;&amp;nbsp; <br />   &amp;#9;&lt;providers&gt;    <br />      &amp;#9;&amp;#9;&lt;add name=\"MyADMembershipProvider\"         <br />&amp;#9;&amp;#9;&amp;#9;connectionStringName=\"ADConnectionString\"<br />&amp;#9;&amp;#9;&amp;#9;minRequiredPasswordLength=\"9\"<br />&amp;#9;&amp;#9;&amp;#9;minRequiredNonalphanumericCharacters=\"2\"         <br />&amp;#9;&amp;#9;&amp;#9;passwordStrengthRegularExpression=\"&amp;#94;(?=.&amp;#42;\\d)(?=.&amp;#42;&amp;#91;&amp;#94;\\w\\d&amp;#93;.&amp;#123;9,20&amp;#125;&amp;#36;\"         <br />&amp;#9;&amp;#9;&amp;#9;maxInvalidPasswordAttempts=3         <br />&amp;#9;&amp;#9;&amp;#9;passwordAttemptWindow=20         <br />&amp;#9;&amp;#9;&amp;#9;passwordAnswerAttemptLockoutDuration=60         <br />&amp;#9;&amp;#9;&amp;#9;requiresUniqueEmail=\"true\"          .../&gt;  <br />   &amp;#9;&lt;/providers&gt;<br />&lt;/membership&gt;</pre>\r\n        <li>\r\n          <p>\r\n            <strong>Improve Your Security Further.</strong> For improved pasword strength you can:</p>\r\n          <ul>\r\n            <li>Check that the password contains both upper and lowercase characters as well as nonalphanumeric characters. <li>Check that the password does not contain the username, the user's first or last name (if known), or the host name/site name. <li>Regularly expire passwords and force users to choose new ones.&amp;nbsp; The amount of time between password changes should be determined by your security needs, but every three months is a reasonable default. <li>Prevent users from reusing old passwords.</li></li></li></li>\r\n          </ul>\r\n          <p>If you have a site with very strong security requirements, simply requiring and enforcing strong passwords may not be enough, in which case you should look into two factor authentication, for which a number of schemes exist, including smartcards, USB dongles, clock-synched external devices, and software-only solutions like client-side SSL certificates.</p>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ol>\r\n  <h1>Problem Example</h1>\r\n  <p>An online banking web site is using the <strong>ActiveDirectoryMembershipProvider </strong>for their authentication.&amp;nbsp; They only require very simple passwords on the site, and suggest that people use their ATM card PIN as a password.&amp;nbsp; As a result, an attacker is able to brute force user's passwords very quickly, gaining access to both online accounts and many ATM cards.&amp;nbsp; Here's their membership provider configuration:</p>\r\n  <pre>&lt;membership defaultProvider=\"MyADMembershipProvider\"&gt;<br />&amp;#9;&lt;providers&gt;    <br />&amp;#9;&amp;#9;&lt;add name=\"MyADMembershipProvider\"<br />&amp;#9;&amp;#9;&amp;#9;connectionStringName=\"ADConnectionString\"          <br />&amp;#9;&amp;#9;&amp;#9;applicationName=\"MyAppName\"         <br />&amp;#9;&amp;#9;&amp;#9;minRequiredPasswordLength=\"4\"         <br />&amp;#9;&amp;#9;&amp;#9;minRequiredNonalphanumericCharacters=\"0\"         <br />&amp;#9;&amp;#9;&amp;#9;passwordStrengthRegularExpression=\"\"         .../&gt;  <br />&amp;#9;&lt;/providers&gt;<br />&lt;/membership&gt;</pre>\r\n  <h1>Solution Example</h1>\r\n  <p>An online banking web site is using the <strong>ActiveDirectoryMembershipProvider</strong> for their authentication.&amp;nbsp; They require fairly complicated passwords on the site, and remind people not to use passwords they use anywhere else.&amp;nbsp; As a result, an attackers are unable to crack passwords in reasonable numbers of attempts, and the site operations staff can easily detect and lock out intruders by watching their security log.&amp;nbsp; Accounts which are automatically locked by the system for having too many invalid login attempts provide a particularly good indicator of malicious password cracking attempts.&amp;nbsp; Here's their membership provider configuration:</p>\r\n  <pre>&lt;membership defaultProvider=\"MyADMembershipProvider\"&gt;&amp;nbsp; <br />   &amp;#9;&lt;providers&gt;    <br />     &amp;#9;&amp;#9;&lt;add name=\"MyADMembershipProvider\"          <br />                   &amp;#9;connectionStringName=\"ADConnectionString\"          <br /><br />                   &amp;#9;applicationName=\"MyAppName\"         <br /><br />                   &amp;#9;minRequiredPasswordLength=\"9\"         <br /><br />                  &amp;#9;&amp;#9;minRequiredNonalphanumericCharacters=\"2\"         <br />                   &amp;#9;maxInvalidPasswordAttempts=3         <br />&amp;#9;&amp;#9; &amp;#9;passwordAttemptWindow=20         <br />&amp;#9;&amp;#9; &amp;#9;passwordAnswerAttemptLockoutDuration=60 <br />&amp;#9;&amp;#9;&amp;#9;requiresUniqueEmail=\"true\"          .../&gt;<br />   &amp;#9;&lt;/providers&gt;<br />&lt;/membership&gt;</pre>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>For information on how to enforce strong password policies in Active Directory under Windows 2003, see <a href=\"http://technet.microsoft.com/en-us/library/cc875814.aspx\">Step-by-Step Guide to Enforcing Strong Password Policies</a>.</li>\r\n  </ul>\r\n  <h1>&amp;nbsp;</h1>\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns &amp; practices guidance. </p>"
        ]
      }
    ]
  }
}