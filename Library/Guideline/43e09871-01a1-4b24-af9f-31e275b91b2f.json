{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "-739045181",
      "Content_Hash": "598145871"
    },
    "Metadata": [
      {
        "Id": [
          "43e09871-01a1-4b24-af9f-31e275b91b2f"
        ],
        "Id_History": [
          "43e09871-01a1-4b24-af9f-31e275b91b2f,d9cf5053-e06c-4a22-b08a-e529624a9cfb,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "Protect Libraries Loaded Through JNI"
        ],
        "Category": [
          "Hardening"
        ],
        "Phase": [
          "Deployment"
        ],
        "Technology": [
          "Java"
        ],
        "Type": [
          "Guideline"
        ],
        "DirectLink": [
          "Protect Libraries Loaded Through JNI"
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          "2"
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>Applications written using Servlets or JSP.</li>\r\n  </ul>\r\n  <h1>What to Do</h1>\r\n  <p>Protect libraries loaded through Java Native Interface.</p>\r\n  <h1>Why</h1>\r\n  <p>Loading libraries through JNI can be dangerous as it may allow arbitrary code to be loaded inside your application's process space.</p>\r\n  <h1>When</h1>\r\n  <p>If your application uses JNI to access native-code libraries, protect the libraries.</p>\r\n  <h1>How</h1>\r\n  <p>To protect libraries loaded through JNI:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Avoid disclosing location of libraries to the client. </strong>The location of your application's dynamically loaded libraries should be only known to your application and its administrators. Avoid disclosing the location of the libraries to the client by&nbsp;careful use of&nbsp;exception handling. <br /></p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Set appropriate file permissions. </strong>Set the filesystem permissions so that only your application and its administrators have access to&nbsp;the dynamically loaded libraries.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Be careful with user input. </strong>Do not allow your application's users to specify either directly or indirectly which libraries are to be loaded.</p>\r\n    </li>\r\n  </ol>\r\n  <h1>Problem Example</h1>\r\n  <p>The following segment illustrates the contents of the application's lib directory. The dynamically loaded library does not have the proper permissions set and can be overwritten by any user that has local access to the server. This allows&nbsp;a user to execute arbitrary code inside the process space of the application.</p>\r\n  <blockquote>\r\n    <pre>myapp@server lib$ ls -la<br />drwxrwxrwx   2 myapp users    80 2013-10-06 15:20 .<br />drwxr-xr-x  63 myapp users  4808 2013-10-06 15:20 ..<br />-rwxrwxrwx   1 myapp users  8384 2013-10-06 15:20 myapplib2.so</pre>\r\n  </blockquote>\r\n  <h1>Solution Example</h1>\r\n  <p>The following segment illustrates the contents of the application's lib directory. The dynamically loaded library has the proper permissions set; therefore, only the administrators can modify the contents of the library.</p>\r\n  <blockquote>\r\n    <pre>myapp@server lib$ ls -la<br />dr-xr-xr-x   2 myapp users    80 2013-10-06 15:20 .<br />drwxr-xr-x  63 myapp users  4808 2013-10-06 15:20 ..<br />-r-xr-xr-x   1 myapp users  8384 2013-10-06 15:20 myapplib2.so</pre>\r\n  </blockquote>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>To learn more about JNI, see: <a href=\"http://java.sun.com/j2se/1.3/docs/guide/jni/spec/jniTOC.doc.html\">Java Native Interface Specification</a>. </li>\r\n    <li>For more information about the security issues that JNI introduces, see: <a href=\"http://www.owasp.org/index.php/Unsafe_JNI\">Unsafe JNI</a> from OWASP. </li>\r\n  </ul>\r\n  <h1>Unmanaged Code Guidelines</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/351b69c8-b40b-4c13-899e-a8399b85a0ea\">Do Not Utilize Functionality Through JNI if Java Already Supports It</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/70b53138-faf7-410a-a966-16f3088fca63\">Minimize the Number of Times Language Boundaries are Crossed</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/946a5edb-e8f8-4365-8675-b8a5032c201b\">Validate All Data Passed Between Native and Java Code</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/43e09871-01a1-4b24-af9f-31e275b91b2f\">Protect Libraries Loaded Through JNI</a>\r\n    </li>\r\n  </ul>\r\n  <h1>Unmanaged Code Checklists</h1>\r\n  <ul>\r\n    <li>\r\n      <a href=\"/article/5b207f0a-b17d-42e3-813f-8ac255b3e1bb\">Java Supported Functionality Is Not Utilized Through JNI</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/24e64319-c897-4c27-bfd5-d721b5cdad3c\">The Number of Times Language Boundaries Are Crossed Is Minimized</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/a61487db-d1e1-4304-89b1-44bb8c88b1e3\">All Data Passed Between Native and Java Code Is Validated</a>\r\n    </li>\r\n    <li>\r\n      <a href=\"/article/d775ead4-8413-4736-a40f-92c7e0231e5b\">Libraries Loaded Through JNI Are Protected</a>\r\n    </li>\r\n  </ul>"
        ]
      }
    ]
  }
}