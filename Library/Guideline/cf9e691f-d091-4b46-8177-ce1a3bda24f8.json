{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "2113465277",
      "Content_Hash": "-2144496410"
    },
    "Metadata": [
      {
        "Id": [
          "cf9e691f-d091-4b46-8177-ce1a3bda24f8"
        ],
        "Id_History": [
          "cf9e691f-d091-4b46-8177-ce1a3bda24f8,6a05e18e-1e38-4ee2-8df1-94eb82e44158,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "[SINK] Validate User's Login Credentials Before Processing Them"
        ],
        "Category": [
          "Authentication"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          ".NET 3.5"
        ],
        "Type": [
          "Guideline"
        ],
        "DirectLink": [
          "Validate User's Login Credentials Before Processing Them"
        ],
        "Tag": [
          "ASP.NET,ASP.NET 3.5,ASP"
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          "2"
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>What to Do</h1>\r\n  <p>Validate user credentials before processing them.</p>\r\n  <h1>Why</h1>\r\n  <p>Validating user-provided login information can help prevent cross site scripting attacks, SQL injections, and other potential problems depending on system architecture. All input should always be validated before use and encoded before display, but login information is especially critical as it interacts with high-value data stores.</p>\r\n  <h1>When</h1>\r\n  <p>All applications with login functionality should validate all user submitted or user modifiable login information.</p>\r\n  <h1>How</h1>\r\n  <p>Use the following steps when validating user credentials:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Establish username requirements: </strong>Establish the acceptable character set and minimum length that should be allowed for a username. For instance, usernames should be at least 6 characters long and must contain alpha-numeric characters only.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Use whitelist validation:</strong> Whitelisting involves defining what input is acceptable. Once valid input is defined, compare all input against the established list. If the input does not match an item from the list, your application should discard it. This technique can be implemented using regular expressions. Example:</p>\r\n      <pre>public bool ValidateUsername(string username)<br />{<br />    Regex rx = new Regex(\"(\\\\w|\\\\d){6,}\");<br />    return rx.IsMatch(username);<br />}</pre>\r\n    </li>\r\n  </ol>\r\n  <h1>Problem Example</h1>\r\n  <p>The following code authenticates a user for a web application. Unfortunately, it fails to validate the user login info therefore allowing an attacker to break the authentication mechanism and gain unauthorized access.</p>\r\n  <pre>&lt;asp:Login ID=\"Login1\" runat=\"server\" BackColor=\"#EFF3FB\" BorderColor=\"#B5C7DE\" BorderPadding=\"4\"<br />    BorderStyle=\"Solid\" BorderWidth=\"1px\" Font-Names=\"Verdana\" Font-Size=\"0.8em\"<br />    ForeColor=\"#333333\" MembershipProvider=\"MyAppMembershipProvider\" /&gt;</pre>\r\n  <h1>Solution Example</h1>\r\n  <p>The following code authenticates a user for a web application. It validates the user login info; therefore making it much more difficult for an attacker to exploit the authentication mechanism.</p>\r\n  <pre>&lt;asp:Login ID=\"Login1\" runat=\"server\" BackColor=\"#EFF3FB\" BorderColor=\"#B5C7DE\" BorderPadding=\"4\"<br />    BorderStyle=\"Solid\" BorderWidth=\"1px\" Font-Names=\"Verdana\" Font-Size=\"0.8em\"<br />    ForeColor=\"#333333\" OnLoggingIn=\"ValidateUsername\" MembershipProvider=\"MyAppMembershipProvider\"<br /> /&gt;</pre>\r\n  <pre>protected void ValidateUsername(object sender, LoginCancelEventArgs e)<br />{<br />    Regex rx = new Regex(\"(\\\\w|\\\\d){6,}\");<br />    e.Cancel = !(rx.IsMatch(Login1.UserName));<br />}</pre>\r\n  <br />\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns & practices guidance.</p>"
        ]
      }
    ]
  }
}