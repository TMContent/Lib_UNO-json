{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "0",
      "Content_Hash": "0"
    },
    "Metadata": [
      {
        "Id": [
          "00000000-0000-0000-0000-0000004a4216"
        ],
        "Id_History": [
          "00000000-0000-0000-0000-0000004a4216,43e6cee5-7806-4f4e-8534-8f4797cf5cf0,"
        ],
        "Library_Id": [
          "7d2d0571-e542-45cd-9335-d7a0556c2bea"
        ],
        "Title": [
          "Expected Origin Is Explicitly Stated with postMessage"
        ],
        "Category": [
          "Web Messaging"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          "HTML5"
        ],
        "Type": [
          "Checklist Item"
        ],
        "DirectLink": [
          "Expected Origin Is Explicitly Stated with postMessage"
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "false",
          "DataType": "wikitext"
        },
        "Data": [
          "==Applies To==\r\n\r\n* HTML5\r\n\r\n==What to Check For==\r\n\r\nVerify that the expected target origin is explicitly stated as the second argument to //postMessage//.\r\n\r\n==Why==\r\n\r\nExplicitly state the expected target origin when using //postMessage// to make sure that only the intended site receives the data that is being sent. Using a specific target origin prevents malicious sites, or any site other than the one intended, from receiving the data in the message.\r\n\r\n==How to Check==\r\n\r\nTo verify that the expected target origin is explicitly stated as the second argument to //postMessage//:\r\n\r\n# **Identify all calls to //postMessage//.** Search application code for references to the //postMessage// method. Create a spreadsheet to list all code that uses the //postMessage// method.\r\n# **Define expected target origins.** In the spreadsheet, for each reference to the //postMessage// method, define what the expected target origin should be and add that information to the spreadsheet. If some kind of logic is required to compute the expected target origins, document all of that in the spreadsheet.\r\n# **Verify that the expected target origin is explicitly stated.** Using the spreadsheet as a guide, review each piece of code that references the //postMessage// method. Make sure that the second parameter matches the expected origin as defined in the spreadsheet.\r\n\r\n==How to Fix==\r\n\r\nTo explicitly state the expected target origin as the second argument to //postMessage//:\r\n\r\n# **Identify all calls to //postMessage//.** Search the application code for references to the //postMessage// method. Create a spreadsheet to list all code that uses the //postMessage// method.\r\n# **Define expected target origins.** In the spreadsheet, for each reference to the //postMessage// method, define what the expected target origin should be and add that information to the spreadsheet. If some kind of logic is required to compute the expected target origins, document all of that in the spreadsheet.\r\n# **State the expected origin when calling //postMessage//.** For each piece of code that uses //postMessage//, specify the expected target origin as defined in the spreadsheet. If necessary, add code that calculates the expected target origin to be passed as the second argument to the //postMessage// method.\r\n\r\n==Additional Resources==\r\n\r\n* For more information about the //postMessage// method, see https://developer.mozilla.org/en-US/docs/Web/API/window.postMessage\r\n\r\n==Web Messaging Guidelines==\r\n\r\n* [[00000000-0000-0000-0000-00000012aada|Do Not Evaluate Messages as Code]]\r\n* [[00000000-0000-0000-0000-00000010eb47|Use element.textContent to Assign Values to DOM Elements]]\r\n* [[00000000-0000-0000-0000-00000076ad87|Explicitly State the Expected Origin with postMessage]]\r\n* [[00000000-0000-0000-0000-0000006ab8ac|Validate Data Received by Event Handlers]]\r\n* [[00000000-0000-0000-0000-00000085babd|Validate the Origin Attribute Against the FQDN]]\r\n* [[00000000-0000-0000-0000-000000763637|Check The Origin Attribute of Messages]]\r\n\r\n==Web Messaging Checklist Items==\r\n\r\n* [[00000000-0000-0000-0000-0000008e9b8f|Messages Are Not Evaluated as Code]]\r\n* [[00000000-0000-0000-0000-00000060fefb|Element.textContent Is Used to Assign Values to DOM Elements]]\r\n* [[00000000-0000-0000-0000-0000004a4216|Expected Origin Is Explicitly Stated with postMessage]]\r\n* [[967c9b95-2319-4741-a6fd-1b4bcdf3b636|Data Received by Event Handlers Is Validated]]\r\n* [[16628f7f-e17a-4bd1-838a-011736bf0995|The Origin Attribute Is Validated Against the FQDN]]\r\n* [[f103974e-3a42-4837-b04b-7da7e87c41ec|The Origin Attribute of Messages Is Checked]]\r\n"
        ]
      }
    ]
  }
}