{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "0",
      "Content_Hash": "0"
    },
    "Metadata": [
      {
        "Id": [
          "00000000-0000-0000-0000-00000091ce5a"
        ],
        "Id_History": [
          "00000000-0000-0000-0000-00000091ce5a,e9396bf6-5974-4046-8916-3e008624eadb,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "TCP Is Not Tunneled via WebSockets"
        ],
        "Category": [
          "WebSockets"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          "HTML5"
        ],
        "Type": [
          "Checklist Item"
        ],
        "DirectLink": [
          "TCP Is Not Tunneled via WebSockets"
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "false",
          "DataType": "wikitext"
        },
        "Data": [
          "==Applies To==\r\n* HTML5\r\n\r\n==What to Check For==\r\n\r\nEnsure that TCP connections are not tunneled via WebSockets. Instead, those connections are made through standard TCP ports. \r\n\r\n==Why==\r\n\r\nDo not use WebSockets to tunnel TCP connections for several reasons:\r\n* Web proxies may not necessarily support the WebSockets upgrade to the HTTP port protocol.\r\n* Tunneling non-HTTP and non-HTTPS traffic through ports 80 and 443 will circumvent firewall rules that may be in place for a larger reason. If you offer support for TCP tunneling by turning your web server into a network proxy, you may undermine standard security infrastructure, such as firewalls and secure gateways.\r\n* Data sent through tunneled TCP connections via WebSockets may not be securely transmittedâ€”particularly if the connection is sent via {{{ws://}}} rather than {{{wss://}}}. The WebSockets connection may not employ the same security and care as the standard TCP connection. This could expose the connection to eavesdropping or other exploits.\r\n\r\n==How To Check==\r\n\r\nTo verify that TCP connections are not tunneled via WebSockets:\r\n\r\n# **Find instances of code that uses WebSockets.** Look for instances where a WebSocket is created, such as: {{{var socket = new WebSocket(url);}}}\r\n# **Review the code to ensure the code is not used for tunneling TCP connections.** Look for any code that uses a port that is not 80 or 443. Also look for code that uses TCP sockets, such as the //Socket// object.\r\n\r\n==How To Fix==\r\n\r\nPerform a thorough review of your applications and remove instances of TCP tunneling if you find any in the review. To perform the review, follow these steps:\r\n\r\n# **Find instances of code that uses WebSockets.** Look for instances where a WebSocket is created, such as: {{{var socket = new WebSocket(url);}}}\r\n# **Review the code to ensure the code is not used for tunneling TCP connections.** Look for any code that uses a port that is not 80 or 443. Also look for code that uses TCP sockets, such as the {{{Socket}}} object.\r\n# **Remove code that performs tunneling.** If you find any code that you suspect of TCP tunneling, remove the offending code from the application.\r\n# **If tunneling is necessary, replace the tunneling with secure techniques such as VPN (virtual private networking).** Use industry-standard mechanisms for providing access to required services. Define and implement access policies that use these mechanisms.\r\n\r\n==WebSocket Guidelines==\r\n\r\n* [[00000000-0000-0000-0000-000000869806|Validate Data Coming from WebSockets]]\r\n* [[00000000-0000-0000-0000-00000093dea4|Check the Origin Header in the WebSocket Handshake]]\r\n* [[00000000-0000-0000-0000-0000005f2e4a|Use TLS to Encrypt WebSocket Connections]]\r\n* [[00000000-0000-0000-0000-000000736a21|Check the Origin Attribute of WebSocket Messages]]\r\n* [[00000000-0000-0000-0000-0000005326a8|Use the Latest WebSocket RFC 6455 Standard]]\r\n* [[00000000-0000-0000-0000-00000085bc2f|Do Not Tunnel TCP via WebSockets]]\r\n\r\n==WebSocket Checklist Items==\r\n\r\n* [[00000000-0000-0000-0000-00000086537e|Data Coming from WebSockets Is Validated]]\r\n* [[00000000-0000-0000-0000-00000077e316|The Origin Header in WebSocket Handshake is Checked]]\r\n* [[bd870268-f104-4f6f-ba0d-6628dc34eb2a|TLS is Used to Encrypt WebSocket Connections]]\r\n* [[00000000-0000-0000-0000-0000002f39d7|The Origin Attribute of WebSocket Messages Is Checked]]\r\n* [[18d5564d-00a4-4afe-a853-707269df2566|Latest RFC 6455 Standard is Used]]\r\n* [[00000000-0000-0000-0000-00000091ce5a|TCP Is Not Tunneled via WebSockets]]\r\n"
        ]
      }
    ]
  }
}