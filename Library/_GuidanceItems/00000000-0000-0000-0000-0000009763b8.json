{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "0",
      "Content_Hash": "0"
    },
    "Metadata": [
      {
        "Id": [
          "00000000-0000-0000-0000-0000009763b8"
        ],
        "Id_History": [
          "00000000-0000-0000-0000-0000009763b8,17000aba-d2c6-4a30-91f1-c486fa349a29,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "File Names and Paths Are Canonicalized"
        ],
        "Category": [
          "Canonicalization"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          "Android"
        ],
        "Type": [
          "Checklist Item"
        ],
        "DirectLink": [
          "File Names and Paths Are Canonicalized"
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "false",
          "DataType": "WikiText"
        },
        "Data": [
          "==What to Check For==\n\nVerify that file names and paths are canonicalized.\n\n==Why==\n\nCanonicalizing file paths before validating them helps prevent unauthorized access. If a file path is not canonicalized, an attacker may use special characters to access resources outside of what is allowed by the application.\n\n==How to Check==\n\nTo verify that file names and paths are canonicalized:\n\n# **Identify all input used for file access.** Enumerate all file access performed by the application. Examine code responsible for accessing each file. Take note of any input used to form path or file names for file access.\n# **Verify that all input data used for file paths is canonicalized.** Examine code that handles file names and paths and make sure that it translates file paths and names into canonical forms before using the files. If file names or paths are hard-coded, they don't need to be canonicalized.\n# **Verify that all file paths are validated.** Examine code that opens files to make sure that file names and paths are validated before being used. If file names or paths are hard-coded, they don't need to be validated.\n\n==How to Fix==\n\nTo canonicalize file names and paths:\n\n# **Identify all input used for file access.** Enumerate all file access performed by the application. Examine code responsible for accessing each file. Take note of any input used to form path or file names for file access.\n# **Canonicalize all input data used for file access.** Use the //getCanonicalPath// method to get the canonical path to a file.\n# **Validate file paths.** Verify that the user or application are authorized to access the specified resource.\n\n==Data Validation Guidelines==\n\n* [[00000000-0000-0000-0000-0000008d3cec|Canonicalize File Names and Paths]]\n* [[00000000-0000-0000-0000-0000008149ca|Validate All Input]]\n* [[00000000-0000-0000-0000-0000006c7089|Validate and Encode Data Inserted into XML Documents]]\n* [[00000000-0000-0000-0000-0000007635ae|Validate File Formats]]\n\n==Data Validation Checklists==\n\n* [[00000000-0000-0000-0000-0000009763b8|File Names and Paths Are Canonicalized]]\n* [[00000000-0000-0000-0000-0000004f2fec|All Input Is Validated]]\n* [[00000000-0000-0000-0000-00000071b4f0|Data Inserted into XML Documents Is Validated and Encoded]]\n* [[00000000-0000-0000-0000-00000080c790|File Formats Are Validated]]\n\n==Additional Resources==\n\n* For more information about the //getCanonicalPath// method, see http://developer.android.com/reference/java/io/File.html#getCanonicalPath()\n"
        ]
      }
    ]
  }
}