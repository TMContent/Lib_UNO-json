{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "-1029018670",
      "Content_Hash": "1371443039"
    },
    "Metadata": [
      {
        "Id": [
          "dad95f69-5438-49ae-9c87-567087525cd0"
        ],
        "Id_History": [
          "dad95f69-5438-49ae-9c87-567087525cd0,5df36a1f-f71f-45f0-8428-00b75505f022,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "[SINK] Generating Cryptographically Secure Random Numbers"
        ],
        "Category": [
          "Cryptography"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          ".NET 3.5"
        ],
        "Type": [
          "Code Example"
        ],
        "DirectLink": [
          "Generating Cryptographically Secure Random Numbers"
        ],
        "Tag": [
          "ASP.NET,ASP.NET 3.5,ASP"
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ],
        "Source": [
          "ASP.NET 3.5"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>C# </li>\r\n  </ul>\r\n  <h1>Summary</h1>\r\n  <p>The purpose of this code snippet is to illustrate how to generate cryptographically secure random numbers for a variety of applications using .NET. Possible uses of cryptographically-secure random numbers are session identifiers, encryption key material and default or auto-generated passwords.</p>\r\n  <h1>Objectives</h1>\r\n  <ul>\r\n    <li>Create a random number value whose value cannot be utilized to determine subsequent number values generated by the same function </li>\r\n  </ul>\r\n  <h1>Scenarios</h1>\r\n  <ul>\r\n    <li>Create an \"un-guessable\" session identifier or application cookie for customized session management <li>Create a one-time-use number for use as a second authentication factor, such as an argument for use within a forgotten email password <li>Create an arbitrary default secret, such as a default password, from random data </li></li></li>\r\n  </ul>\r\n  <h1>Solution Example</h1>\r\n  <pre>static public int SecureRandomNumber()&amp;#123;<br /><br />            // Create a secure RNG class and a byte array to hold the random data<br />            RNGCryptoServiceProvider secureRandom = new RNGCryptoServiceProvider();<br />            byte&amp;#91;&amp;#93; randBytes = new byte&amp;#91;4&amp;#93;;<br />            // Generate 4 bytes of secure random number data and convert to 4-byte integer<br />            secureRandom.GetNonZeroBytes(randBytes);<br />            return(BitConverter.ToInt32(randBytes, 0));<br />&amp;#125;</pre>\r\n  <h1>Problem Example</h1>\r\n  <p>The following example shows generation of a random number using the </p>\r\n  <pre>System.Random class.static public int UnsecureRandomNumber(int seed)&amp;#123;<br />            // Creates a random number, using the default machine time-derived seed<br />             Random unsecureRandom = new Random(seed);<br />            return(unsecureRandom.Next());<br />&amp;#125;</pre>\r\n  <ul>\r\n    <li>Same seed value will always return the same sequence of numbers <li>Seed value -1 or null will make use of machine time to generate seed, which is easily predicted </li></li>\r\n  </ul>\r\n  <h1>Test Case</h1>\r\n  <p>The following classes must be included in any project making use of the sample code provided above:</p>\r\n  <pre>using System.Security.Cryptography;</pre>\r\n  <p>Run the following code to generate a set of both unsecure and secure random numbers. The unsecure example illustrates that two calls to Random that make use of the same seed will return the same sequence of numbers. </p>\r\n  <pre>static void Main(string&amp;#91;&amp;#93; args)&amp;#123;<br />            // Unsecure Random Number<br />            Console.WriteLine(\"Unsecure Value, Default Seed: \" &amp;#43; UnsecureRandomNumber(-1));<br />            Console.WriteLine(\"Unsecure Value, Default Seed: \" &amp;#43; UnsecureRandomNumber(-1));<br />            Console.WriteLine(\"Unsecure Value, Seed = 100: \" &amp;#43; UnsecureRandomNumber(100));<br />            Console.WriteLine(\"Unsecure Value, Seed = 100: \" &amp;#43; UnsecureRandomNumber(100));<br />            Console.WriteLine(\"\");<br />            // Secure Random Numbers<br />            for(int i = 0; i &lt; 10; i&amp;#43;&amp;#43;) &amp;#123;<br />                        Console.WriteLine(\"Secure Value, no seed: \" &amp;#43; SecureRandomNumber());<br />            &amp;#125;<br />&amp;#125;<br />static public int UnsecureRandomNumber(int seed)&amp;#123;<br />            // Creates a random number, using the default machine time-derived seed<br />             Random unsecureRandom = new Random(seed);<br />            return(unsecureRandom.Next());<br />&amp;#125;</pre>\r\n  <h1>Expected Result</h1>\r\n  <pre>Unsecure Value, Default Seed: 534011718<br />Unsecure Value, Default Seed: 534011718<br />Unsecure Value, Seed = 100: 2080427802<br />Unsecure Value, Seed = 100: 2080427802<br />Secure Value, no seed: 1392122031<br />Secure Value, no seed: -1635401565<br />Secure Value, no seed: 1863340408<br />Secure Value, no seed: -497957136<br />Secure Value, no seed: -1444637226<br />Secure Value, no seed: 925340612<br />Secure Value, no seed: 92412438<br />Secure Value, no seed: -1126434204<br />Secure Value, no seed: 2086044763<br />Secure Value, no seed: -840759923</pre>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>RNGCryptoServiceProvider Class: <a href=\"http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrngcryptoserviceproviderclasstopic.asp\">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemsecuritycryptographyrngcryptoserviceproviderclasstopic.asp</a></li>\r\n  </ul>\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns &amp; practices guidance.</p>"
        ]
      }
    ]
  }
}