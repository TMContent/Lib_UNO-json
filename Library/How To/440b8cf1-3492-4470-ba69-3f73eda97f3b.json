{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "311734375",
      "Content_Hash": "1802624136"
    },
    "Metadata": [
      {
        "Id": [
          "440b8cf1-3492-4470-ba69-3f73eda97f3b"
        ],
        "Id_History": [
          "440b8cf1-3492-4470-ba69-3f73eda97f3b,ffa8f230-dd97-4fdf-a06b-1071f7f9074c,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "How to Use WMI For Instrumentation"
        ],
        "Category": [
          "Auditing and Logging"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          ".NET 3.5"
        ],
        "Type": [
          "How To"
        ],
        "DirectLink": [
          "How to Use WMI For Instrumentation"
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>Description</h1>\r\n  <p>The <b>System.Management</b> assembly defines classes that you can use to instrument your application with Windows Management Instrumentation (WMI). To instrument specific aspects of your .NET Framework application, you need to define and register with the Common Information Model Object Manager (CIMOM) a WMI-managed class that captures required information when that specific event occurs in your application. You need to call the <b>Fire</b> method of the WMI-managed event class to notify the WMI infrastructure and monitoring applications that the event has occurred. </p>\r\n  <p>To use WMI, create a WMI-managed class that derives from the <b>BaseEvent</b> class and register the schema with CIMOM. Add the <b>Instrumented</b> assembly-level attribute to the assembly that contains the WMI-managed class definition as shown here. </p>\r\n  <pre>using System;<br />using System.ComponentModel; <br />using System.Management.Instrumentation; <br />... <br />System.Management.Instrumentation;<br />&#91;assembly:Instrumented(&#64;\"root\\MyAppWMI\")&#93; <br />namespace MyApp.WMI&#123;<br />    &#91;ManagedName(\"MyApp_MyAppExceptionEvent\")&#93;<br />    public class MyAppExceptionEvent : BaseEvent<br />    ...<br />&#125;  </pre>\r\n  <p>Add any event-specific properties (to the class) that you would like to be captured when monitoring the application. </p>\r\n  <p>To register the schema of your WMI-managed class with CIMOM, create a new class that derives from the <b>DefaultManagementProjectInstaller </b>class, as shown in the following code example. </p>\r\n  <pre>namespace MyApp.WMI&#123;<br />    &#91;RunInstaller(true)&#93;<br />    public class MyAppWmiSchemaInstaller :<br />                     DefaultManagementProjectInstaller<br /> &#125;  </pre>\r\n  <ul>\r\n    <li>To register the class, run the InstallUtil.exe tool, as follows:</li>\r\n  </ul>\r\n  <pre>installutil MyApp.Wmi.dll </pre>\r\n  <p>At runtime, to instrument an event, call the <b>Fire</b> method of the WMI-managed class when the specific event occurs in the application as shown here. </p>\r\n  <pre>try&#123;&#125;catch(MyAppException ex)&#123;<br />    new MyAppExceptionEvent().Fire();<br />&#125;</pre>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>For more information about WMI in the .NET Framework, see \"Managing Applications Using WMI\" at <a href=\"http://msdn.microsoft.com/library/en-us/cpguide/html/cpconManagingApplicationsUsingWMI.asp\">http://msdn.microsoft.com/library/en-us/cpguide/html/cpconManagingApplicationsUsingWMI.asp</a></li>\r\n  </ul>\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns & practices guidance.</p>"
        ]
      }
    ]
  }
}