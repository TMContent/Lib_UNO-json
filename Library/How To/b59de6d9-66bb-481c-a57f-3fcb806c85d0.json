{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "-1062548507",
      "Content_Hash": "-1036611512"
    },
    "Metadata": [
      {
        "Id": [
          "b59de6d9-66bb-481c-a57f-3fcb806c85d0"
        ],
        "Id_History": [
          "b59de6d9-66bb-481c-a57f-3fcb806c85d0,fd3854cc-757e-4bfa-9541-a0e72e7c4c1d,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "[SINK] How to Program ACLS"
        ],
        "Category": [
          "Authorization"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          ".NET 3.5"
        ],
        "Type": [
          "How To"
        ],
        "DirectLink": [
          "How to Program ACLS"
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>Description</h1>\n  <p>Use classes available in the <b>System.Security.AccessControl</b> namespace to program discretionary access control lists (DACLs) and system access control lists (SACLs) for Windows objects. </p>\n  <p>You can use the <b>Security</b>, <b>AccessRule</b>, and <b>AuditRule</b> classes (which are available for each of the system objects listed earlier) to modify access control programmatically, to create new objects by copying ACLs from one object to another, or to set security audits on various system objects. </p>\n  <p>The following code example shows how to add an ACL to a file. </p>\n  <pre>using System;<br />using System.Security.AccessControl;<br />using System.Security.Principal;<br />using System.IO;<br />// Create an empty Security Descpriptor.<br />FileSecurity newFileSec = new FileSecurity();<br />// Give Read permission to user on this file.<br />newFileSec.AddAccessRule(<br />    new FileSystemAccessRule(&amp;#64;\"Domain\\UserName\",<br />        FileSystemRights.Read,AccessControlType.Allow));<br />            // Set a security audit rule for read operations.<br /> // Note - An audit rule for a user account requires a <br />// corresponding access rule for the same user account.<br />// To permit file and directory auditing on Microsoft Windows&amp;nbsp;NT<br />// or later, you must enable Audit Access Security policy on<br />// your computer. By default, this policy is set to No Auditing.<br />newFileSec.AddAuditRule(<br />    new FileSystemAuditRule(&amp;#64;\"Domain\\UserName\",<br />        FileSystemRights.Read, AuditFlags.Success));<br />            // Create a file with the permissions and audit rule.<br />FileInfo newFile = new FileInfo(\"e:\\\\test1.txt\");<br />newFile.Create();<br />           // Set the access control on the newly created file.<br />newFile.SetAccessControl(newFileSec);</pre>\n  <hr />\n  <p>Adapted from Microsoft patterns &amp; practices guidance.</p>"
        ]
      }
    ]
  }
}