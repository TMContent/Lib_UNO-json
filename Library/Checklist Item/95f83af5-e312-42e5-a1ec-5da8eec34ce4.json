{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "-2146185136",
      "Content_Hash": "-5877493"
    },
    "Metadata": [
      {
        "Id": [
          "95f83af5-e312-42e5-a1ec-5da8eec34ce4"
        ],
        "Id_History": [
          "95f83af5-e312-42e5-a1ec-5da8eec34ce4,f85248e0-2802-48d8-b1f7-a76fee131217,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "Protected Files Are Blocked from Being Retrieved"
        ],
        "Category": [
          "Hardening"
        ],
        "Phase": [
          "Deployment"
        ],
        "Technology": [
          ".NET 3.5"
        ],
        "Type": [
          "Checklist Item"
        ],
        "DirectLink": [
          "Protected Files Are Blocked from Being Retrieved"
        ],
        "Tag": [
          "ASP.NET,ASP.NET 3.5,ASP"
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          "2"
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>What to Check For</h1>\n  <p>Ensure that access is blocked to important application and configuration files.</p>\n  <h1>Why</h1>\n  <p>Certain files, such as source code and important application and configuration files, should be accessed only by the application and not via direct HTTP access.</p>\n  <h1>How to Check</h1>\n  <p>Check the following to block access to protected files:</p>\n  <ol>\n    <li>\n      <p>\n        <strong>Verify file permissions</strong>. Make sure IIS is installed on an NTFS partition, as FAT partitions do not support sufficient access control. Verify that configuration files can be only accessed by your application and its administrators. </p>\n      <li>\n        <p>\n          <strong>Verify that file access is restricted with HttpForbiddenHandler</strong>. HttpForbiddenHandler restricts HTTP access to configuration files. Be sure that these steps&nbsp;are followed when configuring HttpForbiddenHandler to work with your application's custom extensions: </p>\n        <ul>\n          <li>\n            <p>\n              <strong>Check if your application's custom extension has been registered with the ISAPI filter:</strong>\n            </p>\n            <ol>\n              <li>Open the IIS management utility. <li>Locate your application's virtual directory. <li>Right click on your application and select <strong>Properties</strong>. <li>Navigate to the <strong>Home Directory</strong> tab. <li>Select <strong>Configuration</strong>. <li>Locate the <strong>.aspx</strong> extension. <li>Select <strong>Edit</strong>. <li>Note or copy the Executable path. <li>Select <strong>Cancel</strong>. <li>Locate your application's custom extension. <li>Select <strong>Edit.</strong><li>The <strong>Executable</strong> path should be the same as the one for <strong>.aspx</strong>.</li></li></li></li></li></li></li></li></li></li></li></li>\n            </ol>\n            <li>\n              <p>\n                <strong>Check that all sensitive file types are restricted in web.config</strong>:<br />For example, to prevent direct access to Microsoft Access databases (.mdb), SQL Server Express Edition database (.mdf), and XML files, the following should be in web.config:</p>\n            </li>\n          </li>\n        </ul>\n      </li>\n    </li>\n  </ol>\n  <blockquote>\n    <blockquote>\n      <pre>&lt;httpHandlers&gt;<br />   &lt;add verb=\"&#42;\" path=\"&#42;.mdf\" type=\"System.Web.HttpForbiddenHandler\" /&gt;<br />   &lt;add verb=\"&#42;\" path=\"&#42;.mdb\" type=\"System.Web.HttpForbiddenHandler\" /&gt;<br />   &lt;add verb=\"&#42;\" path=\"&#42;.xml\" type=\"System.Web.HttpForbiddenHandler\" /&gt;<br />&lt;/httpHandlers&gt;</pre>\n    </blockquote>\n  </blockquote>\n  <ul>\n  </ul>\n  <h1>Problem Example</h1>\n  <p>MyLib is a paid subscription service for valuable software development content. MyLib stores all articles in PDF format. Because ASP.NET is not configured to block access to PDF files, MyLib's users can access the articles directly, therefore, bypassing the purchase system and obtaining the articles for free.</p>\n  <h1>Additional Resources</h1>\n  <ul>\n    <li>To learn more about how to configure HttpForbiddenHandler, visit <a href=\"http://support.microsoft.com/kb/815152\">HOW TO: Use ASP.NET to Protect File Types</a>. </li>\n  </ul>\n  <h1>Related Guideline</h1>\n  <ul>\n    <li>\n      <a href=\"/article/bdff2308-96e1-4787-9162-a115d1366f76\">Guideline: Block Protected Files From Being Retrieved </a>\n      <hr />\n    </li>\n  </ul>\n  <p>Adapted from Microsoft patterns & practices guidance. </p>"
        ]
      }
    ]
  }
}