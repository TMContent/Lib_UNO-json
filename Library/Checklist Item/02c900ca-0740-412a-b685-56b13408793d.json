{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "-48199468",
      "Content_Hash": "631457165"
    },
    "Metadata": [
      {
        "Id": [
          "02c900ca-0740-412a-b685-56b13408793d"
        ],
        "Id_History": [
          "02c900ca-0740-412a-b685-56b13408793d,4983f0be-5ae7-4ec0-8b00-d8b5afbd2d23,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "All Untrusted Data in HTML Contexts Is Escaped in JSP"
        ],
        "Category": [
          "Encoding"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          "Java"
        ],
        "Type": [
          "Checklist Item"
        ],
        "DirectLink": [
          "All Untrusted Data in HTML Contexts Is Escaped in JSP"
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "html"
        },
        "Data": [
          "<h1>Applies to</h1>\r\n  <ul>\r\n    <li>Java <li>JSP</li></li>\r\n  </ul>\r\n  <h1>What to Check For</h1>\r\n  <p>Verify that all user input that is displayed in HTML contexts is properly escaped. Data is said to be in a HTML context when that data is rendered as a part of a HTML document and is understood by the browser to be HTML. There are other contexts available to Web Applications, such as JavaScript context, CSS context, etc. Data is said to be in a JavaScript context when it is included in JavaScript code and is interpreted as JavaScript by the browser, and so on. Data has to be encoded differently for different contexts to prevent Cross-Site Scripting vulnerabilities. The differences of encoding arise from the fact that different contexts have different special symbols and keywords. Output encoding routines have to be designed with the understanding of the context of the output in mind.</p>\r\n  <h1>Why</h1>\r\n  <p>It is important to properly encode all user-controlled data before it is outputted to a dynamically generated Web page. If data is not encoded then it will make its way to the browser in its original representation, which could be executable script code, causing the browser to interpret and run it. The most common case is of user-controlled input making its way into plain HTML; in this case it should be HTML-encoded before being inserted into the page.</p>\r\n  <h1>How to Check</h1>\r\n  <p>To verify that all user input that is displayed in HTML contexts is properly escaped:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Identify all pages that display data entered by users.</strong> Enumerate all the pages in the application. Make a list of all the pages that display user input.</p>\r\n      <li>\r\n        <p>\r\n          <strong>Verify that user input is escaped when displayed.</strong> Examine the code that displays user input. Make sure that there is code that encodes or escapes user input before or when displaying it.</p>\r\n      </li>\r\n    </li>\r\n  </ol>\r\n  <h1>How to Fix</h1>\r\n  <p>To escape HTML characters in user input:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Identify all pages that display data entered by users.</strong> Enumerate all the pages in the application. Make a list of all the pages that display user input.</p>\r\n      <li>\r\n        <p>\r\n          <strong>Use &lt;c:out&gt; tags whenever displaying data entered by users.</strong> Review each page that displays data entered by users. Verify that Java code in each page uses &lt;<em>c:out</em>&gt; tags to escape special characters in user input. The syntax is very simple - please, see the solution example below.</p>\r\n        <li>\r\n          <p>\r\n            <strong>Use third-party libraries to escape displayed user input if needed.</strong> It may be the case that more sophisticated functionality may be required, for example for XML or JavaScript contexts. In such cases, it is recommended to use third party libraries, such as <em>jTidy HTMLEncode, OWASP Reform, </em>or <em>OWASP ESAPI</em>. Links to these libraries are available at the bottom of this page.</p>\r\n        </li>\r\n      </li>\r\n    </li>\r\n  </ol>\r\n  <h1>Problem Example</h1>\r\n  <pre>&lt;p&gt;User input is: &amp;#36;&amp;#123;user.input&amp;#125;&lt;/p&gt;</pre>\r\n  <p>The problem example above is vulnerable to XSS attacks - if the <em>user.input</em> expression contains malicious script entered by an attacker, whoever views the page with the code above will be at risk of running that script in the context of their browser.</p>\r\n  <h1>Solution Example</h1>\r\n  <pre>&lt;p&gt;User input is: &lt;c:out value=\"&amp;#36;&amp;#123;user.input&amp;#125;\"&gt;Null&lt;/c:out&gt;&lt;/p&gt;</pre>\r\n  <p>In the solution example above, HTML tags are escaped in the expression <em>user.input</em> when being displayed. If the value of <em>user.input</em> is <em>null</em>, the text \"<em>Null</em>\" is displayed. If the expression <em>user.input</em> contains malicious script entered by an attacker, it will not be executable, because HTML tags will have been escaped, and thus not interpreted as script by the browser.</p>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>For more information about JSTL tags, see <a href=\"https://www.owasp.org/index.php/JSP_JSTL\">https://www.owasp.org/index.php/JSP_JSTL</a><li>For more information about preventing XSS vulnerabilities, see <a href=\"https://www.owasp.org/index.php/XSS_&amp;#37;28Cross_Site_Scripting&amp;#37;29_Prevention_Cheat_Sheet\">https://www.owasp.org/index.php/XSS_&amp;#37;28Cross_Site_Scripting&amp;#37;29_Prevention_Cheat_Sheet</a></li></li>\r\n  </ul>"
        ]
      }
    ]
  }
}