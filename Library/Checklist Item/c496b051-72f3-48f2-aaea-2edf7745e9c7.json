{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "1254069726",
      "Content_Hash": "1381158198"
    },
    "Metadata": [
      {
        "Id": [
          "c496b051-72f3-48f2-aaea-2edf7745e9c7"
        ],
        "Id_History": [
          "c496b051-72f3-48f2-aaea-2edf7745e9c7,3e01dad9-b630-4200-838b-3dc453e996be,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "[SINK] Access to the Credential Store Is Limited"
        ],
        "Category": [
          "Authentication"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          ".NET 3.5"
        ],
        "Type": [
          "Checklist Item"
        ],
        "DirectLink": [
          "Access to the Credential Store Is Limited"
        ],
        "Tag": [
          "ASP.NET,ASP.NET 3.5,ASP"
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          "2"
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>What to Check For</h1>\n  <p>Ensure all access (except for normal authentication) to the credential store is limited to your application and administrators with the correct privileges.</p>\n  <h1>Why</h1>\n  <p>Unauthorized access to the credential store can lead to users' credentials being overwritten and&amp;nbsp;allow&amp;nbsp;an attacker to gain access to application resources without obtaining valid credentials prior to the attack.</p>\n  <h1>How to Check</h1>\n  <p>Take the following steps to ensure that the credential store is properly secured: </p>\n  <ol>\n    <li>\n      <p>\n        <strong>Identify your application's authentication provider. </strong>Identify the membership provider that your application uses. To find your application's membership provider, examine the following elements within your application's web.config: </p>\n      <pre>&lt;configuration&gt;<br />&lt;system.web&gt;    <br />&lt;membership&gt;      <br />&lt;providers&gt;        <br />&lt;add/&gt;</pre>\n      <p>Common ASP.NET membership providers are:</p>\n      <ul>\n        <li>SqlMembershipProvider </li>\n        <li>ActiveDirectoryMembershipProvider</li>\n      </ul>\n    </li>\n    <li>\n      <p>\n        <strong>Verify that connection strings are encrypted. </strong>Examine the connectionStrings element inside your application's web.config. Verify that all connection strings are encrypted. Example:</p>\n      <pre>&lt;connectionStrings configProtectionProvider=\"DataProtectionConfigurationProvider\"&gt;  <br />  &lt;EncryptedData&gt;    <br />    &lt;CipherData&gt;      <br />      &lt;CipherValue&gt;AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAACQKi74w6kku2MCd3KtVZNAQAAAACAAAAAAADZgAAqAAA        <br />      ...        <br />      8UCEwJFr3bcxihMDPpGoD536kGj5hYI7OTr9vlIdiuUqFAAAAGSs5s96JSi8XAxlgFtBQy/kehZq      <br />      &lt;/CipherValue&gt;    <br />    &lt;/CipherData&gt;  <br />  &lt;/EncryptedData&gt;<br />&lt;/connectionStrings&gt;</pre>\n    </li>\n    <li>\n      <p />\n      <p>\n        <strong>Ensure that access to the provider's store is limited. </strong>Ensure that appropriate security measures are taken for the following:</p>\n      <ul>\n        <li>\n          <p>\n            <strong>File system and registry:</strong> Verify that all local files and registry keys that are associated with your credential store have the appropriate filesystem permissions. All entities, excluding your application, must be prohibited access to the provider's credential store. </p>\n        </li>\n        <li>\n          <p>\n            <strong>Database:</strong> If your application uses a database as its credential store, ensure that the appropriate database security is applied. All entities, excluding your application, must be prohibited access to the provider's credential store.</p>\n        </li>\n      </ul>\n    </li>\n  </ol>\n  <h1>Problem Example</h1>\n  <p>The following code authenticates a user based on their credentials. Because the code discloses the credentials to the user database, anybody with access to the application's web.config also has access to the credential store.</p>\n  <blockquote>\n    <pre>&lt;connectionStrings&gt;  <br />  &lt;add name=\"MyLocalSQLServer\"<br />      connectionString=\"Server=serv03.example.com;Database=MyAppCredStore;Integrated Security=SSPI;\" <br />      providerName=\"System.Data.SqlClient\"/&gt;<br />&lt;/connectionStrings&gt;  <br /><br /><br />&lt;membership defaultProvider=\"MySqlMembershipProvider\"&gt;  <br />  &lt;providers&gt;    <br />    &lt;add name=\"MySqlMembershipProvider\" <br />      connectionStringName=\"MyLocalSQLServer\" <br />      applicationName=\"MyApp\".../&gt;  <br />  &lt;/providers&gt;<br />&lt;/membership&gt;</pre>\n  </blockquote>\n  <h1>How to Fix</h1>\n  <p>Consider limiting access to only your application's account. Ensure that the connection string used to identify your credential store is encrypted.</p>\n  <p>Also consider storing your credential database on a physically separate server from your Web server. This makes it harder for an attacker to compromise your credential store even if he or she manages to take control of your Web server.</p>\n  <ul>\n  </ul>\n  <hr />\n  <p>Adapted from Microsoft patterns &amp; practices guidance. </p>"
        ]
      }
    ]
  }
}