{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "1642520064",
      "Content_Hash": "-808585436"
    },
    "Metadata": [
      {
        "Id": [
          "5685287c-c516-481b-9a14-42f55fb180ff"
        ],
        "Id_History": [
          "5685287c-c516-481b-9a14-42f55fb180ff,020910c3-5553-4be4-b456-942e11d3e613,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "MSADC Virtual Directory (RDS) Is Removed Or Secured."
        ],
        "Category": [
          "Hardening"
        ],
        "Phase": [
          "Deployment"
        ],
        "Technology": [
          "Web Application"
        ],
        "Type": [
          "Checklist Item"
        ],
        "DirectLink": [
          "MSADC Virtual Directory (RDS) Is Removed Or Secured."
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          "J.D. Meier, Alex Mackman, Michael Dunner, Srinath Vasireddy, Ray Escamilla and Anandha Murukan"
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>Applies to</h1>\n  <ul>\n    <li>\n      <div>Web Application</div>\n    </li>\n  </ul>\n  <h1>What to Check For</h1>\n  <p>Check to ensure that the MSADC virtual directory (RDS) is removed or secured.</p>\n  <p />\n  <h1>How to Fix</h1>\n  <p>Remote Data Services (RDS) is a component that enables controlled Internet access to&nbsp;remote data resources through IIS. The RDS interface is provided by Msadcs.dll, which is located in the following directory: program files\\common files\\system\\Msadc.</p>\n  <h3>Removing RDS</h3>\n  <p>If your applications do not use RDS, remove it.</p>\n  <p>\n    <b>To remove RDS support</b>\n  </p>\n  <ol>\n    <li>Remove the /MSADC virtual directory mapping from IIS. \n<li>Remove the RDS files and subdirectories at the following location: \n<p>\\Program Files\\Common Files\\System\\Msadc </p><li>Remove the following registry key: \n<p>HKLM\\System\\CurrentControlSet\\Services\\W3SVC\\Parameters\\ADCLaunch </p></li></li></li>\n  </ol>\n  <blockquote>\n    <b>Note</b>&nbsp;&nbsp;&nbsp;IISLockdown provides an option to remove the MSADC virtual directory. Note that IISLockdown only removes the virtual directory, not the files or registry key.</blockquote>\n  <h3>Securing RDS</h3>\n  <p>If your applications require RDS, secure it.</p>\n  <p>\n    <b>To secure RDS</b>\n  </p>\n  <ol>\n    <li>Delete the samples at the following location: \n<p>\\Progam Files\\Common Files\\System\\Msadc\\Samples </p><li>Remove the following registry key: \n<p><b>HKLM\\System\\CurrentControlSet\\Services\\W3SVC\\Parameters\\ADCLaunch\\VbBusObj.VbBusObjCls</b></p><li>Disable Anonymous access for the MSADC virtual directory in IIS. \n<li>Create a <b>HandlerRequired</b> registry key in the following location: \n<p><b>HKLM\\Software\\Microsoft\\DataFactory\\HandlerInfo\\</b></p><li>Create a new DWORD value, and set it to <b>1</b> (1 indicates safe mode, while 0 indicates unsafe mode. </li></li></li></li></li>\n  </ol>\n  <blockquote>\n    <b>Note</b>&nbsp;&nbsp;&nbsp;You can use the registry script file Handsafe.reg to change the registry key. The script file is located in the msadc directory: \\Program Files\\Common Files\\System\\msadc</blockquote>\n  <h1>Additional Resources</h1>\n  <p>For more information about securing RDS, see the following: </p>\n  <ul>\n    <li>MS99-025 Microsoft Security Program: Unauthorized Access to IIS Servers through ODBC Data Access with RDS at <a href=\"http://www.microsoft.com/technet/security/bulletin/ms99-025.mspx\">http://www.microsoft.com/technet/security/bulletin/ms99-025.mspx</a>. \n<li>MS98-004 Microsoft Security Program: Microsoft Security Bulletin: Unauthorized ODBC Data Access with RDS and IIS at <a href=\"http://www.microsoft.com/technet/security/bulletin/ms98-004.mspx\">http://www.microsoft.com/technet/security/bulletin/ms98-004.mspx</a>. \n<li>Microsoft Knowledge Base article 184375, \"PRB: Security Implications of RDS 1.5, IIS 3.0 or 4.0, and ODBC.\" </li></li></li>\n  </ul>\n  <hr />\n  <p>Adapted from Microsoft patterns & practices guidance.</p>"
        ]
      }
    ]
  }
}