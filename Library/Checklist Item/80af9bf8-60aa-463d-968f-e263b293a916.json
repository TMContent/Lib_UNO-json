{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "1386104201",
      "Content_Hash": "-406350181"
    },
    "Metadata": [
      {
        "Id": [
          "80af9bf8-60aa-463d-968f-e263b293a916"
        ],
        "Id_History": [
          "80af9bf8-60aa-463d-968f-e263b293a916,ef97b7c3-8453-4b6e-9547-1ef4cb71c875,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "1sink dupe Session IDs Are Not Disclosed"
        ],
        "Category": [
          "Session Management"
        ],
        "Phase": [
          "Design"
        ],
        "Technology": [
          ".NET"
        ],
        "Type": [
          "Checklist Item"
        ],
        "DirectLink": [
          "Session IDs Are Not Disclosed"
        ],
        "Tag": [
          "ASP.NET,ASP.NET 4.0,ASP"
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>What to Check For</h1>\r\n  <p>Verify that session IDs are not disclosed.</p>\r\n  <h1>Why</h1>\r\n  <p>Do not disclose session IDs to make it harder for an attacker to compromise a user's session.</p>\r\n  <h1>How To Check</h1>\r\n  <p>To verify that session IDs are not disclosed:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>Find all pages that use session IDs.</strong> Make a list of all pages that use ASP.NET session management functions.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Verify that a HTTPS binding exists.</strong> Start the \"<em>Internet Information Services (IIS) Manager</em>\". Right-click on the site and select \"<em>Edit bindings...</em>\". Verify that a https binding exists.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Verify that TLS is enabled.</strong> Start the \"<em>Internet Information Services (IIS) Manager</em>\". Navigate the folders with pages that use ASP.NET session management. Double-click on the SSL icon in the right pane and make sure that is enabled.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Verify that session cookies are marked as secure.</strong> Find code that handles session cookies. Make sure that form authentication and session ID cookies are marked as secure. Code similar to that below can be used to mark cookies as secure:</p>\r\n      <pre>if (Response.Cookies.Count &gt; 0)<br />{<br />&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (string cookie in Response.Cookies.AllKeys)<br />&amp;nbsp;&amp;nbsp;&amp;nbsp; {<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (cookie == FormsAuthentication.FormsCookieName)<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.Cookies[cookie].Secure = true;<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; else if (cookie == “ASP.NET_SessionId”){<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.Cookies[cookie].Secure = true;<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }<br />&amp;nbsp;&amp;nbsp;&amp;nbsp; }<br />}</pre>\r\n    </li>\r\n  </ol>\r\n  <h1>How To Fix</h1>\r\n  <p>To prevent disclosure of session IDs:</p>\r\n  <ol>\r\n    <li>\r\n      <p>\r\n        <strong>The session IDs should be sent in non-persistent cookies.</strong> This is the setting used by ASP.NET by default. Review the application design to make sure that this default has not been changed.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Find all pages that use session IDs.</strong> Make a list of all pages that use ASP.NET session management functions.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Enable a HTTPS binding for the site.</strong> Start the \"<em>Internet Information Services (IIS) Manager</em>\". Right-click on the site and select \"<em>Edit bindings...</em>\". Add a binding of the \"<em>https</em>\" type.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Enable TLS on all pages that use session IDs.</strong> Start the \"<em>Internet Information Services (IIS) Manager</em>\". Navigate the folders with pages that use ASP.NET session management. Double-click on the SSL icon in the right pane and enable TLS for the folder. </p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Mark session cookies as secure.</strong> Marking session cookies as secure assures that they are only sent over HTTPS connections.</p>\r\n      <pre>if (Response.Cookies.Count &gt; 0)<br />{<br />&amp;nbsp;&amp;nbsp;&amp;nbsp; foreach (string cookie in Response.Cookies.AllKeys)<br />&amp;nbsp;&amp;nbsp;&amp;nbsp; {<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; if (cookie == FormsAuthentication.FormsCookieName)<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; {<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.Cookies[cookie].Secure = true;<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; else if (cookie == “ASP.NET_SessionId”){<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Response.Cookies[cookie].Secure = true;<br />&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; }<br />&amp;nbsp;&amp;nbsp;&amp;nbsp; }<br />}</pre>\r\n    </li>\r\n  </ol>\r\n  <h1>Additional Resources</h1>\r\n  <ul>\r\n    <li>\r\n      <p>For more information about the SessionID property, please see \"HttpSessionState.SessionID Property\" at&amp;nbsp;<a href=\"http://msdn.microsoft.com/en-us/library/system.web.sessionstate.httpsessionstate.sessionid.aspx\">http://msdn.microsoft.com/en-us/library/system.web.sessionstate.httpsessionstate.sessionid.aspx</a></p>\r\n    </li>\r\n    <li>\r\n      <p>For more information about session management, please see \"Session Management - OWASP\" at&amp;nbsp;<a href=\"http://www.owasp.org/index.php/Session_Management#Protect_Session_Identifiers\">http://www.owasp.org/index.php/Session_Management#Protect_Session_Identifiers</a></p>\r\n    </li>\r\n  </ul>"
        ]
      }
    ]
  }
}