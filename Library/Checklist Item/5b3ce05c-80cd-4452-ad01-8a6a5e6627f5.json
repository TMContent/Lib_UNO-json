{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "-2065333840",
      "Content_Hash": "272043732"
    },
    "Metadata": [
      {
        "Id": [
          "5b3ce05c-80cd-4452-ad01-8a6a5e6627f5"
        ],
        "Id_History": [
          "5b3ce05c-80cd-4452-ad01-8a6a5e6627f5,baa3384b-941a-4423-bab9-749326d45f04,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "[SINK] To Prevent SQL Injection, Input Is Validated And Parameterized Stored Procedures Are Used."
        ],
        "Category": [
          "Database Security"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          ".NET 3.5"
        ],
        "Type": [
          "Checklist Item"
        ],
        "DirectLink": [
          "To Prevent SQL Injection, Input Is Validated And Parameterized Stored Procedures Are Used."
        ],
        "Tag": [
          ""
        ],
        "Security_Demand": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ],
        "Source": [
          "SI"
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "true",
          "DataType": "Html"
        },
        "Data": [
          "<h1>What to Check For</h1>\r\n  <p>Check to ensure that SQL injection is prevented by validating input and by&nbsp;using parameterized stored procedures.</p>\r\n  <p />\r\n  <h1>How to Fix</h1>\r\n  <p>To help prevent SQL injection, you should validate input and use parameterized stored procedures for data access. The use of parameters (for example, <b>SqlParameterCollection</b>) ensures that input values are checked for type and length and values outside the range throw an exception. Parameters are also treated as safe literal values and not as executable code within the database. The following code shows how to use <b>SqlParameterCollection</b> when calling a stored procedure.</p>\r\n  <div>\r\n    <pre>using System.Data;<br />using System.Data.SqlClient;<br />using (SqlConnection connection = new SqlConnection(connectionString))&#123;<br />  DataSet userDataset = new DataSet();<br />  SqlDataAdapter myCommand = new SqlDataAdapter(<br />              \"LoginStoredProcedure\", connection);<br />  myCommand.SelectCommand.CommandType = CommandType.StoredProcedure;<br />  myCommand.SelectCommand.Parameters.Add(\"&#64;au_id\", SqlDbType.VarChar, 11);<br />  myCommand.SelectCommand.Parameters&#91;\"&#64;au_id\"&#93;.Value = SSN.Text;<br />  myCommand.Fill(userDataset);<br />&#125;  </pre>\r\n  </div>\r\n  <p>Avoid stored procedures that accept a single parameter as an executable query. Instead, pass query parameters only.</p>\r\n  <p>Use structured exception handling to catch errors that occur during database access, and prevent them from being returned to the client. A detailed error message may reveal valuable information such as the connection string, SQL server name, or table and database naming conventions. Attackers can use this information to construct more precise attacks.</p>\r\n  <p>As an additional precaution, use a least privileged account to access the database, so that even if your application is compromised, the impact will be reduced.</p>\r\n  <hr />\r\n  <p>Adapted from Microsoft patterns & practices guidance.</p>"
        ]
      }
    ]
  }
}