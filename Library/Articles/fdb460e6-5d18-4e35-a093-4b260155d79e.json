{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "0",
      "Content_Hash": "0"
    },
    "Metadata": [
      {
        "Id": [
          "fdb460e6-5d18-4e35-a093-4b260155d79e"
        ],
        "Id_History": [
          "fdb460e6-5d18-4e35-a093-4b260155d79e,02752a1a-23c3-4090-9401-5c1de8bf999a,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "Include Unique Tokens in HTTP Requests"
        ],
        "Category": [
          "Session Management"
        ],
        "Phase": [
          "Implementation"
        ],
        "Technology": [
          "Technology Independent"
        ],
        "Type": [
          "Guideline"
        ],
        "DirectLink": [
          "Include Unique Tokens in HTTP Requests"
        ],
        "Tag": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "false",
          "DataType": "markdown"
        },
        "Data": [
          "## What to Do ##\r\n\r\nWhen performing sensitive operations, include unique tokens in HTTP requests to prevent cross-site request forgery (CSRF).\r\n\r\n## Why ##\r\n\r\nCSRF may occur when an attacker can form a URL which performs an action on behalf of an authenticated user. Forming such URLs becomes much more difficult if unique tokens are included in HTTP requests. Including difficult-to-predict tokens in HTTP requests is an effective defense against CSRF attacks.\r\n\r\n## How ##\r\n\r\nTo include unique tokens in HTTP requests:\r\n\r\n1. **Identify sensitive operations.** Review application design and code to identify all operations that require authorization.\r\n2. **Identify code that performs sensitive operations.** Identify all pages that are involved in performing sensitive operations. This includes both the pages that link to sensitive operations and the code that actually carries out the sensitive operations.\r\n3. **Choose a method for generating unique tokens.** There are different ways to generate unique tokens. \r\n4. **Add the unique token to the session.** On each page that links to sensitive operations, add code that generates unique tokens and stores them in session variables.\r\n5. **Add unique tokens to HTTP requests.** On each page that links to sensitive operations, add code that sends the generated unique tokens in HTTP requests. One of the simplest ways to do this is to include the tokens in hidden fields in forms.\r\n6. **Add token validation code.** On each page that carries out sensitive operations, add code that compares the tokens sent in HTTP requests to the tokens stored in session variables. This ensures that the tokens are generated by the server as a part of normal application workflow and therefore the requested action is being performed by a legitimate user.\r\n\r\n## Code Examples ##\r\n\r\n* [Java JSF](25e3943b-a651-42c5-9e19-76077de05e90)\r\n* [Java JSP](986c7161-0a76-430a-8d0e-80d4615ab5db)\r\n* [Java SpringMVC](bf931bed-21c0-4b89-9cb2-9274d8c796a6)\r\n* [Java Struts 1](63deed1a-6df4-4e04-9f61-898f190e1fe1)\r\n* [Java Struts 2](a9c2c121-614c-4a3f-9b7c-f2cf57d6aa0b)\r\n* [Scala](19f2779c-14ec-43fb-8e8d-4505cb0801c9)\r\n* [PHP](4236cf87-7f64-4f77-91b3-04dc1507c366)\r\n* [.NET](8f39bcc9-619b-479e-94b7-af822c7cc5fe)\r\n* [Ruby](cbeb5be7-9425-44db-9446-cd0a56f7b7b6)\r\n\r\n## Vulnerabilities ##\r\n\r\n* [Cross-Site Request Forgery (CSRF)](62f78eb2-9eba-484c-ade3-7b54c2df9e5a)"
        ]
      }
    ]
  }
}