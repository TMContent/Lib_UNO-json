{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "0",
      "Content_Hash": "0"
    },
    "Metadata": [
      {
        "Id": [
          "9e6c8b45-6078-466a-9390-3aacc7fc8ff5"
        ],
        "Id_History": [
          "9e6c8b45-6078-466a-9390-3aacc7fc8ff5,3df21330-e5ac-42c3-93b6-e9eb499634c7,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "Directory Browsing Is Disabled"
        ],
        "Category": [
          "Hardening"
        ],
        "Phase": [
          "Deployment"
        ],
        "Technology": [
          "Scala Play"
        ],
        "Type": [
          "Checklist Item"
        ],
        "DirectLink": [
          "Directory Browsing Is Disabled"
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "false",
          "DataType": "html"
        },
        "Data": [
          "<h1>Applies to</h1>\n  <h1>\n    <p style=\"font-size: medium; font-weight: normal;\">Applications written using Scala and Play Framework 2.1.0 using Nginx as front-end in reverse proxy mode.</p>\n  </h1>\n  <h1>What to Check For</h1>\n  <h1>\n    <p style=\"font-size: medium; font-weight: normal;\">Ensure that your application has directory browsing disabled.</p>\n  </h1>\n  <h1>Why</h1>\n  <h1>\n    <p style=\"font-size: medium; font-weight: normal;\">Directory browsing allows an attacker to browse your application's directory structure in search of unprotected files and components.</p>\n  </h1>\n  <h1>How to Check</h1>\n  <h1>\n    <p style=\"font-size: medium; font-weight: normal;\">Use the following steps to ensure that your application has directory browsing disabled:</p>\n    <ol style=\"font-size: medium; font-weight: normal;\">\n      <li>\n        <p>\n          <strong>Identify if directory browsing is enabled.&nbsp;</strong>Navigate to your application's directories. Identify if your application's server returns the directory contents and not an HTTP error message.</p>\n      </li>\n      <li>\n        <p>\n          <strong>Locate the default Nginx configuration.&nbsp;</strong>In Nginx, the default configuration file is located at&nbsp;<i>/etc/nginx/sites-availabe/default</i>. In the default \"server\" block, look for the presence of the \"location\" element that is mapped to the directory for which directory browsing is to be disabled.&nbsp;</p>\n        <pre>server {\n        listen   80;\n        server_name  domain.com www.domain.com;\n        access_log  /var/...........................;\n        root   /path/to/root;\n        location / {\n                index  index.html index.htm;\n        }\n        location /somedir {\n               autoindex on;\n        }\n}</pre>\n      </li>\n      <li>\n        <p>\n          <strong>Ensure directory browsing is disabled in the default Nginx configuration.&nbsp;</strong>Verify that the&nbsp;<i>HttpAutoindexModule</i>&nbsp;module is initialized with \"off\"&nbsp;&nbsp;to disable directory browsing.</p>\n        <pre> location /somedir {\n               autoindex off;\n        }</pre>\n      </li>\n    </ol>\n  </h1>\n  <h1>How to Fix</h1>\n  <h1>\n    <p style=\"font-size: medium; font-weight: normal;\" />\n    <p style=\"font-size: medium; font-weight: normal;\">To disable directory browsing:</p>\n    <ol style=\"font-size: medium; font-weight: normal;\">\n      <li>\n        <p>\n          <strong>Identify if directory browsing is enabled.&nbsp;</strong>Navigate to your application's directories. Identify&nbsp;whether your application's server correctly returns an HTTP error message. If it incorrectly returns&nbsp;the directory contents, continue with the following steps.</p>\n      </li>\n      <li>\n        <p>\n          <strong>Locate the default Nginx configuration.&nbsp;</strong>In Nginx, the default configuration file is located at&nbsp;<i>/etc/nginx/sites-availabe/default</i>. In the default \"server\" block, look for the presence of the \"location\" element that is mapped to the directory for which&nbsp;directory&nbsp;browsing is to disabled. Example:</p>\n        <pre>server {\n        listen   80;\n        server_name  domain.com www.domain.com;\n        access_log  /var/...........................;\n        root   /path/to/root;\n        location / {\n                index  index.html index.htm;\n        }\n        location /somedir {\n               autoindex on;\n        }\n}</pre>\n      </li>\n      <li>\n        <p>\n          <strong>Deny directory browsing in the default Nginx configuration.&nbsp;</strong>Initialize the&nbsp;<i>HttpAutoindexModule&nbsp;</i>with \"<i>off</i>\" to disable directory browsing. Example:</p>\n        <pre>server {\n        listen   80;\n        server_name  domain.com www.domain.com;\n        access_log  /var/...........................;\n        root   /path/to/root;\n        location / {\n                index  index.php index.html index.htm;\n        }\n        location /somedir {\n               autoindex off;\n        }\n}</pre>\n      </li>\n    </ol>\n  </h1>\n  <h1>Problem Example</h1>\n  <h1>\n    <span style=\"font-size: medium; font-weight: normal; background-color: rgb(255, 255, 255);\">An application is deployed on a production server. Unfortunately, the developers did not disable directory browsing. This allows an attacker to search for unprotected configuration files.</span>\n  </h1>\n  <h1>Solution Example</h1>\n  <h1>\n    <span style=\"font-size: medium; font-weight: normal; background-color: rgb(255, 255, 255);\">An application is deployed on a production server. Because the developers have disabled directory browsing, it is difficult for an attacker to use HTTP browsing to search for unprotected configuration files.</span>\n  </h1>\n  <h1 style=\"margin: 0px; padding: 10px 0px 0px; font-size: 17px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255);\">Deployment Guidelines</h1>\n  <h1 style=\"margin: 0px; padding: 10px 0px 0px; font-size: 17px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255);\">\n    <ul style=\"font-weight: normal; margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-size: small;\">\n      <li style=\"margin: 0px; padding: 0px;\">\n        <b>\n          <a href=\"8e5263d3-3fc8-43a9-9636-57094c58f4c4\">Remove Test Accounts</a>\n        </b>\n      </li>\n      <li style=\"margin: 0px; padding: 0px;\">\n        <b>\n          <a href=\"5a36d20f-d8e0-4a86-8776-1f3e95a9da9c\">Disable Directory Browsing</a>\n        </b>\n      </li>\n      <li style=\"margin: 0px; padding: 0px;\">\n        <b>\n          <a href=\"15ccde50-5626-4d85-872d-7ea4ee50e749\">Do not store Plain text data</a>\n        </b>\n      </li>\n    </ul>\n  </h1>\n  <h1 style=\"margin: 0px; padding: 10px 0px 0px; font-size: 17px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255);\">Deployment Checklists</h1>\n  <h1 style=\"margin: 0px; padding: 10px 0px 0px; font-size: 17px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; background-color: rgb(255, 255, 255);\">\n    <ul style=\"font-weight: normal; margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-size: small;\">\n      <li style=\"margin: 0px; padding: 0px;\">\n        <b>\n          <a href=\"ebe0ff95-10a5-4243-a77c-7e07a7381470\">Test Accounts Are Removed</a>\n        </b>\n      </li>\n      <li style=\"margin: 0px; padding: 0px;\">\n        <b>\n          <a href=\"9e6c8b45-6078-466a-9390-3aacc7fc8ff5\">Directory Browsing Is Disabled</a>\n        </b>\n      </li>\n      <li style=\"margin: 0px; padding: 0px;\">\n        <b>\n          <a href=\"15ccde50-5626-4d85-872d-7ea4ee50e749\">Sensitive Data Inside Configuration Files Is Protected</a>\n        </b>\n      </li>\n    </ul>\n  </h1>\n  <ul style=\"margin: 10px 0px 10px 25px; padding: 0px 0px 0px 30px; font-family: 'Segoe UI', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: small; background-color: rgb(255, 255, 255);\">\n  </ul>"
        ]
      }
    ]
  }
}