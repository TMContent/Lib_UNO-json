{
  "TeamMentor_Article": {
    "$": {
      "Metadata_Hash": "0",
      "Content_Hash": "0"
    },
    "Metadata": [
      {
        "Id": [
          "0bf6f129-8641-43f4-a29c-62f58493fb78"
        ],
        "Id_History": [
          "0bf6f129-8641-43f4-a29c-62f58493fb78,81111aba-f125-46ba-813d-ce4358ae3fb3,"
        ],
        "Library_Id": [
          "be5273b1-d682-4361-99d9-6234f2d47eb7"
        ],
        "Title": [
          "Input from All Sources Is Validated"
        ],
        "Category": [
          "Input and Data Validation"
        ],
        "Phase": [
          "Design"
        ],
        "Technology": [
          "Scala Play"
        ],
        "Type": [
          "Checklist Item"
        ],
        "DirectLink": [
          "Input from All Sources Is Validated"
        ],
        "Tag": [
          ""
        ],
        "Author": [
          ""
        ],
        "Priority": [
          ""
        ],
        "Status": [
          ""
        ]
      }
    ],
    "Content": [
      {
        "$": {
          "Sanitized": "false",
          "DataType": "html"
        },
        "Data": [
          "<h1>Applies To</h1>\r\n  <p>Applications written using Scala and Play Framework 2.1.0</p>\r\n  <h1 style=\"font-style: normal;\">What to Check For</h1>\r\n  <p style=\"font-style: normal;\">Check for input that has not been passed through a validation routine. All input from external sources should be validated.</p>\r\n  <h1 style=\"font-style: normal;\">Why</h1>\r\n  <p style=\"font-style: normal;\">Input that is not validated can lead to cross-site scripting, SQL injection, directory traversals, and other vulnerabilities which would allow an attacker to gain unauthorized access to sensitive data.</p>\r\n  <h1 style=\"font-style: normal;\">How to Check</h1>\r\n  <p style=\"font-style: normal;\">Use the following steps to establish a validation strategy:</p>\r\n  <ol>\r\n    <li>\r\n      <p style=\"font-style: normal;\">\r\n        <strong>Identify all sources of input. </strong>An application can take input via various ways such as a web interface, \r\ndatabase, file system or other software running on the server. At design time identify all potential sources of input to your application. Once implemented, scour source code to discover sources of input that may have been missed in the design. Potential sources of input in a web application typically include:</p>\r\n      <ul style=\"font-style: normal;\">\r\n      </ul>\r\n      <ol>\r\n      </ol>\r\n      <ul>\r\n        <li>URL based parameters</li>\r\n        <li>Form based parameters</li>\r\n        <li>Hidden fields</li>\r\n        <li>Cookies</li>\r\n        <li>HTTP headers (Host, accept types, www authentication, cache settings, encodings, etc)</li>\r\n        <li>Local filesystem</li>\r\n        <li>Database</li>\r\n        <li>Other services running on the system</li>\r\n        <li>Javascript variables</li>\r\n        <li>File upload and attributes (filename, size, data, etc)</li>\r\n        <li>DNS results or host names</li>\r\n        <li>External component call return values (AJAX. etc)</li>\r\n      </ul>\r\n      <ol>\r\n      </ol>\r\n      <ul style=\"font-style: normal;\">\r\n      </ul>\r\n      <p style=\"font-style: normal;\">Once you've identified <font color=\"#NaN\">the sources of input</font>, look for all entry points from where data from user can be sent to the server. Good starting points are method parameters and assignment statements. For example, this method uses the&amp;nbsp;<em>searchTerm</em>&amp;nbsp;variable:</p>\r\n      <pre style=\"font-style: normal;\">def productSearch = Action { implicit request =&gt;<br /> ...<br />val searchTerm = prodForm.searchterm</pre>\r\n      <p>This assignment stores data from the form-field <i>searchterm</i>&amp;nbsp;and&amp;nbsp;stores it in the string&amp;nbsp;<em style=\"font-style: normal;\">searchTerm</em>. Ensure that this input is validated before being used somewhere in the code.</p>\r\n    </li>\r\n    <li style=\"font-style: normal;\">\r\n      <p>\r\n        <strong>Trace data from source to sink.&amp;nbsp;</strong>Trace each source of input through your application to its final destination. The final sink may be in memory, on the hard drive, sent over the network or stored in a data store such as a database.</p>\r\n    </li>\r\n    <li style=\"font-style: normal;\">\r\n      <p>\r\n        <strong>Identify validation routines.&amp;nbsp;</strong>Each input source should have a validation routine associated with it. Ideally the validation will occur as soon as the input reaches your application. Shared validation routines are better than creating many throughout the code base, so check for consolidation of routines to aid testing and reduce the chance of one-off bugs. If any input source does not have a validation routine associated with it, flag it for fixing.</p>\r\n    </li>\r\n    <li style=\"font-style: normal;\">\r\n      <p>\r\n        <strong>Ensure quality of validators. </strong>Validation routines should check for length, range, format and type. First check for good data through whitelisting, then for known malicious data through blacklisting. Validate on the server--do not rely on client-side validation alone, as it can be easily bypassed.</p>\r\n    </li>\r\n  </ol>\r\n  <h1 style=\"font-style: normal;\">How to Fix</h1>\r\n  <ol style=\"font-style: normal;\">\r\n    <li>\r\n      <p>\r\n        <strong>Establish your application's trust boundary:</strong> Consider all input not generated by your application to be untrusted.</p>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Identify all sources of input</strong>: Each source of input represents an entry point to your application&amp;nbsp;that can potentially be used to break your application's security model. Enumerate all possible sources of input and make note of the expected input&amp;nbsp;at&amp;nbsp;each source. Potential sources of input in a web application typically include: <br /></p>\r\n      <ol>\r\n      </ol>\r\n      <ul>\r\n        <li>URL based parameters</li>\r\n        <li>Form based parameters</li>\r\n        <li>Hidden fields</li>\r\n        <li>Cookies</li>\r\n        <li>HTTP headers</li>\r\n        <li>Local filesystem</li>\r\n        <li>Database</li>\r\n        <li>Other services running on the system</li>\r\n        <li>Javascript variables</li>\r\n        <li>File upload and attributes (filename, size, data, etc)</li>\r\n        <li>DNS results or host names</li>\r\n        <li>External component call return values (AJAX. etc)</li>\r\n      </ul>\r\n      <ol>\r\n      </ol>\r\n    </li>\r\n    <li>\r\n      <p>\r\n        <strong>Understand the input that your application can handle and process</strong>: For each source of input, define the format and type of input expected.</p>\r\n    </li>\r\n    <li>\r\n      <p />\r\n      <strong>Create a set of validators</strong>: Build a validator for each format and type of expected input. Centralize your application's validators--this helps strengthen the code by limiting the amount of validation code scattered throughout your application. Place the set of validators on your application's trust boundary. Your application should accept input from the outside world only through its set of validators.</li>\r\n  </ol>"
        ]
      }
    ]
  }
}